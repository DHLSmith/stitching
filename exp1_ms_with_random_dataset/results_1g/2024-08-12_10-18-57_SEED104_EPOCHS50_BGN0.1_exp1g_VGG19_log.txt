Executed at 2024-08-12_10-18-57
logging to ./results_1g/2024-08-12_10-18-57_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_log.txt
seed=104
bg_noise=0.1
synthetic_dataset_noise=0.1
train_mix_mnist_model=False
mix_mnist_model_to_load='./results_1g/2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist.weights'
train_bw_mnist_model=False
bw_mnist_model_to_load='./results_1g/2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist.weights'
train_bg_only_colour_mnist_model=False
bg_only_colour_mnist_model_to_load='./results_1g/2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist.weights'
train_bg_unbiased_colour_mnist_model=False
bg_unbiased_colour_mnist_model_to_load='./results_1g/2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist.weights'
train_biased_colour_mnist_model=False
biased_colour_mnist_model_to_load='./results_1g/2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist.weights'
train_unbiased_colour_mnist_model=False
unbiased_colour_mnist_model_to_load='./results_1g/2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist.weights'
stitch_train_epochs=50
================================================
val['loadfrom']='./results_1g/2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist.weights'
val['loadfrom']='./results_1g/2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist.weights'
val['loadfrom']='./results_1g/2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist.weights'
val['loadfrom']='./results_1g/2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist.weights'
val['loadfrom']='./results_1g/2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist.weights'
val['loadfrom']='./results_1g/2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist.weights'
Accuracy Calculation for VGG19 with key='bw'
Test the Trained VGG19
Test Accuracy: 99.12 %
Confusion Matrix
tensor([[ 975,    0,    1,    0,    0,    0,    2,    1,    1,    0],
        [   0, 1133,    0,    0,    0,    0,    1,    1,    0,    0],
        [   1,    2, 1024,    0,    1,    0,    0,    3,    1,    0],
        [   0,    0,    0, 1004,    0,    3,    0,    1,    1,    1],
        [   0,    0,    0,    0,  975,    0,    3,    1,    0,    3],
        [   2,    0,    0,    8,    0,  880,    1,    0,    0,    1],
        [   2,    3,    0,    1,    1,    3,  948,    0,    0,    0],
        [   0,    4,    4,    0,    0,    0,    0, 1016,    1,    3],
        [   0,    0,    1,    4,    1,    1,    0,    0,  964,    3],
        [   1,    2,    0,    2,    6,    2,    0,    3,    0,  993]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='mix'
Test the Trained VGG19
Test Accuracy: 99.23 %
Confusion Matrix
tensor([[ 967,    0,    1,    0,    0,    1,    1,    0,    0,    0],
        [   0, 1179,    0,    0,    0,    1,    1,    0,    0,    0],
        [   0,    0, 1037,    1,    1,    0,    1,    1,    1,    0],
        [   0,    1,    0,  960,    0,    3,    0,    1,    0,    0],
        [   0,    0,    0,    0,  938,    1,    2,    0,    1,   16],
        [   1,    0,    0,    0,    0,  929,    1,    0,    0,    0],
        [   1,    0,    0,    2,    0,    1,  930,    0,    0,    0],
        [   0,    1,    5,    2,    0,    0,    0, 1015,    0,    1],
        [   0,    0,    3,    0,    1,    5,    1,    2, 1009,    2],
        [   1,    3,    0,    0,    2,    5,    0,    1,    1,  959]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='bgonly'
Test the Trained VGG19
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='bg'
Test the Trained VGG19
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  996,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  996,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1003,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1003,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  999,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1003,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1003,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  990]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='bias'
Test the Trained VGG19
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='unbias'
Test the Trained VGG19
Test Accuracy: 98.35 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    0,    2,    1,    1,    0],
        [   0, 1126,    0,    1,    0,    1,    3,    2,    2,    0],
        [   6,    0, 1008,    8,    1,    0,    1,    7,    1,    0],
        [   0,    0,    0, 1003,    0,    1,    0,    3,    2,    1],
        [   0,    0,    1,    0,  964,    0,    4,    2,    0,   11],
        [   1,    0,    0,   15,    0,  871,    1,    0,    1,    3],
        [   6,    3,    0,    1,    4,    8,  932,    0,    4,    0],
        [   0,    1,    2,    0,    0,    0,    0, 1020,    1,    4],
        [   0,    0,    3,    8,    3,    3,    0,    4,  950,    3],
        [   0,    3,    0,    5,    7,    1,    0,    7,    1,  985]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'bw': 99.12, 'mix': 99.23, 'bgonly': 100.0, 'bg': 100.0, 'bias': 100.0, 'unbias': 98.35}
Already evaluated for ./results_1g_rank/bw-bw-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
Already evaluated for ./results_1g_rank/mix-mix-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist-test.csv
Already evaluated for ./results_1g_rank/bgonly-bgonly-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist-test.csv
Already evaluated for ./results_1g_rank/bg-bg-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist-test.csv
Already evaluated for ./results_1g_rank/bias-bias-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist-test.csv
Already evaluated for ./results_1g_rank/unbias-unbias-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist-test.csv
Evaluate ranks and output to ./results_1g_rank/X1bw-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
stitch into model bw
after layer 1, activations shape is torch.Size([10, 512, 7, 7])
Train the stitch to a top model cut after layer 1
Evaluate ranks and output to ./results_1g_rank/X1bw-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
stitch into model bw
after layer 1, activations shape is torch.Size([10, 64, 32, 32])
Train the stitch to a top model cut after layer 1
Epoch 0, loss 577.59
Epoch 1, loss 43.38
Epoch 2, loss 31.41
Epoch 3, loss 28.29
Epoch 4, loss 27.54
Epoch 5, loss 27.29
Epoch 6, loss 27.27
Epoch 7, loss 27.26
Epoch 8, loss 27.20
Epoch 9, loss 27.12
Epoch 10, loss 27.29
Epoch 11, loss 27.60
Epoch 12, loss 28.07
Epoch 13, loss 28.44
Epoch 14, loss 28.66
Epoch 15, loss 28.87
Epoch 16, loss 29.27
Epoch 17, loss 29.69
Epoch 18, loss 29.87
Epoch 19, loss 30.08
Epoch 20, loss 30.37
Epoch 21, loss 30.60
Epoch 22, loss 30.46
Epoch 23, loss 30.45
Epoch 24, loss 30.17
Epoch 25, loss 30.20
Epoch 26, loss 30.12
Epoch 27, loss 30.07
Epoch 28, loss 30.01
Epoch 29, loss 29.92
Epoch 30, loss 29.88
Epoch 31, loss 29.99
Epoch 32, loss 30.00
Epoch 33, loss 30.09
Epoch 34, loss 29.96
Epoch 35, loss 30.05
Epoch 36, loss 30.00
Epoch 37, loss 29.91
Epoch 38, loss 29.93
Epoch 39, loss 30.00
Epoch 40, loss 30.05
Epoch 41, loss 29.94
Epoch 42, loss 29.90
Epoch 43, loss 29.90
Epoch 44, loss 29.95
Epoch 45, loss 29.97
Epoch 46, loss 30.00
Epoch 47, loss 29.99
Epoch 48, loss 30.00
Epoch 49, loss 29.90
**** Finished Training ****
Change in stitch weights: 4.700687408447266
Largest abs weight change: 0.1603318452835083
Number of weights changing > 0.1 of that: 3577
Change in stitch bias: 0.5345088243484497
Largest abs bias change: 0.12326911091804504
Number of bias changing > 0.1 of that: 56
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X8bw-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
stitch into model bw
after layer 8, activations shape is torch.Size([10, 128, 16, 16])
Train the stitch to a top model cut after layer 8
Epoch 0, loss 1280.80
Epoch 1, loss 221.46
Epoch 2, loss 82.38
Epoch 3, loss 64.13
Epoch 4, loss 57.68
Epoch 5, loss 55.25
Epoch 6, loss 54.16
Epoch 7, loss 53.98
Epoch 8, loss 53.75
Epoch 9, loss 54.13
Epoch 10, loss 54.66
Epoch 11, loss 55.14
Epoch 12, loss 55.10
Epoch 13, loss 55.16
Epoch 14, loss 55.58
Epoch 15, loss 55.86
Epoch 16, loss 56.06
Epoch 17, loss 56.35
Epoch 18, loss 56.69
Epoch 19, loss 56.94
Epoch 20, loss 57.57
Epoch 21, loss 57.77
Epoch 22, loss 57.71
Epoch 23, loss 58.11
Epoch 24, loss 58.06
Epoch 25, loss 58.18
Epoch 26, loss 58.01
Epoch 27, loss 57.96
Epoch 28, loss 57.91
Epoch 29, loss 57.61
Epoch 30, loss 57.75
Epoch 31, loss 57.61
Epoch 32, loss 57.57
Epoch 33, loss 57.38
Epoch 34, loss 57.45
Epoch 35, loss 57.32
Epoch 36, loss 57.39
Epoch 37, loss 57.28
Epoch 38, loss 57.14
Epoch 39, loss 57.22
Epoch 40, loss 57.29
Epoch 41, loss 57.11
Epoch 42, loss 57.30
Epoch 43, loss 57.15
Epoch 44, loss 57.18
Epoch 45, loss 57.17
Epoch 46, loss 57.04
Epoch 47, loss 56.91
Epoch 48, loss 56.90
Epoch 49, loss 56.78
**** Finished Training ****
Change in stitch weights: 6.570130825042725
Largest abs weight change: 0.12327881157398224
Number of weights changing > 0.1 of that: 14094
Change in stitch bias: 0.5727521181106567
Largest abs bias change: 0.08687126636505127
Number of bias changing > 0.1 of that: 113
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X22bw-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
stitch into model bw
after layer 22, activations shape is torch.Size([10, 512, 4, 4])
Train the stitch to a top model cut after layer 22
Epoch 0, loss 18.39
Epoch 1, loss 1.71
Epoch 2, loss 1.55
Epoch 3, loss 1.52
Epoch 4, loss 1.53
Epoch 5, loss 1.57
Epoch 6, loss 1.58
Epoch 7, loss 1.63
Epoch 8, loss 1.68
Epoch 9, loss 1.71
Epoch 10, loss 1.78
Epoch 11, loss 1.85
Epoch 12, loss 1.94
Epoch 13, loss 2.05
Epoch 14, loss 2.18
Epoch 15, loss 2.35
Epoch 16, loss 2.54
Epoch 17, loss 2.78
Epoch 18, loss 3.07
Epoch 19, loss 3.46
Epoch 20, loss 3.99
Epoch 21, loss 4.63
Epoch 22, loss 5.42
Epoch 23, loss 6.26
Epoch 24, loss 7.11
Epoch 25, loss 7.84
Epoch 26, loss 8.38
Epoch 27, loss 8.72
Epoch 28, loss 8.91
Epoch 29, loss 9.10
Epoch 30, loss 9.18
Epoch 31, loss 9.23
Epoch 32, loss 9.26
Epoch 33, loss 9.25
Epoch 34, loss 9.29
Epoch 35, loss 9.28
Epoch 36, loss 9.26
Epoch 37, loss 9.28
Epoch 38, loss 9.23
Epoch 39, loss 9.20
Epoch 40, loss 9.24
Epoch 41, loss 9.21
Epoch 42, loss 9.19
Epoch 43, loss 9.21
Epoch 44, loss 9.14
Epoch 45, loss 9.19
Epoch 46, loss 9.16
Epoch 47, loss 9.16
Epoch 48, loss 9.16
Epoch 49, loss 9.15
**** Finished Training ****
Change in stitch weights: 12.992006301879883
Largest abs weight change: 0.05215528607368469
Number of weights changing > 0.1 of that: 230900
Change in stitch bias: 0.5798959732055664
Largest abs bias change: 0.04366030916571617
Number of bias changing > 0.1 of that: 463
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X29bw-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
stitch into model bw
after layer 29, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 29
Epoch 0, loss 29.43
Epoch 1, loss 1.68
Epoch 2, loss 1.43
Epoch 3, loss 1.37
Epoch 4, loss 1.33
Epoch 5, loss 1.34
Epoch 6, loss 1.36
Epoch 7, loss 1.38
Epoch 8, loss 1.41
Epoch 9, loss 1.46
Epoch 10, loss 1.53
Epoch 11, loss 1.64
Epoch 12, loss 1.75
Epoch 13, loss 1.90
Epoch 14, loss 2.10
Epoch 15, loss 2.42
Epoch 16, loss 2.91
Epoch 17, loss 3.60
Epoch 18, loss 4.60
Epoch 19, loss 6.08
Epoch 20, loss 7.76
Epoch 21, loss 9.44
Epoch 22, loss 10.77
Epoch 23, loss 11.79
Epoch 24, loss 12.49
Epoch 25, loss 12.93
Epoch 26, loss 13.20
Epoch 27, loss 13.43
Epoch 28, loss 13.54
Epoch 29, loss 13.61
Epoch 30, loss 13.71
Epoch 31, loss 13.73
Epoch 32, loss 13.78
Epoch 33, loss 13.78
Epoch 34, loss 13.77
Epoch 35, loss 13.70
Epoch 36, loss 13.70
Epoch 37, loss 13.71
Epoch 38, loss 13.68
Epoch 39, loss 13.65
Epoch 40, loss 13.74
Epoch 41, loss 13.70
Epoch 42, loss 13.63
Epoch 43, loss 13.64
Epoch 44, loss 13.65
Epoch 45, loss 13.65
Epoch 46, loss 13.66
Epoch 47, loss 13.57
Epoch 48, loss 13.61
Epoch 49, loss 13.60
**** Finished Training ****
Change in stitch weights: 13.027459144592285
Largest abs weight change: 0.05236373841762543
Number of weights changing > 0.1 of that: 230754
Change in stitch bias: 0.5835151672363281
Largest abs bias change: 0.04377055540680885
Number of bias changing > 0.1 of that: 470
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X35bw-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
stitch into model bw
after layer 35, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 35
Epoch 0, loss 91.39
Epoch 1, loss 0.02
Epoch 2, loss 0.02
Epoch 3, loss 0.03
Epoch 4, loss 0.04
Epoch 5, loss 0.05
Epoch 6, loss 0.07
Epoch 7, loss 0.09
Epoch 8, loss 0.12
Epoch 9, loss 0.16
Epoch 10, loss 0.22
Epoch 11, loss 0.27
Epoch 12, loss 0.33
Epoch 13, loss 0.40
Epoch 14, loss 0.47
Epoch 15, loss 0.56
Epoch 16, loss 0.67
Epoch 17, loss 0.82
Epoch 18, loss 1.01
Epoch 19, loss 1.29
Epoch 20, loss 1.70
Epoch 21, loss 2.29
Epoch 22, loss 3.06
Epoch 23, loss 4.01
Epoch 24, loss 4.93
Epoch 25, loss 5.78
Epoch 26, loss 6.34
Epoch 27, loss 6.75
Epoch 28, loss 7.09
Epoch 29, loss 7.22
Epoch 30, loss 7.36
Epoch 31, loss 7.45
Epoch 32, loss 7.50
Epoch 33, loss 7.57
Epoch 34, loss 7.63
Epoch 35, loss 7.59
Epoch 36, loss 7.61
Epoch 37, loss 7.64
Epoch 38, loss 7.61
Epoch 39, loss 7.64
Epoch 40, loss 7.61
Epoch 41, loss 7.62
Epoch 42, loss 7.62
Epoch 43, loss 7.64
Epoch 44, loss 7.61
Epoch 45, loss 7.65
Epoch 46, loss 7.59
Epoch 47, loss 7.64
Epoch 48, loss 7.61
Epoch 49, loss 7.64
**** Finished Training ****
Change in stitch weights: 12.94212818145752
Largest abs weight change: 0.05144193768501282
Number of weights changing > 0.1 of that: 231296
Change in stitch bias: 0.5843841433525085
Largest abs bias change: 0.04378589242696762
Number of bias changing > 0.1 of that: 462
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X1mix-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist-test.csv
stitch into model mix
after layer 1, activations shape is torch.Size([10, 64, 32, 32])
Train the stitch to a top model cut after layer 1
Epoch 0, loss 851.51
Epoch 1, loss 1.28
Epoch 2, loss 1.11
Epoch 3, loss 1.00
Epoch 4, loss 1.16
Epoch 5, loss 1.27
Epoch 6, loss 1.30
Epoch 7, loss 1.39
Epoch 8, loss 1.49
Epoch 9, loss 1.56
Epoch 10, loss 1.63
Epoch 11, loss 1.75
Epoch 12, loss 1.80
Epoch 13, loss 1.90
Epoch 14, loss 1.95
Epoch 15, loss 1.98
Epoch 16, loss 2.03
Epoch 17, loss 1.99
Epoch 18, loss 2.01
Epoch 19, loss 2.01
Epoch 20, loss 2.01
Epoch 21, loss 2.03
Epoch 22, loss 2.04
Epoch 23, loss 2.04
Epoch 24, loss 2.04
Epoch 25, loss 2.06
Epoch 26, loss 2.06
Epoch 27, loss 2.07
Epoch 28, loss 2.06
Epoch 29, loss 2.05
Epoch 30, loss 2.03
Epoch 31, loss 2.03
Epoch 32, loss 2.00
Epoch 33, loss 2.01
Epoch 34, loss 1.99
Epoch 35, loss 1.98
Epoch 36, loss 1.96
Epoch 37, loss 1.95
Epoch 38, loss 1.95
Epoch 39, loss 1.95
Epoch 40, loss 1.93
Epoch 41, loss 1.93
Epoch 42, loss 1.93
Epoch 43, loss 1.90
Epoch 44, loss 1.92
Epoch 45, loss 1.92
Epoch 46, loss 1.92
Epoch 47, loss 1.90
Epoch 48, loss 1.89
Epoch 49, loss 1.90
**** Finished Training ****
Change in stitch weights: 4.574839115142822
Largest abs weight change: 0.14236854016780853
Number of weights changing > 0.1 of that: 3613
Change in stitch bias: 0.6182205677032471
Largest abs bias change: 0.12300991266965866
Number of bias changing > 0.1 of that: 61
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X8mix-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist-test.csv
stitch into model mix
after layer 8, activations shape is torch.Size([10, 128, 16, 16])
Train the stitch to a top model cut after layer 8
Epoch 0, loss 104.49
Epoch 1, loss 3.63
Epoch 2, loss 3.39
Epoch 3, loss 3.45
Epoch 4, loss 3.66
Epoch 5, loss 3.85
Epoch 6, loss 4.04
Epoch 7, loss 4.16
Epoch 8, loss 4.26
Epoch 9, loss 4.31
Epoch 10, loss 4.23
Epoch 11, loss 4.10
Epoch 12, loss 3.94
Epoch 13, loss 3.76
Epoch 14, loss 3.62
Epoch 15, loss 3.53
Epoch 16, loss 3.50
Epoch 17, loss 3.50
Epoch 18, loss 3.54
Epoch 19, loss 3.59
Epoch 20, loss 3.68
Epoch 21, loss 3.81
Epoch 22, loss 3.92
Epoch 23, loss 4.07
Epoch 24, loss 4.21
Epoch 25, loss 4.35
Epoch 26, loss 4.43
Epoch 27, loss 4.52
Epoch 28, loss 4.55
Epoch 29, loss 4.58
Epoch 30, loss 4.56
Epoch 31, loss 4.58
Epoch 32, loss 4.57
Epoch 33, loss 4.57
Epoch 34, loss 4.52
Epoch 35, loss 4.55
Epoch 36, loss 4.52
Epoch 37, loss 4.51
Epoch 38, loss 4.50
Epoch 39, loss 4.49
Epoch 40, loss 4.50
Epoch 41, loss 4.48
Epoch 42, loss 4.47
Epoch 43, loss 4.46
Epoch 44, loss 4.47
Epoch 45, loss 4.46
Epoch 46, loss 4.46
Epoch 47, loss 4.42
Epoch 48, loss 4.45
Epoch 49, loss 4.43
**** Finished Training ****
Change in stitch weights: 6.475798606872559
Largest abs weight change: 0.10335125774145126
Number of weights changing > 0.1 of that: 14507
Change in stitch bias: 0.5309804677963257
Largest abs bias change: 0.08718302845954895
Number of bias changing > 0.1 of that: 115
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X22mix-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist-test.csv
stitch into model mix
after layer 22, activations shape is torch.Size([10, 512, 4, 4])
Train the stitch to a top model cut after layer 22
Epoch 0, loss 22.55
Epoch 1, loss 0.83
Epoch 2, loss 0.95
Epoch 3, loss 1.10
Epoch 4, loss 1.25
Epoch 5, loss 1.40
Epoch 6, loss 1.54
Epoch 7, loss 1.65
Epoch 8, loss 1.77
Epoch 9, loss 1.87
Epoch 10, loss 1.96
Epoch 11, loss 2.05
Epoch 12, loss 2.17
Epoch 13, loss 2.28
Epoch 14, loss 2.39
Epoch 15, loss 2.53
Epoch 16, loss 2.72
Epoch 17, loss 2.92
Epoch 18, loss 3.20
Epoch 19, loss 3.55
Epoch 20, loss 3.99
Epoch 21, loss 4.61
Epoch 22, loss 5.32
Epoch 23, loss 6.14
Epoch 24, loss 7.01
Epoch 25, loss 7.81
Epoch 26, loss 8.48
Epoch 27, loss 9.01
Epoch 28, loss 9.36
Epoch 29, loss 9.61
Epoch 30, loss 9.73
Epoch 31, loss 9.85
Epoch 32, loss 9.93
Epoch 33, loss 9.94
Epoch 34, loss 9.95
Epoch 35, loss 9.95
Epoch 36, loss 10.00
Epoch 37, loss 9.93
Epoch 38, loss 9.94
Epoch 39, loss 9.96
Epoch 40, loss 9.87
Epoch 41, loss 9.91
Epoch 42, loss 9.89
Epoch 43, loss 9.89
Epoch 44, loss 9.85
Epoch 45, loss 9.85
Epoch 46, loss 9.84
Epoch 47, loss 9.82
Epoch 48, loss 9.85
Epoch 49, loss 9.80
**** Finished Training ****
Change in stitch weights: 12.992844581604004
Largest abs weight change: 0.05122877657413483
Number of weights changing > 0.1 of that: 231612
Change in stitch bias: 0.5539546012878418
Largest abs bias change: 0.04364156723022461
Number of bias changing > 0.1 of that: 461
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X29mix-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist-test.csv
stitch into model mix
after layer 29, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 29
Epoch 0, loss 29.75
Epoch 1, loss 3.04
Epoch 2, loss 2.62
Epoch 3, loss 2.57
Epoch 4, loss 2.61
Epoch 5, loss 2.71
Epoch 6, loss 2.85
Epoch 7, loss 3.05
Epoch 8, loss 3.23
Epoch 9, loss 3.49
Epoch 10, loss 3.77
Epoch 11, loss 4.19
Epoch 12, loss 4.70
Epoch 13, loss 5.37
Epoch 14, loss 6.32
Epoch 15, loss 7.51
Epoch 16, loss 9.10
Epoch 17, loss 10.99
Epoch 18, loss 13.21
Epoch 19, loss 15.48
Epoch 20, loss 17.57
Epoch 21, loss 19.29
Epoch 22, loss 20.78
Epoch 23, loss 21.76
Epoch 24, loss 22.53
Epoch 25, loss 23.05
Epoch 26, loss 23.46
Epoch 27, loss 23.76
Epoch 28, loss 24.01
Epoch 29, loss 24.10
Epoch 30, loss 24.38
Epoch 31, loss 24.40
Epoch 32, loss 24.31
Epoch 33, loss 24.35
Epoch 34, loss 24.27
Epoch 35, loss 24.30
Epoch 36, loss 24.15
Epoch 37, loss 24.15
Epoch 38, loss 24.27
Epoch 39, loss 24.23
Epoch 40, loss 24.16
Epoch 41, loss 24.11
Epoch 42, loss 24.00
Epoch 43, loss 24.06
Epoch 44, loss 24.04
Epoch 45, loss 24.00
Epoch 46, loss 24.02
Epoch 47, loss 23.93
Epoch 48, loss 23.98
Epoch 49, loss 24.03
**** Finished Training ****
Change in stitch weights: 13.015958786010742
Largest abs weight change: 0.0526808500289917
Number of weights changing > 0.1 of that: 230751
Change in stitch bias: 0.5775236487388611
Largest abs bias change: 0.043750565499067307
Number of bias changing > 0.1 of that: 458
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X35mix-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist-test.csv
stitch into model mix
after layer 35, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 35
Epoch 0, loss 31.54
Epoch 1, loss 0.21
Epoch 2, loss 0.22
Epoch 3, loss 0.25
Epoch 4, loss 0.33
Epoch 5, loss 0.40
Epoch 6, loss 0.45
Epoch 7, loss 0.52
Epoch 8, loss 0.59
Epoch 9, loss 0.67
Epoch 10, loss 0.75
Epoch 11, loss 0.88
Epoch 12, loss 0.99
Epoch 13, loss 1.16
Epoch 14, loss 1.37
Epoch 15, loss 1.65
Epoch 16, loss 2.07
Epoch 17, loss 2.61
Epoch 18, loss 3.42
Epoch 19, loss 4.52
Epoch 20, loss 6.00
Epoch 21, loss 7.60
Epoch 22, loss 9.32
Epoch 23, loss 10.61
Epoch 24, loss 11.71
Epoch 25, loss 12.49
Epoch 26, loss 13.02
Epoch 27, loss 13.46
Epoch 28, loss 13.68
Epoch 29, loss 13.86
Epoch 30, loss 14.12
Epoch 31, loss 14.12
Epoch 32, loss 14.17
Epoch 33, loss 14.27
Epoch 34, loss 14.30
Epoch 35, loss 14.31
Epoch 36, loss 14.31
Epoch 37, loss 14.24
Epoch 38, loss 14.29
Epoch 39, loss 14.34
Epoch 40, loss 14.33
Epoch 41, loss 14.32
Epoch 42, loss 14.38
Epoch 43, loss 14.29
Epoch 44, loss 14.33
Epoch 45, loss 14.27
Epoch 46, loss 14.28
Epoch 47, loss 14.29
Epoch 48, loss 14.26
Epoch 49, loss 14.32
**** Finished Training ****
Change in stitch weights: 12.948708534240723
Largest abs weight change: 0.050701580941677094
Number of weights changing > 0.1 of that: 231708
Change in stitch bias: 0.5741980671882629
Largest abs bias change: 0.04374906048178673
Number of bias changing > 0.1 of that: 461
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X1bgonly-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist-test.csv
stitch into model bgonly
after layer 1, activations shape is torch.Size([10, 64, 32, 32])
Train the stitch to a top model cut after layer 1
Epoch 0, loss 9447.54
Epoch 1, loss 8470.16
Epoch 2, loss 8382.19
Epoch 3, loss 8344.69
Epoch 4, loss 8293.45
Epoch 5, loss 8262.02
Epoch 6, loss 8235.49
Epoch 7, loss 8233.24
Epoch 8, loss 8197.54
Epoch 9, loss 8176.38
Epoch 10, loss 8176.07
Epoch 11, loss 8179.51
Epoch 12, loss 8166.38
Epoch 13, loss 8175.90
Epoch 14, loss 8147.62
Epoch 15, loss 8148.30
Epoch 16, loss 8143.84
Epoch 17, loss 8142.86
Epoch 18, loss 8149.58
Epoch 19, loss 8143.03
Epoch 20, loss 8140.54
Epoch 21, loss 8149.34
Epoch 22, loss 8132.16
Epoch 23, loss 8139.93
Epoch 24, loss 8152.79
Epoch 25, loss 8142.19
Epoch 26, loss 8128.82
Epoch 27, loss 8143.57
Epoch 28, loss 8149.94
Epoch 29, loss 8135.18
Epoch 30, loss 8141.15
Epoch 31, loss 8136.05
Epoch 32, loss 8140.55
Epoch 33, loss 8145.26
Epoch 34, loss 8155.01
Epoch 35, loss 8154.77
Epoch 36, loss 8133.06
Epoch 37, loss 8138.77
Epoch 38, loss 8140.92
Epoch 39, loss 8142.08
Epoch 40, loss 8140.41
Epoch 41, loss 8145.04
Epoch 42, loss 8134.11
Epoch 43, loss 8130.40
Epoch 44, loss 8132.55
Epoch 45, loss 8145.06
Epoch 46, loss 8121.91
Epoch 47, loss 8132.90
Epoch 48, loss 8131.43
Epoch 49, loss 8120.55
**** Finished Training ****
Change in stitch weights: 5.052679061889648
Largest abs weight change: 0.21607837080955505
Number of weights changing > 0.1 of that: 3394
Change in stitch bias: 0.5685274600982666
Largest abs bias change: 0.12338539958000183
Number of bias changing > 0.1 of that: 58
Test the trained stitch
Test Accuracy: 70.00 %
Confusion Matrix
tensor([[   0,   10,  421,  445,    0,    0,  124,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,  209,   72,    0,    0,  719,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,  195,    0,    0,  805,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X8bgonly-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist-test.csv
stitch into model bgonly
after layer 8, activations shape is torch.Size([10, 128, 16, 16])
Train the stitch to a top model cut after layer 8
Epoch 0, loss 10713.64
Epoch 1, loss 10076.31
Epoch 2, loss 9893.22
Epoch 3, loss 9800.31
Epoch 4, loss 9730.39
Epoch 5, loss 9675.04
Epoch 6, loss 9633.66
Epoch 7, loss 9585.15
Epoch 8, loss 9557.00
Epoch 9, loss 9517.95
Epoch 10, loss 9490.05
Epoch 11, loss 9468.92
Epoch 12, loss 9448.85
Epoch 13, loss 9428.71
Epoch 14, loss 9396.62
Epoch 15, loss 9371.56
Epoch 16, loss 9371.35
Epoch 17, loss 9338.26
Epoch 18, loss 9328.76
Epoch 19, loss 9306.88
Epoch 20, loss 9288.78
Epoch 21, loss 9280.02
Epoch 22, loss 9272.59
Epoch 23, loss 9235.21
Epoch 24, loss 7565.69
Epoch 25, loss 7512.01
Epoch 26, loss 7503.76
Epoch 27, loss 7498.88
Epoch 28, loss 7486.67
Epoch 29, loss 7477.81
Epoch 30, loss 7479.34
Epoch 31, loss 7473.83
Epoch 32, loss 7465.19
Epoch 33, loss 7463.46
Epoch 34, loss 7443.60
Epoch 35, loss 7453.31
Epoch 36, loss 7433.44
Epoch 37, loss 7442.40
Epoch 38, loss 7443.35
Epoch 39, loss 7443.40
Epoch 40, loss 7438.04
Epoch 41, loss 7434.87
Epoch 42, loss 7429.64
Epoch 43, loss 7421.08
Epoch 44, loss 7424.87
Epoch 45, loss 7419.81
Epoch 46, loss 7433.10
Epoch 47, loss 7428.61
Epoch 48, loss 7410.64
Epoch 49, loss 7411.25
**** Finished Training ****
Change in stitch weights: 6.832815647125244
Largest abs weight change: 0.1640501618385315
Number of weights changing > 0.1 of that: 13219
Change in stitch bias: 0.5600306391716003
Largest abs bias change: 0.08754041790962219
Number of bias changing > 0.1 of that: 111
Test the trained stitch
Test Accuracy: 70.00 %
Confusion Matrix
tensor([[   0,    0,   14,  901,    0,    0,   85,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    1,  826,    0,    0,  173,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X22bgonly-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist-test.csv
stitch into model bgonly
after layer 22, activations shape is torch.Size([10, 512, 4, 4])
Train the stitch to a top model cut after layer 22
Epoch 0, loss 314.30
Epoch 1, loss 9.41
Epoch 2, loss 5.61
Epoch 3, loss 4.57
Epoch 4, loss 4.16
Epoch 5, loss 3.83
Epoch 6, loss 3.71
Epoch 7, loss 3.55
Epoch 8, loss 3.45
Epoch 9, loss 3.36
Epoch 10, loss 3.31
Epoch 11, loss 3.16
Epoch 12, loss 2.51
Epoch 13, loss 1.61
Epoch 14, loss 1.49
Epoch 15, loss 1.42
Epoch 16, loss 1.62
Epoch 17, loss 1.82
Epoch 18, loss 2.08
Epoch 19, loss 2.39
Epoch 20, loss 2.92
Epoch 21, loss 3.19
Epoch 22, loss 6.97
Epoch 23, loss 13.00
Epoch 24, loss 3.79
Epoch 25, loss 4.44
Epoch 26, loss 4.68
Epoch 27, loss 4.90
Epoch 28, loss 5.64
Epoch 29, loss 5.14
Epoch 30, loss 5.22
Epoch 31, loss 5.04
Epoch 32, loss 5.02
Epoch 33, loss 5.25
Epoch 34, loss 4.92
Epoch 35, loss 5.44
Epoch 36, loss 5.02
Epoch 37, loss 4.97
Epoch 38, loss 4.93
Epoch 39, loss 5.30
Epoch 40, loss 5.23
Epoch 41, loss 5.08
Epoch 42, loss 5.08
Epoch 43, loss 4.95
Epoch 44, loss 5.21
Epoch 45, loss 5.20
Epoch 46, loss 4.96
Epoch 47, loss 5.07
Epoch 48, loss 5.12
Epoch 49, loss 5.01
**** Finished Training ****
Change in stitch weights: 13.022442817687988
Largest abs weight change: 0.05202516168355942
Number of weights changing > 0.1 of that: 231123
Change in stitch bias: 0.5875428915023804
Largest abs bias change: 0.043773356825113297
Number of bias changing > 0.1 of that: 464
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X29bgonly-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist-test.csv
stitch into model bgonly
after layer 29, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 29
Epoch 0, loss 35.55
Epoch 1, loss 1.01
Epoch 2, loss 0.85
Epoch 3, loss 0.82
Epoch 4, loss 0.85
Epoch 5, loss 0.86
Epoch 6, loss 0.85
Epoch 7, loss 0.93
Epoch 8, loss 0.92
Epoch 9, loss 0.97
Epoch 10, loss 1.01
Epoch 11, loss 1.09
Epoch 12, loss 1.16
Epoch 13, loss 1.28
Epoch 14, loss 1.44
Epoch 15, loss 1.71
Epoch 16, loss 1.97
Epoch 17, loss 2.53
Epoch 18, loss 3.41
Epoch 19, loss 4.32
Epoch 20, loss 5.43
Epoch 21, loss 7.09
Epoch 22, loss 7.57
Epoch 23, loss 8.47
Epoch 24, loss 8.50
Epoch 25, loss 8.52
Epoch 26, loss 10.83
Epoch 27, loss 7.98
Epoch 28, loss 9.04
Epoch 29, loss 9.02
Epoch 30, loss 9.21
Epoch 31, loss 9.00
Epoch 32, loss 8.97
Epoch 33, loss 9.37
Epoch 34, loss 12.20
Epoch 35, loss 8.90
Epoch 36, loss 9.10
Epoch 37, loss 8.96
Epoch 38, loss 8.89
Epoch 39, loss 9.15
Epoch 40, loss 9.16
Epoch 41, loss 9.07
Epoch 42, loss 10.26
Epoch 43, loss 9.05
Epoch 44, loss 9.47
Epoch 45, loss 8.89
Epoch 46, loss 9.35
Epoch 47, loss 9.18
Epoch 48, loss 13.14
Epoch 49, loss 9.54
**** Finished Training ****
Change in stitch weights: 13.012664794921875
Largest abs weight change: 0.05487873777747154
Number of weights changing > 0.1 of that: 229266
Change in stitch bias: 0.5488584041595459
Largest abs bias change: 0.04367246851325035
Number of bias changing > 0.1 of that: 457
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X35bgonly-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist-test.csv
stitch into model bgonly
after layer 35, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 35
Epoch 0, loss 634.82
Epoch 1, loss 4.87
Epoch 2, loss 2.47
Epoch 3, loss 1.38
Epoch 4, loss 1.47
Epoch 5, loss 1.13
Epoch 6, loss 1.09
Epoch 7, loss 1.06
Epoch 8, loss 0.85
Epoch 9, loss 0.86
Epoch 10, loss 1.01
Epoch 11, loss 1.06
Epoch 12, loss 1.43
Epoch 13, loss 1.29
Epoch 14, loss 1.50
Epoch 15, loss 1.59
Epoch 16, loss 1.90
Epoch 17, loss 1.94
Epoch 18, loss 2.02
Epoch 19, loss 2.27
Epoch 20, loss 2.45
Epoch 21, loss 2.67
Epoch 22, loss 2.92
Epoch 23, loss 3.28
Epoch 24, loss 3.55
Epoch 25, loss 3.83
Epoch 26, loss 4.15
Epoch 27, loss 4.38
Epoch 28, loss 4.72
Epoch 29, loss 4.90
Epoch 30, loss 5.24
Epoch 31, loss 5.46
Epoch 32, loss 5.69
Epoch 33, loss 6.06
Epoch 34, loss 5.65
Epoch 35, loss 5.70
Epoch 36, loss 5.81
Epoch 37, loss 6.34
Epoch 38, loss 5.83
Epoch 39, loss 5.95
Epoch 40, loss 6.01
Epoch 41, loss 5.93
Epoch 42, loss 6.00
Epoch 43, loss 5.94
Epoch 44, loss 5.81
Epoch 45, loss 5.88
Epoch 46, loss 6.45
Epoch 47, loss 5.90
Epoch 48, loss 5.92
Epoch 49, loss 6.16
**** Finished Training ****
Change in stitch weights: 12.960928916931152
Largest abs weight change: 0.06437729299068451
Number of weights changing > 0.1 of that: 223529
Change in stitch bias: 0.54826819896698
Largest abs bias change: 0.043554820120334625
Number of bias changing > 0.1 of that: 472
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X1bg-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist-test.csv
stitch into model bg
after layer 1, activations shape is torch.Size([10, 64, 32, 32])
Train the stitch to a top model cut after layer 1
Epoch 0, loss 5440.38
Epoch 1, loss 97.92
Epoch 2, loss 43.87
Epoch 3, loss 28.58
Epoch 4, loss 18.55
Epoch 5, loss 12.42
Epoch 6, loss 9.49
Epoch 7, loss 7.77
Epoch 8, loss 6.20
Epoch 9, loss 5.86
Epoch 10, loss 5.02
Epoch 11, loss 4.84
Epoch 12, loss 4.38
Epoch 13, loss 3.76
Epoch 14, loss 4.11
Epoch 15, loss 85.68
Epoch 16, loss 3.77
Epoch 17, loss 2.98
Epoch 18, loss 2.95
Epoch 19, loss 2.74
Epoch 20, loss 2.67
Epoch 21, loss 2.90
Epoch 22, loss 2.67
Epoch 23, loss 2.78
Epoch 24, loss 387.24
Epoch 25, loss 6.79
Epoch 26, loss 4.37
Epoch 27, loss 3.04
Epoch 28, loss 3.04
Epoch 29, loss 3.01
Epoch 30, loss 51.71
Epoch 31, loss 3.52
Epoch 32, loss 2.70
Epoch 33, loss 2.54
Epoch 34, loss 2.46
Epoch 35, loss 2.51
Epoch 36, loss 256.57
Epoch 37, loss 44.73
Epoch 38, loss 4.27
Epoch 39, loss 2.96
Epoch 40, loss 23.70
Epoch 41, loss 3.03
Epoch 42, loss 2.26
Epoch 43, loss 2.27
Epoch 44, loss 2.42
Epoch 45, loss 2.74
Epoch 46, loss 1126.69
Epoch 47, loss 989.88
Epoch 48, loss 923.56
Epoch 49, loss 899.53
**** Finished Training ****
Change in stitch weights: 4.65238618850708
Largest abs weight change: 0.17127081751823425
Number of weights changing > 0.1 of that: 3486
Change in stitch bias: 0.574908435344696
Largest abs bias change: 0.12106423825025558
Number of bias changing > 0.1 of that: 55
Test the trained stitch
Test Accuracy: 80.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  247,    0,  753,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X8bg-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist-test.csv
stitch into model bg
after layer 8, activations shape is torch.Size([10, 128, 16, 16])
Train the stitch to a top model cut after layer 8
Epoch 0, loss 598.61
Epoch 1, loss 3.77
Epoch 2, loss 2.37
Epoch 3, loss 2.29
Epoch 4, loss 2.11
Epoch 5, loss 2.16
Epoch 6, loss 2.50
Epoch 7, loss 2.73
Epoch 8, loss 2.79
Epoch 9, loss 3.01
Epoch 10, loss 3.25
Epoch 11, loss 3.23
Epoch 12, loss 3.39
Epoch 13, loss 3.44
Epoch 14, loss 3.47
Epoch 15, loss 3.55
Epoch 16, loss 3.47
Epoch 17, loss 3.59
Epoch 18, loss 3.60
Epoch 19, loss 3.65
Epoch 20, loss 3.78
Epoch 21, loss 3.92
Epoch 22, loss 4.14
Epoch 23, loss 4.36
Epoch 24, loss 4.37
Epoch 25, loss 4.56
Epoch 26, loss 4.65
Epoch 27, loss 4.85
Epoch 28, loss 4.91
Epoch 29, loss 5.08
Epoch 30, loss 5.00
Epoch 31, loss 5.01
Epoch 32, loss 4.94
Epoch 33, loss 5.03
Epoch 34, loss 5.08
Epoch 35, loss 4.85
Epoch 36, loss 5.10
Epoch 37, loss 4.98
Epoch 38, loss 4.84
Epoch 39, loss 4.88
Epoch 40, loss 4.97
Epoch 41, loss 4.91
Epoch 42, loss 4.99
Epoch 43, loss 4.85
Epoch 44, loss 4.86
Epoch 45, loss 4.95
Epoch 46, loss 4.89
Epoch 47, loss 4.76
Epoch 48, loss 4.88
Epoch 49, loss 5.02
**** Finished Training ****
Change in stitch weights: 6.491695880889893
Largest abs weight change: 0.10791425406932831
Number of weights changing > 0.1 of that: 14402
Change in stitch bias: 0.5724356174468994
Largest abs bias change: 0.08664518594741821
Number of bias changing > 0.1 of that: 118
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X22bg-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist-test.csv
stitch into model bg
after layer 22, activations shape is torch.Size([10, 512, 4, 4])
Train the stitch to a top model cut after layer 22
Epoch 0, loss 66.53
Epoch 1, loss 13.66
Epoch 2, loss 11.28
Epoch 3, loss 10.53
Epoch 4, loss 10.29
Epoch 5, loss 10.35
Epoch 6, loss 10.63
Epoch 7, loss 10.85
Epoch 8, loss 11.21
Epoch 9, loss 11.67
Epoch 10, loss 12.39
Epoch 11, loss 13.08
Epoch 12, loss 13.96
Epoch 13, loss 15.04
Epoch 14, loss 16.47
Epoch 15, loss 17.98
Epoch 16, loss 19.66
Epoch 17, loss 21.60
Epoch 18, loss 23.77
Epoch 19, loss 25.76
Epoch 20, loss 27.80
Epoch 21, loss 29.74
Epoch 22, loss 31.71
Epoch 23, loss 33.09
Epoch 24, loss 34.36
Epoch 25, loss 35.48
Epoch 26, loss 36.24
Epoch 27, loss 36.90
Epoch 28, loss 37.24
Epoch 29, loss 37.34
Epoch 30, loss 37.69
Epoch 31, loss 37.63
Epoch 32, loss 37.46
Epoch 33, loss 37.76
Epoch 34, loss 37.64
Epoch 35, loss 37.61
Epoch 36, loss 37.74
Epoch 37, loss 37.62
Epoch 38, loss 37.85
Epoch 39, loss 37.43
Epoch 40, loss 37.75
Epoch 41, loss 37.45
Epoch 42, loss 37.47
Epoch 43, loss 37.55
Epoch 44, loss 37.24
Epoch 45, loss 37.17
Epoch 46, loss 37.49
Epoch 47, loss 37.41
Epoch 48, loss 37.30
Epoch 49, loss 37.39
**** Finished Training ****
Change in stitch weights: 13.048498153686523
Largest abs weight change: 0.054684486240148544
Number of weights changing > 0.1 of that: 229498
Change in stitch bias: 0.5661874413490295
Largest abs bias change: 0.043768689036369324
Number of bias changing > 0.1 of that: 457
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X29bg-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist-test.csv
stitch into model bg
after layer 29, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 29
Epoch 0, loss 109.35
Epoch 1, loss 23.23
Epoch 2, loss 18.76
Epoch 3, loss 17.69
Epoch 4, loss 17.97
Epoch 5, loss 18.80
Epoch 6, loss 20.60
Epoch 7, loss 22.62
Epoch 8, loss 25.33
Epoch 9, loss 28.80
Epoch 10, loss 33.04
Epoch 11, loss 37.82
Epoch 12, loss 43.86
Epoch 13, loss 49.75
Epoch 14, loss 55.76
Epoch 15, loss 61.68
Epoch 16, loss 67.30
Epoch 17, loss 72.14
Epoch 18, loss 76.14
Epoch 19, loss 79.36
Epoch 20, loss 82.20
Epoch 21, loss 83.72
Epoch 22, loss 85.24
Epoch 23, loss 86.58
Epoch 24, loss 87.32
Epoch 25, loss 88.52
Epoch 26, loss 88.88
Epoch 27, loss 89.22
Epoch 28, loss 89.90
Epoch 29, loss 90.41
Epoch 30, loss 90.41
Epoch 31, loss 90.42
Epoch 32, loss 90.79
Epoch 33, loss 90.75
Epoch 34, loss 90.69
Epoch 35, loss 90.81
Epoch 36, loss 90.37
Epoch 37, loss 90.34
Epoch 38, loss 90.86
Epoch 39, loss 90.54
Epoch 40, loss 90.51
Epoch 41, loss 90.44
Epoch 42, loss 90.30
Epoch 43, loss 90.50
Epoch 44, loss 90.18
Epoch 45, loss 90.34
Epoch 46, loss 90.54
Epoch 47, loss 90.28
Epoch 48, loss 90.27
Epoch 49, loss 89.93
**** Finished Training ****
Change in stitch weights: 13.056059837341309
Largest abs weight change: 0.05246816202998161
Number of weights changing > 0.1 of that: 230896
Change in stitch bias: 0.5797306299209595
Largest abs bias change: 0.04364899545907974
Number of bias changing > 0.1 of that: 464
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X35bg-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist-test.csv
stitch into model bg
after layer 35, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 35
Epoch 0, loss 140.67
Epoch 1, loss 4.75
Epoch 2, loss 3.91
Epoch 3, loss 3.95
Epoch 4, loss 4.10
Epoch 5, loss 4.30
Epoch 6, loss 4.89
Epoch 7, loss 5.37
Epoch 8, loss 6.01
Epoch 9, loss 6.91
Epoch 10, loss 7.93
Epoch 11, loss 9.25
Epoch 12, loss 10.85
Epoch 13, loss 12.86
Epoch 14, loss 15.43
Epoch 15, loss 18.16
Epoch 16, loss 21.26
Epoch 17, loss 24.44
Epoch 18, loss 27.56
Epoch 19, loss 30.38
Epoch 20, loss 32.60
Epoch 21, loss 34.51
Epoch 22, loss 36.32
Epoch 23, loss 37.40
Epoch 24, loss 38.37
Epoch 25, loss 38.97
Epoch 26, loss 39.80
Epoch 27, loss 40.29
Epoch 28, loss 40.43
Epoch 29, loss 40.87
Epoch 30, loss 41.04
Epoch 31, loss 41.25
Epoch 32, loss 41.41
Epoch 33, loss 41.50
Epoch 34, loss 41.39
Epoch 35, loss 41.50
Epoch 36, loss 41.64
Epoch 37, loss 41.30
Epoch 38, loss 41.57
Epoch 39, loss 41.55
Epoch 40, loss 41.34
Epoch 41, loss 41.49
Epoch 42, loss 41.65
Epoch 43, loss 41.80
Epoch 44, loss 41.44
Epoch 45, loss 41.49
Epoch 46, loss 41.49
Epoch 47, loss 41.33
Epoch 48, loss 41.44
Epoch 49, loss 41.53
**** Finished Training ****
Change in stitch weights: 12.998465538024902
Largest abs weight change: 0.0519670695066452
Number of weights changing > 0.1 of that: 231097
Change in stitch bias: 0.5725215077400208
Largest abs bias change: 0.04377498850226402
Number of bias changing > 0.1 of that: 467
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X1bias-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist-test.csv
stitch into model bias
after layer 1, activations shape is torch.Size([10, 64, 32, 32])
Train the stitch to a top model cut after layer 1
Epoch 0, loss 2407.69
Epoch 1, loss 61.13
Epoch 2, loss 16.07
Epoch 3, loss 39.69
Epoch 4, loss 14.35
Epoch 5, loss 7.38
Epoch 6, loss 6.71
Epoch 7, loss 7.94
Epoch 8, loss 7.24
Epoch 9, loss 6.72
Epoch 10, loss 11.82
Epoch 11, loss 23.96
Epoch 12, loss 7.67
Epoch 13, loss 7.24
Epoch 14, loss 7.93
Epoch 15, loss 49.04
Epoch 16, loss 5.75
Epoch 17, loss 7.46
Epoch 18, loss 6.16
Epoch 19, loss 6.79
Epoch 20, loss 7.83
Epoch 21, loss 81.02
Epoch 22, loss 6.62
Epoch 23, loss 6.99
Epoch 24, loss 5.78
Epoch 25, loss 7.31
Epoch 26, loss 7.52
Epoch 27, loss 12.99
Epoch 28, loss 42.36
Epoch 29, loss 5.88
Epoch 30, loss 7.21
Epoch 31, loss 6.40
Epoch 32, loss 41.16
Epoch 33, loss 6.54
Epoch 34, loss 5.99
Epoch 35, loss 6.38
Epoch 36, loss 7.54
Epoch 37, loss 19.99
Epoch 38, loss 7.47
Epoch 39, loss 41.10
Epoch 40, loss 8.84
Epoch 41, loss 6.24
Epoch 42, loss 6.67
Epoch 43, loss 8.02
Epoch 44, loss 82.04
Epoch 45, loss 7.03
Epoch 46, loss 6.18
Epoch 47, loss 5.53
Epoch 48, loss 17.62
Epoch 49, loss 5.59
**** Finished Training ****
Change in stitch weights: 4.734344482421875
Largest abs weight change: 0.16665443778038025
Number of weights changing > 0.1 of that: 3574
Change in stitch bias: 0.570563793182373
Largest abs bias change: 0.11525443196296692
Number of bias changing > 0.1 of that: 57
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X8bias-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist-test.csv
stitch into model bias
after layer 8, activations shape is torch.Size([10, 128, 16, 16])
Train the stitch to a top model cut after layer 8
Epoch 0, loss 995.16
Epoch 1, loss 11.42
Epoch 2, loss 8.62
Epoch 3, loss 8.01
Epoch 4, loss 7.63
Epoch 5, loss 7.89
Epoch 6, loss 7.92
Epoch 7, loss 8.01
Epoch 8, loss 8.28
Epoch 9, loss 8.49
Epoch 10, loss 8.60
Epoch 11, loss 8.67
Epoch 12, loss 8.92
Epoch 13, loss 8.78
Epoch 14, loss 9.02
Epoch 15, loss 8.90
Epoch 16, loss 9.02
Epoch 17, loss 9.20
Epoch 18, loss 9.32
Epoch 19, loss 9.36
Epoch 20, loss 9.41
Epoch 21, loss 9.78
Epoch 22, loss 9.89
Epoch 23, loss 10.44
Epoch 24, loss 10.49
Epoch 25, loss 10.64
Epoch 26, loss 10.51
Epoch 27, loss 10.68
Epoch 28, loss 10.87
Epoch 29, loss 10.88
Epoch 30, loss 10.85
Epoch 31, loss 11.05
Epoch 32, loss 10.75
Epoch 33, loss 10.83
Epoch 34, loss 11.08
Epoch 35, loss 10.89
Epoch 36, loss 10.51
Epoch 37, loss 10.71
Epoch 38, loss 11.15
Epoch 39, loss 10.79
Epoch 40, loss 10.93
Epoch 41, loss 10.68
Epoch 42, loss 10.79
Epoch 43, loss 10.59
Epoch 44, loss 10.81
Epoch 45, loss 10.69
Epoch 46, loss 10.50
Epoch 47, loss 10.61
Epoch 48, loss 10.94
Epoch 49, loss 10.76
**** Finished Training ****
Change in stitch weights: 6.464770793914795
Largest abs weight change: 0.11347316205501556
Number of weights changing > 0.1 of that: 14289
Change in stitch bias: 0.5761876106262207
Largest abs bias change: 0.08607564866542816
Number of bias changing > 0.1 of that: 118
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X22bias-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist-test.csv
stitch into model bias
after layer 22, activations shape is torch.Size([10, 512, 4, 4])
Train the stitch to a top model cut after layer 22
Epoch 0, loss 68.52
Epoch 1, loss 20.81
Epoch 2, loss 16.76
Epoch 3, loss 15.43
Epoch 4, loss 15.07
Epoch 5, loss 15.07
Epoch 6, loss 15.45
Epoch 7, loss 15.98
Epoch 8, loss 16.65
Epoch 9, loss 17.48
Epoch 10, loss 18.48
Epoch 11, loss 19.68
Epoch 12, loss 21.04
Epoch 13, loss 22.94
Epoch 14, loss 24.76
Epoch 15, loss 26.94
Epoch 16, loss 29.32
Epoch 17, loss 31.83
Epoch 18, loss 34.50
Epoch 19, loss 37.18
Epoch 20, loss 39.75
Epoch 21, loss 41.92
Epoch 22, loss 43.99
Epoch 23, loss 45.60
Epoch 24, loss 47.13
Epoch 25, loss 48.09
Epoch 26, loss 49.26
Epoch 27, loss 49.84
Epoch 28, loss 50.33
Epoch 29, loss 50.90
Epoch 30, loss 50.53
Epoch 31, loss 50.94
Epoch 32, loss 50.93
Epoch 33, loss 50.93
Epoch 34, loss 50.79
Epoch 35, loss 50.96
Epoch 36, loss 50.87
Epoch 37, loss 50.64
Epoch 38, loss 50.63
Epoch 39, loss 50.84
Epoch 40, loss 50.87
Epoch 41, loss 50.69
Epoch 42, loss 50.58
Epoch 43, loss 50.62
Epoch 44, loss 50.30
Epoch 45, loss 50.54
Epoch 46, loss 50.53
Epoch 47, loss 50.41
Epoch 48, loss 50.55
Epoch 49, loss 50.39
**** Finished Training ****
Change in stitch weights: 13.042725563049316
Largest abs weight change: 0.05379308760166168
Number of weights changing > 0.1 of that: 229676
Change in stitch bias: 0.5598415732383728
Largest abs bias change: 0.043773308396339417
Number of bias changing > 0.1 of that: 460
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X29bias-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist-test.csv
stitch into model bias
after layer 29, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 29
Epoch 0, loss 98.97
Epoch 1, loss 26.38
Epoch 2, loss 21.52
Epoch 3, loss 20.30
Epoch 4, loss 20.71
Epoch 5, loss 21.77
Epoch 6, loss 23.35
Epoch 7, loss 25.59
Epoch 8, loss 28.49
Epoch 9, loss 32.28
Epoch 10, loss 36.86
Epoch 11, loss 41.79
Epoch 12, loss 47.32
Epoch 13, loss 54.04
Epoch 14, loss 60.67
Epoch 15, loss 66.95
Epoch 16, loss 73.04
Epoch 17, loss 78.10
Epoch 18, loss 82.65
Epoch 19, loss 86.31
Epoch 20, loss 89.07
Epoch 21, loss 91.69
Epoch 22, loss 93.58
Epoch 23, loss 95.05
Epoch 24, loss 96.20
Epoch 25, loss 97.41
Epoch 26, loss 98.09
Epoch 27, loss 98.68
Epoch 28, loss 98.72
Epoch 29, loss 99.07
Epoch 30, loss 99.26
Epoch 31, loss 99.38
Epoch 32, loss 99.37
Epoch 33, loss 99.34
Epoch 34, loss 99.38
Epoch 35, loss 99.83
Epoch 36, loss 99.49
Epoch 37, loss 99.56
Epoch 38, loss 99.73
Epoch 39, loss 99.48
Epoch 40, loss 99.45
Epoch 41, loss 99.39
Epoch 42, loss 99.38
Epoch 43, loss 99.32
Epoch 44, loss 99.12
Epoch 45, loss 99.26
Epoch 46, loss 99.08
Epoch 47, loss 98.91
Epoch 48, loss 99.12
Epoch 49, loss 99.02
**** Finished Training ****
Change in stitch weights: 13.084613800048828
Largest abs weight change: 0.05300958454608917
Number of weights changing > 0.1 of that: 230442
Change in stitch bias: 0.5661312341690063
Largest abs bias change: 0.04376550763845444
Number of bias changing > 0.1 of that: 461
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X35bias-synth-104_2024-08-11_11-32-44_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist-test.csv
stitch into model bias
after layer 35, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 35
Epoch 0, loss 114.40
Epoch 1, loss 5.09
Epoch 2, loss 4.34
Epoch 3, loss 4.30
Epoch 4, loss 4.38
Epoch 5, loss 4.71
Epoch 6, loss 5.13
Epoch 7, loss 5.81
Epoch 8, loss 6.54
Epoch 9, loss 7.43
Epoch 10, loss 8.65
Epoch 11, loss 10.01
Epoch 12, loss 11.83
Epoch 13, loss 14.08
Epoch 14, loss 16.71
Epoch 15, loss 19.73
Epoch 16, loss 23.34
Epoch 17, loss 26.61
Epoch 18, loss 30.29
Epoch 19, loss 32.95
Epoch 20, loss 35.31
Epoch 21, loss 37.76
Epoch 22, loss 39.24
Epoch 23, loss 40.73
Epoch 24, loss 41.53
Epoch 25, loss 42.55
Epoch 26, loss 43.00
Epoch 27, loss 43.69
Epoch 28, loss 44.10
Epoch 29, loss 44.41
Epoch 30, loss 44.61
Epoch 31, loss 44.78
Epoch 32, loss 44.77
Epoch 33, loss 45.06
Epoch 34, loss 45.03
Epoch 35, loss 45.05
Epoch 36, loss 45.19
Epoch 37, loss 45.02
Epoch 38, loss 45.17
Epoch 39, loss 45.03
Epoch 40, loss 45.28
Epoch 41, loss 44.98
Epoch 42, loss 44.90
Epoch 43, loss 45.08
Epoch 44, loss 45.05
Epoch 45, loss 45.14
Epoch 46, loss 45.04
Epoch 47, loss 45.06
Epoch 48, loss 45.06
Epoch 49, loss 45.08
**** Finished Training ****
Change in stitch weights: 12.989540100097656
Largest abs weight change: 0.05343222990632057
Number of weights changing > 0.1 of that: 230072
Change in stitch bias: 0.5607239007949829
Largest abs bias change: 0.04367273673415184
Number of bias changing > 0.1 of that: 463
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X1unbias-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist-test.csv
stitch into model unbias
after layer 1, activations shape is torch.Size([10, 64, 32, 32])
Train the stitch to a top model cut after layer 1
Epoch 0, loss 294.36
Epoch 1, loss 26.69
Epoch 2, loss 20.40
Epoch 3, loss 18.80
Epoch 4, loss 18.41
Epoch 5, loss 18.56
Epoch 6, loss 18.90
Epoch 7, loss 19.28
Epoch 8, loss 19.66
Epoch 9, loss 19.99
Epoch 10, loss 20.20
Epoch 11, loss 20.30
Epoch 12, loss 20.38
Epoch 13, loss 20.41
Epoch 14, loss 20.61
Epoch 15, loss 20.93
Epoch 16, loss 21.29
Epoch 17, loss 21.66
Epoch 18, loss 22.09
Epoch 19, loss 22.48
Epoch 20, loss 22.63
Epoch 21, loss 22.88
Epoch 22, loss 22.87
Epoch 23, loss 23.02
Epoch 24, loss 23.04
Epoch 25, loss 22.93
Epoch 26, loss 22.78
Epoch 27, loss 22.93
Epoch 28, loss 22.73
Epoch 29, loss 22.76
Epoch 30, loss 22.73
Epoch 31, loss 22.67
Epoch 32, loss 22.65
Epoch 33, loss 22.56
Epoch 34, loss 22.58
Epoch 35, loss 22.62
Epoch 36, loss 22.61
Epoch 37, loss 22.56
Epoch 38, loss 22.64
Epoch 39, loss 22.52
Epoch 40, loss 22.63
Epoch 41, loss 22.56
Epoch 42, loss 22.57
Epoch 43, loss 22.59
Epoch 44, loss 22.53
Epoch 45, loss 22.52
Epoch 46, loss 22.46
Epoch 47, loss 22.43
Epoch 48, loss 22.46
Epoch 49, loss 22.43
**** Finished Training ****
Change in stitch weights: 4.677889347076416
Largest abs weight change: 0.16670149564743042
Number of weights changing > 0.1 of that: 3558
Change in stitch bias: 0.5426861643791199
Largest abs bias change: 0.12383264303207397
Number of bias changing > 0.1 of that: 59
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X8unbias-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist-test.csv
stitch into model unbias
after layer 8, activations shape is torch.Size([10, 128, 16, 16])
Train the stitch to a top model cut after layer 8
Epoch 0, loss 600.36
Epoch 1, loss 87.68
Epoch 2, loss 59.50
Epoch 3, loss 50.80
Epoch 4, loss 47.36
Epoch 5, loss 46.02
Epoch 6, loss 45.46
Epoch 7, loss 45.14
Epoch 8, loss 45.01
Epoch 9, loss 44.96
Epoch 10, loss 44.99
Epoch 11, loss 44.97
Epoch 12, loss 45.24
Epoch 13, loss 45.54
Epoch 14, loss 46.00
Epoch 15, loss 46.22
Epoch 16, loss 46.62
Epoch 17, loss 46.95
Epoch 18, loss 47.39
Epoch 19, loss 48.09
Epoch 20, loss 48.50
Epoch 21, loss 48.76
Epoch 22, loss 49.06
Epoch 23, loss 49.18
Epoch 24, loss 49.34
Epoch 25, loss 49.12
Epoch 26, loss 49.17
Epoch 27, loss 48.95
Epoch 28, loss 48.97
Epoch 29, loss 48.85
Epoch 30, loss 48.85
Epoch 31, loss 48.70
Epoch 32, loss 48.62
Epoch 33, loss 48.56
Epoch 34, loss 48.44
Epoch 35, loss 48.24
Epoch 36, loss 48.22
Epoch 37, loss 48.36
Epoch 38, loss 48.23
Epoch 39, loss 48.13
Epoch 40, loss 48.23
Epoch 41, loss 48.15
Epoch 42, loss 48.09
Epoch 43, loss 48.08
Epoch 44, loss 48.19
Epoch 45, loss 48.10
Epoch 46, loss 47.98
Epoch 47, loss 47.90
Epoch 48, loss 47.95
Epoch 49, loss 48.00
**** Finished Training ****
Change in stitch weights: 6.518340587615967
Largest abs weight change: 0.11937007308006287
Number of weights changing > 0.1 of that: 14156
Change in stitch bias: 0.5606059432029724
Largest abs bias change: 0.08565227687358856
Number of bias changing > 0.1 of that: 120
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X22unbias-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist-test.csv
stitch into model unbias
after layer 22, activations shape is torch.Size([10, 512, 4, 4])
Train the stitch to a top model cut after layer 22
Epoch 0, loss 20.60
Epoch 1, loss 2.63
Epoch 2, loss 2.33
Epoch 3, loss 2.27
Epoch 4, loss 2.30
Epoch 5, loss 2.36
Epoch 6, loss 2.43
Epoch 7, loss 2.53
Epoch 8, loss 2.64
Epoch 9, loss 2.74
Epoch 10, loss 2.89
Epoch 11, loss 3.05
Epoch 12, loss 3.22
Epoch 13, loss 3.45
Epoch 14, loss 3.70
Epoch 15, loss 4.01
Epoch 16, loss 4.45
Epoch 17, loss 4.91
Epoch 18, loss 5.53
Epoch 19, loss 6.26
Epoch 20, loss 7.12
Epoch 21, loss 8.20
Epoch 22, loss 9.36
Epoch 23, loss 10.49
Epoch 24, loss 11.41
Epoch 25, loss 12.14
Epoch 26, loss 12.66
Epoch 27, loss 13.16
Epoch 28, loss 13.37
Epoch 29, loss 13.55
Epoch 30, loss 13.65
Epoch 31, loss 13.66
Epoch 32, loss 13.72
Epoch 33, loss 13.75
Epoch 34, loss 13.72
Epoch 35, loss 13.65
Epoch 36, loss 13.73
Epoch 37, loss 13.73
Epoch 38, loss 13.67
Epoch 39, loss 13.67
Epoch 40, loss 13.60
Epoch 41, loss 13.58
Epoch 42, loss 13.64
Epoch 43, loss 13.53
Epoch 44, loss 13.58
Epoch 45, loss 13.55
Epoch 46, loss 13.59
Epoch 47, loss 13.52
Epoch 48, loss 13.54
Epoch 49, loss 13.50
**** Finished Training ****
Change in stitch weights: 13.013734817504883
Largest abs weight change: 0.052849315106868744
Number of weights changing > 0.1 of that: 230313
Change in stitch bias: 0.5737671852111816
Largest abs bias change: 0.04365168884396553
Number of bias changing > 0.1 of that: 465
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X29unbias-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist-test.csv
stitch into model unbias
after layer 29, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 29
Epoch 0, loss 33.74
Epoch 1, loss 2.77
Epoch 2, loss 2.31
Epoch 3, loss 2.19
Epoch 4, loss 2.18
Epoch 5, loss 2.24
Epoch 6, loss 2.31
Epoch 7, loss 2.41
Epoch 8, loss 2.52
Epoch 9, loss 2.67
Epoch 10, loss 2.89
Epoch 11, loss 3.22
Epoch 12, loss 3.64
Epoch 13, loss 4.20
Epoch 14, loss 5.03
Epoch 15, loss 6.17
Epoch 16, loss 7.76
Epoch 17, loss 9.72
Epoch 18, loss 11.99
Epoch 19, loss 14.34
Epoch 20, loss 16.56
Epoch 21, loss 18.28
Epoch 22, loss 19.48
Epoch 23, loss 20.32
Epoch 24, loss 20.81
Epoch 25, loss 21.27
Epoch 26, loss 21.46
Epoch 27, loss 21.80
Epoch 28, loss 21.98
Epoch 29, loss 21.97
Epoch 30, loss 22.12
Epoch 31, loss 22.13
Epoch 32, loss 22.08
Epoch 33, loss 22.15
Epoch 34, loss 22.12
Epoch 35, loss 22.10
Epoch 36, loss 22.08
Epoch 37, loss 22.08
Epoch 38, loss 22.03
Epoch 39, loss 22.01
Epoch 40, loss 21.96
Epoch 41, loss 22.03
Epoch 42, loss 22.00
Epoch 43, loss 21.93
Epoch 44, loss 21.91
Epoch 45, loss 21.99
Epoch 46, loss 21.93
Epoch 47, loss 21.93
Epoch 48, loss 21.85
Epoch 49, loss 21.91
**** Finished Training ****
Change in stitch weights: 13.046891212463379
Largest abs weight change: 0.05241528898477554
Number of weights changing > 0.1 of that: 230890
Change in stitch bias: 0.5555341839790344
Largest abs bias change: 0.04373002424836159
Number of bias changing > 0.1 of that: 462
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_1g_rank/X35unbias-synth-104_2024-08-10_22-57-13_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist-test.csv
stitch into model unbias
after layer 35, activations shape is torch.Size([10, 512, 2, 2])
Train the stitch to a top model cut after layer 35
Epoch 0, loss 34.69
Epoch 1, loss 0.09
Epoch 2, loss 0.13
Epoch 3, loss 0.18
Epoch 4, loss 0.23
Epoch 5, loss 0.29
Epoch 6, loss 0.35
Epoch 7, loss 0.41
Epoch 8, loss 0.47
Epoch 9, loss 0.53
Epoch 10, loss 0.60
Epoch 11, loss 0.68
Epoch 12, loss 0.78
Epoch 13, loss 0.89
Epoch 14, loss 1.03
Epoch 15, loss 1.24
Epoch 16, loss 1.51
Epoch 17, loss 1.90
Epoch 18, loss 2.47
Epoch 19, loss 3.29
Epoch 20, loss 4.40
Epoch 21, loss 5.71
Epoch 22, loss 7.01
Epoch 23, loss 8.18
Epoch 24, loss 9.05
Epoch 25, loss 9.73
Epoch 26, loss 10.20
Epoch 27, loss 10.58
Epoch 28, loss 10.72
Epoch 29, loss 10.94
Epoch 30, loss 11.09
Epoch 31, loss 11.16
Epoch 32, loss 11.20
Epoch 33, loss 11.32
Epoch 34, loss 11.30
Epoch 35, loss 11.31
Epoch 36, loss 11.31
Epoch 37, loss 11.36
Epoch 38, loss 11.38
Epoch 39, loss 11.36
Epoch 40, loss 11.34
Epoch 41, loss 11.35
Epoch 42, loss 11.35
Epoch 43, loss 11.35
Epoch 44, loss 11.35
Epoch 45, loss 11.34
Epoch 46, loss 11.36
Epoch 47, loss 11.33
Epoch 48, loss 11.35
Epoch 49, loss 11.32
**** Finished Training ****
Change in stitch weights: 12.966692924499512
Largest abs weight change: 0.05121830105781555
Number of weights changing > 0.1 of that: 231519
Change in stitch bias: 0.5783325433731079
Largest abs bias change: 0.04363297298550606
Number of bias changing > 0.1 of that: 465
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1000,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1000,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1000,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1000,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1000,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1000,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1000,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1000,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1000]],
       dtype=torch.int32)
===================================================================
