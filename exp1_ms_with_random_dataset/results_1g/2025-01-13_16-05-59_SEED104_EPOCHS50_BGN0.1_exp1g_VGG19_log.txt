Executed at 2025-01-13_16-05-59
logging to ./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_log.txt
seed=104
bg_noise=0.1
synthetic_dataset_noise=0.1
train_mix_mnist_model=True
save_mix_mnist_model_as='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist.weights'
original_train_epochs=50
train_bw_mnist_model=True
save_bw_mnist_model_as='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist.weights'
original_train_epochs=50
train_bg_only_colour_mnist_model=True
save_bg_only_colour_mnist_model_as='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist.weights'
original_train_epochs=50
train_bg_unbiased_colour_mnist_model=True
save_bg_unbiased_colour_mnist_model_as='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist.weights'
original_train_epochs=50
train_biased_colour_mnist_model=True
save_biased_colour_mnist_model_as='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist.weights'
original_train_epochs=50
train_unbiased_colour_mnist_model=True
save_unbiased_colour_mnist_model_as='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist.weights'
original_train_epochs=50
stitch_train_epochs=50
================================================
Train Model on bw
Epoch 0, loss 2157.93
Epoch 1, loss 2156.62
Epoch 2, loss 2156.53
Epoch 3, loss 2156.48
Epoch 4, loss 2156.42
Epoch 5, loss 2156.38
Epoch 6, loss 2156.34
Epoch 7, loss 2156.32
Epoch 8, loss 2156.30
Epoch 9, loss 2156.29
Epoch 10, loss 2156.26
Epoch 11, loss 2156.25
Epoch 12, loss 2156.24
Epoch 13, loss 2156.23
Epoch 14, loss 2156.23
Epoch 15, loss 2156.23
Epoch 16, loss 2156.22
Epoch 17, loss 2156.21
Epoch 18, loss 2156.21
Epoch 19, loss 2156.21
Epoch 20, loss 2156.20
Epoch 21, loss 2156.20
Epoch 22, loss 2156.19
Epoch 23, loss 2156.19
Epoch 24, loss 2156.19
Epoch 25, loss 2156.20
Epoch 26, loss 2156.19
Epoch 27, loss 2156.19
Epoch 28, loss 2156.19
Epoch 29, loss 2156.18
Epoch 30, loss 2156.18
Epoch 31, loss 2156.18
Epoch 32, loss 2156.20
Epoch 33, loss 2156.19
Epoch 34, loss 2156.19
Epoch 35, loss 2156.19
Epoch 36, loss 2156.19
Epoch 37, loss 2156.19
Epoch 38, loss 2156.19
Epoch 39, loss 2156.19
Epoch 40, loss 2156.19
Epoch 41, loss 2156.18
Epoch 42, loss 2156.19
Epoch 43, loss 2156.19
Epoch 44, loss 2156.18
Epoch 45, loss 2156.18
Epoch 46, loss 2156.19
Epoch 47, loss 2156.18
Epoch 48, loss 2156.18
Epoch 49, loss 2156.18
**** Finished Training ****
saveas='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist.weights'
Train Model on mix
Epoch 0, loss 1305.11
Epoch 1, loss 1024.07
Epoch 2, loss 901.74
Epoch 3, loss 707.08
Epoch 4, loss 503.31
Epoch 5, loss 270.00
Epoch 6, loss 144.35
Epoch 7, loss 98.23
Epoch 8, loss 73.81
Epoch 9, loss 58.45
Epoch 10, loss 51.42
Epoch 11, loss 44.29
Epoch 12, loss 37.77
Epoch 13, loss 34.90
Epoch 14, loss 32.28
Epoch 15, loss 28.72
Epoch 16, loss 25.67
Epoch 17, loss 26.09
Epoch 18, loss 23.36
Epoch 19, loss 22.00
Epoch 20, loss 19.84
Epoch 21, loss 18.18
Epoch 22, loss 16.29
Epoch 23, loss 15.15
Epoch 24, loss 14.88
Epoch 25, loss 14.69
Epoch 26, loss 13.00
Epoch 27, loss 13.30
Epoch 28, loss 11.76
Epoch 29, loss 13.08
Epoch 30, loss 10.55
Epoch 31, loss 10.92
Epoch 32, loss 9.12
Epoch 33, loss 9.21
Epoch 34, loss 8.31
Epoch 35, loss 7.73
Epoch 36, loss 7.69
Epoch 37, loss 7.58
Epoch 38, loss 7.48
Epoch 39, loss 7.13
Epoch 40, loss 6.07
Epoch 41, loss 5.89
Epoch 42, loss 5.08
Epoch 43, loss 5.18
Epoch 44, loss 5.27
Epoch 45, loss 4.19
Epoch 46, loss 4.55
Epoch 47, loss 4.41
Epoch 48, loss 4.14
Epoch 49, loss 4.42
**** Finished Training ****
saveas='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist.weights'
Train Model on bgonly
Epoch 0, loss 1716.99
Epoch 1, loss 1629.11
Epoch 2, loss 1283.62
Epoch 3, loss 1032.93
Epoch 4, loss 966.32
Epoch 5, loss 940.62
Epoch 6, loss 907.52
Epoch 7, loss 740.86
Epoch 8, loss 652.58
Epoch 9, loss 531.30
Epoch 10, loss 493.25
Epoch 11, loss 474.89
Epoch 12, loss 370.83
Epoch 13, loss 272.18
Epoch 14, loss 190.28
Epoch 15, loss 82.71
Epoch 16, loss 14.69
Epoch 17, loss 2.07
Epoch 18, loss 36.16
Epoch 19, loss 1.87
Epoch 20, loss 0.70
Epoch 21, loss 0.65
Epoch 22, loss 0.37
Epoch 23, loss 0.18
Epoch 24, loss 0.28
Epoch 25, loss 0.42
Epoch 26, loss 0.20
Epoch 27, loss 0.12
Epoch 28, loss 0.16
Epoch 29, loss 0.08
Epoch 30, loss 0.07
Epoch 31, loss 0.11
Epoch 32, loss 0.10
Epoch 33, loss 0.12
Epoch 34, loss 0.11
Epoch 35, loss 0.11
Epoch 36, loss 0.19
Epoch 37, loss 0.05
Epoch 38, loss 0.05
Epoch 39, loss 0.48
Epoch 40, loss 1.89
Epoch 41, loss 0.08
Epoch 42, loss 0.17
Epoch 43, loss 0.07
Epoch 44, loss 0.08
Epoch 45, loss 0.06
Epoch 46, loss 0.05
Epoch 47, loss 0.05
Epoch 48, loss 0.05
Epoch 49, loss 0.04
**** Finished Training ****
saveas='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist.weights'
Train Model on bg
Epoch 0, loss 1579.84
Epoch 1, loss 1488.77
Epoch 2, loss 1300.20
Epoch 3, loss 1223.89
Epoch 4, loss 1183.06
Epoch 5, loss 1160.85
Epoch 6, loss 1147.73
Epoch 7, loss 1136.77
Epoch 8, loss 1126.82
Epoch 9, loss 1117.60
Epoch 10, loss 1108.65
Epoch 11, loss 1100.16
Epoch 12, loss 1091.36
Epoch 13, loss 1080.61
Epoch 14, loss 1031.12
Epoch 15, loss 877.45
Epoch 16, loss 762.45
Epoch 17, loss 665.45
Epoch 18, loss 546.48
Epoch 19, loss 407.48
Epoch 20, loss 212.88
Epoch 21, loss 78.72
Epoch 22, loss 11.87
Epoch 23, loss 10.76
Epoch 24, loss 7.80
Epoch 25, loss 1.31
Epoch 26, loss 0.85
Epoch 27, loss 0.58
Epoch 28, loss 3.18
Epoch 29, loss 1.00
Epoch 30, loss 0.61
Epoch 31, loss 0.82
Epoch 32, loss 0.30
Epoch 33, loss 443.32
Epoch 34, loss 17.13
Epoch 35, loss 3.12
Epoch 36, loss 1.06
Epoch 37, loss 0.55
Epoch 38, loss 0.36
Epoch 39, loss 0.32
Epoch 40, loss 0.37
Epoch 41, loss 0.61
Epoch 42, loss 3.89
Epoch 43, loss 0.33
Epoch 44, loss 0.21
Epoch 45, loss 0.16
Epoch 46, loss 0.14
Epoch 47, loss 0.13
Epoch 48, loss 0.10
Epoch 49, loss 0.10
**** Finished Training ****
saveas='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist.weights'
Train Model on bias
Epoch 0, loss 1641.07
Epoch 1, loss 1348.31
Epoch 2, loss 988.62
Epoch 3, loss 577.16
Epoch 4, loss 207.24
Epoch 5, loss 76.15
Epoch 6, loss 16.72
Epoch 7, loss 37.10
Epoch 8, loss 5.62
Epoch 9, loss 5.25
Epoch 10, loss 3.01
Epoch 11, loss 1.75
Epoch 12, loss 8.13
Epoch 13, loss 0.73
Epoch 14, loss 1.32
Epoch 15, loss 0.44
Epoch 16, loss 0.95
Epoch 17, loss 0.58
Epoch 18, loss 0.70
Epoch 19, loss 0.75
Epoch 20, loss 0.20
Epoch 21, loss 1.13
Epoch 22, loss 6.31
Epoch 23, loss 0.54
Epoch 24, loss 0.23
Epoch 25, loss 0.18
Epoch 26, loss 4.10
Epoch 27, loss 16.02
Epoch 28, loss 1.31
Epoch 29, loss 0.43
Epoch 30, loss 0.66
Epoch 31, loss 0.49
Epoch 32, loss 0.19
Epoch 33, loss 0.18
Epoch 34, loss 0.12
Epoch 35, loss 0.11
Epoch 36, loss 0.13
Epoch 37, loss 0.78
Epoch 38, loss 0.11
Epoch 39, loss 0.08
Epoch 40, loss 0.09
Epoch 41, loss 0.06
Epoch 42, loss 0.07
Epoch 43, loss 0.16
Epoch 44, loss 0.23
Epoch 45, loss 0.11
Epoch 46, loss 0.05
Epoch 47, loss 0.05
Epoch 48, loss 0.05
Epoch 49, loss 0.05
**** Finished Training ****
saveas='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist.weights'
Train Model on unbias
Epoch 0, loss 1318.78
Epoch 1, loss 431.57
Epoch 2, loss 249.62
Epoch 3, loss 186.42
Epoch 4, loss 149.45
Epoch 5, loss 128.63
Epoch 6, loss 109.80
Epoch 7, loss 100.29
Epoch 8, loss 88.83
Epoch 9, loss 80.49
Epoch 10, loss 72.42
Epoch 11, loss 67.54
Epoch 12, loss 59.28
Epoch 13, loss 56.64
Epoch 14, loss 52.33
Epoch 15, loss 48.61
Epoch 16, loss 43.56
Epoch 17, loss 40.82
Epoch 18, loss 37.98
Epoch 19, loss 35.77
Epoch 20, loss 33.19
Epoch 21, loss 30.82
Epoch 22, loss 27.83
Epoch 23, loss 26.19
Epoch 24, loss 24.60
Epoch 25, loss 22.78
Epoch 26, loss 19.97
Epoch 27, loss 18.43
Epoch 28, loss 18.49
Epoch 29, loss 15.90
Epoch 30, loss 15.70
Epoch 31, loss 14.19
Epoch 32, loss 11.29
Epoch 33, loss 11.89
Epoch 34, loss 10.93
Epoch 35, loss 10.05
Epoch 36, loss 8.59
Epoch 37, loss 8.24
Epoch 38, loss 7.25
Epoch 39, loss 9.69
Epoch 40, loss 8.95
Epoch 41, loss 6.72
Epoch 42, loss 7.79
Epoch 43, loss 5.59
Epoch 44, loss 5.23
Epoch 45, loss 4.21
Epoch 46, loss 7.56
Epoch 47, loss 3.68
Epoch 48, loss 2.15
Epoch 49, loss 3.79
**** Finished Training ****
saveas='./results_1g/2025-01-13_16-05-59_SEED104_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist.weights'
Accuracy Calculation for VGG19 with key='bw'
Test the Trained VGG19
Test Accuracy: 11.35 %
Confusion Matrix
tensor([[   0,  980,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  974,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1009,    0,    0,    0,    0,    0,    0,    0,    0]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='mix'
Test the Trained VGG19
Test Accuracy: 99.40 %
Confusion Matrix
tensor([[ 969,    0,    0,    0,    0,    0,    1,    0,    0,    0],
        [   0, 1174,    1,    1,    1,    0,    1,    2,    1,    0],
        [   0,    0, 1038,    1,    0,    0,    0,    1,    2,    0],
        [   0,    0,    1,  958,    0,    4,    0,    2,    0,    0],
        [   0,    0,    0,    0,  947,    0,    0,    1,    1,    9],
        [   0,    0,    0,    0,    0,  928,    2,    0,    0,    1],
        [   4,    1,    0,    2,    0,    3,  924,    0,    0,    0],
        [   0,    0,    3,    0,    0,    0,    0, 1019,    1,    1],
        [   2,    0,    2,    0,    0,    3,    0,    2, 1013,    1],
        [   0,    0,    0,    0,    2,    0,    0,    0,    0,  970]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='bgonly'
Test the Trained VGG19
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='bg'
Test the Trained VGG19
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  995,    0,    1,    0,    0,    0,    0,    0,    0],
        [   0,    0,  996,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1003,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1003,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  999,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1003,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1003,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  990]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='bias'
Test the Trained VGG19
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='unbias'
Test the Trained VGG19
Test Accuracy: 98.32 %
Confusion Matrix
tensor([[ 973,    1,    0,    0,    0,    0,    4,    1,    1,    0],
        [   0, 1120,    1,    3,    1,    1,    1,    1,    7,    0],
        [   5,    2, 1008,    6,    1,    0,    1,    4,    5,    0],
        [   0,    0,    0, 1001,    0,    2,    0,    2,    4,    1],
        [   0,    0,    0,    0,  970,    0,    4,    1,    0,    7],
        [   2,    1,    0,    6,    0,  873,    4,    1,    3,    2],
        [   5,    2,    0,    1,    1,    3,  945,    0,    1,    0],
        [   1,    3,    3,    3,    1,    0,    0, 1012,    1,    4],
        [   3,    0,    1,    7,    2,    2,    1,    3,  951,    4],
        [   1,    3,    0,    6,   14,    1,    0,    5,    0,  979]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'bw': 11.35, 'mix': 99.4, 'bgonly': 100.0, 'bg': 99.99, 'bias': 100.0, 'unbias': 98.32}
Measure Rank for key='bw'
