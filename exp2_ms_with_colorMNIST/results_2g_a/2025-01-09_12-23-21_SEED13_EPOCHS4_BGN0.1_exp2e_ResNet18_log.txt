Executed at 2025-01-09_12-23-21
logging to ./results_2g_a/2025-01-09_12-23-21_SEED13_EPOCHS4_BGN0.1_exp2e_ResNet18_log.txt
seed=13
bg_noise=0.1
train_mix_mnist_model=False
mix_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
train_bw_mnist_model=False
bw_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
train_bg_only_colour_mnist_model=False
bg_only_colour_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
train_bg_unbiased_colour_mnist_model=False
bg_unbiased_colour_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
train_biased_colour_mnist_model=False
biased_colour_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
train_unbiased_colour_mnist_model=False
unbiased_colour_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
stitch_train_epochs=10
================================================
val['loadfrom']='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
Entering Confusion
Accuracy Calculation for ResNet18 with key='bw'
Test the Trained Resnet18 against OWN TEST LOADER: key='bw'
Test Accuracy: 99.09 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    1,    0,    0,    0,    0],
        [   0, 1132,    0,    0,    0,    2,    1,    0,    0,    0],
        [   1,    1, 1025,    3,    1,    0,    0,    1,    0,    0],
        [   1,    0,    0, 1000,    0,    5,    0,    0,    3,    1],
        [   0,    0,    0,    0,  973,    0,    0,    1,    0,    8],
        [   2,    0,    0,    1,    0,  881,    1,    0,    2,    5],
        [   3,    4,    0,    0,    0,    2,  948,    0,    1,    0],
        [   0,    5,    9,    2,    0,    0,    0, 1006,    1,    5],
        [   3,    0,    1,    0,    0,    1,    0,    2,  965,    2],
        [   1,    1,    0,    2,    3,    1,    0,    0,    1, 1000]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bgonly'
Test the Trained Resnet18 against OWN TEST LOADER: key='bgonly'
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'bw': 99.09, 'bgonly': 100.0}
Entering whole model check
Measure Rank for key='bw'
Measure Rank for key='bgonly'
Entering whole model check
Already evaluated for ./results_2g_a_rank/bw-bias-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Already evaluated for ./results_2g_a_rank/bgonly-bias-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Entering whole model check
Measure Rank for key='bw'
Entering whole model check
Measure Rank for key='bw'
Measure Rank for key='bgonly'
Entering Stitch/Rank
device='cuda:2'
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Entering Stitch/Rank
device='cuda:2'
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Entering Stitch/Rank
device='cuda:2'
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Entering Stitch/Rank
device='cuda:2'
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Entering Stitch/Rank
device='cuda:2'
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Entering Stitch/Rank
device='cuda:2'
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 1903.95
Epoch 1, loss 654.17
Epoch 2, loss 428.47
Epoch 3, loss 333.87
Epoch 4, loss 278.10
Epoch 5, loss 246.47
Epoch 6, loss 222.03
Epoch 7, loss 201.44
Epoch 8, loss 187.88
Epoch 9, loss 177.19
**** Finished Training ****
Change in stitch weights: 2.36252760887146
Largest abs weight change: 0.2109905481338501
Number of weights changing > 0.1 of that: 2147
Change in stitch bias: 0.026319235563278198
Largest abs bias change: 0.005551829934120178
Number of bias changing > 0.1 of that: 61
Test the trained stitch against key='bgonly' data
Test Accuracy: 90.38 %
Confusion Matrix
tensor([[ 907,    9,    3,    0,    4,   17,   34,    1,   27,    7],
        [   1,  929,    7,    3,    3,    5,    9,   14,    2,    7],
        [   6,    8, 1087,    4,    1,    2,    2,    8,    9,    8],
        [   1,   19,    4,  844,   15,   19,    0,   17,   59,   54],
        [  10,    5,    7,    5,  910,    6,   17,    4,   27,   19],
        [  32,    1,    3,    9,    2,  905,   10,   11,    8,    1],
        [   6,   16,    4,    0,   25,   16,  799,    3,   11,   12],
        [   1,   26,    5,    4,    2,   27,   17,  866,    0,   10],
        [  22,    2,    6,   17,    7,   10,    4,    0,  955,    5],
        [   6,   31,    1,    7,   29,   40,    9,    3,   12,  836]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2g_a_rank/bw4bw-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Entering Stitch/Rank
device='cuda:2'
Already evaluated for ./results_2g_a_rank/bw3bw-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw4bw-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
