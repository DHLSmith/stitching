Executed at 2025-01-27_09-36-53
logging to ./results_2g_a/2025-01-27_09-36-53_SEED13_EPOCHS4_BGN0.1_exp2e_ResNet18_log.txt
seed=13
bg_noise=0.1
train_mix_mnist_model=False
mix_mnist_model_to_load='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
train_bw_mnist_model=False
bw_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
train_bg_only_colour_mnist_model=False
bg_only_colour_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
train_bg_unbiased_colour_mnist_model=False
bg_unbiased_colour_mnist_model_to_load='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
train_biased_colour_mnist_model=False
biased_colour_mnist_model_to_load='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
train_unbiased_colour_mnist_model=False
unbiased_colour_mnist_model_to_load='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
stitch_train_epochs=10
================================================
Processing for key='bw'
val['loadfrom']='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
Processing for key='bgonly'
val['loadfrom']='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
Processing for key='bias'
val['loadfrom']='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
Entering Confusion
Accuracy Calculation for ResNet18 with key='bw'
Test the Trained Resnet18 against OWN TEST LOADER: key='bw'
Test Accuracy: 99.09 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    1,    0,    0,    0,    0],
        [   0, 1132,    0,    0,    0,    2,    1,    0,    0,    0],
        [   1,    1, 1025,    3,    1,    0,    0,    1,    0,    0],
        [   1,    0,    0, 1000,    0,    5,    0,    0,    3,    1],
        [   0,    0,    0,    0,  973,    0,    0,    1,    0,    8],
        [   2,    0,    0,    1,    0,  881,    1,    0,    2,    5],
        [   3,    4,    0,    0,    0,    2,  948,    0,    1,    0],
        [   0,    5,    9,    2,    0,    0,    0, 1006,    1,    5],
        [   3,    0,    1,    0,    0,    1,    0,    2,  965,    2],
        [   1,    1,    0,    2,    3,    1,    0,    0,    1, 1000]],
       dtype=torch.int32)
tensor(10000)
Already evaluated for ./results_2g_a_rank/bw-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Accuracy Calculation for ResNet18 with key='bgonly'
Test the Trained Resnet18 against OWN TEST LOADER: key='bgonly'
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Already evaluated for ./results_2g_a_rank/bgonly-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Accuracy Calculation for ResNet18 with key='bias'
Test the Trained Resnet18 against OWN TEST LOADER: key='bias'
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Already evaluated for ./results_2g_a_rank/bias-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
original_accuracy={'bw': 99.09, 'bgonly': 100.0, 'bias': 100.0}
Entering Stitch/Rank
device='cuda:2'
target_offset=0
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 142.88
Epoch 1, loss 49.64
Epoch 2, loss 39.46
Epoch 3, loss 33.95
Epoch 4, loss 31.23
Epoch 5, loss 28.93
Epoch 6, loss 27.29
Epoch 7, loss 26.08
Epoch 8, loss 24.89
Epoch 9, loss 23.84
**** Finished Training ****
Change in stitch weights: 0.9635379910469055
Largest abs weight change: 0.13469451665878296
Number of weights changing > 0.1 of that: 1280
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.027068743482232094
Largest abs bias change: 0.005700737237930298
Number of bias changing > 0.1 of that: 61
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.46 %
Confusion Matrix
tensor([[ 973,    0,    1,    0,    0,    3,    1,    0,    2,    0],
        [   0, 1130,    0,    2,    0,    0,    0,    2,    1,    0],
        [   1,    0, 1028,    2,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0,  999,    0,    6,    0,    1,    2,    2],
        [   0,    1,    3,    0,  960,    0,    2,    4,    4,    8],
        [   1,    0,    0,    8,    0,  879,    1,    0,    3,    0],
        [   7,    5,    1,    0,    3,    2,  939,    0,    1,    0],
        [   0,    1,   10,    3,    0,    0,    0, 1008,    2,    4],
        [   2,    0,    4,    1,    2,    1,    0,    3,  953,    8],
        [   1,    1,    1,    4,    7,    6,    0,    5,    7,  977]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw3bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw4bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 328.91
Epoch 1, loss 39.71
Epoch 2, loss 32.95
Epoch 3, loss 29.39
Epoch 4, loss 26.03
Epoch 5, loss 24.39
Epoch 6, loss 23.22
Epoch 7, loss 21.69
Epoch 8, loss 20.83
Epoch 9, loss 20.32
**** Finished Training ****
Change in stitch weights: 1.1364396810531616
Largest abs weight change: 0.1213090717792511
Number of weights changing > 0.1 of that: 1776
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.02722993493080139
Largest abs bias change: 0.005689144134521484
Number of bias changing > 0.1 of that: 58
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.63 %
Confusion Matrix
tensor([[ 971,    0,    2,    0,    0,    1,    2,    1,    2,    1],
        [   0, 1123,    2,    2,    0,    2,    2,    2,    2,    0],
        [   0,    0, 1028,    1,    0,    0,    0,    1,    2,    0],
        [   0,    0,    1, 1003,    0,    4,    0,    0,    1,    1],
        [   0,    0,    2,    0,  970,    0,    1,    0,    2,    7],
        [   2,    0,    0,    6,    0,  882,    2,    0,    0,    0],
        [   0,    3,    3,    0,    2,    3,  939,    0,    8,    0],
        [   1,    3,    8,    1,    0,    0,    0, 1008,    1,    6],
        [   2,    0,    4,    2,    1,    1,    1,    2,  959,    2],
        [   1,    5,    3,    4,    3,    3,    0,    6,    4,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw4bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw5bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 122.16
Epoch 1, loss 27.18
Epoch 2, loss 22.16
Epoch 3, loss 20.03
Epoch 4, loss 18.29
Epoch 5, loss 16.80
Epoch 6, loss 15.52
Epoch 7, loss 14.84
Epoch 8, loss 14.07
Epoch 9, loss 13.97
**** Finished Training ****
Change in stitch weights: 0.9196287393569946
Largest abs weight change: 0.05576866865158081
Number of weights changing > 0.1 of that: 6332
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.028205888345837593
Largest abs bias change: 0.0040315985679626465
Number of bias changing > 0.1 of that: 116
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.88 %
Confusion Matrix
tensor([[ 975,    0,    2,    0,    0,    0,    0,    1,    2,    0],
        [   0, 1127,    0,    2,    0,    2,    1,    3,    0,    0],
        [   2,    0, 1022,    2,    0,    0,    1,    3,    2,    0],
        [   0,    0,    2,  999,    0,    5,    0,    0,    3,    1],
        [   0,    1,    0,    0,  970,    0,    0,    1,    2,    8],
        [   2,    0,    0,    3,    0,  883,    1,    0,    2,    1],
        [   2,    4,    0,    0,    4,    4,  939,    0,    5,    0],
        [   0,    1,    3,    0,    1,    0,    0, 1020,    1,    2],
        [   1,    0,    3,    0,    0,    1,    0,    2,  965,    2],
        [   4,    0,    0,    1,    4,    4,    0,    3,    5,  988]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw5bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw6bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 85.89
Epoch 1, loss 18.02
Epoch 2, loss 15.24
Epoch 3, loss 13.59
Epoch 4, loss 12.68
Epoch 5, loss 11.84
Epoch 6, loss 11.23
Epoch 7, loss 10.76
Epoch 8, loss 10.31
Epoch 9, loss 9.91
**** Finished Training ****
Change in stitch weights: 0.8404508829116821
Largest abs weight change: 0.029208391904830933
Number of weights changing > 0.1 of that: 20741
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.025602420791983604
Largest abs bias change: 0.0028502270579338074
Number of bias changing > 0.1 of that: 235
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.14 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    1,    0,    1,    2,    0],
        [   0, 1129,    1,    0,    1,    1,    1,    2,    0,    0],
        [   2,    0, 1026,    0,    1,    0,    0,    3,    0,    0],
        [   0,    0,    0, 1006,    0,    3,    0,    0,    0,    1],
        [   0,    0,    0,    0,  976,    0,    0,    1,    0,    5],
        [   2,    0,    0,    6,    0,  883,    1,    0,    0,    0],
        [   2,    4,    0,    0,    4,    1,  946,    0,    1,    0],
        [   0,    2,    4,    1,    1,    0,    0, 1017,    0,    3],
        [   1,    0,    2,    1,    0,    1,    0,    2,  966,    1],
        [   2,    0,    0,    1,    5,    3,    0,    7,    2,  989]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw6bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw7bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 58.00
Epoch 1, loss 14.62
Epoch 2, loss 12.64
Epoch 3, loss 11.59
Epoch 4, loss 10.96
Epoch 5, loss 10.44
Epoch 6, loss 9.90
Epoch 7, loss 9.67
Epoch 8, loss 9.51
Epoch 9, loss 9.25
**** Finished Training ****
Change in stitch weights: 0.8469421863555908
Largest abs weight change: 0.016784686595201492
Number of weights changing > 0.1 of that: 77780
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02651279978454113
Largest abs bias change: 0.00201566144824028
Number of bias changing > 0.1 of that: 466
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.24 %
Confusion Matrix
tensor([[ 977,    0,    0,    0,    0,    0,    1,    1,    1,    0],
        [   0, 1130,    1,    1,    0,    1,    1,    1,    0,    0],
        [   0,    0, 1025,    2,    1,    0,    0,    3,    1,    0],
        [   1,    0,    0, 1002,    0,    5,    0,    0,    1,    1],
        [   0,    0,    0,    0,  978,    0,    0,    0,    0,    4],
        [   2,    0,    0,    3,    0,  881,    1,    0,    1,    4],
        [   2,    3,    0,    0,    0,    1,  951,    0,    1,    0],
        [   0,    2,    2,    0,    0,    0,    0, 1020,    1,    3],
        [   0,    0,    1,    1,    0,    1,    0,    2,  967,    2],
        [   0,    1,    0,    1,    6,    3,    0,    2,    3,  993]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw7bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw8bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 58.80
Epoch 1, loss 15.01
Epoch 2, loss 12.74
Epoch 3, loss 11.85
Epoch 4, loss 11.27
Epoch 5, loss 10.68
Epoch 6, loss 10.39
Epoch 7, loss 9.77
Epoch 8, loss 9.66
Epoch 9, loss 9.38
**** Finished Training ****
Change in stitch weights: 0.8571301698684692
Largest abs weight change: 0.014222169294953346
Number of weights changing > 0.1 of that: 101957
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.025846850126981735
Largest abs bias change: 0.0020146071910858154
Number of bias changing > 0.1 of that: 451
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.26 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1130,    1,    1,    0,    1,    1,    1,    0,    0],
        [   0,    0, 1026,    1,    1,    0,    1,    3,    0,    0],
        [   0,    0,    1, 1001,    0,    5,    0,    0,    2,    1],
        [   0,    0,    0,    0,  978,    0,    0,    0,    0,    4],
        [   2,    0,    0,    3,    0,  883,    1,    0,    1,    2],
        [   2,    3,    0,    0,    0,    2,  950,    0,    1,    0],
        [   0,    3,    3,    0,    1,    0,    0, 1018,    1,    2],
        [   2,    0,    1,    0,    0,    1,    0,    0,  969,    1],
        [   1,    0,    0,    2,    4,    3,    0,    3,    4,  992]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw8bw-offset0-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bgonly3bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 206.46
Epoch 1, loss 8.97
Epoch 2, loss 5.45
Epoch 3, loss 5.02
Epoch 4, loss 4.75
Epoch 5, loss 3.32
Epoch 6, loss 3.70
Epoch 7, loss 2.26
Epoch 8, loss 2.46
Epoch 9, loss 1.95
**** Finished Training ****
Change in stitch weights: 0.9426455497741699
Largest abs weight change: 0.07928524166345596
Number of weights changing > 0.1 of that: 2226
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.02667813189327717
Largest abs bias change: 0.005612045526504517
Number of bias changing > 0.1 of that: 62
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly3bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly4bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 633.08
Epoch 1, loss 198.57
Epoch 2, loss 184.64
Epoch 3, loss 177.80
Epoch 4, loss 171.21
Epoch 5, loss 163.45
Epoch 6, loss 158.19
Epoch 7, loss 150.77
Epoch 8, loss 90.01
Epoch 9, loss 3.44
**** Finished Training ****
Change in stitch weights: 1.080378532409668
Largest abs weight change: 0.09618258476257324
Number of weights changing > 0.1 of that: 2188
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.026850223541259766
Largest abs bias change: 0.0056483447551727295
Number of bias changing > 0.1 of that: 59
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly4bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly5bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 90.39
Epoch 1, loss 2.51
Epoch 2, loss 1.80
Epoch 3, loss 1.56
Epoch 4, loss 1.47
Epoch 5, loss 1.74
Epoch 6, loss 1.20
Epoch 7, loss 1.09
Epoch 8, loss 1.12
Epoch 9, loss 1.34
**** Finished Training ****
Change in stitch weights: 0.6546168327331543
Largest abs weight change: 0.028426485136151314
Number of weights changing > 0.1 of that: 8914
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.027416586875915527
Largest abs bias change: 0.004038430750370026
Number of bias changing > 0.1 of that: 115
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly5bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly6bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 91.21
Epoch 1, loss 2.35
Epoch 2, loss 1.78
Epoch 3, loss 1.46
Epoch 4, loss 1.30
Epoch 5, loss 1.24
Epoch 6, loss 1.46
Epoch 7, loss 1.10
Epoch 8, loss 0.91
Epoch 9, loss 1.05
**** Finished Training ****
Change in stitch weights: 0.7222900986671448
Largest abs weight change: 0.02705351449549198
Number of weights changing > 0.1 of that: 19663
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.026757150888442993
Largest abs bias change: 0.002811271697282791
Number of bias changing > 0.1 of that: 230
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly6bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly7bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 45.22
Epoch 1, loss 2.52
Epoch 2, loss 2.21
Epoch 3, loss 1.62
Epoch 4, loss 1.40
Epoch 5, loss 1.36
Epoch 6, loss 1.45
Epoch 7, loss 1.22
Epoch 8, loss 1.14
Epoch 9, loss 1.03
**** Finished Training ****
Change in stitch weights: 0.7864189147949219
Largest abs weight change: 0.01275405939668417
Number of weights changing > 0.1 of that: 112549
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026097862049937248
Largest abs bias change: 0.0020132437348365784
Number of bias changing > 0.1 of that: 458
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly7bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly8bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 43.00
Epoch 1, loss 2.84
Epoch 2, loss 1.88
Epoch 3, loss 1.84
Epoch 4, loss 1.24
Epoch 5, loss 1.38
Epoch 6, loss 1.42
Epoch 7, loss 0.93
Epoch 8, loss 1.22
Epoch 9, loss 0.79
**** Finished Training ****
Change in stitch weights: 0.7827845811843872
Largest abs weight change: 0.011776525527238846
Number of weights changing > 0.1 of that: 121887
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02675146795809269
Largest abs bias change: 0.0020180121064186096
Number of bias changing > 0.1 of that: 464
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly8bgonly-offset0-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bias3bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 274.67
Epoch 1, loss 30.13
Epoch 2, loss 19.42
Epoch 3, loss 11.11
Epoch 4, loss 11.73
Epoch 5, loss 9.04
Epoch 6, loss 7.41
Epoch 7, loss 7.68
Epoch 8, loss 7.05
Epoch 9, loss 5.55
**** Finished Training ****
Change in stitch weights: 2.130089521408081
Largest abs weight change: 0.16842079162597656
Number of weights changing > 0.1 of that: 2176
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.02725020796060562
Largest abs bias change: 0.005686953663825989
Number of bias changing > 0.1 of that: 61
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias3bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias4bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 63.38
Epoch 1, loss 4.49
Epoch 2, loss 3.79
Epoch 3, loss 2.34
Epoch 4, loss 2.72
Epoch 5, loss 3.39
Epoch 6, loss 1.78
Epoch 7, loss 1.39
Epoch 8, loss 1.62
Epoch 9, loss 2.61
**** Finished Training ****
Change in stitch weights: 0.5848265290260315
Largest abs weight change: 0.06236341595649719
Number of weights changing > 0.1 of that: 1716
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.026666628196835518
Largest abs bias change: 0.00565744936466217
Number of bias changing > 0.1 of that: 58
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias4bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias5bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 130.00
Epoch 1, loss 3.17
Epoch 2, loss 8.35
Epoch 3, loss 2.54
Epoch 4, loss 1.69
Epoch 5, loss 1.79
Epoch 6, loss 1.49
Epoch 7, loss 1.91
Epoch 8, loss 1.62
Epoch 9, loss 1.46
**** Finished Training ****
Change in stitch weights: 0.8905790448188782
Largest abs weight change: 0.041417382657527924
Number of weights changing > 0.1 of that: 8084
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.025709038600325584
Largest abs bias change: 0.003993332386016846
Number of bias changing > 0.1 of that: 116
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias5bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias6bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 59.97
Epoch 1, loss 2.01
Epoch 2, loss 1.49
Epoch 3, loss 1.36
Epoch 4, loss 1.07
Epoch 5, loss 1.05
Epoch 6, loss 0.98
Epoch 7, loss 0.86
Epoch 8, loss 1.13
Epoch 9, loss 0.69
**** Finished Training ****
Change in stitch weights: 0.7271683216094971
Largest abs weight change: 0.026011472567915916
Number of weights changing > 0.1 of that: 20601
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.026049211621284485
Largest abs bias change: 0.002844449132680893
Number of bias changing > 0.1 of that: 232
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias6bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias7bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 37.66
Epoch 1, loss 1.16
Epoch 2, loss 0.99
Epoch 3, loss 0.96
Epoch 4, loss 0.67
Epoch 5, loss 0.55
Epoch 6, loss 0.61
Epoch 7, loss 0.68
Epoch 8, loss 0.62
Epoch 9, loss 0.57
**** Finished Training ****
Change in stitch weights: 0.7471906542778015
Largest abs weight change: 0.01000208966434002
Number of weights changing > 0.1 of that: 139446
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02697082981467247
Largest abs bias change: 0.0020195916295051575
Number of bias changing > 0.1 of that: 462
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias7bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias8bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 44.19
Epoch 1, loss 1.41
Epoch 2, loss 1.15
Epoch 3, loss 0.91
Epoch 4, loss 0.82
Epoch 5, loss 0.66
Epoch 6, loss 0.49
Epoch 7, loss 0.54
Epoch 8, loss 0.50
Epoch 9, loss 0.62
**** Finished Training ****
Change in stitch weights: 0.7662928104400635
Largest abs weight change: 0.012794049456715584
Number of weights changing > 0.1 of that: 108757
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026657894253730774
Largest abs bias change: 0.0020156465470790863
Number of bias changing > 0.1 of that: 462
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias8bias-offset0-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
target_offset=4
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 1257.60
Epoch 1, loss 431.92
Epoch 2, loss 339.46
Epoch 3, loss 292.00
Epoch 4, loss 257.35
Epoch 5, loss 235.07
Epoch 6, loss 219.78
Epoch 7, loss 204.23
Epoch 8, loss 195.34
Epoch 9, loss 183.43
**** Finished Training ****
Change in stitch weights: 2.0150985717773438
Largest abs weight change: 0.16301928460597992
Number of weights changing > 0.1 of that: 2378
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.02400774322450161
Largest abs bias change: 0.005480505526065826
Number of bias changing > 0.1 of that: 60
Test the trained stitch against send_key='bw' data
Test Accuracy: 89.90 %
Confusion Matrix
tensor([[ 888,    2,   12,    1,    8,    7,    0,    2,   20,   18],
        [   1,  941,    2,   20,    4,   16,   12,   11,   21,    0],
        [  10,    4,  890,   15,    9,    2,   13,    3,   22,    6],
        [   3,   10,    8,  877,    6,    9,    0,   19,   52,   25],
        [   5,    1,   12,    1,  908,    9,    0,    0,   34,   10],
        [   4,   10,    0,    8,    0, 1098,    4,    1,    8,    2],
        [   9,   32,   73,    7,   15,   47,  806,   11,   32,    0],
        [   1,   34,   22,   25,   13,    6,    3,  851,    3,   52],
        [   2,    3,    7,   24,    1,   12,    4,    0,  927,    2],
        [   5,    2,    8,   15,   13,    8,    0,   32,    5,  804]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw3bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw4bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 890.43
Epoch 1, loss 271.22
Epoch 2, loss 180.39
Epoch 3, loss 139.47
Epoch 4, loss 120.13
Epoch 5, loss 103.81
Epoch 6, loss 94.52
Epoch 7, loss 85.93
Epoch 8, loss 80.55
Epoch 9, loss 75.19
**** Finished Training ****
Change in stitch weights: 1.9914569854736328
Largest abs weight change: 0.12172731757164001
Number of weights changing > 0.1 of that: 2809
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.02680877409875393
Largest abs bias change: 0.005701780319213867
Number of bias changing > 0.1 of that: 56
Test the trained stitch against send_key='bw' data
Test Accuracy: 96.17 %
Confusion Matrix
tensor([[ 911,    4,   13,    0,    3,    4,    3,    0,    3,   17],
        [   0,  988,    8,    6,    0,    8,    9,    4,    5,    0],
        [   3,    0,  945,    4,    8,    0,    5,    2,    4,    3],
        [   0,   11,   10,  945,    4,    1,    0,    2,   22,   14],
        [   0,    1,    9,    0,  962,    0,    2,    1,    1,    4],
        [   4,    4,    0,    3,    1, 1116,    1,    4,    1,    1],
        [   1,   10,   15,    1,    8,   10,  981,    2,    4,    0],
        [   0,   17,    6,    2,    4,    2,    4,  966,    1,    8],
        [   6,    1,    3,   13,    0,    0,    3,    1,  954,    1],
        [   8,    2,   10,    7,    3,    0,    0,    9,    4,  849]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw4bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw5bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 283.93
Epoch 1, loss 57.21
Epoch 2, loss 41.45
Epoch 3, loss 34.31
Epoch 4, loss 29.66
Epoch 5, loss 26.77
Epoch 6, loss 25.02
Epoch 7, loss 23.63
Epoch 8, loss 21.80
Epoch 9, loss 20.58
**** Finished Training ****
Change in stitch weights: 1.2337837219238281
Largest abs weight change: 0.04933544620871544
Number of weights changing > 0.1 of that: 9388
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.027077797800302505
Largest abs bias change: 0.0040121302008628845
Number of bias changing > 0.1 of that: 117
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.67 %
Confusion Matrix
tensor([[ 942,    0,    1,    0,    1,    3,    1,    0,    4,    6],
        [   0, 1002,    2,    1,    1,    3,   12,    3,    2,    2],
        [   2,    1,  965,    2,    2,    0,    1,    0,    1,    0],
        [   1,    0,    5,  985,    2,    0,    0,    3,    6,    7],
        [   0,    1,    2,    0,  974,    0,    1,    1,    0,    1],
        [   1,    1,    1,    0,    0, 1129,    1,    2,    0,    0],
        [   0,    4,    0,    0,    3,    0, 1022,    1,    2,    0],
        [   0,    1,    1,    2,    1,    0,    1,  998,    0,    6],
        [   0,    0,    1,    4,    0,    2,    1,    0,  973,    1],
        [   2,    0,    1,    5,    2,    0,    0,    5,    0,  877]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw5bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw6bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 112.97
Epoch 1, loss 25.03
Epoch 2, loss 20.30
Epoch 3, loss 18.13
Epoch 4, loss 16.64
Epoch 5, loss 15.69
Epoch 6, loss 14.59
Epoch 7, loss 14.11
Epoch 8, loss 13.41
Epoch 9, loss 12.89
**** Finished Training ****
Change in stitch weights: 0.8853110074996948
Largest abs weight change: 0.03455738723278046
Number of weights changing > 0.1 of that: 16727
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.026263706386089325
Largest abs bias change: 0.002841480076313019
Number of bias changing > 0.1 of that: 226
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.10 %
Confusion Matrix
tensor([[ 950,    0,    2,    0,    1,    2,    1,    0,    0,    2],
        [   0, 1016,    2,    3,    0,    1,    3,    2,    1,    0],
        [   0,    1,  967,    2,    1,    0,    1,    1,    1,    0],
        [   0,    5,    3,  988,    0,    0,    1,    3,    4,    5],
        [   1,    0,    0,    0,  978,    0,    0,    0,    0,    1],
        [   1,    0,    0,    1,    0, 1128,    1,    2,    1,    1],
        [   0,    5,    0,    0,    2,    0, 1023,    1,    1,    0],
        [   0,    0,    1,    0,    1,    0,    1, 1004,    0,    3],
        [   0,    0,    0,    5,    0,    0,    0,    0,  977,    0],
        [   1,    0,    2,    2,    1,    0,    0,    7,    0,  879]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw6bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw7bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 67.77
Epoch 1, loss 15.62
Epoch 2, loss 12.85
Epoch 3, loss 12.33
Epoch 4, loss 11.50
Epoch 5, loss 10.63
Epoch 6, loss 10.26
Epoch 7, loss 10.39
Epoch 8, loss 9.92
Epoch 9, loss 9.92
**** Finished Training ****
Change in stitch weights: 0.8629426956176758
Largest abs weight change: 0.013041225261986256
Number of weights changing > 0.1 of that: 115038
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.025658516213297844
Largest abs bias change: 0.0020100846886634827
Number of bias changing > 0.1 of that: 454
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.19 %
Confusion Matrix
tensor([[ 951,    0,    0,    0,    2,    3,    0,    0,    1,    1],
        [   0, 1018,    1,    3,    0,    3,    2,    0,    1,    0],
        [   0,    2,  965,    2,    3,    0,    1,    0,    0,    1],
        [   0,    3,    2,  994,    0,    1,    0,    2,    5,    2],
        [   0,    1,    0,    0,  979,    0,    0,    0,    0,    0],
        [   1,    1,    0,    0,    0, 1129,    1,    2,    0,    1],
        [   1,    4,    1,    0,    1,    0, 1022,    2,    1,    0],
        [   0,    0,    1,    1,    1,    0,    0, 1003,    0,    4],
        [   0,    0,    0,    5,    0,    0,    0,    0,  977,    0],
        [   1,    1,    1,    3,    2,    0,    0,    3,    0,  881]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw7bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw8bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 69.12
Epoch 1, loss 16.34
Epoch 2, loss 13.32
Epoch 3, loss 12.07
Epoch 4, loss 11.63
Epoch 5, loss 10.93
Epoch 6, loss 10.47
Epoch 7, loss 10.18
Epoch 8, loss 9.55
Epoch 9, loss 9.83
**** Finished Training ****
Change in stitch weights: 0.8745346069335938
Largest abs weight change: 0.017177311703562737
Number of weights changing > 0.1 of that: 76843
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02592710591852665
Largest abs bias change: 0.0020149797201156616
Number of bias changing > 0.1 of that: 459
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.25 %
Confusion Matrix
tensor([[ 949,    0,    1,    0,    2,    2,    1,    0,    1,    2],
        [   0, 1021,    1,    2,    0,    2,    1,    0,    1,    0],
        [   0,    2,  966,    1,    2,    0,    1,    1,    0,    1],
        [   0,    1,    1,  997,    0,    0,    0,    2,    5,    3],
        [   0,    1,    0,    0,  979,    0,    0,    0,    0,    0],
        [   1,    2,    0,    0,    0, 1128,    1,    2,    0,    1],
        [   0,    3,    0,    0,    0,    0, 1027,    2,    0,    0],
        [   0,    0,    1,    1,    1,    0,    0, 1005,    0,    2],
        [   0,    0,    0,    5,    0,    0,    1,    0,  976,    0],
        [   1,    0,    1,    5,    2,    0,    0,    6,    0,  877]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw8bw-offset4-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bgonly3bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 404.53
Epoch 1, loss 17.00
Epoch 2, loss 10.98
Epoch 3, loss 6.57
Epoch 4, loss 6.12
Epoch 5, loss 4.82
Epoch 6, loss 3.76
Epoch 7, loss 3.78
Epoch 8, loss 3.97
Epoch 9, loss 2.87
**** Finished Training ****
Change in stitch weights: 0.9087633490562439
Largest abs weight change: 0.08108633011579514
Number of weights changing > 0.1 of that: 2190
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.024519527330994606
Largest abs bias change: 0.0056504979729652405
Number of bias changing > 0.1 of that: 56
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 958,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  974,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1135,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  982,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly3bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly4bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 1411.66
Epoch 1, loss 271.46
Epoch 2, loss 236.84
Epoch 3, loss 214.35
Epoch 4, loss 205.93
Epoch 5, loss 200.14
Epoch 6, loss 192.70
Epoch 7, loss 188.64
Epoch 8, loss 183.31
Epoch 9, loss 178.78
**** Finished Training ****
Change in stitch weights: 1.2240564823150635
Largest abs weight change: 0.1222326010465622
Number of weights changing > 0.1 of that: 1987
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.029139811173081398
Largest abs bias change: 0.005614101886749268
Number of bias changing > 0.1 of that: 59
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 88.65 %
Confusion Matrix
tensor([[ 958,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  974,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1135,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  982,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly4bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly5bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 924.91
Epoch 1, loss 44.01
Epoch 2, loss 2.50
Epoch 3, loss 1.80
Epoch 4, loss 1.49
Epoch 5, loss 1.59
Epoch 6, loss 1.58
Epoch 7, loss 0.92
Epoch 8, loss 1.61
Epoch 9, loss 1.43
**** Finished Training ****
Change in stitch weights: 0.9642385840415955
Largest abs weight change: 0.03958641737699509
Number of weights changing > 0.1 of that: 9433
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.028201686218380928
Largest abs bias change: 0.0040380582213401794
Number of bias changing > 0.1 of that: 114
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 958,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  974,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1135,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  982,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly5bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly6bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 74.72
Epoch 1, loss 1.64
Epoch 2, loss 1.25
Epoch 3, loss 1.28
Epoch 4, loss 1.20
Epoch 5, loss 0.85
Epoch 6, loss 0.91
Epoch 7, loss 0.82
Epoch 8, loss 0.61
Epoch 9, loss 0.90
**** Finished Training ****
Change in stitch weights: 0.7168471813201904
Largest abs weight change: 0.018715646117925644
Number of weights changing > 0.1 of that: 31801
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.026407217606902122
Largest abs bias change: 0.0028306543827056885
Number of bias changing > 0.1 of that: 238
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 958,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  974,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1135,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  982,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly6bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly7bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 32.53
Epoch 1, loss 2.74
Epoch 2, loss 2.11
Epoch 3, loss 2.25
Epoch 4, loss 1.54
Epoch 5, loss 1.57
Epoch 6, loss 1.26
Epoch 7, loss 1.29
Epoch 8, loss 1.73
Epoch 9, loss 1.19
**** Finished Training ****
Change in stitch weights: 0.7631558775901794
Largest abs weight change: 0.010565456002950668
Number of weights changing > 0.1 of that: 134249
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026898372918367386
Largest abs bias change: 0.0020193345844745636
Number of bias changing > 0.1 of that: 471
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 958,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  974,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1135,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  982,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly7bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly8bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 35.15
Epoch 1, loss 2.48
Epoch 2, loss 1.98
Epoch 3, loss 1.80
Epoch 4, loss 1.22
Epoch 5, loss 1.25
Epoch 6, loss 1.45
Epoch 7, loss 1.10
Epoch 8, loss 1.01
Epoch 9, loss 1.35
**** Finished Training ****
Change in stitch weights: 0.7648908495903015
Largest abs weight change: 0.0144455935806036
Number of weights changing > 0.1 of that: 91896
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02572513557970524
Largest abs bias change: 0.0020200610160827637
Number of bias changing > 0.1 of that: 469
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 958,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  974,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1135,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  982,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly8bgonly-offset4-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bias3bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 3438.07
Epoch 1, loss 329.32
Epoch 2, loss 305.20
Epoch 3, loss 285.48
Epoch 4, loss 269.37
Epoch 5, loss 181.85
Epoch 6, loss 31.68
Epoch 7, loss 18.75
Epoch 8, loss 14.05
Epoch 9, loss 10.45
**** Finished Training ****
Change in stitch weights: 1.4910014867782593
Largest abs weight change: 0.12008673697710037
Number of weights changing > 0.1 of that: 2376
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.025960532948374748
Largest abs bias change: 0.005599409341812134
Number of bias changing > 0.1 of that: 54
Test the trained stitch against send_key='bias' data
Test Accuracy: 99.94 %
Confusion Matrix
tensor([[ 956,    0,    0,    0,    0,    0,    2,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  973,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1135,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    3,    0,    0,    0,    0,    0,  979,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias3bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias4bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 1055.61
Epoch 1, loss 17.62
Epoch 2, loss 8.68
Epoch 3, loss 7.07
Epoch 4, loss 5.40
Epoch 5, loss 4.64
Epoch 6, loss 5.67
Epoch 7, loss 4.02
Epoch 8, loss 4.20
Epoch 9, loss 3.08
**** Finished Training ****
Change in stitch weights: 1.3042930364608765
Largest abs weight change: 0.11698845028877258
Number of weights changing > 0.1 of that: 2047
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.025958789512515068
Largest abs bias change: 0.005641505122184753
Number of bias changing > 0.1 of that: 60
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 958,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  974,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1135,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  982,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias4bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias5bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 2469.84
Epoch 1, loss 11.07
Epoch 2, loss 6.66
Epoch 3, loss 6.60
Epoch 4, loss 4.71
Epoch 5, loss 4.52
Epoch 6, loss 2.96
Epoch 7, loss 3.78
Epoch 8, loss 2.99
Epoch 9, loss 2.92
**** Finished Training ****
Change in stitch weights: 1.21739661693573
Largest abs weight change: 0.0731753557920456
Number of weights changing > 0.1 of that: 5988
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.02627594582736492
Largest abs bias change: 0.004041925072669983
Number of bias changing > 0.1 of that: 116
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 958,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  974,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1135,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  982,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias5bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias6bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 356.77
Epoch 1, loss 5.76
Epoch 2, loss 3.79
Epoch 3, loss 2.31
Epoch 4, loss 1.97
Epoch 5, loss 1.95
Epoch 6, loss 2.28
Epoch 7, loss 1.21
Epoch 8, loss 2.17
Epoch 9, loss 1.23
**** Finished Training ****
Change in stitch weights: 1.1121548414230347
Largest abs weight change: 0.039559729397296906
Number of weights changing > 0.1 of that: 17716
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.026774171739816666
Largest abs bias change: 0.002849102020263672
Number of bias changing > 0.1 of that: 234
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 958,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  974,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1135,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  982,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias6bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias7bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 26.70
Epoch 1, loss 1.53
Epoch 2, loss 1.14
Epoch 3, loss 0.75
Epoch 4, loss 0.78
Epoch 5, loss 0.72
Epoch 6, loss 0.54
Epoch 7, loss 0.57
Epoch 8, loss 0.58
Epoch 9, loss 0.63
**** Finished Training ****
Change in stitch weights: 0.7309435606002808
Largest abs weight change: 0.009699871763586998
Number of weights changing > 0.1 of that: 142547
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02630067802965641
Largest abs bias change: 0.0020189881324768066
Number of bias changing > 0.1 of that: 450
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 958,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  974,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1135,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  982,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias7bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias8bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 33.12
Epoch 1, loss 1.48
Epoch 2, loss 1.11
Epoch 3, loss 0.80
Epoch 4, loss 0.67
Epoch 5, loss 0.69
Epoch 6, loss 0.64
Epoch 7, loss 0.50
Epoch 8, loss 0.42
Epoch 9, loss 0.51
**** Finished Training ****
Change in stitch weights: 0.7349515557289124
Largest abs weight change: 0.00932295061647892
Number of weights changing > 0.1 of that: 147342
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026788147166371346
Largest abs bias change: 0.0020175985991954803
Number of bias changing > 0.1 of that: 456
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 958,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1028,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  974,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1135,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1032,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1010,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  982,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  892]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias8bias-offset4-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
target_offset=5
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 2209.89
Epoch 1, loss 662.36
Epoch 2, loss 429.84
Epoch 3, loss 335.45
Epoch 4, loss 283.63
Epoch 5, loss 247.06
Epoch 6, loss 224.94
Epoch 7, loss 207.13
Epoch 8, loss 191.63
Epoch 9, loss 180.43
**** Finished Training ****
Change in stitch weights: 2.3986313343048096
Largest abs weight change: 0.18759362399578094
Number of weights changing > 0.1 of that: 2397
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.027007516473531723
Largest abs bias change: 0.005685798823833466
Number of bias changing > 0.1 of that: 57
Test the trained stitch against send_key='bw' data
Test Accuracy: 90.70 %
Confusion Matrix
tensor([[ 766,    7,   20,   22,    4,   15,    4,    2,   35,   17],
        [   8,  900,    1,   10,    2,   15,    3,   11,    1,    7],
        [   0,    1,  927,   21,   26,    3,    1,   21,   23,    5],
        [   0,    9,    9,  883,    6,   32,    2,    9,   11,   13],
        [   1,    5,   39,   16,  850,   18,    8,    8,   15,   49],
        [   3,    6,    4,   14,    2,  944,    1,    1,    4,    1],
        [   3,   10,    3,    0,    2,    1, 1107,    3,    6,    0],
        [   1,   10,   33,   32,    9,   47,    1,  858,   34,    7],
        [   3,    0,   24,   19,    7,    9,    2,   15,  929,    2],
        [   0,   14,    4,    9,   27,    9,    4,    4,    5,  906]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw3bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw4bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 1097.14
Epoch 1, loss 212.69
Epoch 2, loss 153.52
Epoch 3, loss 126.26
Epoch 4, loss 109.40
Epoch 5, loss 99.22
Epoch 6, loss 90.67
Epoch 7, loss 85.01
Epoch 8, loss 80.97
Epoch 9, loss 76.08
**** Finished Training ****
Change in stitch weights: 1.8583526611328125
Largest abs weight change: 0.1263129562139511
Number of weights changing > 0.1 of that: 2696
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.02372477389872074
Largest abs bias change: 0.005644969642162323
Number of bias changing > 0.1 of that: 56
Test the trained stitch against send_key='bw' data
Test Accuracy: 95.83 %
Confusion Matrix
tensor([[ 845,    4,    5,   11,    5,    5,    0,    0,   15,    2],
        [   4,  928,    0,    7,    0,   11,    3,    2,    0,    3],
        [   1,    0,  973,    4,   15,    1,    2,   18,   12,    2],
        [   1,    9,    4,  934,    2,    7,    0,    5,    5,    7],
        [   5,    0,   23,    6,  936,    7,    4,    1,   14,   13],
        [   2,    3,    1,    4,    5,  959,    1,    2,    2,    1],
        [   2,    4,    3,    0,    0,    2, 1116,    2,    5,    1],
        [   1,    6,   10,    8,    3,    7,    0,  980,    9,    8],
        [  13,    0,    8,    7,    0,    1,    0,    9,  972,    0],
        [   0,    5,   11,    3,   21,    0,    0,    1,    1,  940]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw4bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw5bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 335.53
Epoch 1, loss 61.25
Epoch 2, loss 45.08
Epoch 3, loss 37.64
Epoch 4, loss 33.47
Epoch 5, loss 29.94
Epoch 6, loss 27.34
Epoch 7, loss 25.88
Epoch 8, loss 23.57
Epoch 9, loss 23.14
**** Finished Training ****
Change in stitch weights: 1.2650753259658813
Largest abs weight change: 0.06366991996765137
Number of weights changing > 0.1 of that: 7971
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.02595154196023941
Largest abs bias change: 0.00402754545211792
Number of bias changing > 0.1 of that: 114
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.49 %
Confusion Matrix
tensor([[ 876,    3,    2,    2,    2,    2,    0,    0,    5,    0],
        [   2,  951,    0,    3,    0,    1,    1,    0,    0,    0],
        [   0,    0, 1006,    1,    7,    0,    1,   11,    0,    2],
        [   1,    1,    2,  962,    2,    1,    0,    4,    0,    1],
        [   8,    0,    3,    2,  984,    3,    1,    2,    2,    4],
        [   1,    1,    1,    1,    0,  975,    0,    1,    0,    0],
        [   3,    1,    3,    0,    0,    2, 1120,    2,    3,    1],
        [   0,    0,    4,    3,    0,    6,    0, 1012,    3,    4],
        [   7,    0,    2,    3,    1,    1,    0,    0,  996,    0],
        [   0,    2,    2,    0,    9,    0,    0,    2,    0,  967]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw5bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw6bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 109.80
Epoch 1, loss 27.84
Epoch 2, loss 22.51
Epoch 3, loss 19.45
Epoch 4, loss 17.35
Epoch 5, loss 16.13
Epoch 6, loss 15.12
Epoch 7, loss 14.42
Epoch 8, loss 13.90
Epoch 9, loss 13.10
**** Finished Training ****
Change in stitch weights: 0.8571420907974243
Largest abs weight change: 0.03624502196907997
Number of weights changing > 0.1 of that: 14827
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.02709098905324936
Largest abs bias change: 0.0028471611440181732
Number of bias changing > 0.1 of that: 241
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.93 %
Confusion Matrix
tensor([[ 883,    1,    1,    1,    1,    1,    0,    0,    4,    0],
        [   3,  945,    0,    3,    0,    4,    1,    0,    1,    1],
        [   0,    0, 1016,    1,    3,    0,    2,    5,    1,    0],
        [   1,    0,    1,  965,    1,    1,    0,    2,    3,    0],
        [  10,    0,    4,    1,  984,    0,    1,    0,    2,    7],
        [   0,    0,    1,    1,    0,  978,    0,    0,    0,    0],
        [   2,    2,    1,    0,    0,    0, 1126,    1,    2,    1],
        [   0,    0,    4,    0,    0,    1,    0, 1023,    4,    0],
        [   8,    0,    0,    1,    0,    0,    0,    2,  999,    0],
        [   0,    0,    0,    0,    7,    0,    0,    1,    0,  974]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw6bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw7bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 71.42
Epoch 1, loss 15.72
Epoch 2, loss 13.09
Epoch 3, loss 11.76
Epoch 4, loss 11.09
Epoch 5, loss 10.70
Epoch 6, loss 10.58
Epoch 7, loss 10.04
Epoch 8, loss 10.33
Epoch 9, loss 9.89
**** Finished Training ****
Change in stitch weights: 0.8741657733917236
Largest abs weight change: 0.012812834233045578
Number of weights changing > 0.1 of that: 118175
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.025559639558196068
Largest abs bias change: 0.0020133331418037415
Number of bias changing > 0.1 of that: 451
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.22 %
Confusion Matrix
tensor([[ 882,    1,    0,    1,    2,    2,    0,    0,    4,    0],
        [   2,  947,    0,    1,    0,    3,    3,    0,    0,    2],
        [   0,    0, 1023,    1,    1,    0,    1,    1,    0,    1],
        [   1,    0,    2,  965,    2,    3,    0,    1,    0,    0],
        [   2,    0,    3,    1,  993,    1,    1,    0,    1,    7],
        [   0,    0,    1,    0,    0,  979,    0,    0,    0,    0],
        [   1,    1,    2,    0,    0,    0, 1129,    1,    1,    0],
        [   0,    0,    3,    0,    0,    2,    0, 1025,    1,    1],
        [   5,    0,    0,    1,    1,    1,    0,    1, 1001,    0],
        [   0,    0,    0,    0,    4,    0,    0,    0,    0,  978]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw7bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw8bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 58.89
Epoch 1, loss 15.38
Epoch 2, loss 13.04
Epoch 3, loss 11.86
Epoch 4, loss 11.19
Epoch 5, loss 10.45
Epoch 6, loss 10.37
Epoch 7, loss 9.87
Epoch 8, loss 9.78
Epoch 9, loss 9.61
**** Finished Training ****
Change in stitch weights: 0.8509308099746704
Largest abs weight change: 0.01754867285490036
Number of weights changing > 0.1 of that: 70435
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02521645836532116
Largest abs bias change: 0.002013247460126877
Number of bias changing > 0.1 of that: 448
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.23 %
Confusion Matrix
tensor([[ 878,    1,    0,    1,    4,    2,    0,    0,    6,    0],
        [   1,  950,    0,    1,    0,    2,    2,    1,    0,    1],
        [   0,    0, 1021,    1,    2,    0,    2,    1,    0,    1],
        [   1,    0,    2,  966,    2,    1,    0,    1,    1,    0],
        [   1,    0,    2,    2,  999,    0,    0,    0,    1,    4],
        [   1,    0,    1,    0,    0,  977,    0,    1,    0,    0],
        [   1,    1,    2,    0,    0,    0, 1128,    1,    2,    0],
        [   0,    1,    3,    0,    0,    1,    0, 1023,    3,    1],
        [   2,    0,    0,    1,    2,    1,    0,    0, 1004,    0],
        [   0,    0,    0,    0,    5,    0,    0,    0,    0,  977]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw8bw-offset5-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bgonly3bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 308.75
Epoch 1, loss 15.52
Epoch 2, loss 9.71
Epoch 3, loss 6.54
Epoch 4, loss 5.50
Epoch 5, loss 5.87
Epoch 6, loss 3.75
Epoch 7, loss 6.62
Epoch 8, loss 3.40
Epoch 9, loss 3.26
**** Finished Training ****
Change in stitch weights: 0.8763421773910522
Largest abs weight change: 0.07698196172714233
Number of weights changing > 0.1 of that: 2163
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.025584591552615166
Largest abs bias change: 0.0056570544838905334
Number of bias changing > 0.1 of that: 56
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1028,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  974,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  980,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1032,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly3bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly4bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 2240.08
Epoch 1, loss 381.83
Epoch 2, loss 236.12
Epoch 3, loss 215.86
Epoch 4, loss 200.86
Epoch 5, loss 194.57
Epoch 6, loss 190.06
Epoch 7, loss 185.48
Epoch 8, loss 180.24
Epoch 9, loss 174.81
**** Finished Training ****
Change in stitch weights: 1.4736279249191284
Largest abs weight change: 0.11139540374279022
Number of weights changing > 0.1 of that: 2398
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.027236081659793854
Largest abs bias change: 0.005706451833248138
Number of bias changing > 0.1 of that: 61
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 90.20 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1028,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  974,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1032,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly4bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly5bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 104.21
Epoch 1, loss 5.34
Epoch 2, loss 2.21
Epoch 3, loss 2.06
Epoch 4, loss 2.37
Epoch 5, loss 1.65
Epoch 6, loss 1.71
Epoch 7, loss 1.01
Epoch 8, loss 1.43
Epoch 9, loss 0.78
**** Finished Training ****
Change in stitch weights: 0.6312074661254883
Largest abs weight change: 0.025700204074382782
Number of weights changing > 0.1 of that: 9454
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.026699809357523918
Largest abs bias change: 0.004036076366901398
Number of bias changing > 0.1 of that: 119
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1028,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  974,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  980,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1032,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly5bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly6bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 108.29
Epoch 1, loss 4.20
Epoch 2, loss 2.55
Epoch 3, loss 2.48
Epoch 4, loss 1.52
Epoch 5, loss 1.77
Epoch 6, loss 1.13
Epoch 7, loss 1.53
Epoch 8, loss 1.34
Epoch 9, loss 1.08
**** Finished Training ****
Change in stitch weights: 0.7900722622871399
Largest abs weight change: 0.026805998757481575
Number of weights changing > 0.1 of that: 22796
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.026546167209744453
Largest abs bias change: 0.0028496868908405304
Number of bias changing > 0.1 of that: 235
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1028,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  974,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  980,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1032,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly6bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly7bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 39.29
Epoch 1, loss 2.65
Epoch 2, loss 1.94
Epoch 3, loss 1.73
Epoch 4, loss 1.32
Epoch 5, loss 1.10
Epoch 6, loss 1.41
Epoch 7, loss 1.31
Epoch 8, loss 1.17
Epoch 9, loss 1.16
**** Finished Training ****
Change in stitch weights: 0.775851309299469
Largest abs weight change: 0.011378230527043343
Number of weights changing > 0.1 of that: 125762
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026400016620755196
Largest abs bias change: 0.00201965868473053
Number of bias changing > 0.1 of that: 453
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1028,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  974,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  980,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1032,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly7bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly8bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 35.96
Epoch 1, loss 2.93
Epoch 2, loss 2.15
Epoch 3, loss 1.97
Epoch 4, loss 1.32
Epoch 5, loss 1.39
Epoch 6, loss 1.18
Epoch 7, loss 1.14
Epoch 8, loss 0.96
Epoch 9, loss 1.03
**** Finished Training ****
Change in stitch weights: 0.7652480006217957
Largest abs weight change: 0.013189921155571938
Number of weights changing > 0.1 of that: 104879
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.0258567463606596
Largest abs bias change: 0.0020121783018112183
Number of bias changing > 0.1 of that: 464
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1028,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  974,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  980,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1032,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly8bgonly-offset5-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bias3bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 2019.44
Epoch 1, loss 790.21
Epoch 2, loss 689.33
Epoch 3, loss 635.76
Epoch 4, loss 621.91
Epoch 5, loss 577.00
Epoch 6, loss 561.56
Epoch 7, loss 518.70
Epoch 8, loss 522.43
Epoch 9, loss 521.30
**** Finished Training ****
Change in stitch weights: 2.296416997909546
Largest abs weight change: 0.14337369799613953
Number of weights changing > 0.1 of that: 2851
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.026838885620236397
Largest abs bias change: 0.005714632570743561
Number of bias changing > 0.1 of that: 57
Test the trained stitch against send_key='bias' data
Test Accuracy: 82.01 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    4,  789,    0,   17,    1,  217,    0],
        [   0,    0,    0,  972,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  978,    0,    0,    0,    2],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [  94,    0,  673,    0,    0,    0,    0,  265,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias3bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias4bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 697.02
Epoch 1, loss 338.70
Epoch 2, loss 305.33
Epoch 3, loss 272.29
Epoch 4, loss 38.13
Epoch 5, loss 6.93
Epoch 6, loss 5.74
Epoch 7, loss 3.53
Epoch 8, loss 3.70
Epoch 9, loss 3.93
**** Finished Training ****
Change in stitch weights: 1.1802457571029663
Largest abs weight change: 0.09933535754680634
Number of weights changing > 0.1 of that: 2258
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.027452148497104645
Largest abs bias change: 0.005713962018489838
Number of bias changing > 0.1 of that: 63
Test the trained stitch against send_key='bias' data
Test Accuracy: 99.97 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1025,    0,    0,    0,    0,    0,    3,    0],
        [   0,    0,    0,  974,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  980,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1032,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias4bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias5bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 949.46
Epoch 1, loss 24.61
Epoch 2, loss 14.52
Epoch 3, loss 8.82
Epoch 4, loss 6.84
Epoch 5, loss 6.37
Epoch 6, loss 4.78
Epoch 7, loss 4.80
Epoch 8, loss 3.43
Epoch 9, loss 3.42
**** Finished Training ****
Change in stitch weights: 1.2190492153167725
Largest abs weight change: 0.06851851940155029
Number of weights changing > 0.1 of that: 6605
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.026536136865615845
Largest abs bias change: 0.004023134708404541
Number of bias changing > 0.1 of that: 114
Test the trained stitch against send_key='bias' data
Test Accuracy: 99.97 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1025,    0,    0,    0,    0,    0,    3,    0],
        [   0,    0,    0,  974,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  980,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1032,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias5bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias6bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 266.35
Epoch 1, loss 6.71
Epoch 2, loss 4.56
Epoch 3, loss 3.01
Epoch 4, loss 2.37
Epoch 5, loss 3.64
Epoch 6, loss 1.76
Epoch 7, loss 1.49
Epoch 8, loss 1.70
Epoch 9, loss 1.61
**** Finished Training ****
Change in stitch weights: 1.112215518951416
Largest abs weight change: 0.07745258510112762
Number of weights changing > 0.1 of that: 4786
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.026528002694249153
Largest abs bias change: 0.002855077385902405
Number of bias changing > 0.1 of that: 226
Test the trained stitch against send_key='bias' data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1027,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0,  974,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  980,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1032,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias6bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias7bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 41.52
Epoch 1, loss 1.33
Epoch 2, loss 1.20
Epoch 3, loss 1.02
Epoch 4, loss 0.94
Epoch 5, loss 0.88
Epoch 6, loss 0.78
Epoch 7, loss 0.53
Epoch 8, loss 0.53
Epoch 9, loss 0.51
**** Finished Training ****
Change in stitch weights: 0.7597305774688721
Largest abs weight change: 0.009512944146990776
Number of weights changing > 0.1 of that: 146478
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026954909786581993
Largest abs bias change: 0.002007119357585907
Number of bias changing > 0.1 of that: 457
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1028,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  974,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  980,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1032,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias7bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias8bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 35.65
Epoch 1, loss 1.63
Epoch 2, loss 1.05
Epoch 3, loss 0.99
Epoch 4, loss 0.76
Epoch 5, loss 0.75
Epoch 6, loss 0.62
Epoch 7, loss 0.58
Epoch 8, loss 0.45
Epoch 9, loss 0.52
**** Finished Training ****
Change in stitch weights: 0.7436900734901428
Largest abs weight change: 0.009159745648503304
Number of weights changing > 0.1 of that: 149292
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026679784059524536
Largest abs bias change: 0.002013225108385086
Number of bias changing > 0.1 of that: 463
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 892,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  958,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1028,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  974,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1009,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  980,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1135,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1032,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1010,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  982]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias8bias-offset5-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
target_offset=6
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 1268.52
Epoch 1, loss 377.29
Epoch 2, loss 286.79
Epoch 3, loss 244.00
Epoch 4, loss 217.55
Epoch 5, loss 197.20
Epoch 6, loss 185.63
Epoch 7, loss 174.65
Epoch 8, loss 165.96
Epoch 9, loss 157.53
**** Finished Training ****
Change in stitch weights: 2.144974708557129
Largest abs weight change: 0.15223315358161926
Number of weights changing > 0.1 of that: 2480
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.024884942919015884
Largest abs bias change: 0.005604833364486694
Number of bias changing > 0.1 of that: 58
Test the trained stitch against send_key='bw' data
Test Accuracy: 91.64 %
Confusion Matrix
tensor([[ 910,    4,    7,    6,    1,   28,    6,   11,    2,    7],
        [   0,  841,   11,    6,   17,    3,    2,    8,    2,    2],
        [  25,   16,  902,    2,    9,    0,    0,    1,    3,    0],
        [   2,    0,    7,  943,    2,   27,    3,    0,   14,   30],
        [   4,    6,   11,    6,  868,   17,    2,    6,   32,   22],
        [  19,   18,    0,   27,   18,  898,   13,    3,    5,    8],
        [   2,    3,   47,    4,    7,   10,  867,    9,   31,    0],
        [   1,    4,   11,    3,    0,    1,    0, 1111,    2,    2],
        [   4,    3,   19,   22,    8,   16,    8,    2,  933,   17],
        [   0,   28,    4,   17,   27,   16,    1,    4,   22,  891]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw3bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw4bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 652.15
Epoch 1, loss 187.16
Epoch 2, loss 139.03
Epoch 3, loss 115.98
Epoch 4, loss 101.91
Epoch 5, loss 90.50
Epoch 6, loss 83.31
Epoch 7, loss 77.71
Epoch 8, loss 72.67
Epoch 9, loss 69.38
**** Finished Training ****
Change in stitch weights: 1.7579047679901123
Largest abs weight change: 0.11075455695390701
Number of weights changing > 0.1 of that: 2740
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.025920411571860313
Largest abs bias change: 0.005413256585597992
Number of bias changing > 0.1 of that: 57
Test the trained stitch against send_key='bw' data
Test Accuracy: 96.32 %
Confusion Matrix
tensor([[ 950,    1,    0,    3,    0,   21,    0,    2,    2,    3],
        [   0,  874,    3,    2,    3,    1,    2,    0,    1,    6],
        [   6,   12,  924,    2,    6,    0,    4,    2,    2,    0],
        [   1,    1,    1,  976,    1,   15,    1,    2,   15,   15],
        [   4,    6,   11,    1,  915,    8,    5,    2,    7,   15],
        [  11,    9,    2,   11,   10,  957,    3,    2,    3,    1],
        [   3,    0,   10,    2,    3,    1,  955,    0,    6,    0],
        [   1,    1,    6,    2,    0,    0,    0, 1118,    2,    5],
        [   1,    0,    7,    6,    3,    0,   10,    2,  989,   14],
        [   0,   12,    0,    2,    9,    5,    0,    4,    4,  974]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw4bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw5bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 298.21
Epoch 1, loss 58.95
Epoch 2, loss 44.61
Epoch 3, loss 37.47
Epoch 4, loss 33.41
Epoch 5, loss 31.39
Epoch 6, loss 27.91
Epoch 7, loss 26.89
Epoch 8, loss 25.33
Epoch 9, loss 23.70
**** Finished Training ****
Change in stitch weights: 1.2742148637771606
Largest abs weight change: 0.05483973026275635
Number of weights changing > 0.1 of that: 8965
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.026708828285336494
Largest abs bias change: 0.003990955650806427
Number of bias changing > 0.1 of that: 116
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.55 %
Confusion Matrix
tensor([[ 970,    0,    0,    1,    0,   11,    0,    0,    0,    0],
        [   0,  881,    2,    1,    0,    1,    1,    0,    0,    6],
        [   2,    4,  944,    1,    1,    0,    3,    2,    1,    0],
        [   1,    0,    0, 1004,    1,   10,    0,    1,    8,    3],
        [   1,    2,    0,    1,  957,    4,    1,    0,    2,    6],
        [   4,    6,    0,    1,    4,  986,    3,    0,    3,    2],
        [   3,    2,    4,    1,    2,    0,  967,    0,    1,    0],
        [   2,    2,    1,    1,    1,    0,    0, 1123,    1,    4],
        [   0,    0,    3,    4,    0,    0,    2,    0, 1022,    1],
        [   0,    2,    0,    1,    2,    3,    0,    0,    1, 1001]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw5bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw6bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 108.13
Epoch 1, loss 24.32
Epoch 2, loss 19.57
Epoch 3, loss 17.41
Epoch 4, loss 16.25
Epoch 5, loss 15.04
Epoch 6, loss 13.91
Epoch 7, loss 14.06
Epoch 8, loss 13.18
Epoch 9, loss 13.27
**** Finished Training ****
Change in stitch weights: 0.8856205344200134
Largest abs weight change: 0.03055347315967083
Number of weights changing > 0.1 of that: 20757
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.025672152638435364
Largest abs bias change: 0.0028492584824562073
Number of bias changing > 0.1 of that: 232
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.10 %
Confusion Matrix
tensor([[ 977,    0,    0,    0,    1,    4,    0,    0,    0,    0],
        [   0,  879,    1,    0,    1,    2,    1,    0,    0,    8],
        [   1,    0,  951,    0,    0,    0,    3,    3,    0,    0],
        [   0,    1,    0, 1014,    1,    3,    0,    1,    5,    3],
        [   0,    1,    0,    1,  966,    1,    0,    0,    3,    2],
        [   6,    2,    0,    1,    2,  991,    2,    1,    2,    2],
        [   0,    1,    2,    1,    1,    0,  974,    0,    1,    0],
        [   0,    0,    2,    1,    0,    0,    0, 1129,    1,    2],
        [   1,    0,    1,    1,    0,    0,    2,    0, 1025,    2],
        [   0,    2,    0,    0,    2,    0,    0,    0,    2, 1004]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw6bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw7bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 69.77
Epoch 1, loss 15.18
Epoch 2, loss 12.66
Epoch 3, loss 11.97
Epoch 4, loss 11.30
Epoch 5, loss 10.95
Epoch 6, loss 10.17
Epoch 7, loss 10.00
Epoch 8, loss 9.73
Epoch 9, loss 9.82
**** Finished Training ****
Change in stitch weights: 0.8710424304008484
Largest abs weight change: 0.013203855603933334
Number of weights changing > 0.1 of that: 114001
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026675280183553696
Largest abs bias change: 0.0020096227526664734
Number of bias changing > 0.1 of that: 461
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.23 %
Confusion Matrix
tensor([[ 974,    0,    0,    1,    0,    6,    0,    0,    1,    0],
        [   0,  881,    1,    0,    1,    2,    2,    0,    0,    5],
        [   0,    2,  948,    0,    2,    0,    2,    4,    0,    0],
        [   0,    0,    0, 1020,    1,    2,    0,    3,    2,    0],
        [   0,    1,    0,    2,  965,    2,    2,    0,    2,    0],
        [   3,    1,    0,    2,    1, 1000,    0,    0,    0,    2],
        [   0,    0,    0,    1,    1,    1,  977,    0,    0,    0],
        [   0,    1,    1,    1,    0,    0,    0, 1129,    1,    2],
        [   1,    0,    0,    3,    0,    0,    2,    0, 1025,    1],
        [   0,    3,    0,    0,    1,    1,    1,    0,    0, 1004]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw7bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw8bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 61.68
Epoch 1, loss 15.14
Epoch 2, loss 12.65
Epoch 3, loss 11.51
Epoch 4, loss 11.06
Epoch 5, loss 10.33
Epoch 6, loss 10.16
Epoch 7, loss 9.79
Epoch 8, loss 9.35
Epoch 9, loss 9.40
**** Finished Training ****
Change in stitch weights: 0.8514611124992371
Largest abs weight change: 0.012564610689878464
Number of weights changing > 0.1 of that: 118540
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026699014008045197
Largest abs bias change: 0.0020166710019111633
Number of bias changing > 0.1 of that: 468
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.24 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    3,    0,    0,    0,    0],
        [   0,  878,    1,    0,    1,    5,    2,    0,    0,    5],
        [   1,    1,  949,    0,    1,    0,    2,    4,    0,    0],
        [   1,    0,    0, 1020,    1,    2,    0,    2,    2,    0],
        [   0,    1,    0,    2,  965,    2,    2,    0,    2,    0],
        [   5,    1,    0,    3,    1,  995,    1,    1,    0,    2],
        [   0,    0,    0,    1,    0,    0,  979,    0,    0,    0],
        [   0,    1,    1,    0,    0,    0,    0, 1130,    1,    2],
        [   1,    0,    0,    3,    0,    0,    0,    0, 1026,    2],
        [   0,    2,    0,    0,    2,    1,    1,    0,    1, 1003]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw8bw-offset6-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bgonly3bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 265.34
Epoch 1, loss 15.36
Epoch 2, loss 9.42
Epoch 3, loss 8.23
Epoch 4, loss 9.15
Epoch 5, loss 5.09
Epoch 6, loss 5.59
Epoch 7, loss 4.91
Epoch 8, loss 5.54
Epoch 9, loss 3.60
**** Finished Training ****
Change in stitch weights: 0.8582879900932312
Largest abs weight change: 0.052064619958400726
Number of weights changing > 0.1 of that: 2821
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.026988370344042778
Largest abs bias change: 0.005684077739715576
Number of bias changing > 0.1 of that: 59
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 982,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  958,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly3bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly4bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 3908.14
Epoch 1, loss 600.08
Epoch 2, loss 230.11
Epoch 3, loss 219.33
Epoch 4, loss 211.28
Epoch 5, loss 205.35
Epoch 6, loss 210.07
Epoch 7, loss 192.98
Epoch 8, loss 181.74
Epoch 9, loss 16.30
**** Finished Training ****
Change in stitch weights: 1.2887623310089111
Largest abs weight change: 0.11525209248065948
Number of weights changing > 0.1 of that: 2089
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.02540183812379837
Largest abs bias change: 0.005615845322608948
Number of bias changing > 0.1 of that: 56
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 982,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  958,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly4bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly5bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 229.19
Epoch 1, loss 8.86
Epoch 2, loss 6.92
Epoch 3, loss 4.68
Epoch 4, loss 4.30
Epoch 5, loss 3.15
Epoch 6, loss 3.96
Epoch 7, loss 2.68
Epoch 8, loss 3.34
Epoch 9, loss 2.87
**** Finished Training ****
Change in stitch weights: 0.800202488899231
Largest abs weight change: 0.033975906670093536
Number of weights changing > 0.1 of that: 8886
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.026366272941231728
Largest abs bias change: 0.004040680825710297
Number of bias changing > 0.1 of that: 111
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 982,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  958,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly5bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly6bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 155.74
Epoch 1, loss 3.57
Epoch 2, loss 2.75
Epoch 3, loss 2.65
Epoch 4, loss 1.57
Epoch 5, loss 1.43
Epoch 6, loss 1.93
Epoch 7, loss 1.63
Epoch 8, loss 1.05
Epoch 9, loss 1.20
**** Finished Training ****
Change in stitch weights: 0.7325903177261353
Largest abs weight change: 0.020421843975782394
Number of weights changing > 0.1 of that: 29852
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.025889746844768524
Largest abs bias change: 0.002855271100997925
Number of bias changing > 0.1 of that: 231
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 982,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  958,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly6bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly7bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 40.90
Epoch 1, loss 2.49
Epoch 2, loss 2.05
Epoch 3, loss 1.86
Epoch 4, loss 1.60
Epoch 5, loss 1.21
Epoch 6, loss 1.61
Epoch 7, loss 1.54
Epoch 8, loss 1.11
Epoch 9, loss 1.19
**** Finished Training ****
Change in stitch weights: 0.7671257257461548
Largest abs weight change: 0.01222885213792324
Number of weights changing > 0.1 of that: 115399
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.025705037638545036
Largest abs bias change: 0.0020148009061813354
Number of bias changing > 0.1 of that: 455
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 982,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  958,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly7bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly8bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 28.85
Epoch 1, loss 2.63
Epoch 2, loss 2.03
Epoch 3, loss 1.26
Epoch 4, loss 1.47
Epoch 5, loss 1.29
Epoch 6, loss 1.42
Epoch 7, loss 1.00
Epoch 8, loss 0.81
Epoch 9, loss 0.86
**** Finished Training ****
Change in stitch weights: 0.7370631098747253
Largest abs weight change: 0.009692870080471039
Number of weights changing > 0.1 of that: 143044
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026765096932649612
Largest abs bias change: 0.0020181946456432343
Number of bias changing > 0.1 of that: 467
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 982,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  958,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly8bgonly-offset6-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bias3bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 3716.45
Epoch 1, loss 223.30
Epoch 2, loss 17.62
Epoch 3, loss 13.66
Epoch 4, loss 14.49
Epoch 5, loss 12.29
Epoch 6, loss 7.57
Epoch 7, loss 8.16
Epoch 8, loss 6.31
Epoch 9, loss 7.93
**** Finished Training ****
Change in stitch weights: 1.445353627204895
Largest abs weight change: 0.1081438735127449
Number of weights changing > 0.1 of that: 2382
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.025949351489543915
Largest abs bias change: 0.0053921714425086975
Number of bias changing > 0.1 of that: 58
Test the trained stitch against send_key='bias' data
Test Accuracy: 99.96 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    2,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  956,    0,    0,    1,    0,    0,    1,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias3bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias4bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 347.83
Epoch 1, loss 18.59
Epoch 2, loss 17.71
Epoch 3, loss 9.11
Epoch 4, loss 9.20
Epoch 5, loss 10.04
Epoch 6, loss 7.64
Epoch 7, loss 4.94
Epoch 8, loss 4.18
Epoch 9, loss 5.54
**** Finished Training ****
Change in stitch weights: 0.9182432293891907
Largest abs weight change: 0.07776781916618347
Number of weights changing > 0.1 of that: 2188
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.02874823845922947
Largest abs bias change: 0.005658477544784546
Number of bias changing > 0.1 of that: 59
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 982,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  958,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias4bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias5bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 2965.43
Epoch 1, loss 771.28
Epoch 2, loss 18.20
Epoch 3, loss 9.40
Epoch 4, loss 7.88
Epoch 5, loss 10.19
Epoch 6, loss 4.84
Epoch 7, loss 3.39
Epoch 8, loss 4.45
Epoch 9, loss 4.25
**** Finished Training ****
Change in stitch weights: 1.4422072172164917
Largest abs weight change: 0.07555146515369415
Number of weights changing > 0.1 of that: 6955
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.027127642184495926
Largest abs bias change: 0.0040014758706092834
Number of bias changing > 0.1 of that: 113
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 982,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  958,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias5bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias6bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 351.92
Epoch 1, loss 7.37
Epoch 2, loss 4.59
Epoch 3, loss 2.89
Epoch 4, loss 2.27
Epoch 5, loss 2.26
Epoch 6, loss 2.03
Epoch 7, loss 1.46
Epoch 8, loss 1.26
Epoch 9, loss 2.64
**** Finished Training ****
Change in stitch weights: 0.9693204760551453
Largest abs weight change: 0.031842559576034546
Number of weights changing > 0.1 of that: 21296
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.02633487805724144
Largest abs bias change: 0.0028571560978889465
Number of bias changing > 0.1 of that: 237
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 982,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  958,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias6bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias7bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 36.22
Epoch 1, loss 1.58
Epoch 2, loss 1.21
Epoch 3, loss 0.80
Epoch 4, loss 0.71
Epoch 5, loss 0.76
Epoch 6, loss 0.58
Epoch 7, loss 0.69
Epoch 8, loss 0.49
Epoch 9, loss 0.74
**** Finished Training ****
Change in stitch weights: 0.7423255443572998
Largest abs weight change: 0.011906128376722336
Number of weights changing > 0.1 of that: 116884
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.025527097284793854
Largest abs bias change: 0.0020197294652462006
Number of bias changing > 0.1 of that: 463
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 982,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  958,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias7bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias8bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 21.15
Epoch 1, loss 1.44
Epoch 2, loss 0.94
Epoch 3, loss 0.99
Epoch 4, loss 0.67
Epoch 5, loss 0.64
Epoch 6, loss 0.58
Epoch 7, loss 0.56
Epoch 8, loss 0.65
Epoch 9, loss 0.68
**** Finished Training ****
Change in stitch weights: 0.701166570186615
Largest abs weight change: 0.00946751981973648
Number of weights changing > 0.1 of that: 143300
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026723116636276245
Largest abs bias change: 0.002017006278038025
Number of bias changing > 0.1 of that: 469
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 982,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  892,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  958,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1028,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1009,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  980,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1135,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1032,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1010]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias8bias-offset6-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
target_offset=7
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 1453.87
Epoch 1, loss 405.66
Epoch 2, loss 312.00
Epoch 3, loss 266.09
Epoch 4, loss 233.64
Epoch 5, loss 214.80
Epoch 6, loss 199.30
Epoch 7, loss 188.05
Epoch 8, loss 176.71
Epoch 9, loss 169.53
**** Finished Training ****
Change in stitch weights: 2.0515685081481934
Largest abs weight change: 0.14248749613761902
Number of weights changing > 0.1 of that: 2600
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.026950212195515633
Largest abs bias change: 0.005603298544883728
Number of bias changing > 0.1 of that: 58
Test the trained stitch against send_key='bw' data
Test Accuracy: 89.94 %
Confusion Matrix
tensor([[ 905,    2,   31,    4,   11,   14,    5,    4,   21,   13],
        [   0,  933,    8,    9,    1,   12,   11,    2,    5,    1],
        [  27,    4,  797,   37,    3,    3,    2,    5,   11,    3],
        [   0,   21,    7,  891,    1,    5,    0,   32,    1,    0],
        [   3,    8,    6,    0,  940,   25,   12,    2,   22,   10],
        [   6,   16,    7,   58,    9,  841,    6,    3,   10,   18],
        [   5,   34,   31,    4,   36,   85,  780,    7,   27,    0],
        [   0,    6,    3,   17,    8,    8,    2,  929,    0,    7],
        [   2,    5,    4,   10,    0,    4,    0,    0, 1109,    1],
        [   5,    2,    0,   36,   32,   70,    1,   13,    4,  869]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw3bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw4bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 1045.98
Epoch 1, loss 180.07
Epoch 2, loss 137.85
Epoch 3, loss 117.19
Epoch 4, loss 102.87
Epoch 5, loss 92.98
Epoch 6, loss 86.52
Epoch 7, loss 81.27
Epoch 8, loss 76.48
Epoch 9, loss 71.63
**** Finished Training ****
Change in stitch weights: 1.7538431882858276
Largest abs weight change: 0.11471472680568695
Number of weights changing > 0.1 of that: 2763
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.027294447645545006
Largest abs bias change: 0.0056244730949401855
Number of bias changing > 0.1 of that: 60
Test the trained stitch against send_key='bw' data
Test Accuracy: 96.32 %
Confusion Matrix
tensor([[ 977,    0,   13,    0,    7,    4,    2,    0,    0,    7],
        [   0,  952,    3,    6,    1,    2,   10,    2,    3,    3],
        [  12,    0,  858,    9,    1,    0,    3,    5,    3,    1],
        [   0,    5,    4,  930,    0,    1,    0,   13,    3,    2],
        [   6,    4,    4,    0,  977,    1,    2,    1,   13,   20],
        [   5,    8,    3,   15,    3,  926,    7,    5,    1,    1],
        [   7,   15,   13,    2,   10,    5,  940,    6,   10,    1],
        [   1,    1,    5,    4,    1,    3,    0,  962,    1,    2],
        [   3,    0,    2,    1,    1,    1,    0,    2, 1122,    3],
        [   3,    0,    1,    3,   25,    3,    0,    5,    4,  988]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw4bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw5bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 321.81
Epoch 1, loss 54.37
Epoch 2, loss 42.57
Epoch 3, loss 35.91
Epoch 4, loss 32.49
Epoch 5, loss 29.50
Epoch 6, loss 27.70
Epoch 7, loss 25.56
Epoch 8, loss 24.78
Epoch 9, loss 23.55
**** Finished Training ****
Change in stitch weights: 1.238931655883789
Largest abs weight change: 0.056679870933294296
Number of weights changing > 0.1 of that: 8573
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.025805428624153137
Largest abs bias change: 0.0039953142404556274
Number of bias changing > 0.1 of that: 111
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.67 %
Confusion Matrix
tensor([[1002,    0,    3,    0,    0,    3,    0,    1,    0,    1],
        [   0,  970,    0,    1,    1,    3,    6,    0,    0,    1],
        [   7,    1,  874,    3,    1,    0,    4,    2,    0,    0],
        [   0,    2,    1,  942,    0,    5,    0,    3,    4,    1],
        [   1,    1,    1,    0, 1008,    1,    2,    1,    3,   10],
        [   2,    1,    0,    1,    3,  961,    2,    1,    0,    3],
        [   1,    1,    0,    0,    4,    4,  994,    4,    1,    0],
        [   0,    0,    1,    1,    2,    3,    0,  972,    0,    1],
        [   1,    0,    2,    1,    2,    2,    0,    0, 1126,    1],
        [   0,    2,    0,    0,    6,    4,    0,    1,    1, 1018]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw5bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw6bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 135.39
Epoch 1, loss 29.39
Epoch 2, loss 23.27
Epoch 3, loss 20.96
Epoch 4, loss 18.27
Epoch 5, loss 17.30
Epoch 6, loss 16.01
Epoch 7, loss 15.23
Epoch 8, loss 14.59
Epoch 9, loss 14.03
**** Finished Training ****
Change in stitch weights: 0.9585614800453186
Largest abs weight change: 0.044299542903900146
Number of weights changing > 0.1 of that: 12023
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.027483999729156494
Largest abs bias change: 0.002835966646671295
Number of bias changing > 0.1 of that: 235
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.94 %
Confusion Matrix
tensor([[1004,    0,    3,    0,    0,    1,    0,    1,    0,    1],
        [   0,  978,    0,    0,    0,    0,    4,    0,    0,    0],
        [   5,    0,  879,    0,    0,    2,    4,    2,    0,    0],
        [   0,    3,    3,  942,    0,    3,    0,    4,    3,    0],
        [   2,    1,    0,    0, 1017,    0,    2,    0,    2,    4],
        [   4,    0,    1,    0,    0,  967,    1,    0,    0,    1],
        [   1,    7,    9,    0,    6,    2,  981,    1,    1,    1],
        [   0,    0,    2,    0,    1,    0,    0,  975,    0,    2],
        [   2,    1,    2,    1,    0,    0,    0,    0, 1128,    1],
        [   3,    1,    0,    0,    3,    0,    0,    2,    0, 1023]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw6bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw7bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 61.34
Epoch 1, loss 15.79
Epoch 2, loss 12.94
Epoch 3, loss 12.13
Epoch 4, loss 11.30
Epoch 5, loss 10.83
Epoch 6, loss 10.33
Epoch 7, loss 10.03
Epoch 8, loss 10.03
Epoch 9, loss 9.88
**** Finished Training ****
Change in stitch weights: 0.8631353378295898
Largest abs weight change: 0.01673864759504795
Number of weights changing > 0.1 of that: 78422
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026582585647702217
Largest abs bias change: 0.002012506127357483
Number of bias changing > 0.1 of that: 469
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.27 %
Confusion Matrix
tensor([[1003,    0,    3,    0,    0,    1,    1,    1,    0,    1],
        [   0,  977,    0,    0,    0,    0,    5,    0,    0,    0],
        [   4,    0,  880,    1,    0,    1,    4,    2,    0,    0],
        [   0,    1,    1,  949,    0,    1,    0,    2,    4,    0],
        [   0,    1,    0,    0, 1020,    1,    2,    0,    2,    2],
        [   0,    0,    1,    0,    2,  965,    2,    3,    0,    1],
        [   1,    3,    0,    0,    4,    2,  998,    0,    1,    0],
        [   0,    0,    0,    0,    1,    0,    0,  979,    0,    0],
        [   2,    0,    1,    1,    1,    0,    0,    0, 1129,    1],
        [   1,    1,    0,    0,    3,    0,    0,    0,    0, 1027]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw7bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw8bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 76.74
Epoch 1, loss 15.02
Epoch 2, loss 12.66
Epoch 3, loss 11.80
Epoch 4, loss 11.11
Epoch 5, loss 10.65
Epoch 6, loss 10.20
Epoch 7, loss 10.30
Epoch 8, loss 9.79
Epoch 9, loss 9.57
**** Finished Training ****
Change in stitch weights: 0.8956529498100281
Largest abs weight change: 0.015478961169719696
Number of weights changing > 0.1 of that: 94115
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026187215000391006
Largest abs bias change: 0.002012159675359726
Number of bias changing > 0.1 of that: 465
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.16 %
Confusion Matrix
tensor([[1002,    0,    4,    0,    0,    1,    1,    0,    0,    2],
        [   0,  978,    0,    0,    0,    0,    4,    0,    0,    0],
        [   4,    0,  882,    1,    0,    1,    2,    2,    0,    0],
        [   0,    2,    2,  947,    0,    2,    0,    2,    3,    0],
        [   0,    1,    0,    0, 1018,    1,    2,    0,    3,    3],
        [   0,    0,    1,    0,    2,  966,    2,    2,    0,    1],
        [   2,    3,    4,    0,    5,    2,  991,    1,    1,    0],
        [   0,    0,    0,    0,    1,    0,    0,  979,    0,    0],
        [   2,    0,    1,    2,    2,    0,    0,    0, 1127,    1],
        [   2,    1,    0,    0,    3,    0,    0,    0,    0, 1026]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw8bw-offset7-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bgonly3bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 1253.98
Epoch 1, loss 322.80
Epoch 2, loss 254.42
Epoch 3, loss 235.90
Epoch 4, loss 219.81
Epoch 5, loss 211.74
Epoch 6, loss 201.81
Epoch 7, loss 199.75
Epoch 8, loss 194.97
Epoch 9, loss 190.42
**** Finished Training ****
Change in stitch weights: 1.3553364276885986
Largest abs weight change: 0.09704132378101349
Number of weights changing > 0.1 of that: 2573
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.028230926021933556
Largest abs bias change: 0.005639351904392242
Number of bias changing > 0.1 of that: 57
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 90.26 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  144,    0,  830,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1032]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly3bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly4bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 1020.03
Epoch 1, loss 216.75
Epoch 2, loss 198.46
Epoch 3, loss 186.09
Epoch 4, loss 178.54
Epoch 5, loss 173.98
Epoch 6, loss 167.19
Epoch 7, loss 162.62
Epoch 8, loss 159.23
Epoch 9, loss 155.38
**** Finished Training ****
Change in stitch weights: 0.9954884052276611
Largest abs weight change: 0.0787794440984726
Number of weights changing > 0.1 of that: 2342
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.024090593680739403
Largest abs bias change: 0.005616962909698486
Number of bias changing > 0.1 of that: 55
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 90.26 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  960,    0,    0,   14,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1032]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly4bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly5bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 269.46
Epoch 1, loss 139.90
Epoch 2, loss 43.91
Epoch 3, loss 3.23
Epoch 4, loss 2.98
Epoch 5, loss 2.97
Epoch 6, loss 2.17
Epoch 7, loss 1.95
Epoch 8, loss 2.82
Epoch 9, loss 2.25
**** Finished Training ****
Change in stitch weights: 0.8282658457756042
Largest abs weight change: 0.03421003371477127
Number of weights changing > 0.1 of that: 9188
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.025878073647618294
Largest abs bias change: 0.003984607756137848
Number of bias changing > 0.1 of that: 117
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  974,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1032]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly5bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly6bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 56.83
Epoch 1, loss 2.93
Epoch 2, loss 2.48
Epoch 3, loss 3.19
Epoch 4, loss 1.70
Epoch 5, loss 1.65
Epoch 6, loss 2.61
Epoch 7, loss 1.59
Epoch 8, loss 2.08
Epoch 9, loss 1.52
**** Finished Training ****
Change in stitch weights: 0.7101467847824097
Largest abs weight change: 0.017640428617596626
Number of weights changing > 0.1 of that: 33255
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.027039796113967896
Largest abs bias change: 0.002846907824277878
Number of bias changing > 0.1 of that: 229
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  974,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1032]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly6bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly7bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 43.51
Epoch 1, loss 2.65
Epoch 2, loss 1.73
Epoch 3, loss 2.01
Epoch 4, loss 1.24
Epoch 5, loss 1.47
Epoch 6, loss 1.35
Epoch 7, loss 1.38
Epoch 8, loss 1.14
Epoch 9, loss 0.99
**** Finished Training ****
Change in stitch weights: 0.7768582701683044
Largest abs weight change: 0.013219006359577179
Number of weights changing > 0.1 of that: 106058
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.025693057104945183
Largest abs bias change: 0.002019215375185013
Number of bias changing > 0.1 of that: 460
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  974,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1032]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly7bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly8bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 45.42
Epoch 1, loss 2.42
Epoch 2, loss 1.92
Epoch 3, loss 1.42
Epoch 4, loss 1.20
Epoch 5, loss 1.19
Epoch 6, loss 1.22
Epoch 7, loss 1.38
Epoch 8, loss 0.99
Epoch 9, loss 0.89
**** Finished Training ****
Change in stitch weights: 0.7745488286018372
Largest abs weight change: 0.010941377840936184
Number of weights changing > 0.1 of that: 130881
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02663549780845642
Largest abs bias change: 0.0020192377269268036
Number of bias changing > 0.1 of that: 457
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  974,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1032]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly8bgonly-offset7-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bias3bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 2783.87
Epoch 1, loss 1810.12
Epoch 2, loss 502.59
Epoch 3, loss 24.05
Epoch 4, loss 14.54
Epoch 5, loss 11.14
Epoch 6, loss 8.45
Epoch 7, loss 7.46
Epoch 8, loss 7.54
Epoch 9, loss 5.97
**** Finished Training ****
Change in stitch weights: 1.6224783658981323
Largest abs weight change: 0.09896356612443924
Number of weights changing > 0.1 of that: 2769
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.02806580439209938
Largest abs bias change: 0.005651995539665222
Number of bias changing > 0.1 of that: 57
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  974,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1032]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias3bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias4bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 5095.11
Epoch 1, loss 45.00
Epoch 2, loss 21.55
Epoch 3, loss 18.59
Epoch 4, loss 14.28
Epoch 5, loss 11.27
Epoch 6, loss 10.48
Epoch 7, loss 8.86
Epoch 8, loss 8.29
Epoch 9, loss 10.35
**** Finished Training ****
Change in stitch weights: 1.6055338382720947
Largest abs weight change: 0.16995325684547424
Number of weights changing > 0.1 of that: 1647
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.024268222972750664
Largest abs bias change: 0.005670927464962006
Number of bias changing > 0.1 of that: 55
Test the trained stitch against send_key='bias' data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  974,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    2,    0,    0,    0, 1030]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias4bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias5bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 183.55
Epoch 1, loss 9.13
Epoch 2, loss 5.65
Epoch 3, loss 6.28
Epoch 4, loss 6.08
Epoch 5, loss 3.21
Epoch 6, loss 3.00
Epoch 7, loss 3.67
Epoch 8, loss 2.33
Epoch 9, loss 2.75
**** Finished Training ****
Change in stitch weights: 0.7821893095970154
Largest abs weight change: 0.034162990748882294
Number of weights changing > 0.1 of that: 8549
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.02604077383875847
Largest abs bias change: 0.004029184579849243
Number of bias changing > 0.1 of that: 118
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  974,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1032]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias5bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias6bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 132.36
Epoch 1, loss 7.57
Epoch 2, loss 3.37
Epoch 3, loss 2.66
Epoch 4, loss 1.96
Epoch 5, loss 2.75
Epoch 6, loss 2.30
Epoch 7, loss 2.42
Epoch 8, loss 1.81
Epoch 9, loss 1.86
**** Finished Training ****
Change in stitch weights: 0.9358186721801758
Largest abs weight change: 0.03170360252261162
Number of weights changing > 0.1 of that: 19449
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.025787394493818283
Largest abs bias change: 0.00282890722155571
Number of bias changing > 0.1 of that: 224
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  974,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1032]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias6bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias7bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 26.24
Epoch 1, loss 1.68
Epoch 2, loss 1.22
Epoch 3, loss 1.07
Epoch 4, loss 0.66
Epoch 5, loss 0.67
Epoch 6, loss 0.56
Epoch 7, loss 0.53
Epoch 8, loss 0.49
Epoch 9, loss 0.58
**** Finished Training ****
Change in stitch weights: 0.7173226475715637
Largest abs weight change: 0.009422952309250832
Number of weights changing > 0.1 of that: 144837
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02708226628601551
Largest abs bias change: 0.0020195655524730682
Number of bias changing > 0.1 of that: 463
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  974,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1032]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias7bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias8bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 29.32
Epoch 1, loss 1.35
Epoch 2, loss 0.92
Epoch 3, loss 1.07
Epoch 4, loss 0.77
Epoch 5, loss 0.79
Epoch 6, loss 0.67
Epoch 7, loss 0.61
Epoch 8, loss 0.48
Epoch 9, loss 0.52
**** Finished Training ****
Change in stitch weights: 0.7315652370452881
Largest abs weight change: 0.009088123217225075
Number of weights changing > 0.1 of that: 149834
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.025760365650057793
Largest abs bias change: 0.0020188838243484497
Number of bias changing > 0.1 of that: 458
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1010,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,  982,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  892,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  958,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1028,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  974,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1009,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1135,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1032]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias8bias-offset7-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
target_offset=8
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 1901.49
Epoch 1, loss 585.09
Epoch 2, loss 401.41
Epoch 3, loss 329.08
Epoch 4, loss 291.96
Epoch 5, loss 261.41
Epoch 6, loss 242.17
Epoch 7, loss 223.72
Epoch 8, loss 210.33
Epoch 9, loss 197.99
**** Finished Training ****
Change in stitch weights: 2.2626216411590576
Largest abs weight change: 0.174186572432518
Number of weights changing > 0.1 of that: 2417
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.029948033392429352
Largest abs bias change: 0.005704179406166077
Number of bias changing > 0.1 of that: 59
Test the trained stitch against send_key='bw' data
Test Accuracy: 89.84 %
Confusion Matrix
tensor([[ 872,   19,   26,    6,    3,   64,   17,    5,   15,    5],
        [   2,  928,    6,   23,    0,   21,   12,    7,    7,    4],
        [   1,    1,  923,    9,   11,    0,    6,   20,    8,    3],
        [   0,   18,    4,  807,    3,   17,    1,   14,   14,   14],
        [   0,    1,   41,    9,  839,    0,    1,    9,   50,    8],
        [  11,   23,   13,    7,    0,  919,    8,   28,   12,    7],
        [  22,   16,   52,    2,   21,    6,  782,   13,   57,    3],
        [   1,    8,   37,   19,   10,   30,   10,  879,   13,    2],
        [   0,    0,    7,    7,    7,   16,    2,    2,  939,    0],
        [   2,    3,    2,    7,    9,    5,    0,    1,   10, 1096]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw3bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw4bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 984.12
Epoch 1, loss 260.90
Epoch 2, loss 178.94
Epoch 3, loss 145.08
Epoch 4, loss 124.17
Epoch 5, loss 110.70
Epoch 6, loss 101.91
Epoch 7, loss 93.12
Epoch 8, loss 87.39
Epoch 9, loss 81.96
**** Finished Training ****
Change in stitch weights: 1.9048575162887573
Largest abs weight change: 0.13275189697742462
Number of weights changing > 0.1 of that: 2668
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.0267887394875288
Largest abs bias change: 0.00567144900560379
Number of bias changing > 0.1 of that: 56
Test the trained stitch against send_key='bw' data
Test Accuracy: 95.67 %
Confusion Matrix
tensor([[ 982,    6,    8,    2,    1,   21,    4,    0,    6,    2],
        [   1,  989,    0,    7,    0,    7,    2,    0,    4,    0],
        [   1,    2,  944,    1,    8,    0,    4,   18,    2,    2],
        [   0,   18,    2,  853,    1,    1,    0,    5,    9,    3],
        [   1,    3,   10,    6,  913,    0,    0,    0,   19,    6],
        [  24,    9,    2,    1,    0,  962,    6,    8,    5,   11],
        [   4,    8,   13,    4,    6,   30,  894,    8,    7,    0],
        [   0,   12,   10,    7,    1,   16,    3,  951,    5,    4],
        [   0,    1,    0,    8,    2,    8,    1,    0,  960,    0],
        [   6,    2,    2,    2,    1,    1,    1,    0,    1, 1119]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw4bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw5bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 333.54
Epoch 1, loss 71.26
Epoch 2, loss 53.91
Epoch 3, loss 44.87
Epoch 4, loss 39.39
Epoch 5, loss 35.49
Epoch 6, loss 33.09
Epoch 7, loss 30.91
Epoch 8, loss 29.50
Epoch 9, loss 27.87
**** Finished Training ****
Change in stitch weights: 1.337931513786316
Largest abs weight change: 0.05805392563343048
Number of weights changing > 0.1 of that: 9152
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.025727268308401108
Largest abs bias change: 0.004023507237434387
Number of bias changing > 0.1 of that: 113
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.44 %
Confusion Matrix
tensor([[1018,    2,    0,    0,    2,    4,    6,    0,    0,    0],
        [   1, 1001,    0,    2,    0,    2,    2,    0,    1,    1],
        [   4,    0,  965,    1,    1,    1,    0,   10,    0,    0],
        [   0,    6,    0,  877,    0,    2,    1,    2,    3,    1],
        [   0,    2,    2,    1,  938,    0,    4,    0,    9,    2],
        [  11,    3,    1,    2,    0, 1004,    1,    6,    0,    0],
        [   4,    0,    2,    0,    1,    2,  961,    2,    2,    0],
        [   0,    3,    6,    7,    0,    6,    3,  983,    1,    0],
        [   0,    0,    0,    0,    0,    3,    2,    0,  975,    0],
        [   1,    2,    1,    0,    2,    6,    1,    0,    0, 1122]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw5bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw6bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 180.90
Epoch 1, loss 30.77
Epoch 2, loss 24.84
Epoch 3, loss 20.94
Epoch 4, loss 18.84
Epoch 5, loss 17.65
Epoch 6, loss 16.18
Epoch 7, loss 15.23
Epoch 8, loss 15.47
Epoch 9, loss 14.31
**** Finished Training ****
Change in stitch weights: 1.0081185102462769
Largest abs weight change: 0.030079012736678123
Number of weights changing > 0.1 of that: 24969
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.02692769654095173
Largest abs bias change: 0.0028441324830055237
Number of bias changing > 0.1 of that: 239
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.03 %
Confusion Matrix
tensor([[1023,    3,    2,    0,    0,    3,    0,    0,    1,    0],
        [   0, 1006,    0,    0,    0,    1,    1,    1,    1,    0],
        [   1,    0,  975,    0,    0,    0,    0,    6,    0,    0],
        [   0,    5,    0,  882,    1,    0,    1,    1,    2,    0],
        [   0,    0,    2,    3,  945,    0,    3,    0,    1,    4],
        [   8,    2,    3,    0,    0, 1010,    0,    3,    0,    2],
        [   2,    2,    0,    1,    0,    2,  964,    1,    2,    0],
        [   0,    0,    6,    7,    0,    1,    3,  991,    1,    0],
        [   0,    0,    0,    0,    0,    1,    0,    0,  979,    0],
        [   1,    2,    0,    1,    1,    2,    0,    0,    0, 1128]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw6bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw7bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 69.78
Epoch 1, loss 15.62
Epoch 2, loss 13.26
Epoch 3, loss 12.50
Epoch 4, loss 11.10
Epoch 5, loss 10.63
Epoch 6, loss 10.48
Epoch 7, loss 10.12
Epoch 8, loss 10.05
Epoch 9, loss 9.66
**** Finished Training ****
Change in stitch weights: 0.8699386715888977
Largest abs weight change: 0.0113017987459898
Number of weights changing > 0.1 of that: 133636
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026180462911725044
Largest abs bias change: 0.002010513097047806
Number of bias changing > 0.1 of that: 465
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.26 %
Confusion Matrix
tensor([[1025,    2,    1,    0,    0,    3,    0,    0,    1,    0],
        [   0, 1007,    0,    2,    0,    0,    1,    0,    0,    0],
        [   0,    0,  979,    0,    0,    0,    0,    3,    0,    0],
        [   0,    4,    0,  880,    1,    0,    1,    4,    2,    0],
        [   1,    0,    2,    3,  945,    0,    2,    0,    2,    3],
        [   3,    0,    0,    1,    0, 1019,    1,    2,    0,    2],
        [   1,    0,    0,    1,    0,    2,  967,    2,    1,    0],
        [   0,    1,    5,    2,    0,    2,    2,  997,    0,    0],
        [   0,    0,    0,    0,    0,    1,    1,    0,  978,    0],
        [   1,    2,    0,    1,    1,    1,    0,    0,    0, 1129]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw7bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw8bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 77.34
Epoch 1, loss 16.20
Epoch 2, loss 13.35
Epoch 3, loss 12.29
Epoch 4, loss 11.36
Epoch 5, loss 10.88
Epoch 6, loss 10.46
Epoch 7, loss 9.95
Epoch 8, loss 9.72
Epoch 9, loss 9.73
**** Finished Training ****
Change in stitch weights: 0.9076259732246399
Largest abs weight change: 0.016437359154224396
Number of weights changing > 0.1 of that: 85764
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026272045448422432
Largest abs bias change: 0.00201474130153656
Number of bias changing > 0.1 of that: 467
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.18 %
Confusion Matrix
tensor([[1024,    2,    1,    0,    0,    3,    1,    0,    0,    1],
        [   0, 1001,    0,    5,    0,    0,    2,    1,    1,    0],
        [   0,    0,  977,    0,    0,    0,    0,    5,    0,    0],
        [   0,    4,    0,  879,    1,    0,    1,    5,    2,    0],
        [   0,    0,    2,    1,  948,    0,    1,    0,    2,    4],
        [   1,    1,    1,    0,    0, 1019,    1,    2,    0,    3],
        [   1,    0,    0,    1,    0,    2,  965,    2,    3,    0],
        [   0,    1,    4,    2,    0,    0,    4,  997,    1,    0],
        [   0,    0,    0,    0,    0,    1,    0,    1,  978,    0],
        [   0,    2,    0,    1,    1,    1,    0,    0,    0, 1130]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw8bw-offset8-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bgonly3bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 608.59
Epoch 1, loss 20.24
Epoch 2, loss 17.65
Epoch 3, loss 11.25
Epoch 4, loss 9.97
Epoch 5, loss 7.33
Epoch 6, loss 6.33
Epoch 7, loss 6.45
Epoch 8, loss 5.22
Epoch 9, loss 6.27
**** Finished Training ****
Change in stitch weights: 0.9696077108383179
Largest abs weight change: 0.10591162741184235
Number of weights changing > 0.1 of that: 1777
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.026779508218169212
Largest abs bias change: 0.005667500197887421
Number of bias changing > 0.1 of that: 55
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1028,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly3bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly4bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 2414.89
Epoch 1, loss 494.86
Epoch 2, loss 225.11
Epoch 3, loss 209.69
Epoch 4, loss 202.62
Epoch 5, loss 192.20
Epoch 6, loss 189.71
Epoch 7, loss 185.48
Epoch 8, loss 181.49
Epoch 9, loss 178.95
**** Finished Training ****
Change in stitch weights: 1.2215070724487305
Largest abs weight change: 0.09134211391210556
Number of weights changing > 0.1 of that: 2469
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.026259029284119606
Largest abs bias change: 0.005716584622859955
Number of bias changing > 0.1 of that: 56
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 89.72 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  944,    0,   84,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly4bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly5bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 402.66
Epoch 1, loss 57.98
Epoch 2, loss 4.29
Epoch 3, loss 4.57
Epoch 4, loss 2.69
Epoch 5, loss 2.21
Epoch 6, loss 2.73
Epoch 7, loss 3.49
Epoch 8, loss 1.61
Epoch 9, loss 1.23
**** Finished Training ****
Change in stitch weights: 0.7449358701705933
Largest abs weight change: 0.04181721433997154
Number of weights changing > 0.1 of that: 7210
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.025726715102791786
Largest abs bias change: 0.003976635634899139
Number of bias changing > 0.1 of that: 115
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1028,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly5bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly6bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 166.02
Epoch 1, loss 4.76
Epoch 2, loss 3.76
Epoch 3, loss 2.25
Epoch 4, loss 2.21
Epoch 5, loss 2.01
Epoch 6, loss 1.78
Epoch 7, loss 1.36
Epoch 8, loss 1.15
Epoch 9, loss 1.73
**** Finished Training ****
Change in stitch weights: 0.831426739692688
Largest abs weight change: 0.024398356676101685
Number of weights changing > 0.1 of that: 27312
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.027018235996365547
Largest abs bias change: 0.0028462670743465424
Number of bias changing > 0.1 of that: 230
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1028,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly6bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly7bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 33.96
Epoch 1, loss 2.09
Epoch 2, loss 2.01
Epoch 3, loss 1.40
Epoch 4, loss 1.57
Epoch 5, loss 1.24
Epoch 6, loss 1.29
Epoch 7, loss 0.95
Epoch 8, loss 0.99
Epoch 9, loss 0.97
**** Finished Training ****
Change in stitch weights: 0.7454412579536438
Largest abs weight change: 0.01083480753004551
Number of weights changing > 0.1 of that: 129583
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026480410248041153
Largest abs bias change: 0.002020902931690216
Number of bias changing > 0.1 of that: 465
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1028,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly7bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly8bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 43.65
Epoch 1, loss 2.22
Epoch 2, loss 1.67
Epoch 3, loss 1.26
Epoch 4, loss 1.52
Epoch 5, loss 1.23
Epoch 6, loss 1.05
Epoch 7, loss 1.12
Epoch 8, loss 1.08
Epoch 9, loss 1.06
**** Finished Training ****
Change in stitch weights: 0.7751030325889587
Largest abs weight change: 0.014383072964847088
Number of weights changing > 0.1 of that: 93192
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02561461739242077
Largest abs bias change: 0.002020515501499176
Number of bias changing > 0.1 of that: 458
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1028,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly8bgonly-offset8-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bias3bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 372.57
Epoch 1, loss 24.99
Epoch 2, loss 14.54
Epoch 3, loss 11.01
Epoch 4, loss 9.12
Epoch 5, loss 7.36
Epoch 6, loss 6.94
Epoch 7, loss 5.26
Epoch 8, loss 5.03
Epoch 9, loss 4.39
**** Finished Training ****
Change in stitch weights: 0.8706440925598145
Largest abs weight change: 0.06288021057844162
Number of weights changing > 0.1 of that: 2535
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.026628747582435608
Largest abs bias change: 0.005687296390533447
Number of bias changing > 0.1 of that: 61
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1028,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias3bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias4bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 167.49
Epoch 1, loss 16.83
Epoch 2, loss 14.65
Epoch 3, loss 8.42
Epoch 4, loss 7.63
Epoch 5, loss 5.81
Epoch 6, loss 6.71
Epoch 7, loss 5.16
Epoch 8, loss 4.75
Epoch 9, loss 3.38
**** Finished Training ****
Change in stitch weights: 0.8289607167243958
Largest abs weight change: 0.06390959024429321
Number of weights changing > 0.1 of that: 2317
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.025365125387907028
Largest abs bias change: 0.005660153925418854
Number of bias changing > 0.1 of that: 56
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1028,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias4bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias5bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 366.30
Epoch 1, loss 12.95
Epoch 2, loss 9.39
Epoch 3, loss 6.14
Epoch 4, loss 4.37
Epoch 5, loss 3.64
Epoch 6, loss 3.59
Epoch 7, loss 3.85
Epoch 8, loss 8.21
Epoch 9, loss 2.59
**** Finished Training ****
Change in stitch weights: 1.0127915143966675
Largest abs weight change: 0.05420123040676117
Number of weights changing > 0.1 of that: 6978
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.0266218651086092
Largest abs bias change: 0.003955669701099396
Number of bias changing > 0.1 of that: 117
Test the trained stitch against send_key='bias' data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1027,    0,    0,    1,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias5bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias6bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 183.36
Epoch 1, loss 2.65
Epoch 2, loss 3.77
Epoch 3, loss 1.97
Epoch 4, loss 3.24
Epoch 5, loss 3.38
Epoch 6, loss 1.93
Epoch 7, loss 1.26
Epoch 8, loss 1.07
Epoch 9, loss 1.75
**** Finished Training ****
Change in stitch weights: 0.9739986062049866
Largest abs weight change: 0.03502483665943146
Number of weights changing > 0.1 of that: 18270
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.027014192193746567
Largest abs bias change: 0.002857256680727005
Number of bias changing > 0.1 of that: 230
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1028,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias6bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias7bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 54.90
Epoch 1, loss 1.80
Epoch 2, loss 1.21
Epoch 3, loss 0.97
Epoch 4, loss 0.88
Epoch 5, loss 0.80
Epoch 6, loss 0.80
Epoch 7, loss 0.46
Epoch 8, loss 0.57
Epoch 9, loss 0.68
**** Finished Training ****
Change in stitch weights: 0.7833372950553894
Largest abs weight change: 0.01090980414301157
Number of weights changing > 0.1 of that: 131912
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02560504898428917
Largest abs bias change: 0.0020201578736305237
Number of bias changing > 0.1 of that: 460
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1028,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias7bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias8bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 34.39
Epoch 1, loss 1.62
Epoch 2, loss 1.47
Epoch 3, loss 0.95
Epoch 4, loss 1.10
Epoch 5, loss 0.70
Epoch 6, loss 0.55
Epoch 7, loss 0.48
Epoch 8, loss 0.60
Epoch 9, loss 0.58
**** Finished Training ****
Change in stitch weights: 0.741511881351471
Largest abs weight change: 0.009931473061442375
Number of weights changing > 0.1 of that: 140037
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026114048436284065
Largest abs bias change: 0.0020185858011245728
Number of bias changing > 0.1 of that: 456
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1032,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1010,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  982,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  892,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  958,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1028,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  974,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1009,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  980,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1135]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias8bias-offset8-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
target_offset=9
Evaluate ranks and output to ./results_2g_a_rank/bw3bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 1482.94
Epoch 1, loss 539.22
Epoch 2, loss 404.49
Epoch 3, loss 336.41
Epoch 4, loss 291.26
Epoch 5, loss 261.87
Epoch 6, loss 243.56
Epoch 7, loss 224.61
Epoch 8, loss 210.18
Epoch 9, loss 198.16
**** Finished Training ****
Change in stitch weights: 2.254319906234741
Largest abs weight change: 0.15163879096508026
Number of weights changing > 0.1 of that: 2645
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.027364561334252357
Largest abs bias change: 0.005608879029750824
Number of bias changing > 0.1 of that: 59
Test the trained stitch against send_key='bw' data
Test Accuracy: 89.58 %
Confusion Matrix
tensor([[1091,    0,    6,    9,    2,    6,    0,    6,   10,    5],
        [   0,  906,   23,   26,    7,    7,    4,   21,    3,   35],
        [   0,   23,  865,   24,   13,    3,    8,   50,   15,    9],
        [   1,    0,    3,  941,    0,   19,    0,    3,   15,    0],
        [   0,    5,   33,    2,  806,   16,    4,   12,   10,    4],
        [   0,    3,    1,   41,   12,  878,    1,    4,    2,   16],
        [  28,   26,   15,   13,    2,   15,  828,    1,   94,    6],
        [   0,   17,   21,   28,   16,   19,    0,  841,   14,   18],
        [   3,    1,   16,   66,    2,   23,    4,   15,  871,    8],
        [   0,    7,    1,   18,    8,   10,    1,    2,    2,  931]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw3bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw4bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 768.93
Epoch 1, loss 217.72
Epoch 2, loss 165.16
Epoch 3, loss 139.94
Epoch 4, loss 124.23
Epoch 5, loss 111.83
Epoch 6, loss 103.26
Epoch 7, loss 95.34
Epoch 8, loss 89.87
Epoch 9, loss 82.17
**** Finished Training ****
Change in stitch weights: 1.8231462240219116
Largest abs weight change: 0.11352427303791046
Number of weights changing > 0.1 of that: 2821
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.022628141567111015
Largest abs bias change: 0.005046218633651733
Number of bias changing > 0.1 of that: 53
Test the trained stitch against send_key='bw' data
Test Accuracy: 95.48 %
Confusion Matrix
tensor([[1119,    3,    5,    3,    2,    0,    1,    1,    1,    0],
        [   2,  998,    4,    6,    0,    2,    4,    5,    2,    9],
        [   0,   13,  961,    0,   13,    0,    5,    6,    4,    8],
        [   1,    3,    1,  949,    0,   10,    1,    0,   16,    1],
        [   0,    0,   12,    1,  845,    7,    3,   10,    5,    9],
        [   1,    9,    0,   11,   12,  907,    0,    2,    1,   15],
        [  10,   21,   12,    0,    5,   12,  935,    3,   27,    3],
        [   0,   11,    9,   10,    7,    4,    1,  917,    7,    8],
        [   3,    4,   12,   11,    1,    3,    6,   11,  954,    4],
        [   0,    6,    0,    1,    2,    5,    1,    1,    1,  963]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw4bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw5bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 220.20
Epoch 1, loss 50.52
Epoch 2, loss 39.95
Epoch 3, loss 33.86
Epoch 4, loss 30.50
Epoch 5, loss 27.05
Epoch 6, loss 26.05
Epoch 7, loss 23.78
Epoch 8, loss 23.19
Epoch 9, loss 22.09
**** Finished Training ****
Change in stitch weights: 1.1284278631210327
Largest abs weight change: 0.051939696073532104
Number of weights changing > 0.1 of that: 8498
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.02767682448029518
Largest abs bias change: 0.0040180981159210205
Number of bias changing > 0.1 of that: 119
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.71 %
Confusion Matrix
tensor([[1127,    1,    2,    0,    1,    2,    2,    0,    0,    0],
        [   2, 1018,    3,    2,    0,    1,    2,    2,    0,    2],
        [   0,    2,  999,    0,    3,    0,    3,    2,    0,    1],
        [   0,    0,    0,  974,    0,    1,    0,    0,    7,    0],
        [   0,    0,    4,    0,  880,    2,    2,    1,    1,    2],
        [   2,    2,    0,    2,    5,  943,    0,    1,    0,    3],
        [   3,    5,    1,    0,    0,    1, 1006,    1,   11,    0],
        [   0,    2,    1,    3,    1,    2,    1,  960,    3,    1],
        [   1,    0,    2,    6,    0,    2,    3,    3,  988,    4],
        [   0,    1,    0,    0,    1,    0,    1,    1,    0,  976]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw5bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw6bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 186.23
Epoch 1, loss 27.13
Epoch 2, loss 21.74
Epoch 3, loss 19.61
Epoch 4, loss 17.41
Epoch 5, loss 16.44
Epoch 6, loss 15.49
Epoch 7, loss 14.69
Epoch 8, loss 14.43
Epoch 9, loss 13.34
**** Finished Training ****
Change in stitch weights: 0.9915709495544434
Largest abs weight change: 0.04166349023580551
Number of weights changing > 0.1 of that: 14555
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.026021458208560944
Largest abs bias change: 0.002848472446203232
Number of bias changing > 0.1 of that: 225
Test the trained stitch against send_key='bw' data
Test Accuracy: 98.93 %
Confusion Matrix
tensor([[1126,    1,    3,    0,    1,    1,    2,    0,    1,    0],
        [   0, 1023,    2,    0,    0,    0,    3,    2,    0,    2],
        [   0,    1, 1002,    0,    5,    0,    0,    1,    1,    0],
        [   0,    4,    0,  968,    0,    1,    0,    0,    9,    0],
        [   0,    0,    4,    0,  878,    1,    1,    2,    4,    2],
        [   1,    1,    1,    0,    4,  949,    0,    1,    0,    1],
        [   3,    6,    2,    0,    1,    0, 1009,    0,    7,    0],
        [   0,    1,    3,    0,    1,    0,    2,  966,    1,    0],
        [   0,    1,    1,    2,    4,    0,    1,    2,  996,    2],
        [   0,    1,    0,    0,    1,    0,    1,    1,    0,  976]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw6bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw7bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 70.16
Epoch 1, loss 16.08
Epoch 2, loss 13.19
Epoch 3, loss 11.81
Epoch 4, loss 11.46
Epoch 5, loss 10.68
Epoch 6, loss 10.38
Epoch 7, loss 9.88
Epoch 8, loss 9.72
Epoch 9, loss 9.38
**** Finished Training ****
Change in stitch weights: 0.878170371055603
Largest abs weight change: 0.01429678127169609
Number of weights changing > 0.1 of that: 103451
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026386620476841927
Largest abs bias change: 0.002013370394706726
Number of bias changing > 0.1 of that: 451
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.25 %
Confusion Matrix
tensor([[1128,    1,    1,    0,    1,    1,    3,    0,    0,    0],
        [   0, 1027,    1,    0,    0,    1,    3,    0,    0,    0],
        [   0,    1, 1001,    0,    5,    0,    0,    1,    1,    1],
        [   0,    0,    0,  978,    0,    0,    0,    0,    4,    0],
        [   0,    0,    3,    0,  882,    1,    0,    1,    3,    2],
        [   2,    1,    0,    1,    2,  948,    0,    2,    0,    2],
        [   2,    1,    0,    0,    0,    0, 1023,    1,    1,    0],
        [   0,    1,    0,    0,    1,    0,    2,  968,    1,    1],
        [   0,    0,    1,    6,    2,    0,    3,    4,  992,    1],
        [   0,    1,    0,    0,    0,    0,    1,    0,    0,  978]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw7bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bw8bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to bw
Use the bw data loader (train and test) regardless of what bw was trained on
Epoch 0, loss 62.02
Epoch 1, loss 15.23
Epoch 2, loss 13.05
Epoch 3, loss 11.96
Epoch 4, loss 11.52
Epoch 5, loss 10.43
Epoch 6, loss 10.06
Epoch 7, loss 10.09
Epoch 8, loss 9.71
Epoch 9, loss 9.74
**** Finished Training ****
Change in stitch weights: 0.8505363464355469
Largest abs weight change: 0.015653356909751892
Number of weights changing > 0.1 of that: 87975
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02663363330066204
Largest abs bias change: 0.0020166151225566864
Number of bias changing > 0.1 of that: 471
Test the trained stitch against send_key='bw' data
Test Accuracy: 99.24 %
Confusion Matrix
tensor([[1128,    1,    2,    0,    1,    1,    2,    0,    0,    0],
        [   0, 1025,    2,    0,    0,    1,    3,    1,    0,    0],
        [   0,    1, 1002,    0,    4,    0,    0,    1,    1,    1],
        [   0,    1,    0,  977,    0,    0,    0,    0,    4,    0],
        [   0,    0,    5,    0,  881,    1,    0,    1,    2,    2],
        [   2,    0,    0,    0,    2,  952,    0,    1,    0,    1],
        [   3,    2,    0,    0,    0,    0, 1020,    1,    2,    0],
        [   0,    1,    0,    0,    1,    0,    2,  967,    2,    1],
        [   0,    0,    1,    4,    4,    0,    3,    3,  993,    1],
        [   0,    0,    0,    0,    0,    0,    1,    0,    0,  979]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bw8bw-offset9-StitchEpochs10-bw-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bgonly3bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 782.71
Epoch 1, loss 16.13
Epoch 2, loss 13.24
Epoch 3, loss 10.14
Epoch 4, loss 9.95
Epoch 5, loss 5.90
Epoch 6, loss 7.42
Epoch 7, loss 8.78
Epoch 8, loss 6.45
Epoch 9, loss 6.42
**** Finished Training ****
Change in stitch weights: 0.9642621278762817
Largest abs weight change: 0.09525533765554428
Number of weights changing > 0.1 of that: 1895
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.028171032667160034
Largest abs bias change: 0.0057002827525138855
Number of bias changing > 0.1 of that: 58
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1135,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  958,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly3bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly4bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 691.01
Epoch 1, loss 206.72
Epoch 2, loss 193.78
Epoch 3, loss 185.74
Epoch 4, loss 180.80
Epoch 5, loss 178.47
Epoch 6, loss 174.28
Epoch 7, loss 172.18
Epoch 8, loss 170.75
Epoch 9, loss 168.21
**** Finished Training ****
Change in stitch weights: 1.058907389640808
Largest abs weight change: 0.08991891145706177
Number of weights changing > 0.1 of that: 2293
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.027215344831347466
Largest abs bias change: 0.00560394674539566
Number of bias changing > 0.1 of that: 55
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 90.42 %
Confusion Matrix
tensor([[1135,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [ 116,    0,    0,    0,  457,    0,  385,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly4bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly5bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 275.36
Epoch 1, loss 6.16
Epoch 2, loss 3.87
Epoch 3, loss 4.27
Epoch 4, loss 2.45
Epoch 5, loss 3.49
Epoch 6, loss 2.86
Epoch 7, loss 2.73
Epoch 8, loss 2.65
Epoch 9, loss 1.99
**** Finished Training ****
Change in stitch weights: 0.8438928723335266
Largest abs weight change: 0.05354110151529312
Number of weights changing > 0.1 of that: 5997
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.026355065405368805
Largest abs bias change: 0.004040531814098358
Number of bias changing > 0.1 of that: 120
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1135,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  958,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly5bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly6bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 270.14
Epoch 1, loss 5.02
Epoch 2, loss 3.42
Epoch 3, loss 2.98
Epoch 4, loss 2.30
Epoch 5, loss 1.94
Epoch 6, loss 3.12
Epoch 7, loss 1.75
Epoch 8, loss 1.95
Epoch 9, loss 1.68
**** Finished Training ****
Change in stitch weights: 0.9338594079017639
Largest abs weight change: 0.025678975507616997
Number of weights changing > 0.1 of that: 28883
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.0264928936958313
Largest abs bias change: 0.0028518736362457275
Number of bias changing > 0.1 of that: 233
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1135,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  958,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly6bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly7bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 42.68
Epoch 1, loss 2.58
Epoch 2, loss 1.95
Epoch 3, loss 1.65
Epoch 4, loss 1.31
Epoch 5, loss 1.10
Epoch 6, loss 0.98
Epoch 7, loss 1.14
Epoch 8, loss 1.03
Epoch 9, loss 0.97
**** Finished Training ****
Change in stitch weights: 0.7807298302650452
Largest abs weight change: 0.013790391385555267
Number of weights changing > 0.1 of that: 100585
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02686448208987713
Largest abs bias change: 0.002020731568336487
Number of bias changing > 0.1 of that: 459
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1135,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  958,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly7bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bgonly8bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to bgonly
Use the bgonly data loader (train and test) regardless of what bgonly was trained on
Epoch 0, loss 34.07
Epoch 1, loss 2.79
Epoch 2, loss 2.04
Epoch 3, loss 1.93
Epoch 4, loss 1.66
Epoch 5, loss 1.14
Epoch 6, loss 1.22
Epoch 7, loss 1.05
Epoch 8, loss 0.88
Epoch 9, loss 1.03
**** Finished Training ****
Change in stitch weights: 0.7644705772399902
Largest abs weight change: 0.011047272011637688
Number of weights changing > 0.1 of that: 128837
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.026081962510943413
Largest abs bias change: 0.002015545964241028
Number of bias changing > 0.1 of that: 465
Test the trained stitch against send_key='bgonly' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1135,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  958,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bgonly8bgonly-offset9-StitchEpochs10-bgonly-13_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist-test.csv
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
NOTE: Only running stitch between same model: skipping
Evaluate ranks and output to ./results_2g_a_rank/bias3bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 3426.21
Epoch 1, loss 26.12
Epoch 2, loss 17.29
Epoch 3, loss 11.96
Epoch 4, loss 8.77
Epoch 5, loss 7.34
Epoch 6, loss 7.40
Epoch 7, loss 5.93
Epoch 8, loss 5.77
Epoch 9, loss 4.51
**** Finished Training ****
Change in stitch weights: 1.4775925874710083
Largest abs weight change: 0.1128808856010437
Number of weights changing > 0.1 of that: 2374
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.027033381164073944
Largest abs bias change: 0.005612380802631378
Number of bias changing > 0.1 of that: 54
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1135,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  958,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias3bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias4bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 1219.98
Epoch 1, loss 13.85
Epoch 2, loss 8.85
Epoch 3, loss 7.12
Epoch 4, loss 6.58
Epoch 5, loss 5.31
Epoch 6, loss 4.63
Epoch 7, loss 4.28
Epoch 8, loss 4.00
Epoch 9, loss 2.88
**** Finished Training ****
Change in stitch weights: 1.29967200756073
Largest abs weight change: 0.14511866867542267
Number of weights changing > 0.1 of that: 1581
Number of weight / bias in stitch layer is 64
Change in stitch bias: 0.02571658045053482
Largest abs bias change: 0.005596160888671875
Number of bias changing > 0.1 of that: 58
Test the trained stitch against send_key='bias' data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[1134,    0,    0,    1,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  958,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias4bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias5bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 187.80
Epoch 1, loss 6.54
Epoch 2, loss 5.17
Epoch 3, loss 3.80
Epoch 4, loss 3.58
Epoch 5, loss 2.43
Epoch 6, loss 2.31
Epoch 7, loss 2.16
Epoch 8, loss 2.16
Epoch 9, loss 1.57
**** Finished Training ****
Change in stitch weights: 1.1074153184890747
Largest abs weight change: 0.08082297444343567
Number of weights changing > 0.1 of that: 4027
Number of weight / bias in stitch layer is 128
Change in stitch bias: 0.026261013001203537
Largest abs bias change: 0.004022158682346344
Number of bias changing > 0.1 of that: 112
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1135,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  958,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias5bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias6bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 379.54
Epoch 1, loss 4.66
Epoch 2, loss 3.29
Epoch 3, loss 2.26
Epoch 4, loss 1.85
Epoch 5, loss 1.93
Epoch 6, loss 1.41
Epoch 7, loss 1.36
Epoch 8, loss 1.70
Epoch 9, loss 0.91
**** Finished Training ****
Change in stitch weights: 1.0217643976211548
Largest abs weight change: 0.03633706644177437
Number of weights changing > 0.1 of that: 19013
Number of weight / bias in stitch layer is 256
Change in stitch bias: 0.028088396415114403
Largest abs bias change: 0.002842981368303299
Number of bias changing > 0.1 of that: 236
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1135,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  958,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias6bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias7bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 47.43
Epoch 1, loss 1.76
Epoch 2, loss 1.32
Epoch 3, loss 0.92
Epoch 4, loss 0.68
Epoch 5, loss 0.76
Epoch 6, loss 0.73
Epoch 7, loss 0.63
Epoch 8, loss 0.62
Epoch 9, loss 0.57
**** Finished Training ****
Change in stitch weights: 0.7855870127677917
Largest abs weight change: 0.014199212193489075
Number of weights changing > 0.1 of that: 96636
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02585246041417122
Largest abs bias change: 0.002019427716732025
Number of bias changing > 0.1 of that: 458
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1135,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  958,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias7bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Evaluate ranks and output to ./results_2g_a_rank/bias8bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to bias
Use the bias data loader (train and test) regardless of what bias was trained on
Epoch 0, loss 40.69
Epoch 1, loss 1.41
Epoch 2, loss 1.23
Epoch 3, loss 0.78
Epoch 4, loss 0.76
Epoch 5, loss 0.54
Epoch 6, loss 0.61
Epoch 7, loss 0.49
Epoch 8, loss 0.69
Epoch 9, loss 0.48
**** Finished Training ****
Change in stitch weights: 0.7628718614578247
Largest abs weight change: 0.01056845486164093
Number of weights changing > 0.1 of that: 133568
Number of weight / bias in stitch layer is 512
Change in stitch bias: 0.02613777108490467
Largest abs bias change: 0.002018321305513382
Number of bias changing > 0.1 of that: 468
Test the trained stitch against send_key='bias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1135,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1032,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1010,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  982,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  892,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  958,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1028,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  974,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1009,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  980]],
       dtype=torch.int32)
===================================================================
output to ./results_2g_a_rank/bias8bias-offset9-StitchEpochs10-bias-13_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist-test.csv
