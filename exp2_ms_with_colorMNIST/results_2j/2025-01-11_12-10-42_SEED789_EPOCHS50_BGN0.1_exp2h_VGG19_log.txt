Executed at 2025-01-11_12-10-42
logging to ./results_2j/2025-01-11_12-10-42_SEED789_EPOCHS50_BGN0.1_exp2h_VGG19_log.txt
seed=789
bg_noise=0.1
synthetic_dataset_noise=0.1
train_mix_mnist_model=False
mix_mnist_model_to_load='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist.weights'
train_bw_mnist_model=False
bw_mnist_model_to_load='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist.weights'
train_bg_only_colour_mnist_model=False
bg_only_colour_mnist_model_to_load='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist.weights'
train_bg_unbiased_colour_mnist_model=False
bg_unbiased_colour_mnist_model_to_load='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist.weights'
train_biased_colour_mnist_model=False
biased_colour_mnist_model_to_load='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist.weights'
train_unbiased_colour_mnist_model=False
unbiased_colour_mnist_model_to_load='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist.weights'
stitch_train_epochs=50
================================================
val['loadfrom']='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist.weights'
val['loadfrom']='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist.weights'
val['loadfrom']='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist.weights'
val['loadfrom']='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist.weights'
val['loadfrom']='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist.weights'
val['loadfrom']='../exp1_ms_with_random_dataset/results_1g/2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist.weights'
Accuracy Calculation for VGG19 with key='bw'
Test the Trained VGG19
Test Accuracy: 98.75 %
Confusion Matrix
tensor([[ 968,    0,    1,    0,    0,    1,    7,    1,    1,    1],
        [   0, 1130,    1,    1,    0,    0,    1,    1,    1,    0],
        [   1,    3, 1012,    8,    1,    0,    1,    4,    2,    0],
        [   0,    0,    0, 1002,    0,    3,    0,    1,    2,    2],
        [   0,    0,    0,    0,  969,    0,    7,    1,    0,    5],
        [   1,    0,    0,    5,    0,  884,    1,    0,    1,    0],
        [   1,    2,    0,    1,    1,    2,  949,    0,    2,    0],
        [   1,    2,    5,    3,    1,    0,    0, 1012,    0,    4],
        [   0,    0,    1,    4,    0,    2,    0,    0,  966,    1],
        [   1,    2,    0,    5,    7,    4,    0,    5,    2,  983]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='mix'
Test the Trained VGG19
Test Accuracy: 99.44 %
Confusion Matrix
tensor([[ 969,    0,    0,    0,    0,    1,    2,    0,    0,    0],
        [   0, 1118,    0,    0,    0,    0,    1,    0,    3,    0],
        [   0,    0,  968,    0,    0,    0,    1,    0,    1,    0],
        [   0,    0,    1, 1055,    0,    3,    0,    0,    0,    0],
        [   0,    0,    1,    0, 1002,    0,    1,    0,    0,    0],
        [   0,    0,    0,    1,    0,  864,    0,    0,    4,    0],
        [   1,    2,    1,    0,    0,    3,  939,    0,    1,    0],
        [   0,    0,    2,    2,    0,    0,    0, 1018,    1,    8],
        [   0,    0,    2,    0,    0,    1,    0,    0,  971,    0],
        [   0,    1,    0,    0,    2,    1,    0,    0,    8, 1040]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='bgonly'
Test the Trained VGG19
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='bg'
Test the Trained VGG19
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1003,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  999,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  996,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1002,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1002,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  989,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  999]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='bias'
Test the Trained VGG19
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for VGG19 with key='unbias'
Test the Trained VGG19
Test Accuracy: 98.13 %
Confusion Matrix
tensor([[ 972,    0,    0,    0,    0,    0,    4,    1,    3,    0],
        [   1, 1107,    1,    2,    2,    1,    2,    2,   17,    0],
        [   2,    0, 1024,    1,    1,    0,    0,    2,    2,    0],
        [   0,    0,    3,  995,    0,    4,    0,    2,    4,    2],
        [   0,    0,    1,    0,  963,    0,    5,    2,    2,    9],
        [   2,    0,    0,    9,    0,  869,    4,    1,    6,    1],
        [   4,    3,    0,    1,    3,    2,  942,    0,    3,    0],
        [   0,    2,    4,    3,    1,    0,    0, 1006,    2,   10],
        [   0,    0,    2,    4,    3,    4,    0,    3,  956,    2],
        [   1,    3,    1,    6,    7,    4,    0,    4,    4,  979]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'bw': 98.75, 'mix': 99.44, 'bgonly': 100.0, 'bg': 100.0, 'bias': 100.0, 'unbias': 98.13}
Evaluate ranks and output to ./results_2j_rank/bw1unbias-bw-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
stitch into model bw
Train the stitch after layer 1
Epoch 0, loss 31.64
Epoch 1, loss 12.59
Epoch 2, loss 11.86
Epoch 3, loss 10.49
Epoch 4, loss 9.57
Epoch 5, loss 8.77
Epoch 6, loss 8.26
Epoch 7, loss 8.00
Epoch 8, loss 7.62
Epoch 9, loss 7.21
Epoch 10, loss 6.95
Epoch 11, loss 6.66
Epoch 12, loss 6.23
Epoch 13, loss 6.26
Epoch 14, loss 6.05
Epoch 15, loss 6.10
Epoch 16, loss 5.89
Epoch 17, loss 5.81
Epoch 18, loss 5.75
Epoch 19, loss 5.54
Epoch 20, loss 5.49
Epoch 21, loss 5.53
Epoch 22, loss 5.37
Epoch 23, loss 5.30
Epoch 24, loss 5.19
Epoch 25, loss 5.23
Epoch 26, loss 4.86
Epoch 27, loss 4.86
Epoch 28, loss 5.01
Epoch 29, loss 5.09
Epoch 30, loss 4.97
Epoch 31, loss 4.78
Epoch 32, loss 4.72
Epoch 33, loss 4.75
Epoch 34, loss 4.82
Epoch 35, loss 4.62
Epoch 36, loss 4.59
Epoch 37, loss 4.74
Epoch 38, loss 4.57
Epoch 39, loss 4.53
Epoch 40, loss 4.58
Epoch 41, loss 4.50
Epoch 42, loss 4.47
Epoch 43, loss 4.39
Epoch 44, loss 4.65
Epoch 45, loss 4.33
Epoch 46, loss 4.32
Epoch 47, loss 4.06
Epoch 48, loss 4.58
Epoch 49, loss 4.60
**** Finished Training ****
Change in stitch weights: 2.7274410724639893
Largest abs weight change: 0.12436384707689285
Number of weights changing > 0.1 of that: 3335
Change in stitch bias: 0.2961810529232025
Largest abs bias change: 0.06554240733385086
Number of bias changing > 0.1 of that: 55
Test the trained stitch
Test Accuracy: 99.27 %
Confusion Matrix
tensor([[ 974,    0,    0,    1,    0,    0,    2,    1,    2,    0],
        [   0, 1129,    1,    0,    0,    1,    2,    0,    2,    0],
        [   1,    0, 1029,    0,    0,    0,    0,    2,    0,    0],
        [   0,    0,    0, 1006,    0,    1,    0,    1,    2,    0],
        [   0,    0,    1,    0,  973,    0,    3,    2,    0,    3],
        [   1,    0,    0,    2,    0,  885,    2,    1,    0,    1],
        [   2,    2,    0,    1,    3,    1,  949,    0,    0,    0],
        [   0,    1,    4,    1,    0,    0,    0, 1019,    1,    2],
        [   0,    0,    3,    0,    0,    1,    0,    1,  967,    2],
        [   0,    1,    0,    1,    7,    1,    0,    3,    0,  996]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bw8unbias-bw-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
stitch into model bw
Train the stitch after layer 8
Epoch 0, loss 106.36
Epoch 1, loss 31.99
Epoch 2, loss 25.62
Epoch 3, loss 22.64
Epoch 4, loss 20.62
Epoch 5, loss 19.48
Epoch 6, loss 18.22
Epoch 7, loss 17.59
Epoch 8, loss 17.17
Epoch 9, loss 16.61
Epoch 10, loss 16.01
Epoch 11, loss 15.86
Epoch 12, loss 15.32
Epoch 13, loss 15.09
Epoch 14, loss 15.12
Epoch 15, loss 14.73
Epoch 16, loss 14.59
Epoch 17, loss 14.41
Epoch 18, loss 14.28
Epoch 19, loss 14.09
Epoch 20, loss 14.18
Epoch 21, loss 14.22
Epoch 22, loss 13.85
Epoch 23, loss 13.82
Epoch 24, loss 13.74
Epoch 25, loss 13.70
Epoch 26, loss 13.60
Epoch 27, loss 13.78
Epoch 28, loss 13.86
Epoch 29, loss 13.71
Epoch 30, loss 13.69
Epoch 31, loss 13.62
Epoch 32, loss 13.55
Epoch 33, loss 13.61
Epoch 34, loss 13.58
Epoch 35, loss 13.48
Epoch 36, loss 13.38
Epoch 37, loss 13.43
Epoch 38, loss 13.43
Epoch 39, loss 13.45
Epoch 40, loss 13.53
Epoch 41, loss 13.58
Epoch 42, loss 13.43
Epoch 43, loss 13.42
Epoch 44, loss 13.55
Epoch 45, loss 13.52
Epoch 46, loss 13.30
Epoch 47, loss 13.53
Epoch 48, loss 13.53
Epoch 49, loss 13.59
**** Finished Training ****
Change in stitch weights: 4.409944534301758
Largest abs weight change: 0.1162620335817337
Number of weights changing > 0.1 of that: 12883
Change in stitch bias: 0.33028778433799744
Largest abs bias change: 0.047687940299510956
Number of bias changing > 0.1 of that: 116
Test the trained stitch
Test Accuracy: 99.44 %
Confusion Matrix
tensor([[ 972,    0,    1,    0,    0,    0,    5,    1,    1,    0],
        [   0, 1134,    0,    0,    0,    0,    1,    0,    0,    0],
        [   1,    0, 1029,    0,    0,    0,    0,    2,    0,    0],
        [   0,    0,    0, 1007,    0,    2,    0,    1,    0,    0],
        [   0,    0,    0,    0,  980,    0,    2,    0,    0,    0],
        [   1,    0,    0,    2,    0,  887,    1,    1,    0,    0],
        [   2,    3,    0,    0,    2,    1,  950,    0,    0,    0],
        [   0,    3,    2,    0,    0,    0,    0, 1022,    1,    0],
        [   0,    0,    2,    0,    1,    1,    0,    0,  968,    2],
        [   1,    3,    0,    0,    3,    1,    0,    6,    0,  995]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bw22unbias-bw-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
stitch into model bw
Train the stitch after layer 22
Epoch 0, loss 69.31
Epoch 1, loss 22.75
Epoch 2, loss 17.24
Epoch 3, loss 13.98
Epoch 4, loss 12.13
Epoch 5, loss 10.76
Epoch 6, loss 9.78
Epoch 7, loss 8.97
Epoch 8, loss 8.21
Epoch 9, loss 7.75
Epoch 10, loss 7.19
Epoch 11, loss 6.89
Epoch 12, loss 6.52
Epoch 13, loss 6.27
Epoch 14, loss 6.09
Epoch 15, loss 5.84
Epoch 16, loss 5.60
Epoch 17, loss 5.54
Epoch 18, loss 5.43
Epoch 19, loss 5.35
Epoch 20, loss 5.03
Epoch 21, loss 5.24
Epoch 22, loss 4.97
Epoch 23, loss 4.90
Epoch 24, loss 4.76
Epoch 25, loss 4.81
Epoch 26, loss 4.66
Epoch 27, loss 4.69
Epoch 28, loss 4.54
Epoch 29, loss 4.48
Epoch 30, loss 4.54
Epoch 31, loss 4.65
Epoch 32, loss 4.53
Epoch 33, loss 4.48
Epoch 34, loss 4.43
Epoch 35, loss 4.44
Epoch 36, loss 4.42
Epoch 37, loss 4.54
Epoch 38, loss 4.45
Epoch 39, loss 4.39
Epoch 40, loss 4.46
Epoch 41, loss 4.52
Epoch 42, loss 4.48
Epoch 43, loss 4.53
Epoch 44, loss 4.41
Epoch 45, loss 4.48
Epoch 46, loss 4.51
Epoch 47, loss 4.57
Epoch 48, loss 4.51
Epoch 49, loss 4.51
**** Finished Training ****
Change in stitch weights: 7.768778324127197
Largest abs weight change: 0.04367921128869057
Number of weights changing > 0.1 of that: 216458
Change in stitch bias: 0.30575138330459595
Largest abs bias change: 0.023978736251592636
Number of bias changing > 0.1 of that: 451
Test the trained stitch
Test Accuracy: 99.97 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    1,    0,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    1,    0,    0,    1,    0, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bw29unbias-bw-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
stitch into model bw
Train the stitch after layer 29
Epoch 0, loss 79.17
Epoch 1, loss 21.73
Epoch 2, loss 16.03
Epoch 3, loss 13.42
Epoch 4, loss 12.01
Epoch 5, loss 10.73
Epoch 6, loss 9.95
Epoch 7, loss 9.59
Epoch 8, loss 8.66
Epoch 9, loss 8.40
Epoch 10, loss 7.85
Epoch 11, loss 7.66
Epoch 12, loss 7.37
Epoch 13, loss 7.21
Epoch 14, loss 7.25
Epoch 15, loss 6.84
Epoch 16, loss 6.45
Epoch 17, loss 6.37
Epoch 18, loss 6.06
Epoch 19, loss 5.93
Epoch 20, loss 6.07
Epoch 21, loss 5.89
Epoch 22, loss 5.95
Epoch 23, loss 5.81
Epoch 24, loss 5.65
Epoch 25, loss 5.54
Epoch 26, loss 5.83
Epoch 27, loss 5.49
Epoch 28, loss 5.53
Epoch 29, loss 5.31
Epoch 30, loss 5.45
Epoch 31, loss 5.23
Epoch 32, loss 5.27
Epoch 33, loss 5.22
Epoch 34, loss 5.27
Epoch 35, loss 5.11
Epoch 36, loss 5.46
Epoch 37, loss 5.38
Epoch 38, loss 5.30
Epoch 39, loss 5.35
Epoch 40, loss 5.41
Epoch 41, loss 5.41
Epoch 42, loss 5.30
Epoch 43, loss 5.40
Epoch 44, loss 5.18
Epoch 45, loss 5.39
Epoch 46, loss 5.45
Epoch 47, loss 5.47
Epoch 48, loss 5.50
Epoch 49, loss 5.40
**** Finished Training ****
Change in stitch weights: 7.743712902069092
Largest abs weight change: 0.044473178684711456
Number of weights changing > 0.1 of that: 216050
Change in stitch bias: 0.32291460037231445
Largest abs bias change: 0.02399727888405323
Number of bias changing > 0.1 of that: 457
Test the trained stitch
Test Accuracy: 99.76 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    1,    1,    0,    0],
        [   0, 1134,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1008,    0,    2,    0,    0,    0,    0],
        [   0,    0,    0,    0,  979,    0,    0,    0,    0,    3],
        [   0,    0,    0,    1,    0,  891,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    1,  956,    0,    0,    0],
        [   0,    1,    2,    0,    0,    0,    0, 1025,    0,    0],
        [   0,    0,    0,    1,    0,    0,    0,    0,  972,    1],
        [   1,    0,    0,    0,    5,    0,    0,    2,    0, 1001]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bw35unbias-bw-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bw_mnist-test.csv
stitch into model bw
Train the stitch after layer 35
Epoch 0, loss 29.45
Epoch 1, loss 7.78
Epoch 2, loss 6.66
Epoch 3, loss 6.42
Epoch 4, loss 6.53
Epoch 5, loss 5.63
Epoch 6, loss 5.45
Epoch 7, loss 5.61
Epoch 8, loss 5.45
Epoch 9, loss 4.97
Epoch 10, loss 4.84
Epoch 11, loss 4.72
Epoch 12, loss 4.74
Epoch 13, loss 4.45
Epoch 14, loss 4.43
Epoch 15, loss 4.09
Epoch 16, loss 4.33
Epoch 17, loss 4.43
Epoch 18, loss 4.10
Epoch 19, loss 4.34
Epoch 20, loss 3.70
Epoch 21, loss 3.73
Epoch 22, loss 3.63
Epoch 23, loss 3.77
Epoch 24, loss 3.94
Epoch 25, loss 3.60
Epoch 26, loss 3.95
Epoch 27, loss 4.08
Epoch 28, loss 3.57
Epoch 29, loss 3.43
Epoch 30, loss 3.61
Epoch 31, loss 3.40
Epoch 32, loss 3.20
Epoch 33, loss 3.44
Epoch 34, loss 3.36
Epoch 35, loss 3.61
Epoch 36, loss 3.27
Epoch 37, loss 3.19
Epoch 38, loss 3.67
Epoch 39, loss 3.34
Epoch 40, loss 3.51
Epoch 41, loss 3.45
Epoch 42, loss 3.42
Epoch 43, loss 3.21
Epoch 44, loss 3.23
Epoch 45, loss 3.30
Epoch 46, loss 3.21
Epoch 47, loss 3.35
Epoch 48, loss 3.26
Epoch 49, loss 3.34
**** Finished Training ****
Change in stitch weights: 7.360739707946777
Largest abs weight change: 0.04361303895711899
Number of weights changing > 0.1 of that: 215327
Change in stitch bias: 0.3106142580509186
Largest abs bias change: 0.023909682407975197
Number of bias changing > 0.1 of that: 455
Test the trained stitch
Test Accuracy: 99.71 %
Confusion Matrix
tensor([[ 977,    0,    1,    0,    0,    0,    0,    1,    1,    0],
        [   0, 1132,    0,    0,    0,    0,    1,    1,    0,    1],
        [   0,    0, 1031,    0,    0,    0,    0,    1,    0,    0],
        [   0,    0,    0, 1007,    0,    1,    0,    1,    1,    0],
        [   0,    0,    0,    0,  979,    0,    1,    0,    0,    2],
        [   0,    0,    0,    3,    0,  888,    1,    0,    0,    0],
        [   1,    2,    0,    0,    0,    1,  953,    0,    1,    0],
        [   0,    0,    1,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    1,    0,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    4,    0,    0,    1,    0, 1004]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/mix1unbias-mix-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist-test.csv
stitch into model mix
Train the stitch after layer 1
Epoch 0, loss 128.01
Epoch 1, loss 96.48
Epoch 2, loss 86.57
Epoch 3, loss 80.57
Epoch 4, loss 76.60
Epoch 5, loss 72.72
Epoch 6, loss 70.74
Epoch 7, loss 68.06
Epoch 8, loss 65.67
Epoch 9, loss 63.51
Epoch 10, loss 62.17
Epoch 11, loss 60.26
Epoch 12, loss 59.16
Epoch 13, loss 57.16
Epoch 14, loss 56.25
Epoch 15, loss 55.25
Epoch 16, loss 53.62
Epoch 17, loss 53.06
Epoch 18, loss 52.24
Epoch 19, loss 50.88
Epoch 20, loss 50.11
Epoch 21, loss 49.50
Epoch 22, loss 48.17
Epoch 23, loss 47.03
Epoch 24, loss 46.40
Epoch 25, loss 45.29
Epoch 26, loss 44.72
Epoch 27, loss 43.86
Epoch 28, loss 43.15
Epoch 29, loss 42.64
Epoch 30, loss 42.25
Epoch 31, loss 41.35
Epoch 32, loss 41.30
Epoch 33, loss 40.94
Epoch 34, loss 39.86
Epoch 35, loss 39.47
Epoch 36, loss 39.35
Epoch 37, loss 39.00
Epoch 38, loss 39.11
Epoch 39, loss 38.04
Epoch 40, loss 37.58
Epoch 41, loss 37.90
Epoch 42, loss 37.21
Epoch 43, loss 37.18
Epoch 44, loss 36.63
Epoch 45, loss 37.17
Epoch 46, loss 37.11
Epoch 47, loss 35.99
Epoch 48, loss 35.80
Epoch 49, loss 35.63
**** Finished Training ****
Change in stitch weights: 3.837578058242798
Largest abs weight change: 0.21431758999824524
Number of weights changing > 0.1 of that: 3136
Change in stitch bias: 0.2844451665878296
Largest abs bias change: 0.06597001105546951
Number of bias changing > 0.1 of that: 61
Test the trained stitch
Test Accuracy: 98.53 %
Confusion Matrix
tensor([[ 966,    0,    0,    0,    0,    0,    4,    0,    2,    0],
        [   0, 1121,    0,    0,    0,    0,    0,    0,    1,    0],
        [   1,    0,  968,    0,    0,    0,    0,    1,    0,    0],
        [   0,    0,    1, 1053,    0,    3,    0,    0,    2,    0],
        [   0,    0,    2,    0,  991,    0,    3,    8,    0,    0],
        [   0,    0,    0,    2,    0,  864,    0,    0,    1,    2],
        [   2,    2,    0,    0,    0,    1,  941,    0,    1,    0],
        [   0,    0,    3,    2,    1,    0,    0, 1022,    0,    3],
        [   0,    0,    0,    0,    1,    3,    1,    0,  968,    1],
        [   1,    1,    0,   63,    3,    8,    0,   15,    2,  959]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/mix8unbias-mix-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist-test.csv
stitch into model mix
Train the stitch after layer 8
Epoch 0, loss 214.38
Epoch 1, loss 115.66
Epoch 2, loss 86.58
Epoch 3, loss 71.76
Epoch 4, loss 61.80
Epoch 5, loss 55.13
Epoch 6, loss 50.13
Epoch 7, loss 46.60
Epoch 8, loss 43.28
Epoch 9, loss 40.81
Epoch 10, loss 38.73
Epoch 11, loss 37.14
Epoch 12, loss 35.41
Epoch 13, loss 34.20
Epoch 14, loss 32.90
Epoch 15, loss 32.10
Epoch 16, loss 31.13
Epoch 17, loss 30.45
Epoch 18, loss 29.66
Epoch 19, loss 28.88
Epoch 20, loss 28.42
Epoch 21, loss 27.77
Epoch 22, loss 27.48
Epoch 23, loss 26.91
Epoch 24, loss 26.49
Epoch 25, loss 26.19
Epoch 26, loss 25.69
Epoch 27, loss 25.35
Epoch 28, loss 24.78
Epoch 29, loss 24.62
Epoch 30, loss 24.34
Epoch 31, loss 24.18
Epoch 32, loss 23.84
Epoch 33, loss 23.58
Epoch 34, loss 23.44
Epoch 35, loss 23.45
Epoch 36, loss 23.34
Epoch 37, loss 23.04
Epoch 38, loss 22.83
Epoch 39, loss 22.71
Epoch 40, loss 22.48
Epoch 41, loss 22.36
Epoch 42, loss 22.47
Epoch 43, loss 22.16
Epoch 44, loss 22.06
Epoch 45, loss 21.97
Epoch 46, loss 21.64
Epoch 47, loss 21.72
Epoch 48, loss 21.54
Epoch 49, loss 21.45
**** Finished Training ****
Change in stitch weights: 5.305399417877197
Largest abs weight change: 0.13881248235702515
Number of weights changing > 0.1 of that: 12828
Change in stitch bias: 0.309160441160202
Largest abs bias change: 0.04786919802427292
Number of bias changing > 0.1 of that: 113
Test the trained stitch
Test Accuracy: 99.88 %
Confusion Matrix
tensor([[ 972,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1122,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  970,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1059,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1004,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  869,    0,    0,    0,    0],
        [   0,    2,    0,    0,    1,    2,  942,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1031,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0,    0,  973,    0],
        [   0,    1,    0,    0,    2,    2,    0,    1,    0, 1046]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/mix22unbias-mix-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist-test.csv
stitch into model mix
Train the stitch after layer 22
Epoch 0, loss 65.26
Epoch 1, loss 15.72
Epoch 2, loss 11.07
Epoch 3, loss 8.76
Epoch 4, loss 7.48
Epoch 5, loss 6.62
Epoch 6, loss 6.08
Epoch 7, loss 5.38
Epoch 8, loss 5.16
Epoch 9, loss 4.87
Epoch 10, loss 4.59
Epoch 11, loss 4.29
Epoch 12, loss 4.02
Epoch 13, loss 3.87
Epoch 14, loss 3.79
Epoch 15, loss 3.74
Epoch 16, loss 3.54
Epoch 17, loss 3.58
Epoch 18, loss 3.31
Epoch 19, loss 3.30
Epoch 20, loss 3.13
Epoch 21, loss 3.16
Epoch 22, loss 3.12
Epoch 23, loss 3.11
Epoch 24, loss 3.02
Epoch 25, loss 2.95
Epoch 26, loss 2.89
Epoch 27, loss 2.89
Epoch 28, loss 2.92
Epoch 29, loss 2.89
Epoch 30, loss 2.79
Epoch 31, loss 2.82
Epoch 32, loss 2.90
Epoch 33, loss 2.78
Epoch 34, loss 2.74
Epoch 35, loss 2.79
Epoch 36, loss 2.75
Epoch 37, loss 2.78
Epoch 38, loss 2.80
Epoch 39, loss 2.84
Epoch 40, loss 2.76
Epoch 41, loss 2.78
Epoch 42, loss 2.74
Epoch 43, loss 2.72
Epoch 44, loss 2.80
Epoch 45, loss 2.84
Epoch 46, loss 2.85
Epoch 47, loss 2.82
Epoch 48, loss 2.82
Epoch 49, loss 2.82
**** Finished Training ****
Change in stitch weights: 7.633059501647949
Largest abs weight change: 0.04564225673675537
Number of weights changing > 0.1 of that: 214409
Change in stitch bias: 0.31222084164619446
Largest abs bias change: 0.023851687088608742
Number of bias changing > 0.1 of that: 473
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 972,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1122,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  970,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1059,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1004,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  869,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  947,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1031,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1052]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/mix29unbias-mix-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist-test.csv
stitch into model mix
Train the stitch after layer 29
Epoch 0, loss 91.70
Epoch 1, loss 21.73
Epoch 2, loss 13.52
Epoch 3, loss 10.41
Epoch 4, loss 8.72
Epoch 5, loss 7.64
Epoch 6, loss 6.70
Epoch 7, loss 6.32
Epoch 8, loss 5.82
Epoch 9, loss 5.42
Epoch 10, loss 5.29
Epoch 11, loss 4.91
Epoch 12, loss 4.83
Epoch 13, loss 4.56
Epoch 14, loss 4.57
Epoch 15, loss 4.49
Epoch 16, loss 4.16
Epoch 17, loss 4.17
Epoch 18, loss 4.06
Epoch 19, loss 4.08
Epoch 20, loss 3.80
Epoch 21, loss 4.02
Epoch 22, loss 3.88
Epoch 23, loss 3.76
Epoch 24, loss 3.73
Epoch 25, loss 3.65
Epoch 26, loss 3.63
Epoch 27, loss 3.51
Epoch 28, loss 3.51
Epoch 29, loss 3.45
Epoch 30, loss 3.57
Epoch 31, loss 3.43
Epoch 32, loss 3.56
Epoch 33, loss 3.57
Epoch 34, loss 3.46
Epoch 35, loss 3.49
Epoch 36, loss 3.49
Epoch 37, loss 3.44
Epoch 38, loss 3.45
Epoch 39, loss 3.43
Epoch 40, loss 3.45
Epoch 41, loss 3.52
Epoch 42, loss 3.37
Epoch 43, loss 3.49
Epoch 44, loss 3.48
Epoch 45, loss 3.56
Epoch 46, loss 3.57
Epoch 47, loss 3.48
Epoch 48, loss 3.70
Epoch 49, loss 3.57
**** Finished Training ****
Change in stitch weights: 7.6115241050720215
Largest abs weight change: 0.048751551657915115
Number of weights changing > 0.1 of that: 210912
Change in stitch bias: 0.31028974056243896
Largest abs bias change: 0.024015432223677635
Number of bias changing > 0.1 of that: 464
Test the trained stitch
Test Accuracy: 99.85 %
Confusion Matrix
tensor([[ 972,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1122,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  970,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1059,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1001,    0,    1,    0,    0,    2],
        [   0,    0,    0,    1,    0,  868,    0,    0,    0,    0],
        [   0,    1,    1,    0,    0,    1,  944,    0,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0, 1028,    0,    2],
        [   0,    0,    1,    0,    0,    0,    0,    0,  973,    0],
        [   0,    1,    0,    0,    2,    0,    0,    1,    0, 1048]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/mix35unbias-mix-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_mix_mnist-test.csv
stitch into model mix
Train the stitch after layer 35
Epoch 0, loss 36.46
Epoch 1, loss 6.65
Epoch 2, loss 5.42
Epoch 3, loss 4.47
Epoch 4, loss 3.99
Epoch 5, loss 3.83
Epoch 6, loss 3.39
Epoch 7, loss 3.28
Epoch 8, loss 3.10
Epoch 9, loss 3.15
Epoch 10, loss 2.95
Epoch 11, loss 2.79
Epoch 12, loss 2.81
Epoch 13, loss 2.81
Epoch 14, loss 2.69
Epoch 15, loss 2.66
Epoch 16, loss 2.69
Epoch 17, loss 2.66
Epoch 18, loss 2.54
Epoch 19, loss 2.71
Epoch 20, loss 2.75
Epoch 21, loss 2.60
Epoch 22, loss 2.34
Epoch 23, loss 2.67
Epoch 24, loss 2.57
Epoch 25, loss 2.42
Epoch 26, loss 2.29
Epoch 27, loss 2.38
Epoch 28, loss 2.47
Epoch 29, loss 2.67
Epoch 30, loss 2.36
Epoch 31, loss 2.36
Epoch 32, loss 2.38
Epoch 33, loss 2.25
Epoch 34, loss 2.26
Epoch 35, loss 2.37
Epoch 36, loss 2.19
Epoch 37, loss 2.38
Epoch 38, loss 2.31
Epoch 39, loss 2.28
Epoch 40, loss 2.29
Epoch 41, loss 2.28
Epoch 42, loss 2.31
Epoch 43, loss 2.26
Epoch 44, loss 2.40
Epoch 45, loss 2.24
Epoch 46, loss 2.16
Epoch 47, loss 2.21
Epoch 48, loss 2.07
Epoch 49, loss 2.23
**** Finished Training ****
Change in stitch weights: 7.341289520263672
Largest abs weight change: 0.05582656338810921
Number of weights changing > 0.1 of that: 202461
Change in stitch bias: 0.3195415139198303
Largest abs bias change: 0.02401508204638958
Number of bias changing > 0.1 of that: 462
Test the trained stitch
Test Accuracy: 99.79 %
Confusion Matrix
tensor([[ 972,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1122,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  970,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    1, 1057,    0,    1,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1002,    0,    1,    0,    0,    1],
        [   0,    0,    0,    2,    0,  866,    0,    0,    1,    0],
        [   0,    1,    0,    0,    0,    1,  945,    0,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0, 1028,    0,    2],
        [   0,    0,    2,    0,    0,    1,    0,    0,  971,    0],
        [   0,    1,    0,    1,    2,    0,    0,    2,    0, 1046]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bgonly1unbias-bgonly-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist-test.csv
stitch into model bgonly
Train the stitch after layer 1
Epoch 0, loss 263.89
Epoch 1, loss 199.10
Epoch 2, loss 176.86
Epoch 3, loss 161.08
Epoch 4, loss 150.54
Epoch 5, loss 139.86
Epoch 6, loss 130.50
Epoch 7, loss 123.09
Epoch 8, loss 114.93
Epoch 9, loss 107.08
Epoch 10, loss 100.31
Epoch 11, loss 95.17
Epoch 12, loss 91.27
Epoch 13, loss 86.01
Epoch 14, loss 80.86
Epoch 15, loss 78.85
Epoch 16, loss 75.02
Epoch 17, loss 71.96
Epoch 18, loss 70.66
Epoch 19, loss 68.33
Epoch 20, loss 65.76
Epoch 21, loss 65.77
Epoch 22, loss 61.42
Epoch 23, loss 59.94
Epoch 24, loss 58.67
Epoch 25, loss 56.82
Epoch 26, loss 56.49
Epoch 27, loss 55.98
Epoch 28, loss 53.98
Epoch 29, loss 54.01
Epoch 30, loss 52.97
Epoch 31, loss 50.94
Epoch 32, loss 51.69
Epoch 33, loss 50.28
Epoch 34, loss 49.93
Epoch 35, loss 49.48
Epoch 36, loss 49.29
Epoch 37, loss 49.61
Epoch 38, loss 48.59
Epoch 39, loss 46.89
Epoch 40, loss 49.01
Epoch 41, loss 47.68
Epoch 42, loss 46.67
Epoch 43, loss 46.06
Epoch 44, loss 46.55
Epoch 45, loss 46.54
Epoch 46, loss 45.95
Epoch 47, loss 46.33
Epoch 48, loss 46.50
Epoch 49, loss 44.36
**** Finished Training ****
Change in stitch weights: 4.280622482299805
Largest abs weight change: 0.22675567865371704
Number of weights changing > 0.1 of that: 3135
Change in stitch bias: 0.3283494710922241
Largest abs bias change: 0.06757759302854538
Number of bias changing > 0.1 of that: 59
Test the trained stitch
Test Accuracy: 99.93 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    7,    0,    0,    0, 1002]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bgonly8unbias-bgonly-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist-test.csv
stitch into model bgonly
Train the stitch after layer 8
Epoch 0, loss 194.13
Epoch 1, loss 108.31
Epoch 2, loss 82.72
Epoch 3, loss 68.51
Epoch 4, loss 60.20
Epoch 5, loss 54.60
Epoch 6, loss 50.16
Epoch 7, loss 46.65
Epoch 8, loss 44.10
Epoch 9, loss 41.51
Epoch 10, loss 39.77
Epoch 11, loss 37.71
Epoch 12, loss 36.27
Epoch 13, loss 35.09
Epoch 14, loss 33.86
Epoch 15, loss 33.36
Epoch 16, loss 31.85
Epoch 17, loss 31.19
Epoch 18, loss 30.77
Epoch 19, loss 29.90
Epoch 20, loss 29.38
Epoch 21, loss 28.67
Epoch 22, loss 28.77
Epoch 23, loss 27.76
Epoch 24, loss 27.42
Epoch 25, loss 27.67
Epoch 26, loss 27.16
Epoch 27, loss 26.57
Epoch 28, loss 26.57
Epoch 29, loss 26.26
Epoch 30, loss 25.84
Epoch 31, loss 25.62
Epoch 32, loss 25.42
Epoch 33, loss 25.15
Epoch 34, loss 25.15
Epoch 35, loss 24.76
Epoch 36, loss 24.33
Epoch 37, loss 24.25
Epoch 38, loss 24.41
Epoch 39, loss 24.17
Epoch 40, loss 23.85
Epoch 41, loss 23.69
Epoch 42, loss 23.34
Epoch 43, loss 23.22
Epoch 44, loss 23.12
Epoch 45, loss 22.74
Epoch 46, loss 22.70
Epoch 47, loss 22.58
Epoch 48, loss 22.23
Epoch 49, loss 22.53
**** Finished Training ****
Change in stitch weights: 5.068620204925537
Largest abs weight change: 0.1411859095096588
Number of weights changing > 0.1 of that: 12576
Change in stitch bias: 0.30483680963516235
Largest abs bias change: 0.04759687930345535
Number of bias changing > 0.1 of that: 115
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bgonly22unbias-bgonly-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist-test.csv
stitch into model bgonly
Train the stitch after layer 22
Epoch 0, loss 33.06
Epoch 1, loss 5.19
Epoch 2, loss 3.50
Epoch 3, loss 2.73
Epoch 4, loss 2.28
Epoch 5, loss 2.03
Epoch 6, loss 1.79
Epoch 7, loss 1.65
Epoch 8, loss 1.58
Epoch 9, loss 1.49
Epoch 10, loss 1.44
Epoch 11, loss 1.47
Epoch 12, loss 1.38
Epoch 13, loss 1.27
Epoch 14, loss 1.24
Epoch 15, loss 1.24
Epoch 16, loss 1.23
Epoch 17, loss 1.20
Epoch 18, loss 1.18
Epoch 19, loss 1.19
Epoch 20, loss 1.17
Epoch 21, loss 1.18
Epoch 22, loss 1.16
Epoch 23, loss 1.15
Epoch 24, loss 1.16
Epoch 25, loss 1.34
Epoch 26, loss 1.20
Epoch 27, loss 1.18
Epoch 28, loss 1.15
Epoch 29, loss 1.18
Epoch 30, loss 1.16
Epoch 31, loss 1.17
Epoch 32, loss 1.18
Epoch 33, loss 1.16
Epoch 34, loss 1.18
Epoch 35, loss 1.19
Epoch 36, loss 1.21
Epoch 37, loss 1.19
Epoch 38, loss 1.20
Epoch 39, loss 1.22
Epoch 40, loss 1.21
Epoch 41, loss 1.27
Epoch 42, loss 1.23
Epoch 43, loss 1.22
Epoch 44, loss 1.25
Epoch 45, loss 1.25
Epoch 46, loss 1.27
Epoch 47, loss 1.37
Epoch 48, loss 1.32
Epoch 49, loss 1.28
**** Finished Training ****
Change in stitch weights: 7.377090930938721
Largest abs weight change: 0.0476798415184021
Number of weights changing > 0.1 of that: 210761
Change in stitch bias: 0.31210729479789734
Largest abs bias change: 0.02398708462715149
Number of bias changing > 0.1 of that: 453
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bgonly29unbias-bgonly-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist-test.csv
stitch into model bgonly
Train the stitch after layer 29
Epoch 0, loss 56.41
Epoch 1, loss 8.98
Epoch 2, loss 5.60
Epoch 3, loss 4.20
Epoch 4, loss 3.44
Epoch 5, loss 2.95
Epoch 6, loss 2.63
Epoch 7, loss 2.36
Epoch 8, loss 2.19
Epoch 9, loss 2.05
Epoch 10, loss 1.90
Epoch 11, loss 1.84
Epoch 12, loss 1.74
Epoch 13, loss 1.70
Epoch 14, loss 1.65
Epoch 15, loss 1.60
Epoch 16, loss 1.55
Epoch 17, loss 1.54
Epoch 18, loss 1.54
Epoch 19, loss 1.50
Epoch 20, loss 1.49
Epoch 21, loss 1.46
Epoch 22, loss 1.45
Epoch 23, loss 1.46
Epoch 24, loss 1.40
Epoch 25, loss 1.40
Epoch 26, loss 1.45
Epoch 27, loss 1.40
Epoch 28, loss 1.43
Epoch 29, loss 1.41
Epoch 30, loss 1.40
Epoch 31, loss 1.42
Epoch 32, loss 1.41
Epoch 33, loss 1.47
Epoch 34, loss 1.48
Epoch 35, loss 1.48
Epoch 36, loss 1.48
Epoch 37, loss 1.50
Epoch 38, loss 1.54
Epoch 39, loss 1.51
Epoch 40, loss 1.51
Epoch 41, loss 1.50
Epoch 42, loss 1.55
Epoch 43, loss 1.69
Epoch 44, loss 1.65
Epoch 45, loss 1.60
Epoch 46, loss 1.68
Epoch 47, loss 1.67
Epoch 48, loss 1.67
Epoch 49, loss 1.69
**** Finished Training ****
Change in stitch weights: 7.408772945404053
Largest abs weight change: 0.050904884934425354
Number of weights changing > 0.1 of that: 207941
Change in stitch bias: 0.31440383195877075
Largest abs bias change: 0.023970771580934525
Number of bias changing > 0.1 of that: 472
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bgonly35unbias-bgonly-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_only_colour_mnist-test.csv
stitch into model bgonly
Train the stitch after layer 35
Epoch 0, loss 23.55
Epoch 1, loss 1.52
Epoch 2, loss 1.02
Epoch 3, loss 0.78
Epoch 4, loss 0.68
Epoch 5, loss 0.58
Epoch 6, loss 0.52
Epoch 7, loss 0.48
Epoch 8, loss 0.44
Epoch 9, loss 0.44
Epoch 10, loss 0.40
Epoch 11, loss 0.40
Epoch 12, loss 0.40
Epoch 13, loss 0.36
Epoch 14, loss 0.34
Epoch 15, loss 0.34
Epoch 16, loss 0.33
Epoch 17, loss 0.35
Epoch 18, loss 0.33
Epoch 19, loss 0.34
Epoch 20, loss 0.33
Epoch 21, loss 0.33
Epoch 22, loss 0.31
Epoch 23, loss 0.31
Epoch 24, loss 0.32
Epoch 25, loss 0.31
Epoch 26, loss 0.32
Epoch 27, loss 0.32
Epoch 28, loss 0.32
Epoch 29, loss 0.32
Epoch 30, loss 0.30
Epoch 31, loss 0.32
Epoch 32, loss 0.30
Epoch 33, loss 0.33
Epoch 34, loss 0.31
Epoch 35, loss 0.33
Epoch 36, loss 0.31
Epoch 37, loss 0.33
Epoch 38, loss 0.32
Epoch 39, loss 0.33
Epoch 40, loss 0.33
Epoch 41, loss 0.32
Epoch 42, loss 0.35
Epoch 43, loss 0.35
Epoch 44, loss 0.34
Epoch 45, loss 0.37
Epoch 46, loss 0.36
Epoch 47, loss 0.34
Epoch 48, loss 0.35
Epoch 49, loss 0.35
**** Finished Training ****
Change in stitch weights: 7.232762336730957
Largest abs weight change: 0.04294673353433609
Number of weights changing > 0.1 of that: 215648
Change in stitch bias: 0.31322577595710754
Largest abs bias change: 0.02401038259267807
Number of bias changing > 0.1 of that: 472
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bg1unbias-bg-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist-test.csv
stitch into model bg
Train the stitch after layer 1
Epoch 0, loss 307.68
Epoch 1, loss 212.61
Epoch 2, loss 175.91
Epoch 3, loss 151.64
Epoch 4, loss 133.31
Epoch 5, loss 118.82
Epoch 6, loss 109.78
Epoch 7, loss 100.45
Epoch 8, loss 94.05
Epoch 9, loss 87.07
Epoch 10, loss 82.63
Epoch 11, loss 78.11
Epoch 12, loss 74.59
Epoch 13, loss 71.99
Epoch 14, loss 69.45
Epoch 15, loss 66.01
Epoch 16, loss 64.80
Epoch 17, loss 61.32
Epoch 18, loss 61.57
Epoch 19, loss 59.56
Epoch 20, loss 56.91
Epoch 21, loss 56.15
Epoch 22, loss 56.60
Epoch 23, loss 54.57
Epoch 24, loss 53.00
Epoch 25, loss 51.25
Epoch 26, loss 50.67
Epoch 27, loss 49.30
Epoch 28, loss 49.67
Epoch 29, loss 48.84
Epoch 30, loss 46.49
Epoch 31, loss 50.15
Epoch 32, loss 45.93
Epoch 33, loss 47.29
Epoch 34, loss 45.29
Epoch 35, loss 45.54
Epoch 36, loss 44.13
Epoch 37, loss 43.96
Epoch 38, loss 43.86
Epoch 39, loss 43.68
Epoch 40, loss 43.26
Epoch 41, loss 42.45
Epoch 42, loss 46.08
Epoch 43, loss 45.40
Epoch 44, loss 43.15
Epoch 45, loss 40.91
Epoch 46, loss 43.29
Epoch 47, loss 39.69
Epoch 48, loss 40.97
Epoch 49, loss 46.20
**** Finished Training ****
Change in stitch weights: 4.7345991134643555
Largest abs weight change: 0.2700633406639099
Number of weights changing > 0.1 of that: 3058
Change in stitch bias: 0.31859734654426575
Largest abs bias change: 0.06698119640350342
Number of bias changing > 0.1 of that: 59
Test the trained stitch
Test Accuracy: 98.48 %
Confusion Matrix
tensor([[ 986,    0,    2,    3,    0,    2,    3,    0,    8,    0],
        [   0,  999,    0,    1,    1,    2,    0,    0,    0,    0],
        [   0,    0,  998,    5,    0,    0,    0,    0,    0,    0],
        [   0,    0,    1,  995,    0,    2,    0,    0,    1,    0],
        [   0,    9,    0,    0,  961,    0,    0,   12,   14,    0],
        [   0,    0,    0,    0,    0, 1002,    0,    0,    0,    0],
        [   0,    0,    0,    0,    1,    4,  984,    0,   13,    0],
        [   0,    1,    0,    5,    2,    1,    0,  994,    0,    0],
        [   0,    0,    0,    1,    1,    0,    0,    2,  985,    0],
        [   0,    3,    0,   19,    3,   15,    0,    2,   13,  944]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bg8unbias-bg-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist-test.csv
stitch into model bg
Train the stitch after layer 8
Epoch 0, loss 203.24
Epoch 1, loss 115.80
Epoch 2, loss 89.36
Epoch 3, loss 74.02
Epoch 4, loss 64.25
Epoch 5, loss 57.47
Epoch 6, loss 51.99
Epoch 7, loss 48.09
Epoch 8, loss 43.94
Epoch 9, loss 41.75
Epoch 10, loss 39.58
Epoch 11, loss 37.32
Epoch 12, loss 35.51
Epoch 13, loss 34.67
Epoch 14, loss 32.93
Epoch 15, loss 31.62
Epoch 16, loss 30.67
Epoch 17, loss 29.62
Epoch 18, loss 28.77
Epoch 19, loss 28.16
Epoch 20, loss 27.72
Epoch 21, loss 27.31
Epoch 22, loss 26.52
Epoch 23, loss 26.13
Epoch 24, loss 25.62
Epoch 25, loss 25.19
Epoch 26, loss 24.62
Epoch 27, loss 24.65
Epoch 28, loss 24.15
Epoch 29, loss 23.86
Epoch 30, loss 23.54
Epoch 31, loss 23.24
Epoch 32, loss 23.04
Epoch 33, loss 22.88
Epoch 34, loss 22.49
Epoch 35, loss 22.41
Epoch 36, loss 22.14
Epoch 37, loss 21.94
Epoch 38, loss 21.48
Epoch 39, loss 21.70
Epoch 40, loss 21.43
Epoch 41, loss 21.14
Epoch 42, loss 21.20
Epoch 43, loss 20.79
Epoch 44, loss 20.79
Epoch 45, loss 20.54
Epoch 46, loss 20.63
Epoch 47, loss 20.31
Epoch 48, loss 20.15
Epoch 49, loss 20.11
**** Finished Training ****
Change in stitch weights: 5.313790321350098
Largest abs weight change: 0.13970929384231567
Number of weights changing > 0.1 of that: 12809
Change in stitch bias: 0.3079317510128021
Largest abs bias change: 0.04790365323424339
Number of bias changing > 0.1 of that: 120
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1003,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  999,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  996,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1002,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1002,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  989,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  999]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bg22unbias-bg-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist-test.csv
stitch into model bg
Train the stitch after layer 22
Epoch 0, loss 41.13
Epoch 1, loss 6.33
Epoch 2, loss 4.34
Epoch 3, loss 3.33
Epoch 4, loss 2.80
Epoch 5, loss 2.37
Epoch 6, loss 2.20
Epoch 7, loss 2.06
Epoch 8, loss 1.87
Epoch 9, loss 1.77
Epoch 10, loss 1.67
Epoch 11, loss 1.59
Epoch 12, loss 1.61
Epoch 13, loss 1.50
Epoch 14, loss 1.50
Epoch 15, loss 1.46
Epoch 16, loss 1.45
Epoch 17, loss 1.41
Epoch 18, loss 1.41
Epoch 19, loss 1.39
Epoch 20, loss 1.40
Epoch 21, loss 1.35
Epoch 22, loss 1.37
Epoch 23, loss 1.38
Epoch 24, loss 1.36
Epoch 25, loss 1.35
Epoch 26, loss 1.37
Epoch 27, loss 1.35
Epoch 28, loss 1.37
Epoch 29, loss 1.35
Epoch 30, loss 1.35
Epoch 31, loss 1.39
Epoch 32, loss 1.37
Epoch 33, loss 1.38
Epoch 34, loss 1.38
Epoch 35, loss 1.39
Epoch 36, loss 1.40
Epoch 37, loss 1.40
Epoch 38, loss 1.42
Epoch 39, loss 1.43
Epoch 40, loss 1.42
Epoch 41, loss 1.44
Epoch 42, loss 1.42
Epoch 43, loss 1.43
Epoch 44, loss 1.45
Epoch 45, loss 1.47
Epoch 46, loss 1.47
Epoch 47, loss 1.47
Epoch 48, loss 1.50
Epoch 49, loss 1.51
**** Finished Training ****
Change in stitch weights: 7.431612014770508
Largest abs weight change: 0.041660260409116745
Number of weights changing > 0.1 of that: 218235
Change in stitch bias: 0.31214767694473267
Largest abs bias change: 0.023990225046873093
Number of bias changing > 0.1 of that: 458
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1003,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  999,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  996,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1002,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1002,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  989,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  999]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bg29unbias-bg-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist-test.csv
stitch into model bg
Train the stitch after layer 29
Epoch 0, loss 55.33
Epoch 1, loss 9.29
Epoch 2, loss 5.96
Epoch 3, loss 4.53
Epoch 4, loss 3.71
Epoch 5, loss 3.23
Epoch 6, loss 2.92
Epoch 7, loss 2.69
Epoch 8, loss 2.58
Epoch 9, loss 2.33
Epoch 10, loss 2.15
Epoch 11, loss 2.15
Epoch 12, loss 2.11
Epoch 13, loss 2.00
Epoch 14, loss 2.04
Epoch 15, loss 1.94
Epoch 16, loss 1.88
Epoch 17, loss 1.86
Epoch 18, loss 1.82
Epoch 19, loss 1.81
Epoch 20, loss 1.78
Epoch 21, loss 1.75
Epoch 22, loss 1.79
Epoch 23, loss 1.80
Epoch 24, loss 1.76
Epoch 25, loss 1.74
Epoch 26, loss 1.77
Epoch 27, loss 1.75
Epoch 28, loss 1.72
Epoch 29, loss 1.78
Epoch 30, loss 1.79
Epoch 31, loss 1.76
Epoch 32, loss 1.84
Epoch 33, loss 1.80
Epoch 34, loss 1.76
Epoch 35, loss 1.83
Epoch 36, loss 1.83
Epoch 37, loss 1.85
Epoch 38, loss 1.84
Epoch 39, loss 1.87
Epoch 40, loss 1.85
Epoch 41, loss 1.90
Epoch 42, loss 1.91
Epoch 43, loss 1.92
Epoch 44, loss 1.92
Epoch 45, loss 1.96
Epoch 46, loss 1.96
Epoch 47, loss 2.02
Epoch 48, loss 1.99
Epoch 49, loss 2.04
**** Finished Training ****
Change in stitch weights: 7.433573246002197
Largest abs weight change: 0.061001330614089966
Number of weights changing > 0.1 of that: 197028
Change in stitch bias: 0.3264802396297455
Largest abs bias change: 0.024023551493883133
Number of bias changing > 0.1 of that: 471
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1003,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  999,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  996,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1002,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1002,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  989,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  999]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bg35unbias-bg-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_bg_unbiased_colour_mnist-test.csv
stitch into model bg
Train the stitch after layer 35
Epoch 0, loss 21.40
Epoch 1, loss 1.50
Epoch 2, loss 0.95
Epoch 3, loss 0.77
Epoch 4, loss 0.62
Epoch 5, loss 0.56
Epoch 6, loss 0.53
Epoch 7, loss 0.44
Epoch 8, loss 0.45
Epoch 9, loss 0.39
Epoch 10, loss 0.39
Epoch 11, loss 0.37
Epoch 12, loss 0.36
Epoch 13, loss 0.36
Epoch 14, loss 0.35
Epoch 15, loss 0.35
Epoch 16, loss 0.33
Epoch 17, loss 0.33
Epoch 18, loss 0.32
Epoch 19, loss 0.31
Epoch 20, loss 0.33
Epoch 21, loss 0.33
Epoch 22, loss 0.32
Epoch 23, loss 0.32
Epoch 24, loss 0.31
Epoch 25, loss 0.30
Epoch 26, loss 0.30
Epoch 27, loss 0.31
Epoch 28, loss 0.32
Epoch 29, loss 0.33
Epoch 30, loss 0.31
Epoch 31, loss 0.33
Epoch 32, loss 0.31
Epoch 33, loss 0.32
Epoch 34, loss 0.32
Epoch 35, loss 0.32
Epoch 36, loss 0.32
Epoch 37, loss 0.32
Epoch 38, loss 0.32
Epoch 39, loss 0.32
Epoch 40, loss 0.33
Epoch 41, loss 0.33
Epoch 42, loss 0.35
Epoch 43, loss 0.35
Epoch 44, loss 0.35
Epoch 45, loss 0.35
Epoch 46, loss 0.34
Epoch 47, loss 0.35
Epoch 48, loss 0.35
Epoch 49, loss 0.35
**** Finished Training ****
Change in stitch weights: 7.23806619644165
Largest abs weight change: 0.04803287237882614
Number of weights changing > 0.1 of that: 210317
Change in stitch bias: 0.31498637795448303
Largest abs bias change: 0.024027438834309578
Number of bias changing > 0.1 of that: 473
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1003,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  999,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  996,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0, 1002,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1002,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  989,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0,  999]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bias1unbias-bias-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist-test.csv
stitch into model bias
Train the stitch after layer 1
Epoch 0, loss 33.64
Epoch 1, loss 11.91
Epoch 2, loss 9.21
Epoch 3, loss 8.60
Epoch 4, loss 7.65
Epoch 5, loss 7.27
Epoch 6, loss 7.05
Epoch 7, loss 6.74
Epoch 8, loss 6.21
Epoch 9, loss 6.05
Epoch 10, loss 6.34
Epoch 11, loss 6.10
Epoch 12, loss 5.29
Epoch 13, loss 5.49
Epoch 14, loss 5.29
Epoch 15, loss 4.86
Epoch 16, loss 4.97
Epoch 17, loss 4.80
Epoch 18, loss 4.79
Epoch 19, loss 4.53
Epoch 20, loss 4.60
Epoch 21, loss 4.58
Epoch 22, loss 4.58
Epoch 23, loss 4.23
Epoch 24, loss 4.03
Epoch 25, loss 4.33
Epoch 26, loss 4.16
Epoch 27, loss 3.91
Epoch 28, loss 4.08
Epoch 29, loss 4.09
Epoch 30, loss 3.92
Epoch 31, loss 3.83
Epoch 32, loss 3.90
Epoch 33, loss 3.98
Epoch 34, loss 3.66
Epoch 35, loss 3.87
Epoch 36, loss 3.70
Epoch 37, loss 3.81
Epoch 38, loss 3.75
Epoch 39, loss 3.64
Epoch 40, loss 3.86
Epoch 41, loss 3.82
Epoch 42, loss 3.65
Epoch 43, loss 3.56
Epoch 44, loss 3.58
Epoch 45, loss 3.71
Epoch 46, loss 3.56
Epoch 47, loss 3.62
Epoch 48, loss 3.36
Epoch 49, loss 3.53
**** Finished Training ****
Change in stitch weights: 2.861236572265625
Largest abs weight change: 0.12853969633579254
Number of weights changing > 0.1 of that: 3361
Change in stitch bias: 0.3195856809616089
Largest abs bias change: 0.06766463816165924
Number of bias changing > 0.1 of that: 57
Test the trained stitch
Test Accuracy: 99.46 %
Confusion Matrix
tensor([[ 975,    0,    1,    0,    0,    0,    2,    1,    1,    0],
        [   0, 1131,    1,    0,    0,    1,    1,    0,    1,    0],
        [   1,    0, 1030,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    1,    0,  978,    0,    1,    1,    0,    1],
        [   0,    0,    0,    1,    0,  889,    1,    0,    1,    0],
        [   2,    2,    0,    0,    1,    1,  952,    0,    0,    0],
        [   0,    1,    2,    1,    0,    0,    0, 1019,    1,    4],
        [   0,    0,    3,    0,    0,    2,    0,    1,  967,    1],
        [   1,    2,    0,    3,    4,    0,    0,    2,    2,  995]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bias8unbias-bias-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist-test.csv
stitch into model bias
Train the stitch after layer 8
Epoch 0, loss 199.56
Epoch 1, loss 107.29
Epoch 2, loss 81.73
Epoch 3, loss 67.80
Epoch 4, loss 57.45
Epoch 5, loss 49.93
Epoch 6, loss 44.11
Epoch 7, loss 39.37
Epoch 8, loss 35.87
Epoch 9, loss 32.53
Epoch 10, loss 30.10
Epoch 11, loss 27.62
Epoch 12, loss 25.75
Epoch 13, loss 24.18
Epoch 14, loss 22.66
Epoch 15, loss 21.53
Epoch 16, loss 20.51
Epoch 17, loss 19.78
Epoch 18, loss 18.85
Epoch 19, loss 18.44
Epoch 20, loss 17.67
Epoch 21, loss 17.30
Epoch 22, loss 16.83
Epoch 23, loss 16.41
Epoch 24, loss 16.13
Epoch 25, loss 15.76
Epoch 26, loss 15.41
Epoch 27, loss 15.20
Epoch 28, loss 14.97
Epoch 29, loss 14.58
Epoch 30, loss 14.31
Epoch 31, loss 14.17
Epoch 32, loss 13.90
Epoch 33, loss 13.52
Epoch 34, loss 13.44
Epoch 35, loss 13.33
Epoch 36, loss 13.04
Epoch 37, loss 12.91
Epoch 38, loss 12.74
Epoch 39, loss 12.62
Epoch 40, loss 12.42
Epoch 41, loss 12.21
Epoch 42, loss 12.14
Epoch 43, loss 11.99
Epoch 44, loss 11.98
Epoch 45, loss 11.83
Epoch 46, loss 11.77
Epoch 47, loss 11.55
Epoch 48, loss 11.57
Epoch 49, loss 11.45
**** Finished Training ****
Change in stitch weights: 5.195583343505859
Largest abs weight change: 0.17494690418243408
Number of weights changing > 0.1 of that: 11767
Change in stitch bias: 0.3121432662010193
Largest abs bias change: 0.04676879942417145
Number of bias changing > 0.1 of that: 119
Test the trained stitch
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    0,    1,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bias22unbias-bias-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist-test.csv
stitch into model bias
Train the stitch after layer 22
Epoch 0, loss 39.77
Epoch 1, loss 6.05
Epoch 2, loss 4.00
Epoch 3, loss 3.05
Epoch 4, loss 2.57
Epoch 5, loss 2.31
Epoch 6, loss 2.05
Epoch 7, loss 1.90
Epoch 8, loss 1.80
Epoch 9, loss 1.66
Epoch 10, loss 1.65
Epoch 11, loss 1.57
Epoch 12, loss 1.52
Epoch 13, loss 1.47
Epoch 14, loss 1.48
Epoch 15, loss 1.42
Epoch 16, loss 1.35
Epoch 17, loss 1.36
Epoch 18, loss 1.35
Epoch 19, loss 1.35
Epoch 20, loss 1.33
Epoch 21, loss 1.32
Epoch 22, loss 1.28
Epoch 23, loss 1.29
Epoch 24, loss 1.27
Epoch 25, loss 1.28
Epoch 26, loss 1.26
Epoch 27, loss 1.31
Epoch 28, loss 1.28
Epoch 29, loss 1.27
Epoch 30, loss 1.30
Epoch 31, loss 1.29
Epoch 32, loss 1.26
Epoch 33, loss 1.27
Epoch 34, loss 1.30
Epoch 35, loss 1.30
Epoch 36, loss 1.27
Epoch 37, loss 1.29
Epoch 38, loss 1.30
Epoch 39, loss 1.32
Epoch 40, loss 1.30
Epoch 41, loss 1.35
Epoch 42, loss 1.33
Epoch 43, loss 1.35
Epoch 44, loss 1.32
Epoch 45, loss 1.35
Epoch 46, loss 1.34
Epoch 47, loss 1.37
Epoch 48, loss 1.38
Epoch 49, loss 1.38
**** Finished Training ****
Change in stitch weights: 7.407066822052002
Largest abs weight change: 0.046528756618499756
Number of weights changing > 0.1 of that: 212657
Change in stitch bias: 0.3168424367904663
Largest abs bias change: 0.0240249615162611
Number of bias changing > 0.1 of that: 458
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bias29unbias-bias-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist-test.csv
stitch into model bias
Train the stitch after layer 29
Epoch 0, loss 52.01
Epoch 1, loss 8.29
Epoch 2, loss 5.30
Epoch 3, loss 4.16
Epoch 4, loss 3.54
Epoch 5, loss 3.10
Epoch 6, loss 2.76
Epoch 7, loss 2.65
Epoch 8, loss 2.43
Epoch 9, loss 2.29
Epoch 10, loss 2.20
Epoch 11, loss 2.13
Epoch 12, loss 2.01
Epoch 13, loss 1.97
Epoch 14, loss 1.96
Epoch 15, loss 1.88
Epoch 16, loss 1.89
Epoch 17, loss 1.82
Epoch 18, loss 1.81
Epoch 19, loss 1.80
Epoch 20, loss 1.77
Epoch 21, loss 1.75
Epoch 22, loss 1.74
Epoch 23, loss 1.71
Epoch 24, loss 1.74
Epoch 25, loss 1.70
Epoch 26, loss 1.75
Epoch 27, loss 1.74
Epoch 28, loss 1.74
Epoch 29, loss 1.75
Epoch 30, loss 1.76
Epoch 31, loss 1.77
Epoch 32, loss 1.81
Epoch 33, loss 1.80
Epoch 34, loss 1.85
Epoch 35, loss 1.86
Epoch 36, loss 1.86
Epoch 37, loss 1.88
Epoch 38, loss 1.88
Epoch 39, loss 1.90
Epoch 40, loss 1.90
Epoch 41, loss 1.94
Epoch 42, loss 1.97
Epoch 43, loss 1.92
Epoch 44, loss 1.96
Epoch 45, loss 2.01
Epoch 46, loss 2.07
Epoch 47, loss 2.04
Epoch 48, loss 2.03
Epoch 49, loss 2.06
**** Finished Training ****
Change in stitch weights: 7.423969745635986
Largest abs weight change: 0.055360592901706696
Number of weights changing > 0.1 of that: 202931
Change in stitch bias: 0.3089692294597626
Largest abs bias change: 0.024002909660339355
Number of bias changing > 0.1 of that: 461
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/bias35unbias-bias-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_biased_colour_mnist-test.csv
stitch into model bias
Train the stitch after layer 35
Epoch 0, loss 21.66
Epoch 1, loss 1.44
Epoch 2, loss 0.97
Epoch 3, loss 0.84
Epoch 4, loss 0.66
Epoch 5, loss 0.57
Epoch 6, loss 0.57
Epoch 7, loss 0.47
Epoch 8, loss 0.48
Epoch 9, loss 0.41
Epoch 10, loss 0.39
Epoch 11, loss 0.37
Epoch 12, loss 0.35
Epoch 13, loss 0.36
Epoch 14, loss 0.35
Epoch 15, loss 0.36
Epoch 16, loss 0.35
Epoch 17, loss 0.33
Epoch 18, loss 0.33
Epoch 19, loss 0.33
Epoch 20, loss 0.32
Epoch 21, loss 0.33
Epoch 22, loss 0.32
Epoch 23, loss 0.31
Epoch 24, loss 0.41
Epoch 25, loss 0.37
Epoch 26, loss 0.31
Epoch 27, loss 0.33
Epoch 28, loss 0.30
Epoch 29, loss 0.33
Epoch 30, loss 0.32
Epoch 31, loss 0.32
Epoch 32, loss 0.31
Epoch 33, loss 0.32
Epoch 34, loss 0.32
Epoch 35, loss 0.33
Epoch 36, loss 0.32
Epoch 37, loss 0.32
Epoch 38, loss 0.33
Epoch 39, loss 0.33
Epoch 40, loss 0.34
Epoch 41, loss 0.34
Epoch 42, loss 0.35
Epoch 43, loss 0.34
Epoch 44, loss 0.34
Epoch 45, loss 0.37
Epoch 46, loss 0.37
Epoch 47, loss 0.36
Epoch 48, loss 0.37
Epoch 49, loss 0.38
**** Finished Training ****
Change in stitch weights: 7.228487014770508
Largest abs weight change: 0.061142969876527786
Number of weights changing > 0.1 of that: 196053
Change in stitch bias: 0.3168269395828247
Largest abs bias change: 0.024031557142734528
Number of bias changing > 0.1 of that: 464
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/unbias1unbias-unbias-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist-test.csv
stitch into model unbias
Train the stitch after layer 1
Epoch 0, loss 16.47
Epoch 1, loss 12.69
Epoch 2, loss 10.70
Epoch 3, loss 10.38
Epoch 4, loss 10.23
Epoch 5, loss 9.44
Epoch 6, loss 9.24
Epoch 7, loss 9.21
Epoch 8, loss 9.08
Epoch 9, loss 8.78
Epoch 10, loss 8.52
Epoch 11, loss 8.31
Epoch 12, loss 8.38
Epoch 13, loss 8.36
Epoch 14, loss 8.39
Epoch 15, loss 7.86
Epoch 16, loss 8.12
Epoch 17, loss 8.11
Epoch 18, loss 7.65
Epoch 19, loss 7.36
Epoch 20, loss 7.67
Epoch 21, loss 7.55
Epoch 22, loss 7.40
Epoch 23, loss 7.52
Epoch 24, loss 7.21
Epoch 25, loss 7.10
Epoch 26, loss 7.28
Epoch 27, loss 7.22
Epoch 28, loss 7.14
Epoch 29, loss 7.13
Epoch 30, loss 6.98
Epoch 31, loss 6.75
Epoch 32, loss 6.78
Epoch 33, loss 6.85
Epoch 34, loss 6.78
Epoch 35, loss 6.80
Epoch 36, loss 6.79
Epoch 37, loss 6.50
Epoch 38, loss 6.67
Epoch 39, loss 6.49
Epoch 40, loss 6.82
Epoch 41, loss 6.92
Epoch 42, loss 6.52
Epoch 43, loss 6.18
Epoch 44, loss 6.39
Epoch 45, loss 6.36
Epoch 46, loss 6.56
Epoch 47, loss 6.43
Epoch 48, loss 6.70
Epoch 49, loss 6.31
**** Finished Training ****
Change in stitch weights: 2.775289535522461
Largest abs weight change: 0.12939715385437012
Number of weights changing > 0.1 of that: 3328
Change in stitch bias: 0.3156052529811859
Largest abs bias change: 0.06545991450548172
Number of bias changing > 0.1 of that: 55
Test the trained stitch
Test Accuracy: 98.89 %
Confusion Matrix
tensor([[ 975,    0,    0,    0,    0,    0,    2,    1,    2,    0],
        [   0, 1128,    1,    0,    0,    1,    1,    0,    4,    0],
        [   2,    0, 1025,    0,    1,    0,    0,    2,    2,    0],
        [   0,    0,    3,  997,    0,    4,    0,    2,    3,    1],
        [   0,    0,    1,    0,  972,    0,    4,    2,    0,    3],
        [   1,    0,    0,    7,    0,  876,    4,    1,    1,    2],
        [   2,    2,    0,    0,    3,    1,  949,    0,    1,    0],
        [   0,    1,    3,    2,    1,    0,    0, 1015,    1,    5],
        [   2,    0,    2,    3,    1,    3,    0,    2,  960,    1],
        [   1,    4,    0,    2,    4,    2,    0,    3,    1,  992]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/unbias8unbias-unbias-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist-test.csv
stitch into model unbias
Train the stitch after layer 8
Epoch 0, loss 125.55
Epoch 1, loss 39.52
Epoch 2, loss 31.41
Epoch 3, loss 27.88
Epoch 4, loss 25.61
Epoch 5, loss 23.83
Epoch 6, loss 22.67
Epoch 7, loss 22.22
Epoch 8, loss 21.40
Epoch 9, loss 20.83
Epoch 10, loss 20.37
Epoch 11, loss 20.09
Epoch 12, loss 19.68
Epoch 13, loss 19.17
Epoch 14, loss 19.01
Epoch 15, loss 18.66
Epoch 16, loss 18.81
Epoch 17, loss 18.66
Epoch 18, loss 18.78
Epoch 19, loss 18.32
Epoch 20, loss 18.39
Epoch 21, loss 18.22
Epoch 22, loss 18.36
Epoch 23, loss 18.23
Epoch 24, loss 18.12
Epoch 25, loss 18.04
Epoch 26, loss 18.12
Epoch 27, loss 17.78
Epoch 28, loss 17.96
Epoch 29, loss 17.82
Epoch 30, loss 17.91
Epoch 31, loss 17.79
Epoch 32, loss 17.71
Epoch 33, loss 17.58
Epoch 34, loss 17.78
Epoch 35, loss 17.68
Epoch 36, loss 17.77
Epoch 37, loss 17.54
Epoch 38, loss 17.65
Epoch 39, loss 17.64
Epoch 40, loss 17.51
Epoch 41, loss 17.42
Epoch 42, loss 17.60
Epoch 43, loss 17.50
Epoch 44, loss 17.45
Epoch 45, loss 17.42
Epoch 46, loss 17.58
Epoch 47, loss 17.51
Epoch 48, loss 17.52
Epoch 49, loss 17.58
**** Finished Training ****
Change in stitch weights: 4.575083255767822
Largest abs weight change: 0.13182872533798218
Number of weights changing > 0.1 of that: 12513
Change in stitch bias: 0.31683582067489624
Largest abs bias change: 0.04757876321673393
Number of bias changing > 0.1 of that: 116
Test the trained stitch
Test Accuracy: 98.72 %
Confusion Matrix
tensor([[ 972,    0,    2,    0,    0,    0,    3,    1,    2,    0],
        [   0, 1132,    1,    0,    0,    1,    0,    0,    1,    0],
        [   2,    0, 1028,    0,    0,    0,    0,    1,    1,    0],
        [   0,    0,    3,  991,    0,    6,    0,    3,    6,    1],
        [   0,    0,    0,    0,  972,    0,    5,    1,    1,    3],
        [   2,    0,    0,    5,    0,  877,    5,    1,    1,    1],
        [   3,    3,    0,    0,    3,    1,  947,    0,    1,    0],
        [   0,    2,    6,    0,    0,    0,    0, 1017,    0,    3],
        [   1,    1,    1,    2,    2,    3,    0,    4,  956,    4],
        [   2,    8,    0,    3,    9,    3,    0,    4,    0,  980]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/unbias22unbias-unbias-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist-test.csv
stitch into model unbias
Train the stitch after layer 22
Epoch 0, loss 78.92
Epoch 1, loss 27.17
Epoch 2, loss 20.29
Epoch 3, loss 16.98
Epoch 4, loss 14.54
Epoch 5, loss 12.66
Epoch 6, loss 11.66
Epoch 7, loss 10.43
Epoch 8, loss 9.77
Epoch 9, loss 9.10
Epoch 10, loss 8.50
Epoch 11, loss 8.10
Epoch 12, loss 7.73
Epoch 13, loss 7.21
Epoch 14, loss 6.96
Epoch 15, loss 6.72
Epoch 16, loss 6.50
Epoch 17, loss 6.28
Epoch 18, loss 6.11
Epoch 19, loss 5.83
Epoch 20, loss 5.78
Epoch 21, loss 5.78
Epoch 22, loss 5.62
Epoch 23, loss 5.48
Epoch 24, loss 5.41
Epoch 25, loss 5.28
Epoch 26, loss 5.24
Epoch 27, loss 5.20
Epoch 28, loss 5.18
Epoch 29, loss 5.19
Epoch 30, loss 5.25
Epoch 31, loss 5.05
Epoch 32, loss 5.09
Epoch 33, loss 5.08
Epoch 34, loss 5.09
Epoch 35, loss 5.10
Epoch 36, loss 5.03
Epoch 37, loss 4.98
Epoch 38, loss 4.97
Epoch 39, loss 5.03
Epoch 40, loss 5.03
Epoch 41, loss 5.06
Epoch 42, loss 5.04
Epoch 43, loss 5.02
Epoch 44, loss 5.06
Epoch 45, loss 5.10
Epoch 46, loss 5.06
Epoch 47, loss 5.12
Epoch 48, loss 4.98
Epoch 49, loss 5.09
**** Finished Training ****
Change in stitch weights: 7.827157974243164
Largest abs weight change: 0.0438421368598938
Number of weights changing > 0.1 of that: 216380
Change in stitch bias: 0.3217138946056366
Largest abs bias change: 0.024028610438108444
Number of bias changing > 0.1 of that: 461
Test the trained stitch
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    1,    0,    0,    1,    0, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/unbias29unbias-unbias-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist-test.csv
stitch into model unbias
Train the stitch after layer 29
Epoch 0, loss 91.67
Epoch 1, loss 24.50
Epoch 2, loss 18.94
Epoch 3, loss 16.05
Epoch 4, loss 14.48
Epoch 5, loss 13.12
Epoch 6, loss 12.06
Epoch 7, loss 11.34
Epoch 8, loss 10.66
Epoch 9, loss 10.33
Epoch 10, loss 9.93
Epoch 11, loss 9.20
Epoch 12, loss 8.79
Epoch 13, loss 8.76
Epoch 14, loss 8.63
Epoch 15, loss 8.29
Epoch 16, loss 8.03
Epoch 17, loss 7.78
Epoch 18, loss 7.72
Epoch 19, loss 7.50
Epoch 20, loss 7.37
Epoch 21, loss 7.28
Epoch 22, loss 7.13
Epoch 23, loss 6.84
Epoch 24, loss 7.16
Epoch 25, loss 6.99
Epoch 26, loss 6.95
Epoch 27, loss 6.67
Epoch 28, loss 6.68
Epoch 29, loss 6.64
Epoch 30, loss 6.53
Epoch 31, loss 6.57
Epoch 32, loss 6.46
Epoch 33, loss 6.48
Epoch 34, loss 6.41
Epoch 35, loss 6.36
Epoch 36, loss 6.51
Epoch 37, loss 6.38
Epoch 38, loss 6.48
Epoch 39, loss 6.42
Epoch 40, loss 6.18
Epoch 41, loss 6.32
Epoch 42, loss 6.33
Epoch 43, loss 6.25
Epoch 44, loss 6.25
Epoch 45, loss 6.54
Epoch 46, loss 6.38
Epoch 47, loss 6.45
Epoch 48, loss 6.49
Epoch 49, loss 6.53
**** Finished Training ****
Change in stitch weights: 7.821218967437744
Largest abs weight change: 0.05420440807938576
Number of weights changing > 0.1 of that: 206249
Change in stitch bias: 0.3077368438243866
Largest abs bias change: 0.024005457758903503
Number of bias changing > 0.1 of that: 463
Test the trained stitch
Test Accuracy: 99.71 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    0,    1,    1,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1006,    0,    1,    0,    1,    2,    0],
        [   0,    0,    0,    0,  979,    0,    0,    0,    0,    3],
        [   1,    0,    0,    0,    0,  890,    1,    0,    0,    0],
        [   0,    2,    0,    0,    1,    0,  955,    0,    0,    0],
        [   0,    0,    3,    0,    1,    0,    0, 1023,    0,    1],
        [   0,    0,    0,    0,    0,    0,    0,    1,  973,    0],
        [   0,    0,    0,    1,    4,    2,    0,    2,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2j_rank/unbias35unbias-unbias-789_2024-08-13_23-21-37_SEED105_EPOCHS50_BGN0.1_exp1g_VGG19_unbiased_colour_mnist-test.csv
stitch into model unbias
Train the stitch after layer 35
Epoch 0, loss 34.12
Epoch 1, loss 10.76
Epoch 2, loss 9.96
Epoch 3, loss 9.17
Epoch 4, loss 8.89
Epoch 5, loss 8.30
Epoch 6, loss 7.80
Epoch 7, loss 7.36
Epoch 8, loss 7.25
Epoch 9, loss 6.81
Epoch 10, loss 6.62
Epoch 11, loss 6.77
Epoch 12, loss 6.06
Epoch 13, loss 5.90
Epoch 14, loss 5.77
Epoch 15, loss 5.76
Epoch 16, loss 5.63
Epoch 17, loss 5.73
Epoch 18, loss 5.46
Epoch 19, loss 5.34
Epoch 20, loss 5.48
Epoch 21, loss 5.17
Epoch 22, loss 5.16
Epoch 23, loss 5.18
Epoch 24, loss 4.90
Epoch 25, loss 4.88
Epoch 26, loss 4.52
Epoch 27, loss 4.52
Epoch 28, loss 4.46
Epoch 29, loss 4.55
Epoch 30, loss 4.11
Epoch 31, loss 4.46
Epoch 32, loss 4.48
Epoch 33, loss 4.44
Epoch 34, loss 4.38
Epoch 35, loss 4.27
Epoch 36, loss 4.54
Epoch 37, loss 4.07
Epoch 38, loss 3.89
Epoch 39, loss 4.09
Epoch 40, loss 4.09
Epoch 41, loss 4.26
Epoch 42, loss 3.75
Epoch 43, loss 3.78
Epoch 44, loss 3.91
Epoch 45, loss 3.93
Epoch 46, loss 3.86
Epoch 47, loss 3.82
Epoch 48, loss 3.84
Epoch 49, loss 3.87
**** Finished Training ****
Change in stitch weights: 7.4341206550598145
Largest abs weight change: 0.04570038616657257
Number of weights changing > 0.1 of that: 213677
Change in stitch bias: 0.31482720375061035
Largest abs bias change: 0.023995548486709595
Number of bias changing > 0.1 of that: 458
Test the trained stitch
Test Accuracy: 99.76 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    1,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1006,    0,    1,    0,    0,    3,    0],
        [   0,    0,    0,    0,  978,    0,    0,    0,    0,    4],
        [   0,    0,    0,    2,    0,  889,    1,    0,    0,    0],
        [   1,    1,    0,    0,    0,    0,  956,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1027,    0,    1],
        [   0,    0,    0,    0,    0,    1,    0,    1,  971,    1],
        [   0,    0,    0,    0,    5,    0,    0,    1,    0, 1003]],
       dtype=torch.int32)
===================================================================
stitching_accuracies={'bw': {1: 99.27, 8: 99.44, 22: 99.97, 29: 99.76, 35: 99.71}, 'mix': {1: 98.53, 8: 99.88, 22: 100.0, 29: 99.85, 35: 99.79}, 'bgonly': {1: 99.93, 8: 100.0, 22: 100.0, 29: 100.0, 35: 100.0}, 'bg': {1: 98.48, 8: 100.0, 22: 100.0, 29: 100.0, 35: 100.0}, 'bias': {1: 99.46, 8: 99.99, 22: 100.0, 29: 100.0, 35: 100.0}, 'unbias': {1: 98.89, 8: 98.72, 22: 99.98, 29: 99.71, 35: 99.76}}
stitching_penalties={'bw': {1: -0.519999999999996, 8: -0.6899999999999977, 22: -1.2199999999999989, 29: -1.0100000000000051, 35: -0.9599999999999937}, 'mix': {1: 0.9099999999999966, 8: -0.4399999999999977, 22: -0.5600000000000023, 29: -0.4099999999999966, 35: -0.3500000000000085}, 'bgonly': {1: 0.06999999999999318, 8: 0.0, 22: 0.0, 29: 0.0, 35: 0.0}, 'bg': {1: 1.519999999999996, 8: 0.0, 22: 0.0, 29: 0.0, 35: 0.0}, 'bias': {1: 0.5400000000000063, 8: 0.010000000000005116, 22: 0.0, 29: 0.0, 35: 0.0}, 'unbias': {1: -0.7600000000000051, 8: -0.5900000000000034, 22: -1.8500000000000085, 29: -1.5799999999999983, 35: -1.6300000000000097}}
bw
98.75
Stitch Accuracy
layer=1 99.27
layer=8 99.44
layer=22 99.97
layer=29 99.76
layer=35 99.71
--------------------------
mix
99.44
Stitch Accuracy
layer=1 98.53
layer=8 99.88
layer=22 100.0
layer=29 99.85
layer=35 99.79
--------------------------
bgonly
100.0
Stitch Accuracy
layer=1 99.93
layer=8 100.0
layer=22 100.0
layer=29 100.0
layer=35 100.0
--------------------------
bg
100.0
Stitch Accuracy
layer=1 98.48
layer=8 100.0
layer=22 100.0
layer=29 100.0
layer=35 100.0
--------------------------
bias
100.0
Stitch Accuracy
layer=1 99.46
layer=8 99.99
layer=22 100.0
layer=29 100.0
layer=35 100.0
--------------------------
unbias
98.13
Stitch Accuracy
layer=1 98.89
layer=8 98.72
layer=22 99.98
layer=29 99.71
layer=35 99.76
--------------------------
