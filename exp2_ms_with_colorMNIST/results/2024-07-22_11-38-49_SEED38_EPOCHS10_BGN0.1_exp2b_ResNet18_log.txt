Executed at 2024-07-22_11-38-49
seed=38
bg_noise=0.1
train_bg_only_colour_mnist_model=True
save_bg_only_colour_mnist_model_as='./results/2024-07-22_11-38-49_SEED38_EPOCHS10_BGN0.1_exp2b_ResNet18_bg_only_colour_mnist.weights'
original_train_epochs=10
train_bg_unbiased_colour_mnist_model=False
bg_unbiased_colour_mnist_model_to_load='results/2024-07-20_11-32-04_SEED38_EPOCHS10_BGN0.1_exp2b_ResNet18_bg_unbiased_colour_mnist.weights'
train_biased_colour_mnist_model=False
biased_colour_mnist_model_to_load='results/2024-07-20_11-32-04_SEED38_EPOCHS10_BGN0.1_exp2b_ResNet18_biased_colour_mnist.weights'
train_unbiased_colour_mnist_model=False
unbiased_colour_mnist_model_to_load='results/2024-07-20_11-32-04_SEED38_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist.weights'
train_stitch=True
stitch_train_epochs=10
================================================
Train ResNet18 on bg_only_colour
Epoch 0, loss 79.17
Epoch 1, loss 4.83
Epoch 2, loss 4.47
Epoch 3, loss 2.57
Epoch 4, loss 1.72
Epoch 5, loss 1.51
Epoch 6, loss 2.24
Epoch 7, loss 0.18
Epoch 8, loss 0.50
Epoch 9, loss 0.65
**** Finished Training ****
saveas='./results/2024-07-22_11-38-49_SEED38_EPOCHS10_BGN0.1_exp2b_ResNet18_bg_only_colour_mnist.weights'
val['loadfrom']='results/2024-07-20_11-32-04_SEED38_EPOCHS10_BGN0.1_exp2b_ResNet18_bg_unbiased_colour_mnist.weights'
val['loadfrom']='results/2024-07-20_11-32-04_SEED38_EPOCHS10_BGN0.1_exp2b_ResNet18_biased_colour_mnist.weights'
val['loadfrom']='results/2024-07-20_11-32-04_SEED38_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist.weights'
Accuracy Calculation for ResNet18 with key='bg_only_colour'
Test the Trained Resnet18
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bg_unbiased_colour'
Test the Trained Resnet18
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  993,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1004,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  995,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  996,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1003,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  996,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='biased_colour'
Test the Trained Resnet18
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='unbiased_colour'
Test the Trained Resnet18
Test Accuracy: 98.56 %
Confusion Matrix
tensor([[ 978,    1,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1126,    1,    1,    2,    0,    2,    1,    2,    0],
        [   2,    0, 1024,    0,    2,    0,    0,    3,    1,    0],
        [   2,    1,    5,  990,    0,    3,    0,    2,    5,    2],
        [   0,    0,    0,    0,  979,    0,    0,    0,    0,    3],
        [   3,    0,    0,    8,    0,  876,    3,    0,    2,    0],
        [   4,    2,    0,    0,    6,    2,  944,    0,    0,    0],
        [   0,    1,    7,    0,    3,    0,    0, 1015,    1,    1],
        [   9,    1,    3,    2,    5,    1,    3,    0,  948,    2],
        [   2,    4,    2,    2,   11,    0,    0,    7,    5,  976]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'bg_only_colour': 100.0, 'bg_unbiased_colour': 100.0, 'biased_colour': 100.0, 'unbiased_colour': 98.56}
Train the stitch to a model stitched after layer 3 from bg_only_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 404.79
Epoch 1, loss 3.74
Epoch 2, loss 3.44
Epoch 3, loss 2.94
Epoch 4, loss 3.85
Epoch 5, loss 2.65
Epoch 6, loss 2.16
Epoch 7, loss 2.21
Epoch 8, loss 1.72
Epoch 9, loss 3.03
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 4 from bg_only_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 454.28
Epoch 1, loss 137.08
Epoch 2, loss 12.27
Epoch 3, loss 3.46
Epoch 4, loss 2.56
Epoch 5, loss 1.95
Epoch 6, loss 2.03
Epoch 7, loss 1.55
Epoch 8, loss 1.63
Epoch 9, loss 24.01
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 5 from bg_only_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 90.83
Epoch 1, loss 1.55
Epoch 2, loss 1.26
Epoch 3, loss 1.10
Epoch 4, loss 1.01
Epoch 5, loss 0.98
Epoch 6, loss 0.80
Epoch 7, loss 0.70
Epoch 8, loss 0.70
Epoch 9, loss 0.60
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 6 from bg_only_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 62.35
Epoch 1, loss 2.15
Epoch 2, loss 1.79
Epoch 3, loss 1.42
Epoch 4, loss 1.30
Epoch 5, loss 0.99
Epoch 6, loss 1.00
Epoch 7, loss 0.87
Epoch 8, loss 0.83
Epoch 9, loss 0.75
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 7 from bg_only_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 44.82
Epoch 1, loss 1.65
Epoch 2, loss 1.26
Epoch 3, loss 1.03
Epoch 4, loss 0.78
Epoch 5, loss 0.62
Epoch 6, loss 0.68
Epoch 7, loss 0.58
Epoch 8, loss 0.66
Epoch 9, loss 0.65
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 8 from bg_only_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 45.07
Epoch 1, loss 1.83
Epoch 2, loss 1.45
Epoch 3, loss 1.05
Epoch 4, loss 0.89
Epoch 5, loss 0.88
Epoch 6, loss 1.03
Epoch 7, loss 0.71
Epoch 8, loss 0.59
Epoch 9, loss 0.53
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 3 from bg_only_colour to bg_unbiased_colour
Use the data loader (train and test) that bg_unbiased_colour was trained on
Epoch 0, loss 160.90
Epoch 1, loss 4.14
Epoch 2, loss 3.38
Epoch 3, loss 2.88
Epoch 4, loss 2.44
Epoch 5, loss 2.21
Epoch 6, loss 2.33
Epoch 7, loss 1.39
Epoch 8, loss 1.47
Epoch 9, loss 1.84
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  993,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1004,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  995,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  996,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1003,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  996,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 4 from bg_only_colour to bg_unbiased_colour
Use the data loader (train and test) that bg_unbiased_colour was trained on
Epoch 0, loss 310.04
Epoch 1, loss 10.22
Epoch 2, loss 7.27
Epoch 3, loss 6.36
Epoch 4, loss 6.16
Epoch 5, loss 4.77
Epoch 6, loss 3.89
Epoch 7, loss 3.66
Epoch 8, loss 3.33
Epoch 9, loss 3.40
**** Finished Training ****
Test the trained stitch
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[1003,    0,    0,    0,    0,    0,    1,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  992,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1004,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  995,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  996,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1003,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  996,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 5 from bg_only_colour to bg_unbiased_colour
Use the data loader (train and test) that bg_unbiased_colour was trained on
Epoch 0, loss 171.74
Epoch 1, loss 21.24
Epoch 2, loss 15.08
Epoch 3, loss 13.64
Epoch 4, loss 11.14
Epoch 5, loss 11.14
Epoch 6, loss 8.08
Epoch 7, loss 7.54
Epoch 8, loss 6.25
Epoch 9, loss 5.60
**** Finished Training ****
Test the trained stitch
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[1002,    0,    0,    0,    0,    0,    2,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  993,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1004,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  995,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  996,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1003,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  996,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 6 from bg_only_colour to bg_unbiased_colour
Use the data loader (train and test) that bg_unbiased_colour was trained on
Epoch 0, loss 164.78
Epoch 1, loss 12.11
Epoch 2, loss 8.75
Epoch 3, loss 7.40
Epoch 4, loss 6.70
Epoch 5, loss 6.84
Epoch 6, loss 6.28
Epoch 7, loss 5.84
Epoch 8, loss 5.07
Epoch 9, loss 4.89
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  993,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1004,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  995,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  996,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1003,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1003,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  996,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 7 from bg_only_colour to bg_unbiased_colour
Use the data loader (train and test) that bg_unbiased_colour was trained on
Epoch 0, loss 56.32
Epoch 1, loss 15.32
Epoch 2, loss 12.58
Epoch 3, loss 10.88
Epoch 4, loss 9.97
Epoch 5, loss 9.17
Epoch 6, loss 8.74
Epoch 7, loss 8.43
Epoch 8, loss 8.32
Epoch 9, loss 7.16
**** Finished Training ****
Test the trained stitch
Test Accuracy: 99.94 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  993,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1003,    0,    0,    1,    0,    0,    0],
        [   0,    0,    0,    0,  994,    0,    0,    1,    0,    0],
        [   0,    0,    0,    0,    0,  996,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1003,    0,    0,    0],
        [   0,    0,    0,    0,    4,    0,    0,  999,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  996,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 8 from bg_only_colour to bg_unbiased_colour
Use the data loader (train and test) that bg_unbiased_colour was trained on
Epoch 0, loss 53.50
Epoch 1, loss 15.10
Epoch 2, loss 11.52
Epoch 3, loss 10.97
Epoch 4, loss 10.26
Epoch 5, loss 9.25
Epoch 6, loss 8.71
Epoch 7, loss 8.39
Epoch 8, loss 7.75
Epoch 9, loss 7.67
**** Finished Training ****
Test the trained stitch
Test Accuracy: 99.90 %
Confusion Matrix
tensor([[1004,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  993,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1004,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  987,    0,    0,    8,    0,    0],
        [   0,    0,    0,    0,    0,  996,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0, 1003,    0,    0,    0],
        [   0,    0,    0,    0,    2,    0,    0, 1001,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  996,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 3 from bg_only_colour to biased_colour
Use the data loader (train and test) that biased_colour was trained on
Epoch 0, loss 114.36
Epoch 1, loss 4.11
Epoch 2, loss 2.91
Epoch 3, loss 3.50
Epoch 4, loss 2.15
Epoch 5, loss 2.37
Epoch 6, loss 2.32
Epoch 7, loss 1.79
Epoch 8, loss 1.74
Epoch 9, loss 1.62
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 4 from bg_only_colour to biased_colour
Use the data loader (train and test) that biased_colour was trained on
Epoch 0, loss 798.77
Epoch 1, loss 8.84
Epoch 2, loss 6.20
Epoch 3, loss 5.82
Epoch 4, loss 4.64
Epoch 5, loss 4.25
Epoch 6, loss 4.50
Epoch 7, loss 3.37
Epoch 8, loss 3.59
Epoch 9, loss 3.54
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 5 from bg_only_colour to biased_colour
Use the data loader (train and test) that biased_colour was trained on
Epoch 0, loss 206.84
Epoch 1, loss 8.75
Epoch 2, loss 6.87
Epoch 3, loss 6.89
Epoch 4, loss 4.86
Epoch 5, loss 4.75
Epoch 6, loss 4.17
Epoch 7, loss 4.18
Epoch 8, loss 3.64
Epoch 9, loss 3.43
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 6 from bg_only_colour to biased_colour
Use the data loader (train and test) that biased_colour was trained on
Epoch 0, loss 171.31
Epoch 1, loss 10.55
Epoch 2, loss 8.40
Epoch 3, loss 6.57
Epoch 4, loss 5.47
Epoch 5, loss 4.76
Epoch 6, loss 4.59
Epoch 7, loss 4.30
Epoch 8, loss 4.15
Epoch 9, loss 3.96
**** Finished Training ****
Test the trained stitch
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    2,    0,    0, 1026,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 7 from bg_only_colour to biased_colour
Use the data loader (train and test) that biased_colour was trained on
Epoch 0, loss 51.10
Epoch 1, loss 11.03
Epoch 2, loss 8.85
Epoch 3, loss 7.72
Epoch 4, loss 7.26
Epoch 5, loss 6.49
Epoch 6, loss 6.12
Epoch 7, loss 5.81
Epoch 8, loss 5.77
Epoch 9, loss 5.96
**** Finished Training ****
Test the trained stitch
Test Accuracy: 99.96 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    4,    0,    0, 1024,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 8 from bg_only_colour to biased_colour
Use the data loader (train and test) that biased_colour was trained on
Epoch 0, loss 44.92
Epoch 1, loss 9.63
Epoch 2, loss 7.82
Epoch 3, loss 6.95
Epoch 4, loss 6.94
Epoch 5, loss 6.27
Epoch 6, loss 6.35
Epoch 7, loss 6.06
Epoch 8, loss 4.95
Epoch 9, loss 4.98
**** Finished Training ****
Test the trained stitch
Test Accuracy: 99.89 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,   11,    0,    0, 1017,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 3 from bg_only_colour to unbiased_colour
Use the data loader (train and test) that unbiased_colour was trained on
Epoch 0, loss 987.93
Epoch 1, loss 496.25
Epoch 2, loss 402.78
Epoch 3, loss 356.39
Epoch 4, loss 329.86
Epoch 5, loss 311.25
Epoch 6, loss 301.11
Epoch 7, loss 284.89
Epoch 8, loss 276.06
Epoch 9, loss 263.83
**** Finished Training ****
Test the trained stitch
Test Accuracy: 85.29 %
Confusion Matrix
tensor([[ 884,    2,   18,    6,    1,   23,   26,   11,    6,    3],
        [   0, 1101,    7,    3,    5,    1,    2,    5,   10,    1],
        [   6,   12,  890,   11,   24,    3,   21,   28,   35,    2],
        [   4,   32,   26,  822,    5,   36,    1,   33,   22,   29],
        [   0,    6,    2,    1,  866,    2,   11,   12,    5,   77],
        [   6,    8,    4,   52,   17,  676,   33,   15,   27,   54],
        [   5,    4,    3,    1,   45,   23,  854,    1,   21,    1],
        [   1,   38,   13,    7,   17,   16,    0,  875,   12,   49],
        [  20,   21,    6,   28,   14,   37,   15,   19,  780,   34],
        [   7,   11,    1,    4,  118,   10,    0,   63,   14,  781]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 4 from bg_only_colour to unbiased_colour
Use the data loader (train and test) that unbiased_colour was trained on
Epoch 0, loss 1253.20
Epoch 1, loss 814.22
Epoch 2, loss 653.89
Epoch 3, loss 567.81
Epoch 4, loss 524.08
Epoch 5, loss 483.52
Epoch 6, loss 456.38
Epoch 7, loss 431.70
Epoch 8, loss 417.56
Epoch 9, loss 396.48
**** Finished Training ****
Test the trained stitch
Test Accuracy: 79.24 %
Confusion Matrix
tensor([[ 809,   11,   33,    5,    2,   32,   46,    8,   26,    8],
        [   0, 1066,   10,   23,    2,    6,    1,    9,   17,    1],
        [   6,   25,  856,   32,   36,    9,   24,   12,   30,    2],
        [   5,   34,   50,  792,    8,   13,    2,   23,   47,   36],
        [   1,   12,    4,    3,  798,    4,   22,    9,   15,  114],
        [  19,   34,   10,   81,   31,  534,   40,   33,   74,   36],
        [  12,   15,   19,    3,   56,   12,  814,    0,   23,    4],
        [   3,   56,   20,   37,   20,   13,    3,  791,   16,   69],
        [  12,   27,   13,   61,   14,   22,   12,   32,  762,   19],
        [   4,   15,    3,   10,  137,    6,    5,   66,   61,  702]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 5 from bg_only_colour to unbiased_colour
Use the data loader (train and test) that unbiased_colour was trained on
Epoch 0, loss 1206.27
Epoch 1, loss 916.07
Epoch 2, loss 792.42
Epoch 3, loss 720.93
Epoch 4, loss 670.39
Epoch 5, loss 637.16
Epoch 6, loss 602.43
Epoch 7, loss 578.19
Epoch 8, loss 555.39
Epoch 9, loss 531.75
**** Finished Training ****
Test the trained stitch
Test Accuracy: 68.19 %
Confusion Matrix
tensor([[ 719,   22,   29,   28,    5,   72,   22,   30,   44,    9],
        [   1, 1031,   12,   28,   16,    6,    1,   27,   11,    2],
        [  30,   53,  648,   72,   62,   14,   42,   29,   72,   10],
        [   9,   65,   64,  667,    6,   26,    1,   79,   72,   21],
        [   5,   27,   15,    1,  720,    8,   30,   21,   22,  133],
        [  53,   58,   21,   63,   41,  362,   38,   88,  113,   55],
        [  24,   26,   71,    1,  140,    8,  671,    0,   13,    4],
        [   3,  111,   11,   36,   28,    8,    1,  728,   23,   79],
        [  31,   21,   24,   66,   20,   37,   22,   63,  647,   43],
        [   3,   35,    5,   13,  123,    9,    1,  120,   74,  626]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 6 from bg_only_colour to unbiased_colour
Use the data loader (train and test) that unbiased_colour was trained on
Epoch 0, loss 1288.97
Epoch 1, loss 1025.22
Epoch 2, loss 933.86
Epoch 3, loss 877.95
Epoch 4, loss 841.04
Epoch 5, loss 813.37
Epoch 6, loss 786.91
Epoch 7, loss 762.75
Epoch 8, loss 743.16
Epoch 9, loss 728.65
**** Finished Training ****
Test the trained stitch
Test Accuracy: 48.79 %
Confusion Matrix
tensor([[631,  22,  19,  71,   2, 110,  26,  51,  29,  19],
        [  2, 948,   8,  17,  25,  18,  19,  59,  31,   8],
        [ 65,  64, 301,  87, 104,  37, 209,  42,  87,  36],
        [ 55,  86,  70, 320,  56,  75,  37, 135, 116,  60],
        [  7,  58,   1,  19, 573,  13,  65,  80,  36, 130],
        [ 85, 109,  35, 142,  53, 229,  43,  93,  54,  49],
        [ 29,  49,  92,  45, 114,  22, 510,  20,  49,  28],
        [  1, 114,   1,  43,  65,  41,   5, 614,  32, 112],
        [ 58,  32,  39, 107,  82,  55,  53,  37, 446,  65],
        [ 11,  47,   1,  43, 326,  21,   8, 183,  62, 307]], dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 7 from bg_only_colour to unbiased_colour
Use the data loader (train and test) that unbiased_colour was trained on
Epoch 0, loss 1100.63
Epoch 1, loss 1051.46
Epoch 2, loss 1040.46
Epoch 3, loss 1033.08
Epoch 4, loss 1026.91
Epoch 5, loss 1023.08
Epoch 6, loss 1020.12
Epoch 7, loss 1016.74
Epoch 8, loss 1014.82
Epoch 9, loss 1011.76
**** Finished Training ****
Test the trained stitch
Test Accuracy: 22.28 %
Confusion Matrix
tensor([[341, 110, 132,  74,  42,   3,  21,  70, 124,  63],
        [  1, 911,  39,  13,  40,   3,  13,  67,  15,  33],
        [139, 162, 216,  80,  59,   4,  67,  67, 160,  78],
        [106, 205, 157,  95,  64,   4,  68, 106, 135,  70],
        [ 79, 228, 133,  62,  76,   1,  61, 102, 117, 123],
        [158, 220, 107,  78,  59,   7,  25,  70,  82,  86],
        [129, 149, 179,  63,  69,   1,  75,  35, 182,  76],
        [ 49, 390, 113,  60,  67,   1,  39, 158,  55,  96],
        [179,  88, 169,  82,  44,   2,  58,  39, 220,  93],
        [110, 194, 139,  81,  83,   4,  65,  85, 119, 129]], dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 8 from bg_only_colour to unbiased_colour
Use the data loader (train and test) that unbiased_colour was trained on
Epoch 0, loss 1111.67
Epoch 1, loss 1054.14
Epoch 2, loss 1040.56
Epoch 3, loss 1034.59
Epoch 4, loss 1028.87
Epoch 5, loss 1025.48
Epoch 6, loss 1020.91
Epoch 7, loss 1017.71
Epoch 8, loss 1015.53
Epoch 9, loss 1013.17
**** Finished Training ****
Test the trained stitch
Test Accuracy: 22.57 %
Confusion Matrix
tensor([[280, 105, 124,  68,  35,  58,   4,  48, 178,  80],
        [  4, 911,  20,  12,  29,  16,   1,  52,  35,  55],
        [122, 144, 191,  80,  57,  25,  26,  53, 228, 106],
        [ 94, 170, 125, 103,  49,  39,  18,  83, 185, 144],
        [ 65, 213,  96,  83,  69,  48,  19,  78, 150, 161],
        [122, 210,  72,  81,  60,  36,  11,  71, 117, 112],
        [ 99, 131, 149,  57,  63,  25,  37,  27, 240, 130],
        [ 51, 367,  66,  68,  70,  43,   6, 128, 103, 126],
        [132,  73, 140,  77,  45,  27,  23,  27, 300, 130],
        [ 74, 183,  87,  86,  79,  49,  11,  55, 183, 202]], dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 3 from bg_unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 3152.51
Epoch 1, loss 6.24
Epoch 2, loss 5.34
Epoch 3, loss 5.36
Epoch 4, loss 3.30
Epoch 5, loss 3.23
Epoch 6, loss 2.26
Epoch 7, loss 3.77
Epoch 8, loss 2.74
Epoch 9, loss 1.97
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 4 from bg_unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 1422.71
Epoch 1, loss 74.52
Epoch 2, loss 6.08
Epoch 3, loss 6.25
Epoch 4, loss 5.35
Epoch 5, loss 4.29
Epoch 6, loss 3.17
Epoch 7, loss 5.17
Epoch 8, loss 2.88
Epoch 9, loss 4.73
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 5 from bg_unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 196.95
Epoch 1, loss 7.80
Epoch 2, loss 4.80
Epoch 3, loss 5.23
Epoch 4, loss 4.08
Epoch 5, loss 3.67
Epoch 6, loss 3.91
Epoch 7, loss 4.16
Epoch 8, loss 2.20
Epoch 9, loss 2.53
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 6 from bg_unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 253.90
Epoch 1, loss 4.89
Epoch 2, loss 3.89
Epoch 3, loss 3.02
Epoch 4, loss 3.20
Epoch 5, loss 3.11
Epoch 6, loss 2.90
Epoch 7, loss 2.01
Epoch 8, loss 1.79
Epoch 9, loss 1.91
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 7 from bg_unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 65.60
Epoch 1, loss 4.40
Epoch 2, loss 3.15
Epoch 3, loss 2.71
Epoch 4, loss 2.47
Epoch 5, loss 2.19
Epoch 6, loss 2.79
Epoch 7, loss 1.85
Epoch 8, loss 1.68
Epoch 9, loss 1.45
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 8 from bg_unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 32.60
Epoch 1, loss 3.59
Epoch 2, loss 2.69
Epoch 3, loss 2.44
Epoch 4, loss 2.03
Epoch 5, loss 1.98
Epoch 6, loss 1.94
Epoch 7, loss 1.51
Epoch 8, loss 1.38
Epoch 9, loss 1.38
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Other models have been stitched, just run stitches involving new bg_only_colour model
Other models have been stitched, just run stitches involving new bg_only_colour model
Other models have been stitched, just run stitches involving new bg_only_colour model
Train the stitch to a model stitched after layer 3 from biased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 2167.26
Epoch 1, loss 5.02
Epoch 2, loss 4.88
Epoch 3, loss 3.58
Epoch 4, loss 2.76
Epoch 5, loss 3.09
Epoch 6, loss 2.45
Epoch 7, loss 3.66
Epoch 8, loss 1.93
Epoch 9, loss 2.31
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 4 from biased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 86.99
Epoch 1, loss 5.12
Epoch 2, loss 3.69
Epoch 3, loss 3.04
Epoch 4, loss 3.03
Epoch 5, loss 2.73
Epoch 6, loss 3.00
Epoch 7, loss 2.46
Epoch 8, loss 2.13
Epoch 9, loss 2.38
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 5 from biased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 778.66
Epoch 1, loss 8.79
Epoch 2, loss 9.27
Epoch 3, loss 5.71
Epoch 4, loss 3.86
Epoch 5, loss 3.67
Epoch 6, loss 3.36
Epoch 7, loss 4.19
Epoch 8, loss 2.78
Epoch 9, loss 2.72
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 6 from biased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 161.45
Epoch 1, loss 9.54
Epoch 2, loss 7.06
Epoch 3, loss 5.71
Epoch 4, loss 4.38
Epoch 5, loss 5.13
Epoch 6, loss 3.80
Epoch 7, loss 4.04
Epoch 8, loss 2.72
Epoch 9, loss 3.05
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 7 from biased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 55.81
Epoch 1, loss 6.51
Epoch 2, loss 5.41
Epoch 3, loss 4.61
Epoch 4, loss 3.74
Epoch 5, loss 3.08
Epoch 6, loss 3.23
Epoch 7, loss 2.82
Epoch 8, loss 2.79
Epoch 9, loss 2.84
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 8 from biased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 39.20
Epoch 1, loss 6.22
Epoch 2, loss 4.93
Epoch 3, loss 3.94
Epoch 4, loss 3.38
Epoch 5, loss 3.00
Epoch 6, loss 3.24
Epoch 7, loss 2.87
Epoch 8, loss 2.65
Epoch 9, loss 2.53
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Other models have been stitched, just run stitches involving new bg_only_colour model
Other models have been stitched, just run stitches involving new bg_only_colour model
Other models have been stitched, just run stitches involving new bg_only_colour model
Train the stitch to a model stitched after layer 3 from unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 969.52
Epoch 1, loss 128.57
Epoch 2, loss 8.70
Epoch 3, loss 4.39
Epoch 4, loss 3.96
Epoch 5, loss 2.61
Epoch 6, loss 3.39
Epoch 7, loss 2.66
Epoch 8, loss 1.78
Epoch 9, loss 2.05
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 4 from unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 2636.41
Epoch 1, loss 9.26
Epoch 2, loss 5.04
Epoch 3, loss 4.26
Epoch 4, loss 2.74
Epoch 5, loss 4.05
Epoch 6, loss 2.76
Epoch 7, loss 2.10
Epoch 8, loss 2.09
Epoch 9, loss 1.87
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 5 from unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 220.78
Epoch 1, loss 14.21
Epoch 2, loss 8.70
Epoch 3, loss 6.30
Epoch 4, loss 5.41
Epoch 5, loss 4.63
Epoch 6, loss 3.57
Epoch 7, loss 3.35
Epoch 8, loss 2.77
Epoch 9, loss 2.88
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 6 from unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 147.95
Epoch 1, loss 13.40
Epoch 2, loss 8.67
Epoch 3, loss 5.74
Epoch 4, loss 4.88
Epoch 5, loss 4.33
Epoch 6, loss 3.53
Epoch 7, loss 3.31
Epoch 8, loss 2.79
Epoch 9, loss 2.49
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 7 from unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 100.16
Epoch 1, loss 16.18
Epoch 2, loss 10.90
Epoch 3, loss 9.63
Epoch 4, loss 7.76
Epoch 5, loss 6.33
Epoch 6, loss 5.94
Epoch 7, loss 5.30
Epoch 8, loss 4.72
Epoch 9, loss 4.56
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Train the stitch to a model stitched after layer 8 from unbiased_colour to bg_only_colour
Use the data loader (train and test) that bg_only_colour was trained on
Epoch 0, loss 88.39
Epoch 1, loss 15.16
Epoch 2, loss 11.22
Epoch 3, loss 8.23
Epoch 4, loss 6.53
Epoch 5, loss 6.50
Epoch 6, loss 5.42
Epoch 7, loss 4.97
Epoch 8, loss 4.16
Epoch 9, loss 3.74
**** Finished Training ****
Test the trained stitch
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Other models have been stitched, just run stitches involving new bg_only_colour model
Other models have been stitched, just run stitches involving new bg_only_colour model
Other models have been stitched, just run stitches involving new bg_only_colour model
stitching_penalties={'bg_only_colour': {'bg_only_colour': {3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0}, 'bg_unbiased_colour': {3: 0.0, 4: 0.01999999999999602, 5: 0.01999999999999602, 6: 0.0, 7: 0.060000000000002274, 8: 0.09999999999999432}, 'biased_colour': {3: 0.0, 4: 0.0, 5: 0.0, 6: 0.01999999999999602, 7: 0.04000000000000625, 8: 0.10999999999999943}, 'unbiased_colour': {3: 13.269999999999996, 4: 19.320000000000007, 5: 30.370000000000005, 6: 49.77, 7: 76.28, 8: 75.99000000000001}}, 'bg_unbiased_colour': {'bg_only_colour': {3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0}}, 'biased_colour': {'bg_only_colour': {3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0}}, 'unbiased_colour': {'bg_only_colour': {3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0}}}
