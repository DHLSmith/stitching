Executed at 2024-07-30_14-01-59
logging to ./results/2024-07-30_14-01-59_SEED53_EPOCHS10_BGN0.1_exp2d_ResNet18_log.txt
seed=53
bg_noise=0.1
train_mix_mnist_model=False
mix_mnist_model_to_load='./results/2024-07-24_17-53-22_SEED43_EPOCHS10_BGN0.1_exp2c_ResNet18_mix_mnist.weights'
train_bw_mnist_model=False
bw_mnist_model_to_load='./results/2024-07-19_14-49-04_SEED21_EPOCHS10_exp2a_ResNet18_bw_mnist.weights'
train_bg_only_colour_mnist_model=False
bg_only_colour_mnist_model_to_load='./results/2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_bg_only_colour_mnist.weights'
train_bg_unbiased_colour_mnist_model=False
bg_unbiased_colour_mnist_model_to_load='./results/2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_bg_unbiased_colour_mnist.weights'
train_biased_colour_mnist_model=False
biased_colour_mnist_model_to_load='./results/2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_biased_colour_mnist.weights'
train_unbiased_colour_mnist_model=False
unbiased_colour_mnist_model_to_load='./results/2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist.weights'
stitch_train_epochs=10
================================================
val['loadfrom']='./results/2024-07-24_17-53-22_SEED43_EPOCHS10_BGN0.1_exp2c_ResNet18_mix_mnist.weights'
val['loadfrom']='./results/2024-07-19_14-49-04_SEED21_EPOCHS10_exp2a_ResNet18_bw_mnist.weights'
val['loadfrom']='./results/2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_bg_only_colour_mnist.weights'
val['loadfrom']='./results/2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_bg_unbiased_colour_mnist.weights'
val['loadfrom']='./results/2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_biased_colour_mnist.weights'
val['loadfrom']='./results/2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist.weights'
Entering Confusion
2072252416
Accuracy Calculation for ResNet18 with key='mix'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
2180399104
Accuracy Calculation for ResNet18 with key='bw'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 79.44 %
Confusion Matrix
tensor([[ 839,    0,    1,    0,    0,    0,  126,    1,   13,    0],
        [   0, 1116,    0,    0,    0,    0,   14,    0,    5,    0],
        [   0,    3,  986,    0,    0,    0,    6,    5,   32,    0],
        [   0,  130,    6,  187,    0,    2,   76,   13,  596,    0],
        [   0,   71,    0,    0,  842,    0,   67,    1,    0,    1],
        [   0,   26,    0,    0,    0,  314,  443,    3,  106,    0],
        [   0,    3,    0,    0,    0,    0,  953,    0,    2,    0],
        [   0,   27,    7,    1,    2,    0,    0,  979,   12,    0],
        [   0,    3,    0,    0,    2,    0,   16,    2,  951,    0],
        [   2,   80,    0,    0,    4,    2,   10,   35,   99,  777]],
       dtype=torch.int32)
tensor(10000)
2180665344
Accuracy Calculation for ResNet18 with key='bgonly'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 72.14 %
Confusion Matrix
tensor([[ 959,    0,    0,    0,    0,    0,    0,   21,    0,    0],
        [   0, 1113,    3,   18,    0,    1,    0,    0,    0,    0],
        [   0,    0,  814,  134,    0,    1,    0,    0,   83,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   2,    0,    0,  454,    0,    0,  502,    0,    0,    0],
        [   0,    0,    0,    0,  266,    0,    0,  762,    0,    0],
        [   0,    0,    0,  515,  315,    0,    0,    0,  144,    0],
        [   0,    0,    0,  123,  464,    0,    0,    0,  386,   36]],
       dtype=torch.int32)
tensor(10000)
2180857856
Accuracy Calculation for ResNet18 with key='bg'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
2180943872
Accuracy Calculation for ResNet18 with key='bias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
2181013504
Accuracy Calculation for ResNet18 with key='unbias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 98.01 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    0,    2,    1,    1,    0],
        [   0, 1129,    2,    1,    0,    0,    2,    0,    1,    0],
        [   7,    2, 1016,    4,    1,    0,    0,    1,    1,    0],
        [   0,    0,    6,  983,    0,    8,    0,    2,    8,    3],
        [   0,    0,    0,    0,  974,    0,    1,    1,    1,    5],
        [   3,    0,    0,    7,    0,  871,    6,    0,    2,    3],
        [   2,    2,    1,    0,    3,    2,  944,    0,    4,    0],
        [   1,    6,    6,    1,    0,    0,    0, 1006,    1,    7],
        [   6,    8,    2,    3,    6,    2,    5,    5,  935,    2],
        [   3,    6,    1,    3,   15,    4,    0,    3,    7,  967]],
       dtype=torch.int32)
tensor(10000)
2181087232
original_accuracy={'mix': 100.0, 'bw': 79.44, 'bgonly': 72.14, 'bg': 100.0, 'bias': 100.0, 'unbias': 98.01}
Entering whole model check
2181111808
Measure Rank for key='mix'
4023644160
Measure Rank for key='bw'
4076675072
Measure Rank for key='bgonly'
4076204032
Measure Rank for key='bg'
4076892160
Measure Rank for key='bias'
4078403584
Measure Rank for key='unbias'
4078243840
Entering Stitch/Rank
4078247936
device='cuda:0'
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_rank/mix3unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4078247936
Train the stitch to a model stitched after layer 3 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 168.01
4213641216
Epoch 1, loss 41.70
4214312960
Epoch 2, loss 29.01
4214321152
Epoch 3, loss 21.81
4214575104
Epoch 4, loss 18.17
4214816768
Epoch 5, loss 15.93
4214820864
Epoch 6, loss 13.89
4214865920
Epoch 7, loss 12.31
4214919168
Epoch 8, loss 11.68
4214919168
Epoch 9, loss 10.58
4214927360
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.58 %
Confusion Matrix
tensor([[ 976,    2,    1,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1133,    0,    0,    0,    1,    1,    0,    0,    0],
        [   0,    0, 1027,    2,    0,    1,    0,    0,    2,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    1,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    1,    0,    0,    2,    0,  955,    0,    0,    0],
        [   1,    1,    0,    1,    1,    0,    0, 1022,    0,    2],
        [   4,    0,    2,    0,    0,    0,    1,    0,  966,    1],
        [   4,    0,    0,    3,    0,    2,    0,    4,    0,  996]],
       dtype=torch.int32)
===================================================================
4214927360
4214927360
4374949888
Evaluate ranks and output to ./results_rank/mix4unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4374949888
Train the stitch to a model stitched after layer 4 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 172.75
4160237568
Epoch 1, loss 25.24
4160376832
Epoch 2, loss 16.02
4160376832
Epoch 3, loss 12.44
4160589824
Epoch 4, loss 9.64
4160790528
Epoch 5, loss 8.50
4160790528
Epoch 6, loss 7.25
4160790528
Epoch 7, loss 6.56
4160794624
Epoch 8, loss 5.99
4160921600
Epoch 9, loss 5.34
4160925696
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.78 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    2,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   2,    1,    0,    0,    0,    0,  955,    0,    0,    0],
        [   0,    0,    8,    0,    0,    0,    0, 1020,    0,    0],
        [   0,    0,    0,    1,    2,    0,    0,    0,  971,    0],
        [   0,    0,    0,    3,    1,    1,    0,    0,    1, 1003]],
       dtype=torch.int32)
===================================================================
4160925696
4160925696
4376547328
Evaluate ranks and output to ./results_rank/mix5unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4376547328
Train the stitch to a model stitched after layer 5 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 163.20
4195508224
Epoch 1, loss 12.30
4195635200
Epoch 2, loss 8.28
4195704832
Epoch 3, loss 6.25
4195704832
Epoch 4, loss 5.62
4195708928
Epoch 5, loss 4.98
4195880960
Epoch 6, loss 4.20
4195880960
Epoch 7, loss 3.98
4195999744
Epoch 8, loss 3.42
4195999744
Epoch 9, loss 3.11
4196171776
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.90 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    1,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    2,  956,    0,    0,    0],
        [   0,    0,    0,    0,    1,    1,    0, 1026,    0,    0],
        [   0,    0,    0,    1,    1,    0,    0,    0,  972,    0],
        [   0,    0,    0,    0,    0,    1,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
4196175872
4196175872
4339060736
Evaluate ranks and output to ./results_rank/mix6unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4339060736
Train the stitch to a model stitched after layer 6 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 45.63
4196102144
Epoch 1, loss 5.12
4196462592
Epoch 2, loss 3.72
4196585472
Epoch 3, loss 2.70
4196585472
Epoch 4, loss 2.44
4196769792
Epoch 5, loss 2.06
4196777984
Epoch 6, loss 1.68
4196925440
Epoch 7, loss 1.54
4196925440
Epoch 8, loss 1.57
4196925440
Epoch 9, loss 1.37
4197040128
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    1,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4197040128
4197040128
4300304384
Evaluate ranks and output to ./results_rank/mix7unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4300304384
Train the stitch to a model stitched after layer 7 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 43.92
4200304640
Epoch 1, loss 3.53
4200337408
Epoch 2, loss 2.43
4200337408
Epoch 3, loss 2.14
4200337408
Epoch 4, loss 1.55
4200505344
Epoch 5, loss 1.82
4200505344
Epoch 6, loss 1.62
4200624128
Epoch 7, loss 1.51
4200759296
Epoch 8, loss 1.17
4200878080
Epoch 9, loss 1.61
4200878080
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4200878080
4200878080
4284436480
Evaluate ranks and output to ./results_rank/mix8unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4284436480
Train the stitch to a model stitched after layer 8 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 37.64
4284502016
Epoch 1, loss 3.23
4200022016
Epoch 2, loss 2.66
4200267776
Epoch 3, loss 2.05
4200382464
Epoch 4, loss 1.71
4200382464
Epoch 5, loss 1.44
4200382464
Epoch 6, loss 1.47
4200722432
Epoch 7, loss 1.49
4200722432
Epoch 8, loss 1.18
4200722432
Epoch 9, loss 1.33
4200820736
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4200820736
4200820736
4284514304
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_rank/bw3unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4284514304
Train the stitch to a model stitched after layer 3 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 209.98
4200304640
Epoch 1, loss 73.66
4200304640
Epoch 2, loss 56.85
4200304640
Epoch 3, loss 48.95
4200505344
Epoch 4, loss 44.40
4200697856
Epoch 5, loss 41.25
4200697856
Epoch 6, loss 37.67
4200701952
Epoch 7, loss 35.86
4200837120
Epoch 8, loss 34.68
4200837120
Epoch 9, loss 32.79
4200931328
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 97.96 %
Confusion Matrix
tensor([[ 973,    2,    1,    0,    0,    0,    2,    0,    1,    1],
        [   0, 1131,    3,    0,    0,    1,    0,    0,    0,    0],
        [   7,    2, 1013,    2,    0,    1,    1,    4,    2,    0],
        [   0,    2,    2,  993,    0,    3,    0,    4,    5,    1],
        [   0,    2,    0,    0,  964,    0,    3,    2,    1,   10],
        [   0,    0,    0,   14,    0,  876,    1,    0,    1,    0],
        [   7,    3,    3,    0,    3,    1,  937,    0,    4,    0],
        [   2,    0,    4,    2,    0,    1,    0, 1010,    5,    4],
        [   7,    0,    4,    2,    6,    6,    1,    5,  939,    4],
        [   4,    4,    0,    4,    7,    7,    1,   20,    2,  960]],
       dtype=torch.int32)
===================================================================
4200935424
4200935424
4390051840
Evaluate ranks and output to ./results_rank/bw4unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4390051840
Train the stitch to a model stitched after layer 4 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 178.46
4206911488
Epoch 1, loss 56.83
4207067136
Epoch 2, loss 46.88
4207067136
Epoch 3, loss 41.41
4207067136
Epoch 4, loss 38.03
4207271936
Epoch 5, loss 35.38
4207271936
Epoch 6, loss 33.61
4207435776
Epoch 7, loss 31.93
4207435776
Epoch 8, loss 30.86
4207439872
Epoch 9, loss 29.80
4207558656
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 98.19 %
Confusion Matrix
tensor([[ 974,    3,    1,    0,    0,    0,    2,    0,    0,    0],
        [   1, 1121,    4,    2,    0,    0,    5,    0,    1,    1],
        [   6,    2, 1023,    1,    0,    0,    0,    0,    0,    0],
        [   1,    0,    1,  994,    0,    6,    0,    2,    6,    0],
        [   0,    0,    0,    0,  969,    0,    2,    1,    1,    9],
        [   1,    0,    0,   10,    0,  876,    2,    0,    3,    0],
        [   8,    3,    2,    0,    2,    1,  940,    0,    2,    0],
        [   0,    2,   10,    1,    1,    0,    0, 1006,    2,    6],
        [   7,    0,    7,    4,    1,    1,    2,    2,  944,    6],
        [   6,    1,    1,    6,    8,    0,    0,    7,    8,  972]],
       dtype=torch.int32)
===================================================================
4207558656
4207558656
4389122048
Evaluate ranks and output to ./results_rank/bw5unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4389122048
Train the stitch to a model stitched after layer 5 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 157.90
4200615936
Epoch 1, loss 48.76
4200615936
Epoch 2, loss 37.51
4200615936
Epoch 3, loss 31.69
4200615936
Epoch 4, loss 28.68
4200779776
Epoch 5, loss 25.92
4200779776
Epoch 6, loss 24.08
4200779776
Epoch 7, loss 22.44
4200779776
Epoch 8, loss 21.05
4200779776
Epoch 9, loss 19.73
4200865792
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 98.79 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    0,    1,    0],
        [   1, 1125,    4,    0,    0,    0,    4,    1,    0,    0],
        [   1,    2, 1025,    0,    1,    0,    2,    0,    1,    0],
        [   0,    0,    0, 1001,    0,    3,    0,    0,    5,    1],
        [   0,    0,    1,    0,  967,    0,    2,    1,    3,    8],
        [   0,    0,    0,    7,    0,  883,    1,    0,    1,    0],
        [   2,    1,    0,    1,    1,    1,  948,    0,    3,    1],
        [   1,    1,    5,    1,    0,    0,    0, 1009,    5,    6],
        [   3,    1,    3,    5,    1,    0,    0,    3,  954,    4],
        [   2,    0,    1,    1,    5,    2,    0,    6,    4,  988]],
       dtype=torch.int32)
===================================================================
4200865792
4200865792
4342894592
Evaluate ranks and output to ./results_rank/bw6unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4342894592
Train the stitch to a model stitched after layer 6 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 114.90
4200267776
Epoch 1, loss 25.47
4200910848
Epoch 2, loss 20.99
4200910848
Epoch 3, loss 17.52
4200910848
Epoch 4, loss 16.17
4200910848
Epoch 5, loss 14.89
4200910848
Epoch 6, loss 13.95
4200910848
Epoch 7, loss 13.15
4200910848
Epoch 8, loss 13.09
4200910848
Epoch 9, loss 12.53
4200910848
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.11 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   1, 1127,    3,    1,    0,    0,    2,    0,    1,    0],
        [   1,    1, 1030,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1002,    0,    3,    0,    1,    4,    0],
        [   0,    0,    0,    0,  974,    0,    2,    0,    0,    6],
        [   0,    0,    0,    7,    0,  879,    1,    0,    4,    1],
        [   0,    1,    0,    0,    1,    0,  952,    0,    4,    0],
        [   0,    1,    3,    4,    0,    0,    0, 1014,    1,    5],
        [   1,    0,    1,    5,    2,    0,    0,    2,  960,    3],
        [   1,    0,    1,    0,    5,    0,    0,    3,    6,  993]],
       dtype=torch.int32)
===================================================================
4200910848
4200910848
4303912960
Evaluate ranks and output to ./results_rank/bw7unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4303912960
Train the stitch to a model stitched after layer 7 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 93.02
4304232448
Epoch 1, loss 30.54
4304232448
Epoch 2, loss 26.98
4200452096
Epoch 3, loss 24.41
4200640512
Epoch 4, loss 23.47
4200808448
Epoch 5, loss 22.00
4200808448
Epoch 6, loss 20.93
4200808448
Epoch 7, loss 19.95
4200808448
Epoch 8, loss 19.48
4200808448
Epoch 9, loss 19.10
4200808448
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 98.87 %
Confusion Matrix
tensor([[ 977,    1,    0,    1,    0,    0,    0,    1,    0,    0],
        [   0, 1126,    3,    2,    0,    0,    2,    2,    0,    0],
        [   1,    2, 1026,    0,    0,    0,    0,    3,    0,    0],
        [   1,    0,    0, 1000,    0,    2,    0,    2,    5,    0],
        [   0,    0,    0,    0,  971,    1,    3,    0,    0,    7],
        [   2,    0,    0,    9,    0,  875,    2,    0,    3,    1],
        [   3,    2,    0,    0,    0,    4,  946,    0,    3,    0],
        [   0,    2,    1,    2,    0,    0,    0, 1017,    3,    3],
        [   1,    0,    0,    6,    2,    1,    0,    2,  959,    3],
        [   1,    0,    1,    3,    4,    1,    0,    2,    7,  990]],
       dtype=torch.int32)
===================================================================
4200808448
4200808448
4283203584
Evaluate ranks and output to ./results_rank/bw8unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4283203584
Train the stitch to a model stitched after layer 8 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 82.18
4283531264
Epoch 1, loss 30.20
4200394752
Epoch 2, loss 26.29
4200394752
Epoch 3, loss 24.15
4200394752
Epoch 4, loss 22.90
4200579072
Epoch 5, loss 21.57
4200579072
Epoch 6, loss 20.11
4200763392
Epoch 7, loss 20.23
4200763392
Epoch 8, loss 18.99
4200894464
Epoch 9, loss 18.45
4200894464
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 98.85 %
Confusion Matrix
tensor([[ 977,    0,    0,    1,    0,    1,    0,    1,    0,    0],
        [   2, 1124,    2,    3,    0,    0,    2,    2,    0,    0],
        [   1,    1, 1026,    0,    1,    0,    0,    3,    0,    0],
        [   1,    0,    0,  998,    0,    2,    0,    3,    6,    0],
        [   0,    0,    0,    0,  973,    1,    2,    1,    0,    5],
        [   2,    0,    0,   11,    0,  876,    1,    0,    2,    0],
        [   2,    2,    0,    0,    2,    3,  945,    0,    3,    1],
        [   0,    3,    1,    2,    0,    0,    0, 1013,    4,    5],
        [   1,    0,    0,    6,    2,    1,    0,    2,  959,    3],
        [   0,    1,    1,    2,    5,    0,    0,    0,    6,  994]],
       dtype=torch.int32)
===================================================================
4200894464
4200894464
4283174912
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_rank/bgonly3unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4283174912
Train the stitch to a model stitched after layer 3 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 381.30
4200321024
Epoch 1, loss 43.45
4200321024
Epoch 2, loss 26.22
4200534016
Epoch 3, loss 18.57
4200534016
Epoch 4, loss 13.95
4200718336
Epoch 5, loss 11.08
4200869888
Epoch 6, loss 10.43
4200976384
Epoch 7, loss 9.58
4200976384
Epoch 8, loss 7.82
4200980480
Epoch 9, loss 7.25
4200980480
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.97 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    2,    0,    0,    0, 1007]],
       dtype=torch.int32)
===================================================================
4200980480
4200980480
4388458496
Evaluate ranks and output to ./results_rank/bgonly4unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4388458496
Train the stitch to a model stitched after layer 4 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 255.74
4200460288
Epoch 1, loss 30.13
4200460288
Epoch 2, loss 18.54
4200460288
Epoch 3, loss 14.10
4200460288
Epoch 4, loss 11.20
4200460288
Epoch 5, loss 9.61
4200640512
Epoch 6, loss 8.96
4200640512
Epoch 7, loss 7.91
4200640512
Epoch 8, loss 7.89
4200767488
Epoch 9, loss 6.30
4200882176
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.93 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    1,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    1, 1031,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    2,    0,    0,    0,  972,    0],
        [   0,    1,    0,    0,    0,    0,    0,    1,    0, 1007]],
       dtype=torch.int32)
===================================================================
4200882176
4200882176
4389224448
Evaluate ranks and output to ./results_rank/bgonly5unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4389224448
Train the stitch to a model stitched after layer 5 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 144.29
4200398848
Epoch 1, loss 15.41
4200632320
Epoch 2, loss 10.13
4200632320
Epoch 3, loss 7.38
4200828928
Epoch 4, loss 6.74
4200828928
Epoch 5, loss 5.37
4200828928
Epoch 6, loss 5.36
4200828928
Epoch 7, loss 4.41
4200828928
Epoch 8, loss 3.87
4200828928
Epoch 9, loss 3.85
4200927232
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4200927232
4200927232
4343005184
Evaluate ranks and output to ./results_rank/bgonly6unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4343005184
Train the stitch to a model stitched after layer 6 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 123.36
4200325120
Epoch 1, loss 9.36
4200566784
Epoch 2, loss 6.56
4200566784
Epoch 3, loss 5.31
4200566784
Epoch 4, loss 5.09
4200755200
Epoch 5, loss 4.01
4200755200
Epoch 6, loss 3.89
4200755200
Epoch 7, loss 3.30
4200755200
Epoch 8, loss 3.23
4200849408
Epoch 9, loss 2.77
4201000960
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4201000960
4201000960
4303716352
Evaluate ranks and output to ./results_rank/bgonly7unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4303716352
Train the stitch to a model stitched after layer 7 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 41.02
4200521728
Epoch 1, loss 8.42
4200697856
Epoch 2, loss 6.83
4200697856
Epoch 3, loss 6.29
4200824832
Epoch 4, loss 5.89
4200824832
Epoch 5, loss 5.48
4200824832
Epoch 6, loss 5.42
4200824832
Epoch 7, loss 4.51
4200824832
Epoch 8, loss 4.34
4200824832
Epoch 9, loss 4.10
4200824832
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4200824832
4200824832
4283305984
Evaluate ranks and output to ./results_rank/bgonly8unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4283305984
Train the stitch to a model stitched after layer 8 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 53.19
4283817984
Epoch 1, loss 8.92
4200681472
Epoch 2, loss 7.53
4200681472
Epoch 3, loss 6.94
4200681472
Epoch 4, loss 5.98
4200681472
Epoch 5, loss 5.59
4200681472
Epoch 6, loss 5.26
4200828928
Epoch 7, loss 4.77
4200976384
Epoch 8, loss 4.55
4200976384
Epoch 9, loss 4.10
4200976384
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4200976384
4200976384
4283711488
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_rank/bg3unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4283711488
Train the stitch to a model stitched after layer 3 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 498.64
4200574976
Epoch 1, loss 42.97
4200718336
Epoch 2, loss 27.62
4200718336
Epoch 3, loss 20.76
4200718336
Epoch 4, loss 17.22
4200718336
Epoch 5, loss 14.33
4200718336
Epoch 6, loss 12.92
4200718336
Epoch 7, loss 11.28
4200833024
Epoch 8, loss 10.10
4200923136
Epoch 9, loss 9.95
4200923136
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.84 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1029,    2,    1,    0,    0,    0,    0,    0],
        [   0,    0,    1, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0, 1026,    0,    1],
        [   0,    0,    3,    0,    1,    0,    0,    0,  970,    0],
        [   0,    0,    0,    1,    0,    4,    0,    0,    0, 1004]],
       dtype=torch.int32)
===================================================================
4200923136
4200923136
4388585472
Evaluate ranks and output to ./results_rank/bg4unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4388585472
Train the stitch to a model stitched after layer 4 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 383.76
4200075264
Epoch 1, loss 148.39
4200079360
Epoch 2, loss 121.83
4200079360
Epoch 3, loss 99.88
4200562688
Epoch 4, loss 73.05
4200562688
Epoch 5, loss 39.61
4200562688
Epoch 6, loss 23.52
4200906752
Epoch 7, loss 16.74
4200906752
Epoch 8, loss 13.22
4201037824
Epoch 9, loss 10.62
4201037824
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.92 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    0,    1],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    2,    0,    0,  955,    0,    1,    0],
        [   1,    0,    1,    0,    0,    0,    0, 1025,    1,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    1, 1008]],
       dtype=torch.int32)
===================================================================
4201037824
4201037824
4389101568
Evaluate ranks and output to ./results_rank/bg5unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4389101568
Train the stitch to a model stitched after layer 5 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 166.26
4200329216
Epoch 1, loss 10.72
4200329216
Epoch 2, loss 7.10
4200640512
Epoch 3, loss 4.91
4200640512
Epoch 4, loss 4.55
4200640512
Epoch 5, loss 3.84
4200640512
Epoch 6, loss 3.25
4200792064
Epoch 7, loss 2.78
4200792064
Epoch 8, loss 2.22
4200906752
Epoch 9, loss 2.36
4200906752
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4200906752
4200906752
4342317056
Evaluate ranks and output to ./results_rank/bg6unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4342317056
Train the stitch to a model stitched after layer 6 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 48.19
4199948288
Epoch 1, loss 2.79
4200173568
Epoch 2, loss 1.78
4200402944
Epoch 3, loss 1.41
4200402944
Epoch 4, loss 1.02
4200796160
Epoch 5, loss 0.92
4200796160
Epoch 6, loss 0.76
4200935424
Epoch 7, loss 0.96
4200935424
Epoch 8, loss 0.67
4201046016
Epoch 9, loss 0.76
4201046016
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4201046016
4201046016
4304080896
Evaluate ranks and output to ./results_rank/bg7unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4304080896
Train the stitch to a model stitched after layer 7 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 43.97
4304142336
Epoch 1, loss 2.21
4304142336
Epoch 2, loss 1.33
4202229760
Epoch 3, loss 1.03
4202229760
Epoch 4, loss 0.85
4202299392
Epoch 5, loss 0.84
4202516480
Epoch 6, loss 0.68
4202516480
Epoch 7, loss 0.83
4202516480
Epoch 8, loss 0.61
4202635264
Epoch 9, loss 0.57
4202635264
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4202635264
4202635264
4283568128
Evaluate ranks and output to ./results_rank/bg8unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4283568128
Train the stitch to a model stitched after layer 8 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 40.85
4202336256
Epoch 1, loss 1.61
4202336256
Epoch 2, loss 1.26
4202336256
Epoch 3, loss 0.88
4202336256
Epoch 4, loss 1.80
4202336256
Epoch 5, loss 0.71
4202512384
Epoch 6, loss 0.62
4202528768
Epoch 7, loss 0.58
4202528768
Epoch 8, loss 0.52
4202663936
Epoch 9, loss 0.51
4202663936
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4202663936
4202663936
4283662336
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_rank/bias3unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4283662336
Train the stitch to a model stitched after layer 3 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 159.00
4200587264
Epoch 1, loss 31.91
4200787968
Epoch 2, loss 21.92
4200787968
Epoch 3, loss 17.52
4200787968
Epoch 4, loss 14.17
4200968192
Epoch 5, loss 12.31
4200968192
Epoch 6, loss 10.58
4200968192
Epoch 7, loss 9.45
4200968192
Epoch 8, loss 8.65
4200968192
Epoch 9, loss 8.16
4200968192
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.76 %
Confusion Matrix
tensor([[ 974,    0,    2,    0,    0,    0,    1,    3,    0,    0],
        [   0, 1134,    0,    0,    1,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    1,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    2,    0,    0,    1,    0,  954,    0,    0,    0],
        [   1,    1,    4,    1,    0,    1,    0, 1020,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   1,    0,    0,    2,    0,    1,    0,    0,    0, 1005]],
       dtype=torch.int32)
===================================================================
4200968192
4200968192
4389490688
Evaluate ranks and output to ./results_rank/bias4unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4389490688
Train the stitch to a model stitched after layer 4 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 236.98
4200456192
Epoch 1, loss 36.81
4200697856
Epoch 2, loss 21.75
4200697856
Epoch 3, loss 16.60
4200722432
Epoch 4, loss 12.73
4200722432
Epoch 5, loss 10.76
4200722432
Epoch 6, loss 9.24
4200886272
Epoch 7, loss 7.90
4201025536
Epoch 8, loss 7.57
4201025536
Epoch 9, loss 6.26
4201025536
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.83 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    1,    0,    0,    0,    0,  957,    0,    0,    0],
        [   1,    0,    0,    0,    1,    0,    0, 1026,    0,    0],
        [   0,    0,    0,    0,    1,    1,    0,    0,  970,    2],
        [   0,    0,    1,    2,    2,    1,    0,    1,    2, 1000]],
       dtype=torch.int32)
===================================================================
4201025536
4201025536
4389289984
Evaluate ranks and output to ./results_rank/bias5unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4389289984
Train the stitch to a model stitched after layer 5 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 195.78
4200755200
Epoch 1, loss 13.05
4200755200
Epoch 2, loss 7.97
4200755200
Epoch 3, loss 6.01
4200755200
Epoch 4, loss 4.69
4200755200
Epoch 5, loss 3.99
4200755200
Epoch 6, loss 3.70
4200755200
Epoch 7, loss 3.08
4200755200
Epoch 8, loss 2.64
4200755200
Epoch 9, loss 2.65
4201013248
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    2, 1007]],
       dtype=torch.int32)
===================================================================
4201013248
4201013248
4343742464
Evaluate ranks and output to ./results_rank/bias6unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4343742464
Train the stitch to a model stitched after layer 6 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 64.87
4200321024
Epoch 1, loss 4.66
4200321024
Epoch 2, loss 2.70
4200427520
Epoch 3, loss 2.26
4200427520
Epoch 4, loss 1.84
4200624128
Epoch 5, loss 1.59
4200800256
Epoch 6, loss 1.29
4200800256
Epoch 7, loss 1.13
4201037824
Epoch 8, loss 1.00
4201037824
Epoch 9, loss 0.83
4201115648
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4201115648
4201115648
4304625664
Evaluate ranks and output to ./results_rank/bias7unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4304625664
Train the stitch to a model stitched after layer 7 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 34.09
4200640512
Epoch 1, loss 2.55
4200640512
Epoch 2, loss 1.69
4200816640
Epoch 3, loss 1.28
4200902656
Epoch 4, loss 1.13
4200902656
Epoch 5, loss 1.06
4200902656
Epoch 6, loss 0.87
4200902656
Epoch 7, loss 0.83
4201025536
Epoch 8, loss 0.64
4201025536
Epoch 9, loss 0.69
4201025536
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4201025536
4201025536
4283985920
Evaluate ranks and output to ./results_rank/bias8unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4283985920
Train the stitch to a model stitched after layer 8 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 24.04
4200390656
Epoch 1, loss 2.11
4200390656
Epoch 2, loss 1.43
4200390656
Epoch 3, loss 1.09
4200390656
Epoch 4, loss 1.02
4200448000
Epoch 5, loss 0.73
4200636416
Epoch 6, loss 0.69
4200804352
Epoch 7, loss 0.65
4200804352
Epoch 8, loss 0.56
4200804352
Epoch 9, loss 0.53
4200943616
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
4200943616
4200943616
4284084224
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_rank/unbias3unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4284084224
Train the stitch to a model stitched after layer 3 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 231.46
4200488960
Epoch 1, loss 45.29
4200730624
Epoch 2, loss 33.02
4200796160
Epoch 3, loss 27.42
4200796160
Epoch 4, loss 23.30
4200972288
Epoch 5, loss 20.54
4200972288
Epoch 6, loss 18.02
4200972288
Epoch 7, loss 16.40
4200972288
Epoch 8, loss 15.27
4200972288
Epoch 9, loss 14.45
4200972288
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.09 %
Confusion Matrix
tensor([[ 967,    3,    0,    0,    1,    3,    3,    2,    0,    1],
        [   0, 1133,    1,    0,    0,    0,    1,    0,    0,    0],
        [   2,    0, 1025,    2,    0,    0,    0,    1,    2,    0],
        [   0,    0,    0, 1007,    0,    1,    0,    2,    0,    0],
        [   0,    0,    0,    0,  971,    1,    5,    0,    2,    3],
        [   0,    1,    0,    1,    0,  890,    0,    0,    0,    0],
        [   1,    5,    1,    0,    1,    5,  944,    0,    1,    0],
        [   0,    8,    3,    0,    0,    1,    0, 1013,    0,    3],
        [   1,    0,    4,    0,    1,    0,    0,    0,  965,    3],
        [   6,    1,    1,    4,    1,    1,    0,    1,    0,  994]],
       dtype=torch.int32)
===================================================================
4200972288
4200972288
4389457920
Evaluate ranks and output to ./results_rank/unbias4unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4389457920
Train the stitch to a model stitched after layer 4 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 196.73
4200423424
Epoch 1, loss 41.24
4200660992
Epoch 2, loss 30.03
4200660992
Epoch 3, loss 24.19
4200685568
Epoch 4, loss 21.21
4200685568
Epoch 5, loss 19.17
4200685568
Epoch 6, loss 18.01
4200685568
Epoch 7, loss 16.06
4200992768
Epoch 8, loss 14.69
4200992768
Epoch 9, loss 13.73
4200992768
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 98.91 %
Confusion Matrix
tensor([[ 975,    1,    1,    0,    0,    0,    1,    1,    1,    0],
        [   0, 1129,    1,    1,    1,    1,    1,    1,    0,    0],
        [   1,    0, 1025,    0,    1,    0,    0,    2,    3,    0],
        [   0,    0,    0, 1004,    0,    3,    0,    1,    2,    0],
        [   0,    0,    1,    0,  970,    0,    0,    1,    4,    6],
        [   1,    0,    0,    2,    0,  886,    0,    0,    2,    1],
        [   4,    5,    0,    1,    3,    4,  938,    0,    3,    0],
        [   0,    1,    4,    0,    1,    0,    0, 1017,    0,    5],
        [   2,    0,    3,    0,    4,    2,    0,    0,  962,    1],
        [   3,    2,    0,    4,    6,    3,    0,    5,    1,  985]],
       dtype=torch.int32)
===================================================================
4200992768
4200992768
4389249024
Evaluate ranks and output to ./results_rank/unbias5unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4389249024
Train the stitch to a model stitched after layer 5 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 112.37
4200214528
Epoch 1, loss 30.99
4200714240
Epoch 2, loss 25.05
4200853504
Epoch 3, loss 22.05
4200853504
Epoch 4, loss 19.67
4201033728
Epoch 5, loss 18.08
4201033728
Epoch 6, loss 16.89
4201033728
Epoch 7, loss 15.61
4201033728
Epoch 8, loss 14.83
4201033728
Epoch 9, loss 13.95
4201123840
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 99.03 %
Confusion Matrix
tensor([[ 974,    0,    2,    0,    0,    1,    2,    1,    0,    0],
        [   0, 1132,    2,    1,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1027,    0,    0,    0,    0,    1,    4,    0],
        [   0,    0,    0, 1007,    0,    1,    0,    1,    1,    0],
        [   0,    0,    0,    0,  976,    0,    0,    1,    2,    3],
        [   1,    0,    0,    5,    0,  881,    2,    1,    1,    1],
        [   4,    3,    0,    0,    0,    2,  948,    0,    1,    0],
        [   0,    6,    3,    1,    0,    0,    0, 1008,    1,    9],
        [   2,    0,    5,    0,    2,    1,    0,    3,  961,    0],
        [   2,    2,    2,    2,    8,    0,    0,    3,    1,  989]],
       dtype=torch.int32)
===================================================================
4201123840
4201123840
4342910976
Evaluate ranks and output to ./results_rank/unbias6unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4342910976
Train the stitch to a model stitched after layer 6 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 74.41
4200542208
Epoch 1, loss 27.58
4200542208
Epoch 2, loss 22.49
4200759296
Epoch 3, loss 19.91
4200849408
Epoch 4, loss 18.39
4200849408
Epoch 5, loss 17.08
4200849408
Epoch 6, loss 15.82
4201013248
Epoch 7, loss 14.84
4201013248
Epoch 8, loss 14.10
4201013248
Epoch 9, loss 13.46
4201013248
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 98.85 %
Confusion Matrix
tensor([[ 977,    1,    0,    0,    0,    0,    0,    1,    1,    0],
        [   0, 1130,    0,    2,    0,    0,    2,    0,    1,    0],
        [   4,    0, 1027,    0,    0,    0,    0,    1,    0,    0],
        [   0,    0,    0, 1002,    0,    5,    0,    1,    2,    0],
        [   0,    0,    0,    0,  973,    0,    3,    0,    1,    5],
        [   2,    1,    0,    5,    0,  873,    4,    0,    3,    4],
        [   3,    2,    1,    0,    4,    2,  943,    0,    3,    0],
        [   0,    2,    3,    4,    0,    0,    0, 1014,    0,    5],
        [   2,    0,    0,    1,    2,    0,    0,    5,  963,    1],
        [   2,    4,    1,    3,    7,    2,    0,    4,    3,  983]],
       dtype=torch.int32)
===================================================================
4201013248
4201013248
4303650816
Evaluate ranks and output to ./results_rank/unbias7unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4303650816
Train the stitch to a model stitched after layer 7 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 84.37
4200902656
Epoch 1, loss 23.75
4200902656
Epoch 2, loss 21.81
4200902656
Epoch 3, loss 20.24
4200902656
Epoch 4, loss 18.51
4200902656
Epoch 5, loss 18.75
4201058304
Epoch 6, loss 17.66
4201058304
Epoch 7, loss 16.77
4201058304
Epoch 8, loss 17.42
4201058304
Epoch 9, loss 16.04
4201058304
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 98.62 %
Confusion Matrix
tensor([[ 977,    0,    0,    1,    0,    0,    0,    1,    1,    0],
        [   0, 1130,    1,    1,    0,    0,    1,    0,    2,    0],
        [   7,    2, 1011,    4,    1,    0,    1,    4,    2,    0],
        [   0,    0,    2, 1001,    0,    2,    0,    1,    4,    0],
        [   0,    0,    1,    0,  970,    0,    2,    0,    2,    7],
        [   2,    0,    0,   11,    0,  873,    2,    0,    1,    3],
        [   7,    2,    1,    0,    1,    2,  943,    0,    2,    0],
        [   0,    1,    4,    2,    0,    0,    0, 1019,    1,    1],
        [   4,    0,    2,    2,    1,    2,    1,    5,  955,    2],
        [   1,    3,    1,    4,    6,    1,    0,    4,    6,  983]],
       dtype=torch.int32)
===================================================================
4201058304
4201058304
4284592128
Evaluate ranks and output to ./results_rank/unbias8unbias-bias-53_2024-07-22_17-24-48_SEED41_EPOCHS10_BGN0.1_exp2b_ResNet18_unbiased_colour_mnist-test.csv
4284592128
Train the stitch to a model stitched after layer 8 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 70.72
4200996864
Epoch 1, loss 25.06
4201095168
Epoch 2, loss 21.45
4201095168
Epoch 3, loss 20.72
4201095168
Epoch 4, loss 19.58
4201095168
Epoch 5, loss 18.66
4201095168
Epoch 6, loss 18.40
4201095168
Epoch 7, loss 17.88
4201095168
Epoch 8, loss 16.94
4201095168
Epoch 9, loss 16.61
4201095168
**** Finished Training ****
Test the trained stitch against biased data
Test Accuracy: 98.62 %
Confusion Matrix
tensor([[ 975,    0,    1,    1,    0,    0,    1,    1,    1,    0],
        [   0, 1128,    1,    1,    0,    0,    2,    0,    3,    0],
        [   4,    2, 1017,    2,    2,    0,    1,    1,    3,    0],
        [   0,    0,    2,  999,    0,    3,    0,    2,    4,    0],
        [   0,    0,    0,    0,  971,    0,    3,    0,    3,    5],
        [   2,    0,    0,    8,    0,  871,    3,    0,    3,    5],
        [   1,    2,    1,    0,    2,    4,  943,    0,    5,    0],
        [   1,    1,    5,    2,    0,    0,    0, 1015,    1,    3],
        [   3,    1,    2,    2,    0,    1,    2,    5,  956,    2],
        [   2,    2,    2,    2,    5,    2,    0,    2,    5,  987]],
       dtype=torch.int32)
===================================================================
4201095168
4201095168
4283949056
stitching_accuracies={'mix': {'unbias': {3: 99.58, 4: 99.78, 5: 99.9, 6: 99.99, 7: 99.99, 8: 100.0}}, 'bw': {'unbias': {3: 97.96, 4: 98.19, 5: 98.79, 6: 99.11, 7: 98.87, 8: 98.85}}, 'bgonly': {'unbias': {3: 99.97, 4: 99.93, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bg': {'unbias': {3: 99.84, 4: 99.92, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bias': {'unbias': {3: 99.76, 4: 99.83, 5: 99.98, 6: 100.0, 7: 100.0, 8: 100.0}}, 'unbias': {'unbias': {3: 99.09, 4: 98.91, 5: 99.03, 6: 98.85, 7: 98.62, 8: 98.62}}}
stitching_penalties={'mix': {'unbias': {3: -1.5699999999999932, 4: -1.769999999999996, 5: -1.8900000000000006, 6: -1.9799999999999898, 7: -1.9799999999999898, 8: -1.9899999999999949}}, 'bw': {'unbias': {3: 0.05000000000001137, 4: -0.1799999999999926, 5: -0.7800000000000011, 6: -1.0999999999999943, 7: -0.8599999999999994, 8: -0.8399999999999892}}, 'bgonly': {'unbias': {3: -1.9599999999999937, 4: -1.9200000000000017, 5: -1.9899999999999949, 6: -1.9899999999999949, 7: -1.9899999999999949, 8: -1.9899999999999949}}, 'bg': {'unbias': {3: -1.8299999999999983, 4: -1.9099999999999966, 5: -1.9899999999999949, 6: -1.9899999999999949, 7: -1.9899999999999949, 8: -1.9899999999999949}}, 'bias': {'unbias': {3: -1.75, 4: -1.8199999999999932, 5: -1.9699999999999989, 6: -1.9899999999999949, 7: -1.9899999999999949, 8: -1.9899999999999949}}, 'unbias': {'unbias': {3: -1.0799999999999983, 4: -0.8999999999999915, 5: -1.019999999999996, 6: -0.8399999999999892, 7: -0.6099999999999994, 8: -0.6099999999999994}}}
synth-mix
100.0
Stitch Accuracy
{3: 99.58, 4: 99.78, 5: 99.9, 6: 99.99, 7: 99.99, 8: 100.0}
--------------------------
synth-bw
79.44
Stitch Accuracy
{3: 97.96, 4: 98.19, 5: 98.79, 6: 99.11, 7: 98.87, 8: 98.85}
--------------------------
synth-bgonly
72.14
Stitch Accuracy
{3: 99.97, 4: 99.93, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bg
100.0
Stitch Accuracy
{3: 99.84, 4: 99.92, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bias
100.0
Stitch Accuracy
{3: 99.76, 4: 99.83, 5: 99.98, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-unbias
98.01
Stitch Accuracy
{3: 99.09, 4: 98.91, 5: 99.03, 6: 98.85, 7: 98.62, 8: 98.62}
--------------------------
