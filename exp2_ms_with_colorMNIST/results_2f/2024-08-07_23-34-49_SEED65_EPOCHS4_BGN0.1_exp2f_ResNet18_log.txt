Executed at 2024-08-07_23-34-49
logging to ./results_2f/2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_log.txt
seed=65
bg_noise=0.1
train_mix_mnist_model=False
mix_mnist_model_to_load='./results_4_epochs/2024-08-01_07-35-14_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_mix_mnist.weights'
train_bw_mnist_model=False
bw_mnist_model_to_load='./results_4_epochs/2024-08-02_11-10-38_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bw_mnist.weights'
train_bg_only_colour_mnist_model=False
bg_only_colour_mnist_model_to_load='./results_4_epochs/2024-08-02_11-10-38_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_only_colour_mnist.weights'
train_bg_unbiased_colour_mnist_model=False
bg_unbiased_colour_mnist_model_to_load='./results_4_epochs/2024-08-02_11-10-38_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_unbiased_colour_mnist.weights'
train_biased_colour_mnist_model=False
biased_colour_mnist_model_to_load='./results_4_epochs/2024-08-02_11-10-38_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_biased_colour_mnist.weights'
train_unbiased_colour_mnist_model=True
save_unbiased_colour_mnist_model_as='./results_2f/2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist.weights'
original_train_epochs=4
stitch_train_epochs=10
================================================
val['loadfrom']='./results_4_epochs/2024-08-01_07-35-14_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_mix_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-02_11-10-38_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bw_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-02_11-10-38_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_only_colour_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-02_11-10-38_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_unbiased_colour_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-02_11-10-38_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_biased_colour_mnist.weights'
Train ResNet18 on unbias
Epoch 0, loss 305.42
Rebuilding unbias train_loader
Epoch 1, loss 50.53
Rebuilding unbias train_loader
Epoch 2, loss 34.65
Rebuilding unbias train_loader
Epoch 3, loss 28.46
Rebuilding unbias train_loader
**** Finished Training ****
saveas='./results_2f/2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist.weights'
Entering Confusion
Accuracy Calculation for ResNet18 with key='mix'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bw'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 67.23 %
Confusion Matrix
tensor([[ 960,    1,    0,    0,    0,    0,    5,    1,   13,    0],
        [   0, 1118,    5,    0,    4,    0,    2,    0,    6,    0],
        [   3,    3,  971,    0,    9,    0,    1,    4,   41,    0],
        [  12,   30,    4,    0,  330,    0,    1,    1,  632,    0],
        [   0,   86,    0,    0,  896,    0,    0,    0,    0,    0],
        [   9,   77,    0,    0,  609,    0,   28,    0,  169,    0],
        [   0,   13,    0,    0,   19,    0,  920,    0,    6,    0],
        [   0,  223,    2,    0,  265,    0,    0,  508,   24,    6],
        [   2,   48,    0,    0,   48,    0,    1,    0,  875,    0],
        [   2,   24,    0,    0,  485,    0,    0,    0,   23,  475]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bgonly'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 64.21 %
Confusion Matrix
tensor([[ 286,    0,    0,    0,    0,    0,  694,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  356,    0,    0,    0,    0,    0,  676,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,  592,    0,    0,  366,    0,    0,    0],
        [   0,    0,    0,    0,  903,    0,    0,  125,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,   30,    0,    0,    0,    0,  684,  295]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bg'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='unbias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 97.85 %
Confusion Matrix
tensor([[ 974,    0,    0,    0,    0,    1,    4,    1,    0,    0],
        [   0, 1111,    3,    2,    0,    0,    7,    0,   12,    0],
        [   1,    0, 1017,    1,    1,    0,    2,    4,    5,    1],
        [   0,    0,    0,  997,    0,    4,    0,    2,    6,    1],
        [   0,    0,    2,    1,  939,    0,    3,    2,    2,   33],
        [   3,    0,    0,   14,    0,  867,    4,    2,    2,    0],
        [   2,    2,    1,    0,    2,    6,  944,    0,    1,    0],
        [   0,    3,    5,    6,    0,    0,    0, 1011,    1,    2],
        [   5,    0,    1,    3,    0,    2,    4,    1,  956,    2],
        [   2,    4,    1,   11,    4,    5,    0,    4,    9,  969]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'mix': 100.0, 'bw': 67.23, 'bgonly': 64.21, 'bg': 100.0, 'bias': 100.0, 'unbias': 97.85}
Entering whole model check
Measure Rank for key='mix'
Measure Rank for key='bw'
Measure Rank for key='bgonly'
Measure Rank for key='bg'
Measure Rank for key='bias'
Measure Rank for key='unbias'
Entering Stitch/Rank
device='cuda:0'
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/mix3unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 255.25
Epoch 1, loss 31.04
Epoch 2, loss 21.01
Epoch 3, loss 16.70
Epoch 4, loss 14.34
Epoch 5, loss 12.06
Epoch 6, loss 9.98
Epoch 7, loss 8.92
Epoch 8, loss 8.60
Epoch 9, loss 7.43
**** Finished Training ****
Change in stitch weights: 1.0387169122695923
Largest abs weight change: 0.11259103566408157
Number of weights changing > 0.1 of that: 1484
Change in stitch bias: 0.026425812393426895
Largest abs bias change: 0.005475834012031555
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 99.85 %
Confusion Matrix
tensor([[ 977,    0,    0,    0,    0,    0,    1,    0,    2,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    1,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   5,    0,    0,    1,    1,    0,  951,    0,    0,    0],
        [   1,    0,    0,    0,    1,    0,    0, 1026,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  973,    1],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/mix4unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 254.55
Epoch 1, loss 22.52
Epoch 2, loss 14.58
Epoch 3, loss 11.36
Epoch 4, loss 8.58
Epoch 5, loss 7.11
Epoch 6, loss 6.61
Epoch 7, loss 5.81
Epoch 8, loss 6.01
Epoch 9, loss 4.57
**** Finished Training ****
Change in stitch weights: 0.9676225781440735
Largest abs weight change: 0.08285397291183472
Number of weights changing > 0.1 of that: 2017
Change in stitch bias: 0.026000771671533585
Largest abs bias change: 0.0055787041783332825
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.89 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    1,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    1,    0,    0,    0,    0,  954,    0,    2,    0],
        [   0,    0,    0,    1,    0,    0,    0, 1024,    1,    2],
        [   0,    0,    0,    0,    1,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/mix5unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 261.79
Epoch 1, loss 14.06
Epoch 2, loss 9.19
Epoch 3, loss 6.18
Epoch 4, loss 5.36
Epoch 5, loss 4.59
Epoch 6, loss 3.87
Epoch 7, loss 3.55
Epoch 8, loss 3.41
Epoch 9, loss 2.85
**** Finished Training ****
Change in stitch weights: 0.9403899312019348
Largest abs weight change: 0.051620058715343475
Number of weights changing > 0.1 of that: 6613
Change in stitch bias: 0.02658333070576191
Largest abs bias change: 0.0040026456117630005
Number of bias changing > 0.1 of that: 117
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1027,    0,    1],
        [   0,    0,    0,    0,    1,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/mix6unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 108.17
Epoch 1, loss 7.57
Epoch 2, loss 4.20
Epoch 3, loss 3.30
Epoch 4, loss 2.90
Epoch 5, loss 2.68
Epoch 6, loss 2.42
Epoch 7, loss 1.88
Epoch 8, loss 1.61
Epoch 9, loss 1.82
**** Finished Training ****
Change in stitch weights: 0.7937029600143433
Largest abs weight change: 0.02798694558441639
Number of weights changing > 0.1 of that: 20101
Change in stitch bias: 0.02592502348124981
Largest abs bias change: 0.0028517432510852814
Number of bias changing > 0.1 of that: 227
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    1,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/mix7unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 43.07
Epoch 1, loss 4.57
Epoch 2, loss 3.28
Epoch 3, loss 2.86
Epoch 4, loss 2.52
Epoch 5, loss 2.09
Epoch 6, loss 2.02
Epoch 7, loss 1.78
Epoch 8, loss 1.87
Epoch 9, loss 1.67
**** Finished Training ****
Change in stitch weights: 0.7939853072166443
Largest abs weight change: 0.013911801390349865
Number of weights changing > 0.1 of that: 98345
Change in stitch bias: 0.02587912604212761
Largest abs bias change: 0.002000674605369568
Number of bias changing > 0.1 of that: 461
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    1,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/mix8unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 43.51
Epoch 1, loss 4.18
Epoch 2, loss 3.24
Epoch 3, loss 2.32
Epoch 4, loss 2.09
Epoch 5, loss 2.03
Epoch 6, loss 2.03
Epoch 7, loss 1.82
Epoch 8, loss 1.58
Epoch 9, loss 1.64
**** Finished Training ****
Change in stitch weights: 0.7801142334938049
Largest abs weight change: 0.012737210839986801
Number of weights changing > 0.1 of that: 110266
Change in stitch bias: 0.02667883224785328
Largest abs bias change: 0.0020126961171627045
Number of bias changing > 0.1 of that: 470
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/bw3unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 382.41
Epoch 1, loss 84.82
Epoch 2, loss 62.15
Epoch 3, loss 50.77
Epoch 4, loss 43.53
Epoch 5, loss 39.36
Epoch 6, loss 35.21
Epoch 7, loss 32.57
Epoch 8, loss 30.54
Epoch 9, loss 27.89
**** Finished Training ****
Change in stitch weights: 1.2473249435424805
Largest abs weight change: 0.11601397395133972
Number of weights changing > 0.1 of that: 2008
Change in stitch bias: 0.02741939388215542
Largest abs bias change: 0.005636006593704224
Number of bias changing > 0.1 of that: 56
Test the trained stitch against biased data
Test Accuracy: 98.40 %
Confusion Matrix
tensor([[ 973,    0,    3,    0,    0,    0,    2,    2,    0,    0],
        [   0, 1131,    4,    0,    0,    0,    0,    0,    0,    0],
        [   7,    1, 1010,    6,    0,    0,    2,    1,    5,    0],
        [   0,    0,    1,  999,    0,    6,    0,    2,    2,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    3,    5],
        [   0,    0,    0,    9,    0,  881,    2,    0,    0,    0],
        [  13,    0,    1,    0,    2,    2,  938,    0,    2,    0],
        [   0,    0,    2,    1,    2,    0,    0, 1013,    5,    5],
        [  10,    0,    1,    5,    4,    0,    2,    1,  944,    7],
        [   5,    1,    0,    3,    8,    4,    0,    3,    8,  977]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bw4unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 211.90
Epoch 1, loss 55.18
Epoch 2, loss 44.12
Epoch 3, loss 38.75
Epoch 4, loss 34.81
Epoch 5, loss 32.36
Epoch 6, loss 30.48
Epoch 7, loss 29.03
Epoch 8, loss 27.84
Epoch 9, loss 26.39
**** Finished Training ****
Change in stitch weights: 1.0879638195037842
Largest abs weight change: 0.10522288829088211
Number of weights changing > 0.1 of that: 1675
Change in stitch bias: 0.02734028734266758
Largest abs bias change: 0.005709335207939148
Number of bias changing > 0.1 of that: 60
Test the trained stitch against biased data
Test Accuracy: 98.41 %
Confusion Matrix
tensor([[ 972,    2,    1,    0,    0,    0,    2,    1,    0,    2],
        [   0, 1127,    3,    0,    0,    0,    2,    1,    2,    0],
        [   6,    1, 1018,    1,    0,    0,    1,    5,    0,    0],
        [   0,    0,    0, 1001,    0,    6,    0,    0,    2,    1],
        [   0,    0,    2,    0,  970,    0,    0,    1,    2,    7],
        [   0,    0,    0,    8,    0,  881,    3,    0,    0,    0],
        [   3,    2,    0,    0,    3,    3,  943,    0,    4,    0],
        [   0,    0,    8,    3,    0,    0,    0, 1008,    1,    8],
        [  11,    0,    2,    5,    2,    2,    4,    5,  941,    2],
        [   2,    1,    0,    9,    5,    2,    0,    6,    4,  980]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bw5unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 208.14
Epoch 1, loss 44.71
Epoch 2, loss 35.62
Epoch 3, loss 30.94
Epoch 4, loss 27.89
Epoch 5, loss 25.56
Epoch 6, loss 23.69
Epoch 7, loss 22.42
Epoch 8, loss 20.72
Epoch 9, loss 19.72
**** Finished Training ****
Change in stitch weights: 1.0371146202087402
Largest abs weight change: 0.04926280677318573
Number of weights changing > 0.1 of that: 8060
Change in stitch bias: 0.027533406391739845
Largest abs bias change: 0.004002809524536133
Number of bias changing > 0.1 of that: 114
Test the trained stitch against biased data
Test Accuracy: 98.93 %
Confusion Matrix
tensor([[ 974,    1,    1,    0,    0,    0,    2,    1,    0,    1],
        [   0, 1131,    0,    0,    0,    0,    1,    0,    3,    0],
        [   4,    1, 1026,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1006,    0,    1,    0,    0,    3,    0],
        [   0,    0,    0,    0,  974,    0,    2,    1,    1,    4],
        [   0,    0,    0,    6,    0,  884,    0,    0,    2,    0],
        [   0,    2,    1,    0,    3,    2,  944,    0,    6,    0],
        [   0,    3,    0,    2,    0,    0,    0, 1016,    2,    5],
        [   1,    1,    1,    4,    3,    2,    3,    2,  955,    2],
        [   2,    1,    0,    8,    5,    1,    0,    5,    4,  983]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bw6unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 163.46
Epoch 1, loss 31.12
Epoch 2, loss 25.14
Epoch 3, loss 22.81
Epoch 4, loss 21.01
Epoch 5, loss 19.46
Epoch 6, loss 18.35
Epoch 7, loss 17.65
Epoch 8, loss 16.59
Epoch 9, loss 16.51
**** Finished Training ****
Change in stitch weights: 0.9056092500686646
Largest abs weight change: 0.037556253373622894
Number of weights changing > 0.1 of that: 14023
Change in stitch bias: 0.02662779577076435
Largest abs bias change: 0.002848505973815918
Number of bias changing > 0.1 of that: 230
Test the trained stitch against biased data
Test Accuracy: 99.08 %
Confusion Matrix
tensor([[ 978,    0,    1,    0,    0,    0,    1,    0,    0,    0],
        [   2, 1128,    2,    0,    0,    0,    2,    0,    1,    0],
        [   2,    0, 1028,    0,    0,    0,    1,    1,    0,    0],
        [   0,    0,    0, 1002,    0,    2,    0,    1,    5,    0],
        [   0,    0,    0,    0,  974,    0,    1,    0,    2,    5],
        [   0,    0,    0,    5,    0,  886,    1,    0,    0,    0],
        [   0,    2,    0,    0,    2,    1,  946,    0,    7,    0],
        [   0,    1,    3,    1,    0,    0,    0, 1016,    2,    5],
        [   1,    0,    0,    6,    2,    0,    1,    2,  962,    0],
        [   0,    0,    0,    2,    8,    0,    0,    3,    8,  988]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bw7unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 103.38
Epoch 1, loss 37.66
Epoch 2, loss 33.67
Epoch 3, loss 30.56
Epoch 4, loss 29.64
Epoch 5, loss 28.34
Epoch 6, loss 26.87
Epoch 7, loss 25.93
Epoch 8, loss 25.60
Epoch 9, loss 24.49
**** Finished Training ****
Change in stitch weights: 0.9336861968040466
Largest abs weight change: 0.016723744571208954
Number of weights changing > 0.1 of that: 86770
Change in stitch bias: 0.02621541917324066
Largest abs bias change: 0.0020198114216327667
Number of bias changing > 0.1 of that: 459
Test the trained stitch against biased data
Test Accuracy: 98.80 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    1,    1,    0,    0],
        [   3, 1127,    0,    2,    0,    0,    2,    0,    1,    0],
        [   3,    3, 1024,    0,    0,    0,    0,    1,    1,    0],
        [   0,    0,    0,  995,    0,    4,    0,    3,    7,    1],
        [   0,    0,    0,    0,  976,    2,    0,    0,    1,    3],
        [   0,    0,    0,    8,    0,  877,    2,    1,    4,    0],
        [   0,    2,    0,    0,    1,    9,  941,    0,    5,    0],
        [   0,    3,    4,    1,    0,    0,    0, 1009,    1,   10],
        [   1,    0,    0,    9,    0,    4,    1,    2,  957,    0],
        [   0,    0,    0,    4,    5,    1,    0,    2,    1,  996]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bw8unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 86.89
Epoch 1, loss 37.43
Epoch 2, loss 34.36
Epoch 3, loss 30.79
Epoch 4, loss 30.34
Epoch 5, loss 28.62
Epoch 6, loss 27.14
Epoch 7, loss 25.86
Epoch 8, loss 25.36
Epoch 9, loss 24.67
**** Finished Training ****
Change in stitch weights: 0.8986362814903259
Largest abs weight change: 0.01973416842520237
Number of weights changing > 0.1 of that: 59463
Change in stitch bias: 0.02752501145005226
Largest abs bias change: 0.0020139552652835846
Number of bias changing > 0.1 of that: 472
Test the trained stitch against biased data
Test Accuracy: 98.83 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    1,    1,    0,    0],
        [   0, 1128,    0,    3,    0,    0,    2,    0,    1,    1],
        [   3,    3, 1024,    0,    0,    0,    0,    1,    1,    0],
        [   0,    1,    0,  996,    0,    4,    0,    2,    7,    0],
        [   0,    0,    0,    0,  976,    0,    0,    0,    1,    5],
        [   1,    0,    0,    8,    0,  876,    3,    1,    3,    0],
        [   0,    2,    0,    0,    1,    9,  943,    0,    3,    0],
        [   0,    3,    2,    2,    0,    0,    0, 1014,    0,    7],
        [   1,    1,    0,   11,    0,    4,    0,    1,  956,    0],
        [   0,    0,    0,    5,    6,    2,    0,    3,    1,  992]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/bgonly3unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 391.43
Epoch 1, loss 48.04
Epoch 2, loss 30.74
Epoch 3, loss 23.37
Epoch 4, loss 17.63
Epoch 5, loss 15.50
Epoch 6, loss 13.03
Epoch 7, loss 12.32
Epoch 8, loss 11.12
Epoch 9, loss 10.78
**** Finished Training ****
Change in stitch weights: 1.1746844053268433
Largest abs weight change: 0.09901268035173416
Number of weights changing > 0.1 of that: 2233
Change in stitch bias: 0.024974534288048744
Largest abs bias change: 0.005662247538566589
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.90 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1027,    0,    3,    0,    1,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    2,    0,    0,    0,    1,  954,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bgonly4unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 110.75
Epoch 1, loss 17.22
Epoch 2, loss 12.54
Epoch 3, loss 8.09
Epoch 4, loss 6.53
Epoch 5, loss 5.79
Epoch 6, loss 5.48
Epoch 7, loss 4.66
Epoch 8, loss 4.66
Epoch 9, loss 3.93
**** Finished Training ****
Change in stitch weights: 0.770729124546051
Largest abs weight change: 0.06755627691745758
Number of weights changing > 0.1 of that: 2064
Change in stitch bias: 0.026888640597462654
Largest abs bias change: 0.005699045956134796
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 99.95 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    1,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  973,    1],
        [   1,    0,    0,    0,    0,    0,    0,    0,    1, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bgonly5unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 166.68
Epoch 1, loss 16.12
Epoch 2, loss 11.81
Epoch 3, loss 8.67
Epoch 4, loss 6.83
Epoch 5, loss 5.13
Epoch 6, loss 4.59
Epoch 7, loss 4.57
Epoch 8, loss 3.99
Epoch 9, loss 3.35
**** Finished Training ****
Change in stitch weights: 0.8449188470840454
Largest abs weight change: 0.03615449368953705
Number of weights changing > 0.1 of that: 8748
Change in stitch bias: 0.027675259858369827
Largest abs bias change: 0.004030883312225342
Number of bias changing > 0.1 of that: 113
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bgonly6unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 95.08
Epoch 1, loss 11.02
Epoch 2, loss 8.09
Epoch 3, loss 6.78
Epoch 4, loss 6.00
Epoch 5, loss 5.23
Epoch 6, loss 5.11
Epoch 7, loss 4.00
Epoch 8, loss 4.37
Epoch 9, loss 4.55
**** Finished Training ****
Change in stitch weights: 0.7693626880645752
Largest abs weight change: 0.024260882288217545
Number of weights changing > 0.1 of that: 24133
Change in stitch bias: 0.025521274656057358
Largest abs bias change: 0.0028417110443115234
Number of bias changing > 0.1 of that: 224
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bgonly7unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 43.00
Epoch 1, loss 8.39
Epoch 2, loss 6.50
Epoch 3, loss 6.36
Epoch 4, loss 5.56
Epoch 5, loss 5.96
Epoch 6, loss 5.97
Epoch 7, loss 4.91
Epoch 8, loss 5.15
Epoch 9, loss 5.01
**** Finished Training ****
Change in stitch weights: 0.7743025422096252
Largest abs weight change: 0.014790970832109451
Number of weights changing > 0.1 of that: 87979
Change in stitch bias: 0.02703055739402771
Largest abs bias change: 0.002017788589000702
Number of bias changing > 0.1 of that: 471
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    2,    0,    0, 1026,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bgonly8unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 35.97
Epoch 1, loss 8.42
Epoch 2, loss 7.34
Epoch 3, loss 6.28
Epoch 4, loss 5.75
Epoch 5, loss 5.91
Epoch 6, loss 5.70
Epoch 7, loss 5.30
Epoch 8, loss 5.94
Epoch 9, loss 5.22
**** Finished Training ****
Change in stitch weights: 0.7457086443901062
Largest abs weight change: 0.011290216818451881
Number of weights changing > 0.1 of that: 123662
Change in stitch bias: 0.026422524824738503
Largest abs bias change: 0.002020031213760376
Number of bias changing > 0.1 of that: 473
Test the trained stitch against biased data
Test Accuracy: 99.96 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    2,    0,    0, 1026,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/bg3unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 337.42
Epoch 1, loss 32.18
Epoch 2, loss 18.21
Epoch 3, loss 12.63
Epoch 4, loss 9.73
Epoch 5, loss 8.15
Epoch 6, loss 6.93
Epoch 7, loss 6.59
Epoch 8, loss 6.09
Epoch 9, loss 4.76
**** Finished Training ****
Change in stitch weights: 1.0601413249969482
Largest abs weight change: 0.10700336843729019
Number of weights changing > 0.1 of that: 1797
Change in stitch bias: 0.025370070710778236
Largest abs bias change: 0.0056019797921180725
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 99.88 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    1,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    0,    1,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  972,    2],
        [   1,    0,    0,    0,    0,    0,    0,    0,    4, 1004]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bg4unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 112.50
Epoch 1, loss 18.11
Epoch 2, loss 11.66
Epoch 3, loss 9.49
Epoch 4, loss 6.09
Epoch 5, loss 5.10
Epoch 6, loss 4.63
Epoch 7, loss 4.39
Epoch 8, loss 4.13
Epoch 9, loss 2.89
**** Finished Training ****
Change in stitch weights: 0.7783605456352234
Largest abs weight change: 0.08073090761899948
Number of weights changing > 0.1 of that: 1706
Change in stitch bias: 0.02694586291909218
Largest abs bias change: 0.00558122992515564
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    0,    2,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bg5unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 139.43
Epoch 1, loss 8.80
Epoch 2, loss 4.58
Epoch 3, loss 4.04
Epoch 4, loss 2.57
Epoch 5, loss 2.17
Epoch 6, loss 2.50
Epoch 7, loss 2.57
Epoch 8, loss 1.79
Epoch 9, loss 1.40
**** Finished Training ****
Change in stitch weights: 0.7666459679603577
Largest abs weight change: 0.04114064574241638
Number of weights changing > 0.1 of that: 6927
Change in stitch bias: 0.026735855266451836
Largest abs bias change: 0.0039731040596961975
Number of bias changing > 0.1 of that: 118
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bg6unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 153.65
Epoch 1, loss 8.72
Epoch 2, loss 6.03
Epoch 3, loss 4.10
Epoch 4, loss 3.04
Epoch 5, loss 2.39
Epoch 6, loss 2.25
Epoch 7, loss 2.04
Epoch 8, loss 1.73
Epoch 9, loss 1.55
**** Finished Training ****
Change in stitch weights: 0.8811809420585632
Largest abs weight change: 0.030516888946294785
Number of weights changing > 0.1 of that: 20213
Change in stitch bias: 0.02641226537525654
Largest abs bias change: 0.0028534941375255585
Number of bias changing > 0.1 of that: 234
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bg7unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 44.69
Epoch 1, loss 2.08
Epoch 2, loss 1.84
Epoch 3, loss 1.60
Epoch 4, loss 1.46
Epoch 5, loss 1.05
Epoch 6, loss 1.06
Epoch 7, loss 1.08
Epoch 8, loss 1.04
Epoch 9, loss 0.81
**** Finished Training ****
Change in stitch weights: 0.780380368232727
Largest abs weight change: 0.011002514511346817
Number of weights changing > 0.1 of that: 130195
Change in stitch bias: 0.026928821578621864
Largest abs bias change: 0.0020200423896312714
Number of bias changing > 0.1 of that: 457
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bg8unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 25.98
Epoch 1, loss 2.92
Epoch 2, loss 1.95
Epoch 3, loss 1.48
Epoch 4, loss 1.30
Epoch 5, loss 1.49
Epoch 6, loss 1.02
Epoch 7, loss 1.30
Epoch 8, loss 1.05
Epoch 9, loss 1.16
**** Finished Training ****
Change in stitch weights: 0.7237604856491089
Largest abs weight change: 0.010633978992700577
Number of weights changing > 0.1 of that: 130869
Change in stitch bias: 0.02610469050705433
Largest abs bias change: 0.002019912004470825
Number of bias changing > 0.1 of that: 470
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/bias3unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 360.78
Epoch 1, loss 36.17
Epoch 2, loss 21.33
Epoch 3, loss 15.80
Epoch 4, loss 12.18
Epoch 5, loss 10.35
Epoch 6, loss 9.22
Epoch 7, loss 7.62
Epoch 8, loss 7.43
Epoch 9, loss 6.20
**** Finished Training ****
Change in stitch weights: 1.071779727935791
Largest abs weight change: 0.09168189764022827
Number of weights changing > 0.1 of that: 2066
Change in stitch bias: 0.025415565818548203
Largest abs bias change: 0.005578160285949707
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.84 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1134,    0,    0,    0,    1,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    1,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    1,    0,    1,    0,  890,    0,    0,    0,    0],
        [   3,    2,    0,    0,    1,    1,  950,    0,    1,    0],
        [   0,    0,    0,    0,    1,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  973,    1],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bias4unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 258.88
Epoch 1, loss 20.67
Epoch 2, loss 14.06
Epoch 3, loss 9.57
Epoch 4, loss 8.07
Epoch 5, loss 6.42
Epoch 6, loss 5.61
Epoch 7, loss 5.39
Epoch 8, loss 4.74
Epoch 9, loss 4.39
**** Finished Training ****
Change in stitch weights: 1.0568938255310059
Largest abs weight change: 0.08805879950523376
Number of weights changing > 0.1 of that: 2167
Change in stitch bias: 0.026384906843304634
Largest abs bias change: 0.005612924695014954
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.95 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  957,    0,    1,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   1,    0,    0,    1,    0,    0,    0,    0,    1, 1006]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bias5unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 238.53
Epoch 1, loss 8.82
Epoch 2, loss 4.72
Epoch 3, loss 3.83
Epoch 4, loss 3.29
Epoch 5, loss 2.91
Epoch 6, loss 2.50
Epoch 7, loss 2.06
Epoch 8, loss 1.76
Epoch 9, loss 1.66
**** Finished Training ****
Change in stitch weights: 0.8593458533287048
Largest abs weight change: 0.048987820744514465
Number of weights changing > 0.1 of that: 6152
Change in stitch bias: 0.026544027030467987
Largest abs bias change: 0.004018634557723999
Number of bias changing > 0.1 of that: 114
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    1,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bias6unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 56.76
Epoch 1, loss 4.69
Epoch 2, loss 3.39
Epoch 3, loss 2.68
Epoch 4, loss 2.24
Epoch 5, loss 1.68
Epoch 6, loss 1.75
Epoch 7, loss 1.34
Epoch 8, loss 1.30
Epoch 9, loss 1.24
**** Finished Training ****
Change in stitch weights: 0.6967630982398987
Largest abs weight change: 0.026367276906967163
Number of weights changing > 0.1 of that: 18223
Change in stitch bias: 0.02787288837134838
Largest abs bias change: 0.002853885293006897
Number of bias changing > 0.1 of that: 233
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bias7unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 36.30
Epoch 1, loss 2.18
Epoch 2, loss 1.66
Epoch 3, loss 1.16
Epoch 4, loss 1.09
Epoch 5, loss 0.92
Epoch 6, loss 0.86
Epoch 7, loss 0.71
Epoch 8, loss 0.62
Epoch 9, loss 0.69
**** Finished Training ****
Change in stitch weights: 0.7664955854415894
Largest abs weight change: 0.01288757473230362
Number of weights changing > 0.1 of that: 107999
Change in stitch bias: 0.02612130716443062
Largest abs bias change: 0.002019837498664856
Number of bias changing > 0.1 of that: 454
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bias8unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 46.06
Epoch 1, loss 2.13
Epoch 2, loss 1.36
Epoch 3, loss 1.32
Epoch 4, loss 0.85
Epoch 5, loss 0.75
Epoch 6, loss 0.74
Epoch 7, loss 0.68
Epoch 8, loss 0.69
Epoch 9, loss 0.88
**** Finished Training ****
Change in stitch weights: 0.7805944681167603
Largest abs weight change: 0.010590944439172745
Number of weights changing > 0.1 of that: 134723
Change in stitch bias: 0.0254166591912508
Largest abs bias change: 0.002014521509408951
Number of bias changing > 0.1 of that: 447
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/unbias3unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 220.74
Epoch 1, loss 38.38
Epoch 2, loss 27.28
Epoch 3, loss 22.64
Epoch 4, loss 18.61
Epoch 5, loss 15.89
Epoch 6, loss 14.57
Epoch 7, loss 13.11
Epoch 8, loss 12.26
Epoch 9, loss 11.49
**** Finished Training ****
Change in stitch weights: 1.0248674154281616
Largest abs weight change: 0.12476030737161636
Number of weights changing > 0.1 of that: 1436
Change in stitch bias: 0.028985992074012756
Largest abs bias change: 0.005684554576873779
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.64 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    0,    1,    1,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1027,    0,    0,    0,    0,    0,    5,    0],
        [   0,    0,    1, 1006,    0,    3,    0,    0,    0,    0],
        [   0,    0,    0,    0,  978,    0,    0,    1,    2,    1],
        [   0,    0,    0,    1,    0,  891,    0,    0,    0,    0],
        [   4,    1,    0,    0,    1,    0,  952,    0,    0,    0],
        [   0,    0,    3,    0,    2,    0,    0, 1023,    0,    0],
        [   0,    0,    2,    0,    2,    0,    0,    0,  970,    0],
        [   0,    2,    0,    1,    0,    1,    0,    0,    1, 1004]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/unbias4unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 188.33
Epoch 1, loss 39.96
Epoch 2, loss 31.50
Epoch 3, loss 27.56
Epoch 4, loss 24.56
Epoch 5, loss 22.94
Epoch 6, loss 21.19
Epoch 7, loss 19.74
Epoch 8, loss 18.19
Epoch 9, loss 17.67
**** Finished Training ****
Change in stitch weights: 0.9534472823143005
Largest abs weight change: 0.11472560465335846
Number of weights changing > 0.1 of that: 1293
Change in stitch bias: 0.026262618601322174
Largest abs bias change: 0.005633987486362457
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 98.92 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    0,    0,    3,    1,    0],
        [   0, 1126,    2,    1,    1,    0,    1,    0,    4,    0],
        [   4,    1, 1023,    0,    0,    0,    0,    2,    2,    0],
        [   0,    0,    0, 1005,    0,    1,    0,    0,    3,    1],
        [   0,    0,    1,    1,  967,    0,    2,    0,    1,   10],
        [   0,    0,    0,    6,    0,  880,    4,    0,    2,    0],
        [   1,    1,    0,    0,    2,    4,  948,    0,    2,    0],
        [   0,    1,    3,    2,    0,    0,    1, 1019,    1,    1],
        [   2,    0,    1,    1,    0,    2,    2,    1,  965,    0],
        [   1,    2,    1,    7,    5,    2,    0,    6,    2,  983]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/unbias5unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 140.68
Epoch 1, loss 40.94
Epoch 2, loss 33.66
Epoch 3, loss 29.22
Epoch 4, loss 27.39
Epoch 5, loss 25.13
Epoch 6, loss 23.62
Epoch 7, loss 22.71
Epoch 8, loss 21.67
Epoch 9, loss 20.56
**** Finished Training ****
Change in stitch weights: 0.9216102361679077
Largest abs weight change: 0.05392289534211159
Number of weights changing > 0.1 of that: 6194
Change in stitch bias: 0.02686045691370964
Largest abs bias change: 0.00404057651758194
Number of bias changing > 0.1 of that: 116
Test the trained stitch against biased data
Test Accuracy: 98.48 %
Confusion Matrix
tensor([[ 973,    0,    3,    0,    0,    1,    1,    1,    1,    0],
        [   0, 1125,    2,    3,    0,    0,    3,    0,    2,    0],
        [   2,    0, 1025,    0,    0,    0,    0,    1,    4,    0],
        [   0,    0,    0, 1002,    0,    3,    0,    3,    2,    0],
        [   0,    0,    1,    2,  959,    0,    5,    0,    3,   12],
        [   0,    0,    0,    7,    0,  879,    3,    0,    3,    0],
        [   3,    2,    0,    1,    3,    1,  944,    0,    4,    0],
        [   0,    3,    9,    6,    0,    0,    0, 1003,    2,    5],
        [   3,    0,    1,    1,    1,    0,    4,    1,  960,    3],
        [   2,    4,    0,    6,    7,    3,    0,    5,    4,  978]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/unbias6unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 121.65
Epoch 1, loss 33.45
Epoch 2, loss 28.18
Epoch 3, loss 25.07
Epoch 4, loss 23.48
Epoch 5, loss 22.04
Epoch 6, loss 21.20
Epoch 7, loss 20.13
Epoch 8, loss 19.90
Epoch 9, loss 19.34
**** Finished Training ****
Change in stitch weights: 0.9131298661231995
Largest abs weight change: 0.04695974290370941
Number of weights changing > 0.1 of that: 8946
Change in stitch bias: 0.026428816840052605
Largest abs bias change: 0.0028572939336299896
Number of bias changing > 0.1 of that: 231
Test the trained stitch against biased data
Test Accuracy: 98.59 %
Confusion Matrix
tensor([[ 973,    0,    0,    0,    0,    2,    2,    2,    1,    0],
        [   0, 1130,    1,    1,    1,    0,    1,    0,    1,    0],
        [   3,    1, 1022,    0,    1,    0,    1,    1,    3,    0],
        [   0,    0,    0, 1001,    0,    4,    0,    2,    2,    1],
        [   0,    0,    2,    2,  959,    0,    0,    1,    2,   16],
        [   2,    0,    0,    9,    0,  877,    2,    0,    2,    0],
        [   1,    2,    0,    0,    2,    3,  946,    0,    4,    0],
        [   0,    1,    5,    3,    0,    0,    0, 1015,    1,    3],
        [   3,    0,    2,    3,    1,    4,    4,    2,  953,    2],
        [   2,    4,    0,    2,    6,    2,    0,    5,    5,  983]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/unbias7unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 84.23
Epoch 1, loss 26.06
Epoch 2, loss 23.81
Epoch 3, loss 22.30
Epoch 4, loss 21.63
Epoch 5, loss 20.32
Epoch 6, loss 19.76
Epoch 7, loss 19.37
Epoch 8, loss 19.16
Epoch 9, loss 18.83
**** Finished Training ****
Change in stitch weights: 0.8561040163040161
Largest abs weight change: 0.012603172101080418
Number of weights changing > 0.1 of that: 120386
Change in stitch bias: 0.026933731511235237
Largest abs bias change: 0.0020165741443634033
Number of bias changing > 0.1 of that: 465
Test the trained stitch against biased data
Test Accuracy: 98.66 %
Confusion Matrix
tensor([[ 974,    0,    1,    0,    0,    1,    2,    1,    1,    0],
        [   0, 1130,    1,    0,    0,    0,    2,    0,    2,    0],
        [   2,    0, 1023,    0,    0,    0,    1,    2,    4,    0],
        [   0,    0,    0, 1000,    0,    6,    0,    1,    2,    1],
        [   0,    0,    3,    0,  966,    0,    0,    1,    2,   10],
        [   3,    0,    0,    9,    0,  876,    2,    0,    2,    0],
        [   2,    3,    1,    0,    2,    3,  944,    0,    3,    0],
        [   0,    1,    4,    5,    0,    0,    0, 1015,    2,    1],
        [   2,    0,    1,    3,    2,    3,    1,    1,  958,    3],
        [   2,    3,    1,    5,    7,    1,    0,    3,    7,  980]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/unbias8unbias-bias-65_2024-08-07_23-34-49_SEED65_EPOCHS4_BGN0.1_exp2f_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 81.72
Epoch 1, loss 25.68
Epoch 2, loss 23.58
Epoch 3, loss 22.53
Epoch 4, loss 21.16
Epoch 5, loss 21.06
Epoch 6, loss 19.99
Epoch 7, loss 19.01
Epoch 8, loss 19.27
Epoch 9, loss 18.75
**** Finished Training ****
Change in stitch weights: 0.8479577302932739
Largest abs weight change: 0.011683733202517033
Number of weights changing > 0.1 of that: 129082
Change in stitch bias: 0.025841303169727325
Largest abs bias change: 0.002019435167312622
Number of bias changing > 0.1 of that: 455
Test the trained stitch against biased data
Test Accuracy: 98.62 %
Confusion Matrix
tensor([[ 974,    0,    0,    0,    0,    1,    3,    1,    1,    0],
        [   0, 1126,    1,    2,    2,    0,    2,    0,    2,    0],
        [   0,    0, 1023,    0,    1,    0,    1,    2,    5,    0],
        [   0,    0,    0, 1000,    0,    7,    0,    0,    2,    1],
        [   0,    0,    2,    0,  964,    0,    0,    1,    2,   13],
        [   1,    0,    0,    7,    0,  879,    2,    1,    2,    0],
        [   2,    3,    1,    0,    4,    7,  940,    0,    1,    0],
        [   0,    2,    4,    4,    0,    0,    0, 1014,    1,    3],
        [   2,    0,    1,    3,    2,    3,    2,    2,  956,    3],
        [   2,    4,    1,    4,    5,    1,    0,    1,    5,  986]],
       dtype=torch.int32)
===================================================================
stitching_accuracies={'mix': {'unbias': {3: 99.85, 4: 99.89, 5: 99.98, 6: 99.98, 7: 99.99, 8: 99.99}}, 'bw': {'unbias': {3: 98.4, 4: 98.41, 5: 98.93, 6: 99.08, 7: 98.8, 8: 98.83}}, 'bgonly': {'unbias': {3: 99.9, 4: 99.95, 5: 100.0, 6: 100.0, 7: 99.98, 8: 99.96}}, 'bg': {'unbias': {3: 99.88, 4: 99.98, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bias': {'unbias': {3: 99.84, 4: 99.95, 5: 99.99, 6: 100.0, 7: 100.0, 8: 100.0}}, 'unbias': {'unbias': {3: 99.64, 4: 98.92, 5: 98.48, 6: 98.59, 7: 98.66, 8: 98.62}}}
stitching_penalties={'mix': {'unbias': {3: -2.0, 4: -2.0400000000000063, 5: -2.1300000000000097, 6: -2.1300000000000097, 7: -2.1400000000000006, 8: -2.1400000000000006}}, 'bw': {'unbias': {3: -0.5500000000000114, 4: -0.5600000000000023, 5: -1.0800000000000125, 6: -1.230000000000004, 7: -0.9500000000000028, 8: -0.980000000000004}}, 'bgonly': {'unbias': {3: -2.0500000000000114, 4: -2.1000000000000085, 5: -2.1500000000000057, 6: -2.1500000000000057, 7: -2.1300000000000097, 8: -2.1099999999999994}}, 'bg': {'unbias': {3: -2.030000000000001, 4: -2.1300000000000097, 5: -2.1500000000000057, 6: -2.1500000000000057, 7: -2.1500000000000057, 8: -2.1500000000000057}}, 'bias': {'unbias': {3: -1.990000000000009, 4: -2.1000000000000085, 5: -2.1400000000000006, 6: -2.1500000000000057, 7: -2.1500000000000057, 8: -2.1500000000000057}}, 'unbias': {'unbias': {3: -1.7900000000000063, 4: -1.0700000000000074, 5: -0.6300000000000097, 6: -0.7400000000000091, 7: -0.8100000000000023, 8: -0.7700000000000102}}}
synth-mix
100.0
Stitch Accuracy
{3: 99.85, 4: 99.89, 5: 99.98, 6: 99.98, 7: 99.99, 8: 99.99}
--------------------------
synth-bw
67.23
Stitch Accuracy
{3: 98.4, 4: 98.41, 5: 98.93, 6: 99.08, 7: 98.8, 8: 98.83}
--------------------------
synth-bgonly
64.21
Stitch Accuracy
{3: 99.9, 4: 99.95, 5: 100.0, 6: 100.0, 7: 99.98, 8: 99.96}
--------------------------
synth-bg
100.0
Stitch Accuracy
{3: 99.88, 4: 99.98, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bias
100.0
Stitch Accuracy
{3: 99.84, 4: 99.95, 5: 99.99, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-unbias
97.85
Stitch Accuracy
{3: 99.64, 4: 98.92, 5: 98.48, 6: 98.59, 7: 98.66, 8: 98.62}
--------------------------
