Executed at 2024-08-06_17-10-45
logging to ./results_2f/2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_log.txt
seed=61
bg_noise=0.1
train_mix_mnist_model=False
mix_mnist_model_to_load='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_mix_mnist.weights'
train_bw_mnist_model=False
bw_mnist_model_to_load='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bw_mnist.weights'
train_bg_only_colour_mnist_model=False
bg_only_colour_mnist_model_to_load='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_only_colour_mnist.weights'
train_bg_unbiased_colour_mnist_model=False
bg_unbiased_colour_mnist_model_to_load='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_unbiased_colour_mnist.weights'
train_biased_colour_mnist_model=False
biased_colour_mnist_model_to_load='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_biased_colour_mnist.weights'
train_unbiased_colour_mnist_model=True
save_unbiased_colour_mnist_model_as='./results_2f/2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
original_train_epochs=4
stitch_train_epochs=10
================================================
val['loadfrom']='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_mix_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bw_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_only_colour_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_unbiased_colour_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_biased_colour_mnist.weights'
Train ResNet18 on unbias
Epoch 0, loss 276.44
Rebuilding unbias train_loader
Epoch 1, loss 60.45
Rebuilding unbias train_loader
Epoch 2, loss 37.20
Rebuilding unbias train_loader
Epoch 3, loss 29.34
Rebuilding unbias train_loader
**** Finished Training ****
saveas='./results_2f/2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
Entering Confusion
Accuracy Calculation for ResNet18 with key='mix'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 99.95 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   5,    0,    0,    0,    0,    0,  953,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bw'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 73.65 %
Confusion Matrix
tensor([[ 977,    0,    0,    0,    0,    0,    1,    1,    1,    0],
        [   5, 1103,    4,    0,    0,    0,    5,    0,   18,    0],
        [  16,    1,  983,    0,    0,    0,    3,    1,   28,    0],
        [ 152,   17,   24,    0,    0,    0,  162,    1,  654,    0],
        [   1,   82,    0,    0,  857,    0,   42,    0,    0,    0],
        [   8,   12,    0,    0,    0,    0,  871,    0,    1,    0],
        [   8,    4,    0,    0,    1,    0,  945,    0,    0,    0],
        [  22,   14,   20,    0,    4,    0,    1,  903,   60,    4],
        [  75,   11,    0,    0,    1,    0,   40,    0,  847,    0],
        [  46,   36,    0,    0,   19,    0,    8,   32,  118,  750]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bgonly'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 75.68 %
Confusion Matrix
tensor([[ 788,    0,    0,    0,    1,    0,   92,   99,    0,    0],
        [   0, 1133,    0,    0,    0,    2,    0,    0,    0,    0],
        [   0,    0,  102,    0,    0,    0,    0,    0,  930,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,  322,    0,    0,  636,    0,    0,    0],
        [   0,    0,    0,    0,  193,    0,    0,  835,    0,    0],
        [   0,    0,    0,    0,  340,    0,    0,    0,  634,    0],
        [   0,    0,    0,    0,  453,    0,    0,    0,    0,  556]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bg'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='unbias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 98.23 %
Confusion Matrix
tensor([[ 972,    1,    1,    0,    0,    2,    2,    1,    1,    0],
        [   0, 1131,    1,    1,    1,    0,    0,    0,    1,    0],
        [   0,    0, 1023,    0,    0,    0,    0,    4,    5,    0],
        [   0,    0,    2, 1002,    0,    1,    0,    1,    3,    1],
        [   0,    0,    5,    0,  968,    0,    0,    0,    2,    7],
        [   0,    0,    0,   22,    0,  865,    3,    1,    1,    0],
        [   3,    4,    3,    0,    3,   10,  926,    0,    9,    0],
        [   1,    4,    3,    1,    0,    0,    0, 1016,    1,    2],
        [   1,    4,    3,    3,    2,    1,    0,    4,  953,    3],
        [   4,    7,    2,    9,    8,    1,    0,    5,    6,  967]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'mix': 99.95, 'bw': 73.65, 'bgonly': 75.68, 'bg': 100.0, 'bias': 100.0, 'unbias': 98.23}
Entering whole model check
Measure Rank for key='mix'
Measure Rank for key='bw'
Measure Rank for key='bgonly'
Measure Rank for key='bg'
Measure Rank for key='bias'
Measure Rank for key='unbias'
Entering Stitch/Rank
device='cuda:0'
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/mix3unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 212.43
Epoch 1, loss 27.27
Epoch 2, loss 18.31
Epoch 3, loss 14.34
Epoch 4, loss 11.71
Epoch 5, loss 10.29
Epoch 6, loss 9.27
Epoch 7, loss 8.50
Epoch 8, loss 7.88
Epoch 9, loss 7.48
**** Finished Training ****
Change in stitch weights: 0.9337846636772156
Largest abs weight change: 0.09827480465173721
Number of weights changing > 0.1 of that: 1642
Change in stitch bias: 0.02607807330787182
Largest abs bias change: 0.005643434822559357
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 99.86 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    1, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   6,    1,    2,    0,    0,    0,  949,    0,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0, 1026,    1,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    1,    0,    0,    0,    0,    1,    0, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/mix4unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 266.16
Epoch 1, loss 22.25
Epoch 2, loss 15.22
Epoch 3, loss 12.08
Epoch 4, loss 9.32
Epoch 5, loss 8.40
Epoch 6, loss 7.44
Epoch 7, loss 6.47
Epoch 8, loss 5.69
Epoch 9, loss 5.68
**** Finished Training ****
Change in stitch weights: 0.9733049869537354
Largest abs weight change: 0.09408219158649445
Number of weights changing > 0.1 of that: 1863
Change in stitch bias: 0.025217680260539055
Largest abs bias change: 0.005636200308799744
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.91 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    0,    1],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   3,    0,    0,    0,    0,    0,  953,    0,    2,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    2,    0,    0,    0,    0, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/mix5unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 179.45
Epoch 1, loss 16.72
Epoch 2, loss 9.86
Epoch 3, loss 7.40
Epoch 4, loss 6.28
Epoch 5, loss 5.54
Epoch 6, loss 4.36
Epoch 7, loss 3.88
Epoch 8, loss 3.33
Epoch 9, loss 3.06
**** Finished Training ****
Change in stitch weights: 0.9274749159812927
Largest abs weight change: 0.04831225425004959
Number of weights changing > 0.1 of that: 7588
Change in stitch bias: 0.026989391073584557
Largest abs bias change: 0.004038356244564056
Number of bias changing > 0.1 of that: 112
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/mix6unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 108.60
Epoch 1, loss 4.67
Epoch 2, loss 3.49
Epoch 3, loss 2.90
Epoch 4, loss 2.38
Epoch 5, loss 2.14
Epoch 6, loss 1.95
Epoch 7, loss 1.79
Epoch 8, loss 1.52
Epoch 9, loss 1.47
**** Finished Training ****
Change in stitch weights: 0.7498746514320374
Largest abs weight change: 0.020502153784036636
Number of weights changing > 0.1 of that: 29717
Change in stitch bias: 0.027803877368569374
Largest abs bias change: 0.0028550587594509125
Number of bias changing > 0.1 of that: 226
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/mix7unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 40.48
Epoch 1, loss 2.80
Epoch 2, loss 2.52
Epoch 3, loss 1.92
Epoch 4, loss 1.97
Epoch 5, loss 1.64
Epoch 6, loss 1.47
Epoch 7, loss 1.36
Epoch 8, loss 1.22
Epoch 9, loss 1.56
**** Finished Training ****
Change in stitch weights: 0.7662661671638489
Largest abs weight change: 0.009116627275943756
Number of weights changing > 0.1 of that: 151607
Change in stitch bias: 0.02615669183433056
Largest abs bias change: 0.002010870724916458
Number of bias changing > 0.1 of that: 468
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/mix8unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 33.66
Epoch 1, loss 2.87
Epoch 2, loss 2.10
Epoch 3, loss 1.80
Epoch 4, loss 1.70
Epoch 5, loss 1.48
Epoch 6, loss 1.26
Epoch 7, loss 1.29
Epoch 8, loss 1.11
Epoch 9, loss 1.26
**** Finished Training ****
Change in stitch weights: 0.752678632736206
Largest abs weight change: 0.010586857795715332
Number of weights changing > 0.1 of that: 133338
Change in stitch bias: 0.02648717164993286
Largest abs bias change: 0.002019379287958145
Number of bias changing > 0.1 of that: 466
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/bw3unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 250.73
Epoch 1, loss 79.81
Epoch 2, loss 62.68
Epoch 3, loss 54.11
Epoch 4, loss 47.01
Epoch 5, loss 43.32
Epoch 6, loss 39.96
Epoch 7, loss 37.24
Epoch 8, loss 35.21
Epoch 9, loss 33.23
**** Finished Training ****
Change in stitch weights: 1.1292520761489868
Largest abs weight change: 0.11750520765781403
Number of weights changing > 0.1 of that: 1546
Change in stitch bias: 0.02627742290496826
Largest abs bias change: 0.0057148560881614685
Number of bias changing > 0.1 of that: 56
Test the trained stitch against biased data
Test Accuracy: 98.14 %
Confusion Matrix
tensor([[ 972,    2,    1,    1,    0,    0,    0,    3,    1,    0],
        [   0, 1128,    3,    1,    2,    0,    0,    1,    0,    0],
        [   4,    0, 1017,    2,    0,    0,    0,    4,    5,    0],
        [   0,    0,    1,  998,    0,    7,    0,    1,    1,    2],
        [   0,    0,    1,    1,  972,    0,    3,    1,    1,    3],
        [   0,    0,    0,   13,    0,  873,    2,    0,    3,    1],
        [   8,    3,    1,    1,    3,    0,  933,    0,    9,    0],
        [   0,    1,    6,    3,    1,    1,    0,  995,    2,   19],
        [   3,    1,    2,    9,    2,    1,    0,    6,  941,    9],
        [   1,    1,    1,    3,   11,    0,    0,    6,    1,  985]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bw4unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 192.81
Epoch 1, loss 59.61
Epoch 2, loss 47.21
Epoch 3, loss 41.27
Epoch 4, loss 36.85
Epoch 5, loss 34.07
Epoch 6, loss 31.99
Epoch 7, loss 30.03
Epoch 8, loss 28.58
Epoch 9, loss 27.01
**** Finished Training ****
Change in stitch weights: 1.0836952924728394
Largest abs weight change: 0.12293700873851776
Number of weights changing > 0.1 of that: 1384
Change in stitch bias: 0.024490730836987495
Largest abs bias change: 0.005594119429588318
Number of bias changing > 0.1 of that: 56
Test the trained stitch against biased data
Test Accuracy: 98.34 %
Confusion Matrix
tensor([[ 975,    1,    1,    0,    0,    0,    2,    1,    0,    0],
        [   0, 1125,    3,    0,    1,    1,    2,    0,    3,    0],
        [   7,    0, 1024,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0,  990,    0,   13,    0,    1,    5,    1],
        [   0,    0,    0,    0,  963,    0,    6,    1,    5,    7],
        [   1,    0,    0,    5,    0,  883,    0,    0,    2,    1],
        [   8,    4,    0,    0,    2,    0,  938,    0,    6,    0],
        [   0,    2,    7,    2,    0,    0,    0, 1010,    4,    3],
        [   7,    0,    6,    5,    2,    1,    1,    2,  944,    6],
        [   2,    4,    3,    1,    9,    0,    0,    5,    3,  982]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bw5unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 398.94
Epoch 1, loss 46.92
Epoch 2, loss 36.52
Epoch 3, loss 31.60
Epoch 4, loss 29.02
Epoch 5, loss 26.22
Epoch 6, loss 24.65
Epoch 7, loss 23.79
Epoch 8, loss 22.55
Epoch 9, loss 20.95
**** Finished Training ****
Change in stitch weights: 1.0815480947494507
Largest abs weight change: 0.07044688612222672
Number of weights changing > 0.1 of that: 5897
Change in stitch bias: 0.026255855336785316
Largest abs bias change: 0.004005305469036102
Number of bias changing > 0.1 of that: 122
Test the trained stitch against biased data
Test Accuracy: 98.66 %
Confusion Matrix
tensor([[ 975,    1,    1,    0,    0,    0,    0,    1,    1,    1],
        [   0, 1128,    3,    0,    0,    0,    0,    0,    4,    0],
        [   3,    4, 1023,    0,    0,    0,    0,    1,    1,    0],
        [   0,    0,    0,  995,    0,    8,    0,    0,    6,    1],
        [   0,    0,    0,    1,  968,    0,    2,    0,    3,    8],
        [   0,    0,    0,   10,    0,  880,    2,    0,    0,    0],
        [   6,    0,    0,    0,    6,    0,  943,    0,    3,    0],
        [   0,    5,    4,    0,    0,    0,    0, 1011,    1,    7],
        [   2,    0,    2,    4,    4,    1,    1,    1,  957,    2],
        [   1,    0,    0,    2,   11,    0,    0,    3,    6,  986]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bw6unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 187.11
Epoch 1, loss 36.16
Epoch 2, loss 28.68
Epoch 3, loss 24.69
Epoch 4, loss 22.34
Epoch 5, loss 20.53
Epoch 6, loss 19.92
Epoch 7, loss 18.15
Epoch 8, loss 17.44
Epoch 9, loss 16.68
**** Finished Training ****
Change in stitch weights: 0.9959902763366699
Largest abs weight change: 0.040306899696588516
Number of weights changing > 0.1 of that: 16162
Change in stitch bias: 0.02771078050136566
Largest abs bias change: 0.0028534047305583954
Number of bias changing > 0.1 of that: 234
Test the trained stitch against biased data
Test Accuracy: 98.89 %
Confusion Matrix
tensor([[ 971,    2,    5,    0,    0,    0,    0,    1,    1,    0],
        [   1, 1129,    3,    0,    0,    0,    0,    1,    1,    0],
        [   2,    2, 1026,    0,    0,    0,    0,    1,    1,    0],
        [   0,    0,    0, 1003,    1,    1,    0,    2,    3,    0],
        [   0,    0,    0,    1,  970,    0,    1,    0,    1,    9],
        [   0,    0,    0,   12,    0,  879,    0,    0,    1,    0],
        [   1,    1,    0,    0,    2,    2,  949,    0,    3,    0],
        [   0,    4,    3,    0,    0,    0,    0, 1014,    1,    6],
        [   1,    1,    0,    4,    0,    1,    1,    2,  959,    5],
        [   0,    2,    0,    4,    4,    0,    0,    4,    6,  989]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bw7unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 89.43
Epoch 1, loss 39.60
Epoch 2, loss 34.70
Epoch 3, loss 31.89
Epoch 4, loss 29.94
Epoch 5, loss 28.31
Epoch 6, loss 26.80
Epoch 7, loss 26.53
Epoch 8, loss 25.77
Epoch 9, loss 24.59
**** Finished Training ****
Change in stitch weights: 0.9004857540130615
Largest abs weight change: 0.02935045212507248
Number of weights changing > 0.1 of that: 17699
Change in stitch bias: 0.027123592793941498
Largest abs bias change: 0.0020156651735305786
Number of bias changing > 0.1 of that: 467
Test the trained stitch against biased data
Test Accuracy: 98.49 %
Confusion Matrix
tensor([[ 977,    0,    1,    0,    0,    1,    0,    0,    1,    0],
        [   1, 1127,    2,    0,    0,    0,    0,    1,    4,    0],
        [   3,    2, 1024,    2,    0,    0,    0,    1,    0,    0],
        [   4,    0,    0,  992,    0,    4,    0,    1,    9,    0],
        [   0,    0,    0,    0,  965,    1,    5,    0,    1,   10],
        [   2,    0,    0,   12,    0,  875,    2,    0,    1,    0],
        [   1,    1,    0,    0,    2,    9,  945,    0,    0,    0],
        [   0,    4,    3,    1,    0,    0,    0, 1016,    0,    4],
        [   3,    0,    0,   21,    2,    3,    1,    2,  938,    4],
        [   0,    1,    0,    8,    4,    0,    0,    4,    2,  990]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bw8unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 91.50
Epoch 1, loss 38.59
Epoch 2, loss 33.46
Epoch 3, loss 31.07
Epoch 4, loss 29.22
Epoch 5, loss 28.00
Epoch 6, loss 26.52
Epoch 7, loss 25.61
Epoch 8, loss 25.05
Epoch 9, loss 24.36
**** Finished Training ****
Change in stitch weights: 0.8963188529014587
Largest abs weight change: 0.02285684272646904
Number of weights changing > 0.1 of that: 38573
Change in stitch bias: 0.02699272148311138
Largest abs bias change: 0.0020191147923469543
Number of bias changing > 0.1 of that: 469
Test the trained stitch against biased data
Test Accuracy: 98.50 %
Confusion Matrix
tensor([[ 974,    0,    3,    0,    0,    1,    0,    1,    1,    0],
        [   0, 1128,    0,    0,    0,    0,    0,    3,    4,    0],
        [   2,    5, 1021,    2,    0,    0,    0,    2,    0,    0],
        [   3,    0,    0,  988,    0,    6,    0,    2,   10,    1],
        [   0,    0,    0,    0,  973,    0,    1,    0,    0,    8],
        [   0,    0,    0,   11,    0,  879,    0,    0,    2,    0],
        [   1,    2,    0,    0,    3,    7,  944,    0,    1,    0],
        [   0,    3,    2,    1,    0,    0,    0, 1019,    0,    3],
        [   3,    0,    0,   16,    3,    5,    1,    2,  939,    5],
        [   0,    1,    0,    7,   10,    0,    0,    4,    2,  985]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/bgonly3unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 387.20
Epoch 1, loss 39.37
Epoch 2, loss 27.46
Epoch 3, loss 21.11
Epoch 4, loss 19.38
Epoch 5, loss 15.46
Epoch 6, loss 14.34
Epoch 7, loss 13.37
Epoch 8, loss 12.00
Epoch 9, loss 11.28
**** Finished Training ****
Change in stitch weights: 1.0598212480545044
Largest abs weight change: 0.12044030427932739
Number of weights changing > 0.1 of that: 1806
Change in stitch bias: 0.024937089532613754
Largest abs bias change: 0.005656979978084564
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 99.93 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    2,    0,    0,    1,    2,  953,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    1,    1, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bgonly4unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 247.76
Epoch 1, loss 36.75
Epoch 2, loss 22.85
Epoch 3, loss 17.54
Epoch 4, loss 14.20
Epoch 5, loss 12.01
Epoch 6, loss 10.48
Epoch 7, loss 9.33
Epoch 8, loss 8.71
Epoch 9, loss 7.57
**** Finished Training ****
Change in stitch weights: 1.0162711143493652
Largest abs weight change: 0.10654839873313904
Number of weights changing > 0.1 of that: 1796
Change in stitch bias: 0.025371748954057693
Largest abs bias change: 0.005693413317203522
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bgonly5unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 170.00
Epoch 1, loss 14.11
Epoch 2, loss 9.19
Epoch 3, loss 7.77
Epoch 4, loss 6.10
Epoch 5, loss 4.15
Epoch 6, loss 3.67
Epoch 7, loss 4.02
Epoch 8, loss 3.20
Epoch 9, loss 2.56
**** Finished Training ****
Change in stitch weights: 0.8227599263191223
Largest abs weight change: 0.03670259565114975
Number of weights changing > 0.1 of that: 8565
Change in stitch bias: 0.02586391568183899
Largest abs bias change: 0.0040302276611328125
Number of bias changing > 0.1 of that: 112
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bgonly6unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 63.06
Epoch 1, loss 8.68
Epoch 2, loss 5.82
Epoch 3, loss 5.73
Epoch 4, loss 4.61
Epoch 5, loss 4.57
Epoch 6, loss 3.82
Epoch 7, loss 3.80
Epoch 8, loss 3.54
Epoch 9, loss 3.37
**** Finished Training ****
Change in stitch weights: 0.702726423740387
Largest abs weight change: 0.02372554875910282
Number of weights changing > 0.1 of that: 23490
Change in stitch bias: 0.026741374284029007
Largest abs bias change: 0.002832077443599701
Number of bias changing > 0.1 of that: 231
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bgonly7unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 33.00
Epoch 1, loss 6.45
Epoch 2, loss 5.94
Epoch 3, loss 5.33
Epoch 4, loss 4.40
Epoch 5, loss 4.79
Epoch 6, loss 4.07
Epoch 7, loss 3.87
Epoch 8, loss 4.04
Epoch 9, loss 3.86
**** Finished Training ****
Change in stitch weights: 0.7528310418128967
Largest abs weight change: 0.012300441972911358
Number of weights changing > 0.1 of that: 113345
Change in stitch bias: 0.02572428248822689
Largest abs bias change: 0.002013321965932846
Number of bias changing > 0.1 of that: 459
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bgonly8unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 36.98
Epoch 1, loss 7.00
Epoch 2, loss 6.17
Epoch 3, loss 5.95
Epoch 4, loss 5.02
Epoch 5, loss 4.52
Epoch 6, loss 4.34
Epoch 7, loss 4.06
Epoch 8, loss 4.01
Epoch 9, loss 3.93
**** Finished Training ****
Change in stitch weights: 0.766074001789093
Largest abs weight change: 0.012831778265535831
Number of weights changing > 0.1 of that: 108864
Change in stitch bias: 0.02642403356730938
Largest abs bias change: 0.0020197704434394836
Number of bias changing > 0.1 of that: 451
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/bg3unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 340.39
Epoch 1, loss 38.98
Epoch 2, loss 26.71
Epoch 3, loss 20.98
Epoch 4, loss 17.01
Epoch 5, loss 14.55
Epoch 6, loss 12.87
Epoch 7, loss 11.58
Epoch 8, loss 10.56
Epoch 9, loss 10.00
**** Finished Training ****
Change in stitch weights: 1.0930219888687134
Largest abs weight change: 0.0887836217880249
Number of weights changing > 0.1 of that: 2133
Change in stitch bias: 0.025026574730873108
Largest abs bias change: 0.005370579659938812
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.89 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    0,    2,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    1,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    1,    0,  956,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1026,    0,    2],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    1,    0,    1,    0,    0,    2,    0, 1005]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bg4unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 422.72
Epoch 1, loss 30.72
Epoch 2, loss 18.93
Epoch 3, loss 13.74
Epoch 4, loss 11.70
Epoch 5, loss 8.80
Epoch 6, loss 8.37
Epoch 7, loss 6.78
Epoch 8, loss 6.14
Epoch 9, loss 5.80
**** Finished Training ****
Change in stitch weights: 1.0002528429031372
Largest abs weight change: 0.09778332710266113
Number of weights changing > 0.1 of that: 1884
Change in stitch bias: 0.024845104664564133
Largest abs bias change: 0.005681216716766357
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.93 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    1,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    1,    0,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    1,    1,    0,    0,    0,    3, 1004]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bg5unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 169.79
Epoch 1, loss 8.02
Epoch 2, loss 6.25
Epoch 3, loss 4.18
Epoch 4, loss 2.87
Epoch 5, loss 3.24
Epoch 6, loss 2.92
Epoch 7, loss 2.77
Epoch 8, loss 2.07
Epoch 9, loss 1.86
**** Finished Training ****
Change in stitch weights: 0.7679091095924377
Largest abs weight change: 0.03750583156943321
Number of weights changing > 0.1 of that: 7764
Change in stitch bias: 0.026042262092232704
Largest abs bias change: 0.004033051431179047
Number of bias changing > 0.1 of that: 113
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bg6unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 126.68
Epoch 1, loss 6.24
Epoch 2, loss 3.79
Epoch 3, loss 2.96
Epoch 4, loss 2.34
Epoch 5, loss 2.04
Epoch 6, loss 1.61
Epoch 7, loss 1.81
Epoch 8, loss 1.38
Epoch 9, loss 1.74
**** Finished Training ****
Change in stitch weights: 0.8055943846702576
Largest abs weight change: 0.02745152823626995
Number of weights changing > 0.1 of that: 22428
Change in stitch bias: 0.025790488347411156
Largest abs bias change: 0.0028451457619667053
Number of bias changing > 0.1 of that: 227
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bg7unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 36.06
Epoch 1, loss 2.88
Epoch 2, loss 1.83
Epoch 3, loss 1.56
Epoch 4, loss 1.39
Epoch 5, loss 1.20
Epoch 6, loss 1.12
Epoch 7, loss 0.88
Epoch 8, loss 1.04
Epoch 9, loss 1.15
**** Finished Training ****
Change in stitch weights: 0.7634257078170776
Largest abs weight change: 0.010085657238960266
Number of weights changing > 0.1 of that: 140054
Change in stitch bias: 0.026690587401390076
Largest abs bias change: 0.0020163021981716156
Number of bias changing > 0.1 of that: 470
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bg8unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 45.12
Epoch 1, loss 2.41
Epoch 2, loss 1.99
Epoch 3, loss 1.59
Epoch 4, loss 1.24
Epoch 5, loss 1.13
Epoch 6, loss 0.95
Epoch 7, loss 0.99
Epoch 8, loss 1.16
Epoch 9, loss 0.73
**** Finished Training ****
Change in stitch weights: 0.7761602401733398
Largest abs weight change: 0.01168157160282135
Number of weights changing > 0.1 of that: 122719
Change in stitch bias: 0.027399413287639618
Largest abs bias change: 0.002018749713897705
Number of bias changing > 0.1 of that: 457
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/bias3unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 317.46
Epoch 1, loss 31.32
Epoch 2, loss 21.24
Epoch 3, loss 16.44
Epoch 4, loss 14.31
Epoch 5, loss 12.00
Epoch 6, loss 11.41
Epoch 7, loss 10.12
Epoch 8, loss 9.41
Epoch 9, loss 8.73
**** Finished Training ****
Change in stitch weights: 1.0434222221374512
Largest abs weight change: 0.1005483940243721
Number of weights changing > 0.1 of that: 1941
Change in stitch bias: 0.027529822662472725
Largest abs bias change: 0.005616150796413422
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.89 %
Confusion Matrix
tensor([[ 978,    1,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    1,    0,    0,    1,    0,  956,    0,    0,    0],
        [   0,    0,    2,    0,    0,    0,    0, 1025,    1,    0],
        [   0,    0,    0,    0,    2,    0,    0,    0,  971,    1],
        [   0,    0,    0,    1,    0,    0,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bias4unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 251.46
Epoch 1, loss 34.10
Epoch 2, loss 21.91
Epoch 3, loss 15.94
Epoch 4, loss 12.93
Epoch 5, loss 10.88
Epoch 6, loss 9.08
Epoch 7, loss 8.13
Epoch 8, loss 7.27
Epoch 9, loss 6.43
**** Finished Training ****
Change in stitch weights: 1.0879766941070557
Largest abs weight change: 0.11558850854635239
Number of weights changing > 0.1 of that: 1689
Change in stitch bias: 0.024309596046805382
Largest abs bias change: 0.0056328922510147095
Number of bias changing > 0.1 of that: 55
Test the trained stitch against biased data
Test Accuracy: 99.91 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    1,    0],
        [   0,    1,    0,    0,  981,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  957,    0,    0,    0],
        [   4,    0,    0,    0,    0,    0,    0, 1024,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    2, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bias5unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 499.07
Epoch 1, loss 13.42
Epoch 2, loss 8.82
Epoch 3, loss 5.94
Epoch 4, loss 4.60
Epoch 5, loss 3.90
Epoch 6, loss 3.14
Epoch 7, loss 3.92
Epoch 8, loss 2.71
Epoch 9, loss 2.46
**** Finished Training ****
Change in stitch weights: 0.9263579249382019
Largest abs weight change: 0.05209272354841232
Number of weights changing > 0.1 of that: 6686
Change in stitch bias: 0.02753804624080658
Largest abs bias change: 0.004012309014797211
Number of bias changing > 0.1 of that: 114
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bias6unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 162.36
Epoch 1, loss 3.54
Epoch 2, loss 1.86
Epoch 3, loss 1.95
Epoch 4, loss 1.14
Epoch 5, loss 1.09
Epoch 6, loss 0.83
Epoch 7, loss 0.94
Epoch 8, loss 0.83
Epoch 9, loss 0.68
**** Finished Training ****
Change in stitch weights: 0.7627775073051453
Largest abs weight change: 0.029629074037075043
Number of weights changing > 0.1 of that: 17622
Change in stitch bias: 0.02511502429842949
Largest abs bias change: 0.0028576217591762543
Number of bias changing > 0.1 of that: 225
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bias7unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 40.88
Epoch 1, loss 2.57
Epoch 2, loss 1.63
Epoch 3, loss 1.81
Epoch 4, loss 1.22
Epoch 5, loss 1.04
Epoch 6, loss 0.86
Epoch 7, loss 0.96
Epoch 8, loss 0.74
Epoch 9, loss 0.76
**** Finished Training ****
Change in stitch weights: 0.7675524353981018
Largest abs weight change: 0.021681426092982292
Number of weights changing > 0.1 of that: 31640
Change in stitch bias: 0.02624441683292389
Largest abs bias change: 0.001998934894800186
Number of bias changing > 0.1 of that: 457
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/bias8unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 37.02
Epoch 1, loss 2.56
Epoch 2, loss 2.02
Epoch 3, loss 1.40
Epoch 4, loss 1.82
Epoch 5, loss 1.18
Epoch 6, loss 0.98
Epoch 7, loss 0.77
Epoch 8, loss 0.93
Epoch 9, loss 0.65
**** Finished Training ****
Change in stitch weights: 0.7634199857711792
Largest abs weight change: 0.020252155140042305
Number of weights changing > 0.1 of that: 38582
Change in stitch bias: 0.027272233739495277
Largest abs bias change: 0.002018202096223831
Number of bias changing > 0.1 of that: 464
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2f_rank/unbias3unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 502.01
Epoch 1, loss 40.56
Epoch 2, loss 28.53
Epoch 3, loss 22.23
Epoch 4, loss 18.82
Epoch 5, loss 16.07
Epoch 6, loss 14.15
Epoch 7, loss 12.58
Epoch 8, loss 11.34
Epoch 9, loss 10.55
**** Finished Training ****
Change in stitch weights: 1.0811512470245361
Largest abs weight change: 0.15143230557441711
Number of weights changing > 0.1 of that: 1180
Change in stitch bias: 0.026483340188860893
Largest abs bias change: 0.005687527358531952
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 99.60 %
Confusion Matrix
tensor([[ 977,    0,    0,    0,    0,    0,    0,    1,    2,    0],
        [   0, 1131,    1,    0,    3,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    2, 1008,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    2,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    3,    0,    1,    0,  953,    0,    0,    0],
        [   1,    1,    6,    1,    1,    0,    0, 1017,    0,    1],
        [   0,    0,    3,    0,    0,    0,    0,    0,  970,    1],
        [   0,    0,    1,    2,    2,    0,    0,    4,    0, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/unbias4unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 191.31
Epoch 1, loss 48.69
Epoch 2, loss 37.26
Epoch 3, loss 31.65
Epoch 4, loss 27.35
Epoch 5, loss 24.82
Epoch 6, loss 22.91
Epoch 7, loss 21.37
Epoch 8, loss 19.85
Epoch 9, loss 18.72
**** Finished Training ****
Change in stitch weights: 1.0099579095840454
Largest abs weight change: 0.15428635478019714
Number of weights changing > 0.1 of that: 947
Change in stitch bias: 0.024992963299155235
Largest abs bias change: 0.005639471113681793
Number of bias changing > 0.1 of that: 55
Test the trained stitch against biased data
Test Accuracy: 98.90 %
Confusion Matrix
tensor([[ 974,    0,    0,    0,    0,    1,    2,    2,    1,    0],
        [   0, 1128,    0,    2,    3,    0,    1,    0,    1,    0],
        [   5,    0, 1020,    1,    0,    0,    0,    2,    4,    0],
        [   0,    0,    2,  999,    0,    3,    0,    1,    2,    3],
        [   0,    0,    0,    0,  977,    0,    0,    3,    2,    0],
        [   0,    0,    0,    1,    0,  888,    1,    0,    2,    0],
        [   7,    5,    0,    0,    3,    0,  939,    0,    4,    0],
        [   0,    1,    0,    0,    0,    0,    0, 1022,    1,    4],
        [   2,    1,    5,    2,    2,    0,    0,    1,  957,    4],
        [   3,    5,    1,    8,    4,    0,    0,    2,    0,  986]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/unbias5unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 152.89
Epoch 1, loss 43.27
Epoch 2, loss 35.58
Epoch 3, loss 31.54
Epoch 4, loss 28.57
Epoch 5, loss 26.80
Epoch 6, loss 25.86
Epoch 7, loss 24.10
Epoch 8, loss 23.25
Epoch 9, loss 21.70
**** Finished Training ****
Change in stitch weights: 0.9657596945762634
Largest abs weight change: 0.06688474863767624
Number of weights changing > 0.1 of that: 4908
Change in stitch bias: 0.025558320805430412
Largest abs bias change: 0.003974556922912598
Number of bias changing > 0.1 of that: 116
Test the trained stitch against biased data
Test Accuracy: 98.56 %
Confusion Matrix
tensor([[ 974,    0,    1,    0,    0,    0,    2,    1,    2,    0],
        [   0, 1125,    0,    1,    2,    0,    3,    2,    2,    0],
        [   6,    0, 1019,    0,    0,    0,    0,    1,    6,    0],
        [   0,    0,    2,  998,    0,    6,    0,    1,    3,    0],
        [   0,    1,    0,    0,  968,    0,    2,    3,    4,    4],
        [   0,    0,    0,    9,    0,  879,    2,    1,    1,    0],
        [   5,    2,    0,    0,    3,    2,  942,    0,    4,    0],
        [   1,    4,    5,    1,    0,    0,    0, 1015,    1,    1],
        [   6,    1,    2,    3,    0,    1,    1,    4,  956,    0],
        [   4,    4,    0,    5,    5,    2,    0,    3,    6,  980]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/unbias6unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 160.12
Epoch 1, loss 34.75
Epoch 2, loss 28.89
Epoch 3, loss 26.21
Epoch 4, loss 24.02
Epoch 5, loss 23.18
Epoch 6, loss 21.71
Epoch 7, loss 21.31
Epoch 8, loss 20.09
Epoch 9, loss 20.02
**** Finished Training ****
Change in stitch weights: 0.9238501191139221
Largest abs weight change: 0.0479733869433403
Number of weights changing > 0.1 of that: 9248
Change in stitch bias: 0.025372492149472237
Largest abs bias change: 0.0027820803225040436
Number of bias changing > 0.1 of that: 224
Test the trained stitch against biased data
Test Accuracy: 98.67 %
Confusion Matrix
tensor([[ 972,    0,    1,    0,    0,    2,    2,    1,    1,    1],
        [   0, 1130,    1,    1,    1,    0,    0,    0,    2,    0],
        [   3,    0, 1023,    0,    0,    0,    0,    1,    5,    0],
        [   0,    0,    1, 1000,    0,    5,    0,    1,    3,    0],
        [   0,    0,    0,    0,  973,    0,    1,    0,    2,    6],
        [   1,    0,    0,   11,    0,  874,    4,    1,    1,    0],
        [   4,    3,    0,    0,    3,    3,  942,    0,    3,    0],
        [   1,    3,    4,    1,    0,    0,    0, 1013,    1,    5],
        [   3,    1,    5,    2,    0,    0,    1,    2,  957,    3],
        [   3,    6,    2,    1,    6,    0,    0,    4,    4,  983]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/unbias7unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 76.66
Epoch 1, loss 27.56
Epoch 2, loss 25.75
Epoch 3, loss 24.21
Epoch 4, loss 23.31
Epoch 5, loss 22.77
Epoch 6, loss 22.08
Epoch 7, loss 21.09
Epoch 8, loss 21.32
Epoch 9, loss 20.90
**** Finished Training ****
Change in stitch weights: 0.8506062030792236
Largest abs weight change: 0.013946684077382088
Number of weights changing > 0.1 of that: 104565
Change in stitch bias: 0.026243461295962334
Largest abs bias change: 0.0020205900073051453
Number of bias changing > 0.1 of that: 457
Test the trained stitch against biased data
Test Accuracy: 98.59 %
Confusion Matrix
tensor([[ 973,    0,    0,    1,    0,    2,    2,    1,    1,    0],
        [   0, 1130,    1,    1,    2,    0,    0,    0,    1,    0],
        [   1,    0, 1022,    0,    0,    0,    1,    3,    5,    0],
        [   0,    0,    0, 1001,    0,    4,    0,    1,    4,    0],
        [   0,    0,    1,    0,  971,    0,    2,    2,    1,    5],
        [   0,    0,    0,    9,    0,  878,    3,    1,    1,    0],
        [   5,    4,    0,    0,    1,    5,  937,    0,    6,    0],
        [   1,    4,    4,    2,    1,    0,    0, 1013,    1,    2],
        [   3,    1,    4,    3,    1,    3,    0,    2,  953,    4],
        [   2,    5,    1,    3,    8,    1,    0,    4,    4,  981]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2f_rank/unbias8unbias-bias-61_2024-08-06_17-10-45_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 74.77
Epoch 1, loss 27.35
Epoch 2, loss 25.54
Epoch 3, loss 23.81
Epoch 4, loss 23.38
Epoch 5, loss 21.96
Epoch 6, loss 21.45
Epoch 7, loss 21.12
Epoch 8, loss 20.73
Epoch 9, loss 20.26
**** Finished Training ****
Change in stitch weights: 0.8541847467422485
Largest abs weight change: 0.013760806992650032
Number of weights changing > 0.1 of that: 106069
Change in stitch bias: 0.026965981349349022
Largest abs bias change: 0.0020192377269268036
Number of bias changing > 0.1 of that: 472
Test the trained stitch against biased data
Test Accuracy: 98.71 %
Confusion Matrix
tensor([[ 973,    0,    0,    0,    0,    1,    2,    1,    3,    0],
        [   0, 1130,    1,    1,    1,    0,    1,    0,    1,    0],
        [   1,    0, 1021,    1,    1,    0,    0,    3,    5,    0],
        [   0,    0,    0, 1003,    0,    4,    0,    1,    2,    0],
        [   0,    0,    3,    0,  969,    0,    1,    1,    1,    7],
        [   0,    0,    0,   11,    0,  876,    3,    1,    1,    0],
        [   4,    3,    0,    0,    2,    6,  938,    0,    5,    0],
        [   0,    4,    2,    1,    1,    0,    0, 1015,    1,    4],
        [   3,    2,    3,    2,    1,    1,    0,    1,  958,    3],
        [   1,    5,    0,    2,    5,    0,    0,    3,    5,  988]],
       dtype=torch.int32)
===================================================================
stitching_accuracies={'mix': {'unbias': {3: 99.86, 4: 99.91, 5: 99.98, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bw': {'unbias': {3: 98.14, 4: 98.34, 5: 98.66, 6: 98.89, 7: 98.49, 8: 98.5}}, 'bgonly': {'unbias': {3: 99.93, 4: 100.0, 5: 100.0, 6: 100.0, 7: 100.0, 8: 99.99}}, 'bg': {'unbias': {3: 99.89, 4: 99.93, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bias': {'unbias': {3: 99.89, 4: 99.91, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'unbias': {'unbias': {3: 99.6, 4: 98.9, 5: 98.56, 6: 98.67, 7: 98.59, 8: 98.71}}}
stitching_penalties={'mix': {'unbias': {3: -1.6299999999999955, 4: -1.6799999999999926, 5: -1.75, 6: -1.769999999999996, 7: -1.769999999999996, 8: -1.769999999999996}}, 'bw': {'unbias': {3: 0.09000000000000341, 4: -0.10999999999999943, 5: -0.4299999999999926, 6: -0.6599999999999966, 7: -0.2599999999999909, 8: -0.269999999999996}}, 'bgonly': {'unbias': {3: -1.7000000000000028, 4: -1.769999999999996, 5: -1.769999999999996, 6: -1.769999999999996, 7: -1.769999999999996, 8: -1.759999999999991}}, 'bg': {'unbias': {3: -1.6599999999999966, 4: -1.7000000000000028, 5: -1.769999999999996, 6: -1.769999999999996, 7: -1.769999999999996, 8: -1.769999999999996}}, 'bias': {'unbias': {3: -1.6599999999999966, 4: -1.6799999999999926, 5: -1.769999999999996, 6: -1.769999999999996, 7: -1.769999999999996, 8: -1.769999999999996}}, 'unbias': {'unbias': {3: -1.3699999999999903, 4: -0.6700000000000017, 5: -0.3299999999999983, 6: -0.4399999999999977, 7: -0.35999999999999943, 8: -0.47999999999998977}}}
synth-mix
99.95
Stitch Accuracy
{3: 99.86, 4: 99.91, 5: 99.98, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bw
73.65
Stitch Accuracy
{3: 98.14, 4: 98.34, 5: 98.66, 6: 98.89, 7: 98.49, 8: 98.5}
--------------------------
synth-bgonly
75.68
Stitch Accuracy
{3: 99.93, 4: 100.0, 5: 100.0, 6: 100.0, 7: 100.0, 8: 99.99}
--------------------------
synth-bg
100.0
Stitch Accuracy
{3: 99.89, 4: 99.93, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bias
100.0
Stitch Accuracy
{3: 99.89, 4: 99.91, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-unbias
98.23
Stitch Accuracy
{3: 99.6, 4: 98.9, 5: 98.56, 6: 98.67, 7: 98.59, 8: 98.71}
--------------------------
