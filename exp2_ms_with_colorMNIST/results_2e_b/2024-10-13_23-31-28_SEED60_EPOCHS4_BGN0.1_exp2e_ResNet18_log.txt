Executed at 2024-10-13_23-31-28
logging to ./results_2e_b/2024-10-13_23-31-28_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_log.txt
seed=60
bg_noise=0.1
train_mix_mnist_model=False
mix_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
train_bw_mnist_model=False
bw_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
train_bg_only_colour_mnist_model=False
bg_only_colour_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
train_bg_unbiased_colour_mnist_model=False
bg_unbiased_colour_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
train_biased_colour_mnist_model=False
biased_colour_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
train_unbiased_colour_mnist_model=False
unbiased_colour_mnist_model_to_load='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
stitch_train_epochs=10
================================================
val['loadfrom']='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
Entering Confusion
Accuracy Calculation for ResNet18 with key='mix'
Test the Trained Resnet18 against OWN TEST LOADER: key='mix'
Test Accuracy: 99.32 %
Confusion Matrix
tensor([[1015,    0,    0,    0,    0,    1,    0,    2,    0,    0],
        [   0, 1126,    0,    0,    0,    0,    1,    0,    0,    0],
        [   3,    0, 1024,    0,    0,    0,    0,    2,    1,    0],
        [   0,    0,    1,  986,    1,    0,    0,    0,    0,    2],
        [   0,    0,    1,    0,  990,    0,    3,    0,    0,    0],
        [   2,    0,    0,    8,    0,  906,    3,    0,    0,    0],
        [   2,    3,    0,    0,    0,    0,  932,    0,    0,    0],
        [   0,    1,    3,    0,    0,    0,    0, 1021,    0,    6],
        [   3,    0,    1,    3,    1,    2,    2,    1,  967,    3],
        [   0,    1,    0,    0,    3,    0,    0,    2,    0,  965]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bw'
Test the Trained Resnet18 against OWN TEST LOADER: key='bw'
Test Accuracy: 99.09 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    1,    0,    0,    0,    0],
        [   0, 1132,    0,    0,    0,    2,    1,    0,    0,    0],
        [   1,    1, 1025,    3,    1,    0,    0,    1,    0,    0],
        [   1,    0,    0, 1000,    0,    5,    0,    0,    3,    1],
        [   0,    0,    0,    0,  973,    0,    0,    1,    0,    8],
        [   2,    0,    0,    1,    0,  881,    1,    0,    2,    5],
        [   3,    4,    0,    0,    0,    2,  948,    0,    1,    0],
        [   0,    5,    9,    2,    0,    0,    0, 1006,    1,    5],
        [   3,    0,    1,    0,    0,    1,    0,    2,  965,    2],
        [   1,    1,    0,    2,    3,    1,    0,    0,    1, 1000]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bgonly'
Test the Trained Resnet18 against OWN TEST LOADER: key='bgonly'
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bg'
Test the Trained Resnet18 against OWN TEST LOADER: key='bg'
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1003,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  997,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1003,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  995,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  998,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  995,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1003,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bias'
Test the Trained Resnet18 against OWN TEST LOADER: key='bias'
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='unbias'
Test the Trained Resnet18 against OWN TEST LOADER: key='unbias'
Test Accuracy: 97.80 %
Confusion Matrix
tensor([[ 971,    0,    1,    0,    0,    0,    6,    1,    1,    0],
        [   0, 1127,    1,    3,    0,    1,    1,    1,    1,    0],
        [   0,    3, 1014,    8,    1,    0,    1,    2,    3,    0],
        [   0,    0,    1, 1004,    0,    3,    0,    0,    2,    0],
        [   0,    1,    1,    1,  949,    0,    2,    1,    3,   24],
        [   1,    0,    0,   13,    0,  871,    3,    0,    4,    0],
        [   6,    4,    0,    1,    1,    5,  939,    0,    2,    0],
        [   1,    2,   13,   11,    0,    0,    0,  998,    0,    3],
        [   3,    1,    4,    9,    0,    3,    1,    2,  951,    0],
        [   2,    5,    1,   21,    4,    6,    0,    4,   10,  956]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'mix': 99.32, 'bw': 99.09, 'bgonly': 100.0, 'bg': 100.0, 'bias': 100.0, 'unbias': 97.8}
Entering whole model check
Measure Rank for key='mix'
Measure Rank for key='bw'
Measure Rank for key='bgonly'
Measure Rank for key='bg'
Measure Rank for key='bias'
Measure Rank for key='unbias'
Entering Stitch/Rank
device='cuda:0'
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2e_b_rank/mix3unbias-mix-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from mix to unbias
Use the mix data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 430.99
Epoch 1, loss 110.55
Epoch 2, loss 77.03
Epoch 3, loss 61.76
Epoch 4, loss 50.80
Epoch 5, loss 46.40
Epoch 6, loss 42.72
Epoch 7, loss 38.81
Epoch 8, loss 35.54
Epoch 9, loss 33.89
**** Finished Training ****
Change in stitch weights: 1.3152419328689575
Largest abs weight change: 0.14209222793579102
Number of weights changing > 0.1 of that: 1745
Change in stitch bias: 0.025391969829797745
Largest abs bias change: 0.005655631422996521
Number of bias changing > 0.1 of that: 56
Test the trained stitch against key='unbias' data
Test Accuracy: 98.38 %
Confusion Matrix
tensor([[1008,    0,    0,    2,    0,    0,    7,    0,    1,    0],
        [   0, 1124,    2,    0,    0,    0,    1,    0,    0,    0],
        [   1,    0, 1011,   10,    1,    1,    0,    3,    3,    0],
        [   0,    0,    1,  983,    0,    0,    0,    1,    4,    1],
        [   0,    4,    2,    0,  980,    0,    2,    0,    0,    6],
        [   2,    0,    0,    3,    0,  908,    3,    0,    2,    1],
        [   2,    5,    2,    0,    1,    6,  919,    0,    2,    0],
        [   0,    6,   14,    4,    1,    0,    0,  996,    1,    9],
        [   9,    0,    5,    1,    1,    7,    4,    1,  955,    0],
        [   0,    4,    1,    4,    1,    2,    0,    3,    2,  954]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/mix4unbias-mix-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from mix to unbias
Use the mix data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 767.35
Epoch 1, loss 85.08
Epoch 2, loss 56.03
Epoch 3, loss 45.27
Epoch 4, loss 39.20
Epoch 5, loss 34.48
Epoch 6, loss 31.58
Epoch 7, loss 28.86
Epoch 8, loss 26.51
Epoch 9, loss 25.11
**** Finished Training ****
Change in stitch weights: 1.3236699104309082
Largest abs weight change: 0.15175879001617432
Number of weights changing > 0.1 of that: 1535
Change in stitch bias: 0.026021946221590042
Largest abs bias change: 0.005664072930812836
Number of bias changing > 0.1 of that: 63
Test the trained stitch against key='unbias' data
Test Accuracy: 98.85 %
Confusion Matrix
tensor([[1012,    0,    0,    0,    0,    0,    3,    3,    0,    0],
        [   0, 1124,    1,    0,    1,    0,    1,    0,    0,    0],
        [   2,    0, 1019,    3,    1,    0,    0,    0,    5,    0],
        [   0,    0,    2,  986,    0,    1,    0,    0,    1,    0],
        [   0,    2,    3,    0,  984,    0,    1,    0,    0,    4],
        [   3,    0,    0,    4,    0,  909,    2,    0,    1,    0],
        [   4,    2,    2,    0,    0,    1,  923,    0,    5,    0],
        [   0,    1,   11,    1,    0,    0,    0, 1014,    1,    3],
        [   7,    0,    2,    3,    0,    2,    1,    1,  966,    1],
        [   0,    1,    0,    3,    1,    8,    0,    4,    6,  948]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/mix5unbias-mix-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from mix to unbias
Use the mix data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 338.08
Epoch 1, loss 47.06
Epoch 2, loss 33.62
Epoch 3, loss 27.16
Epoch 4, loss 23.98
Epoch 5, loss 22.21
Epoch 6, loss 19.87
Epoch 7, loss 18.64
Epoch 8, loss 17.14
Epoch 9, loss 16.30
**** Finished Training ****
Change in stitch weights: 1.1793261766433716
Largest abs weight change: 0.05269131809473038
Number of weights changing > 0.1 of that: 8482
Change in stitch bias: 0.028261899948120117
Largest abs bias change: 0.004027456045150757
Number of bias changing > 0.1 of that: 121
Test the trained stitch against key='unbias' data
Test Accuracy: 99.19 %
Confusion Matrix
tensor([[1014,    0,    0,    0,    0,    1,    1,    2,    0,    0],
        [   0, 1125,    0,    0,    0,    0,    1,    1,    0,    0],
        [   3,    1, 1020,    0,    0,    0,    0,    5,    1,    0],
        [   0,    0,    3,  982,    0,    1,    0,    1,    3,    0],
        [   0,    0,    0,    0,  987,    0,    2,    1,    0,    4],
        [   1,    0,    0,    3,    0,  911,    2,    0,    1,    1],
        [   2,    1,    0,    1,    2,    1,  930,    0,    0,    0],
        [   0,    2,    7,    2,    0,    0,    0, 1016,    0,    4],
        [   0,    0,    0,    0,    0,    1,    1,    2,  978,    1],
        [   0,    1,    0,    5,    4,    0,    0,    2,    3,  956]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/mix6unbias-mix-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from mix to unbias
Use the mix data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 116.59
Epoch 1, loss 16.19
Epoch 2, loss 12.21
Epoch 3, loss 10.46
Epoch 4, loss 9.51
Epoch 5, loss 8.74
Epoch 6, loss 8.43
Epoch 7, loss 8.62
Epoch 8, loss 7.68
Epoch 9, loss 7.57
**** Finished Training ****
Change in stitch weights: 0.8789934515953064
Largest abs weight change: 0.04788621515035629
Number of weights changing > 0.1 of that: 8630
Change in stitch bias: 0.026161909103393555
Largest abs bias change: 0.002846725285053253
Number of bias changing > 0.1 of that: 235
Test the trained stitch against key='unbias' data
Test Accuracy: 99.47 %
Confusion Matrix
tensor([[1014,    0,    0,    1,    0,    0,    0,    3,    0,    0],
        [   0, 1124,    0,    0,    0,    0,    1,    1,    0,    1],
        [   3,    0, 1022,    1,    0,    0,    0,    2,    1,    1],
        [   0,    0,    1,  986,    0,    1,    0,    0,    0,    2],
        [   0,    0,    1,    0,  988,    0,    0,    2,    0,    3],
        [   3,    0,    0,    1,    0,  913,    0,    0,    2,    0],
        [   2,    2,    0,    0,    0,    0,  933,    0,    0,    0],
        [   0,    1,    4,    0,    0,    0,    0, 1022,    0,    4],
        [   0,    0,    0,    1,    1,    1,    0,    1,  977,    2],
        [   0,    1,    0,    0,    1,    0,    0,    1,    0,  968]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/mix7unbias-mix-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from mix to unbias
Use the mix data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 51.47
Epoch 1, loss 9.57
Epoch 2, loss 8.09
Epoch 3, loss 7.13
Epoch 4, loss 6.81
Epoch 5, loss 6.73
Epoch 6, loss 6.33
Epoch 7, loss 6.56
Epoch 8, loss 6.30
Epoch 9, loss 5.97
**** Finished Training ****
Change in stitch weights: 0.8082661628723145
Largest abs weight change: 0.010124895721673965
Number of weights changing > 0.1 of that: 142419
Change in stitch bias: 0.0259784497320652
Largest abs bias change: 0.0020124949514865875
Number of bias changing > 0.1 of that: 462
Test the trained stitch against key='unbias' data
Test Accuracy: 99.55 %
Confusion Matrix
tensor([[1016,    0,    0,    0,    0,    1,    0,    1,    0,    0],
        [   0, 1126,    0,    0,    0,    0,    1,    0,    0,    0],
        [   3,    0, 1024,    0,    0,    0,    0,    1,    2,    0],
        [   0,    0,    0,  986,    0,    1,    0,    0,    1,    2],
        [   0,    0,    1,    0,  989,    0,    1,    1,    0,    2],
        [   2,    0,    0,    1,    0,  916,    0,    0,    0,    0],
        [   2,    1,    0,    0,    1,    2,  930,    0,    1,    0],
        [   0,    1,    3,    0,    0,    0,    0, 1023,    0,    4],
        [   1,    0,    0,    2,    0,    0,    0,    0,  979,    1],
        [   0,    1,    0,    1,    1,    0,    0,    2,    0,  966]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/mix8unbias-mix-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from mix to unbias
Use the mix data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 52.04
Epoch 1, loss 8.61
Epoch 2, loss 7.64
Epoch 3, loss 7.12
Epoch 4, loss 6.75
Epoch 5, loss 6.67
Epoch 6, loss 6.55
Epoch 7, loss 6.00
Epoch 8, loss 6.15
Epoch 9, loss 6.08
**** Finished Training ****
Change in stitch weights: 0.802769660949707
Largest abs weight change: 0.013731113635003567
Number of weights changing > 0.1 of that: 102459
Change in stitch bias: 0.026137936860322952
Largest abs bias change: 0.002018321305513382
Number of bias changing > 0.1 of that: 466
Test the trained stitch against key='unbias' data
Test Accuracy: 99.60 %
Confusion Matrix
tensor([[1016,    0,    0,    0,    0,    1,    0,    1,    0,    0],
        [   0, 1126,    0,    0,    0,    0,    1,    0,    0,    0],
        [   3,    0, 1024,    0,    0,    0,    0,    1,    2,    0],
        [   0,    0,    0,  985,    0,    2,    0,    0,    1,    2],
        [   0,    0,    1,    0,  991,    0,    1,    1,    0,    0],
        [   2,    0,    0,    1,    0,  916,    0,    0,    0,    0],
        [   1,    1,    0,    0,    1,    1,  933,    0,    0,    0],
        [   0,    1,    3,    0,    0,    0,    0, 1025,    0,    2],
        [   1,    0,    0,    1,    0,    0,    0,    1,  979,    1],
        [   0,    1,    0,    0,    1,    1,    0,    3,    0,  965]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2e_b_rank/bw3unbias-bw-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to unbias
Use the bw data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 255.41
Epoch 1, loss 76.75
Epoch 2, loss 60.36
Epoch 3, loss 52.37
Epoch 4, loss 46.19
Epoch 5, loss 43.01
Epoch 6, loss 40.48
Epoch 7, loss 38.38
Epoch 8, loss 36.28
Epoch 9, loss 34.95
**** Finished Training ****
Change in stitch weights: 1.1512024402618408
Largest abs weight change: 0.16876322031021118
Number of weights changing > 0.1 of that: 876
Change in stitch bias: 0.02657189778983593
Largest abs bias change: 0.00569508969783783
Number of bias changing > 0.1 of that: 58
Test the trained stitch against key='unbias' data
Test Accuracy: 97.73 %
Confusion Matrix
tensor([[ 959,    2,    2,    1,    0,    1,    7,    0,    3,    5],
        [   0, 1127,    1,    6,    0,    0,    0,    0,    1,    0],
        [   1,    0, 1022,    3,    1,    0,    1,    3,    1,    0],
        [   1,    0,    1,  993,    0,   10,    0,    2,    3,    0],
        [   0,    2,    2,    0,  959,    1,    4,    1,    0,   13],
        [   1,    0,    0,    3,    0,  886,    2,    0,    0,    0],
        [   5,    6,    1,    0,    1,   11,  932,    0,    2,    0],
        [   0,    4,    8,    3,    2,    0,    0,  995,    2,   14],
        [   5,    0,    5,   12,    5,    6,    2,    2,  933,    4],
        [   0,    6,    1,    9,   10,    5,    0,    2,    9,  967]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bw4unbias-bw-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to unbias
Use the bw data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 142.95
Epoch 1, loss 50.10
Epoch 2, loss 41.31
Epoch 3, loss 35.75
Epoch 4, loss 32.87
Epoch 5, loss 30.51
Epoch 6, loss 28.92
Epoch 7, loss 27.36
Epoch 8, loss 26.33
Epoch 9, loss 25.24
**** Finished Training ****
Change in stitch weights: 0.9962894916534424
Largest abs weight change: 0.09885019809007645
Number of weights changing > 0.1 of that: 1587
Change in stitch bias: 0.02353662997484207
Largest abs bias change: 0.005530036985874176
Number of bias changing > 0.1 of that: 58
Test the trained stitch against key='unbias' data
Test Accuracy: 98.46 %
Confusion Matrix
tensor([[ 977,    0,    1,    0,    0,    0,    1,    0,    1,    0],
        [   0, 1130,    0,    1,    0,    1,    0,    0,    3,    0],
        [   1,    1, 1022,    6,    0,    1,    0,    1,    0,    0],
        [   1,    0,    2,  995,    0,    6,    0,    0,    6,    0],
        [   0,    0,    0,    0,  958,    0,    7,    0,    3,   14],
        [   2,    0,    0,    5,    0,  881,    1,    0,    3,    0],
        [   2,    3,    0,    0,    0,    4,  949,    0,    0,    0],
        [   0,    1,    9,    3,    1,    0,    0, 1004,    3,    7],
        [   4,    0,    5,    7,    0,    1,    3,    1,  950,    3],
        [   0,    2,    1,    1,    5,    5,    0,    7,    8,  980]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bw5unbias-bw-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to unbias
Use the bw data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 172.22
Epoch 1, loss 38.82
Epoch 2, loss 29.92
Epoch 3, loss 25.63
Epoch 4, loss 23.38
Epoch 5, loss 21.26
Epoch 6, loss 19.97
Epoch 7, loss 18.95
Epoch 8, loss 17.91
Epoch 9, loss 17.34
**** Finished Training ****
Change in stitch weights: 1.0320194959640503
Largest abs weight change: 0.04552070051431656
Number of weights changing > 0.1 of that: 8623
Change in stitch bias: 0.024935726076364517
Largest abs bias change: 0.0039752572774887085
Number of bias changing > 0.1 of that: 118
Test the trained stitch against key='unbias' data
Test Accuracy: 98.79 %
Confusion Matrix
tensor([[ 975,    0,    0,    0,    0,    1,    0,    1,    3,    0],
        [   0, 1130,    1,    1,    0,    0,    1,    0,    2,    0],
        [   1,    2, 1017,    3,    2,    0,    0,    2,    5,    0],
        [   0,    0,    1, 1001,    0,    5,    0,    0,    3,    0],
        [   0,    1,    1,    0,  969,    0,    0,    1,    0,   10],
        [   2,    0,    0,    7,    0,  880,    1,    0,    2,    0],
        [   2,    1,    0,    0,    1,    2,  946,    0,    6,    0],
        [   0,    2,    7,    0,    1,    0,    0, 1013,    3,    2],
        [   2,    0,    2,    0,    0,    1,    0,    0,  969,    0],
        [   2,    0,    0,    2,    4,    7,    0,    3,   12,  979]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bw6unbias-bw-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to unbias
Use the bw data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 89.84
Epoch 1, loss 17.54
Epoch 2, loss 14.89
Epoch 3, loss 13.43
Epoch 4, loss 12.26
Epoch 5, loss 11.82
Epoch 6, loss 11.31
Epoch 7, loss 10.72
Epoch 8, loss 10.41
Epoch 9, loss 10.33
**** Finished Training ****
Change in stitch weights: 0.807050347328186
Largest abs weight change: 0.024262242019176483
Number of weights changing > 0.1 of that: 25259
Change in stitch bias: 0.026084957644343376
Largest abs bias change: 0.002846851944923401
Number of bias changing > 0.1 of that: 226
Test the trained stitch against key='unbias' data
Test Accuracy: 99.11 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    0,    1,    1,    0],
        [   0, 1128,    1,    2,    0,    1,    1,    2,    0,    0],
        [   2,    1, 1018,    2,    1,    0,    2,    4,    1,    1],
        [   0,    0,    0, 1005,    0,    4,    0,    0,    1,    0],
        [   0,    0,    0,    0,  976,    0,    0,    0,    0,    6],
        [   2,    0,    0,    8,    0,  878,    1,    0,    1,    2],
        [   1,    1,    0,    0,    1,    2,  951,    0,    2,    0],
        [   0,    1,    2,    0,    0,    0,    0, 1020,    2,    3],
        [   1,    0,    1,    2,    0,    1,    0,    2,  966,    1],
        [   1,    0,    0,    0,    3,    7,    0,    3,    4,  991]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bw7unbias-bw-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to unbias
Use the bw data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 60.21
Epoch 1, loss 14.32
Epoch 2, loss 12.11
Epoch 3, loss 11.07
Epoch 4, loss 10.91
Epoch 5, loss 10.16
Epoch 6, loss 9.76
Epoch 7, loss 9.48
Epoch 8, loss 9.77
Epoch 9, loss 9.44
**** Finished Training ****
Change in stitch weights: 0.843377411365509
Largest abs weight change: 0.016149582341313362
Number of weights changing > 0.1 of that: 82056
Change in stitch bias: 0.02680271491408348
Largest abs bias change: 0.0020156130194664
Number of bias changing > 0.1 of that: 477
Test the trained stitch against key='unbias' data
Test Accuracy: 99.24 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1130,    1,    1,    0,    1,    1,    1,    0,    0],
        [   0,    0, 1027,    2,    0,    0,    0,    3,    0,    0],
        [   1,    0,    0, 1005,    0,    2,    0,    0,    1,    1],
        [   0,    0,    1,    0,  974,    0,    0,    0,    0,    7],
        [   2,    0,    0,    5,    0,  880,    1,    0,    1,    3],
        [   2,    4,    0,    0,    2,    3,  946,    0,    1,    0],
        [   0,    3,    2,    0,    1,    0,    0, 1019,    1,    2],
        [   2,    0,    1,    0,    0,    1,    0,    2,  966,    2],
        [   0,    0,    0,    2,    3,    3,    0,    2,    1,  998]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bw8unbias-bw-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to unbias
Use the bw data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 51.83
Epoch 1, loss 13.63
Epoch 2, loss 12.35
Epoch 3, loss 11.42
Epoch 4, loss 10.57
Epoch 5, loss 10.20
Epoch 6, loss 9.94
Epoch 7, loss 9.75
Epoch 8, loss 9.20
Epoch 9, loss 9.52
**** Finished Training ****
Change in stitch weights: 0.8166697025299072
Largest abs weight change: 0.014036181382834911
Number of weights changing > 0.1 of that: 99920
Change in stitch bias: 0.026513759046792984
Largest abs bias change: 0.0020113959908485413
Number of bias changing > 0.1 of that: 462
Test the trained stitch against key='unbias' data
Test Accuracy: 99.23 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1129,    1,    2,    0,    1,    1,    1,    0,    0],
        [   1,    0, 1023,    3,    1,    0,    0,    3,    1,    0],
        [   0,    0,    1, 1003,    0,    4,    0,    0,    1,    1],
        [   0,    0,    0,    0,  977,    0,    0,    0,    0,    5],
        [   2,    0,    0,    3,    0,  883,    1,    0,    1,    2],
        [   2,    4,    1,    0,    1,    2,  947,    0,    1,    0],
        [   0,    2,    1,    0,    0,    0,    0, 1022,    1,    2],
        [   1,    0,    1,    0,    0,    1,    0,    2,  968,    1],
        [   1,    1,    0,    2,    4,    2,    0,    3,    4,  992]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2e_b_rank/bgonly3unbias-bgonly-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to unbias
Use the bgonly data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 830.07
Epoch 1, loss 252.85
Epoch 2, loss 220.15
Epoch 3, loss 211.57
Epoch 4, loss 186.32
Epoch 5, loss 182.66
Epoch 6, loss 178.92
Epoch 7, loss 179.09
Epoch 8, loss 173.25
Epoch 9, loss 168.72
**** Finished Training ****
Change in stitch weights: 1.46443772315979
Largest abs weight change: 0.10300089418888092
Number of weights changing > 0.1 of that: 2610
Change in stitch bias: 0.027017101645469666
Largest abs bias change: 0.005704440176486969
Number of bias changing > 0.1 of that: 59
Test the trained stitch against key='unbias' data
Test Accuracy: 97.18 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,  282,    0,    0,  700,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bgonly4unbias-bgonly-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to unbias
Use the bgonly data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 207.01
Epoch 1, loss 9.89
Epoch 2, loss 6.68
Epoch 3, loss 4.64
Epoch 4, loss 4.07
Epoch 5, loss 3.79
Epoch 6, loss 2.94
Epoch 7, loss 2.97
Epoch 8, loss 2.37
Epoch 9, loss 2.01
**** Finished Training ****
Change in stitch weights: 0.7961394786834717
Largest abs weight change: 0.0671323761343956
Number of weights changing > 0.1 of that: 2155
Change in stitch bias: 0.025791307911276817
Largest abs bias change: 0.005664929747581482
Number of bias changing > 0.1 of that: 58
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bgonly5unbias-bgonly-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to unbias
Use the bgonly data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 489.52
Epoch 1, loss 157.95
Epoch 2, loss 5.81
Epoch 3, loss 5.01
Epoch 4, loss 3.83
Epoch 5, loss 3.76
Epoch 6, loss 3.47
Epoch 7, loss 2.87
Epoch 8, loss 3.13
Epoch 9, loss 2.98
**** Finished Training ****
Change in stitch weights: 0.9503812193870544
Largest abs weight change: 0.03842712193727493
Number of weights changing > 0.1 of that: 9508
Change in stitch bias: 0.025795286521315575
Largest abs bias change: 0.004039451479911804
Number of bias changing > 0.1 of that: 121
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bgonly6unbias-bgonly-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to unbias
Use the bgonly data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 90.92
Epoch 1, loss 4.66
Epoch 2, loss 3.08
Epoch 3, loss 1.91
Epoch 4, loss 1.67
Epoch 5, loss 1.16
Epoch 6, loss 1.76
Epoch 7, loss 1.37
Epoch 8, loss 1.41
Epoch 9, loss 1.08
**** Finished Training ****
Change in stitch weights: 0.7004088759422302
Largest abs weight change: 0.0188785120844841
Number of weights changing > 0.1 of that: 31157
Change in stitch bias: 0.025339093059301376
Largest abs bias change: 0.002833746373653412
Number of bias changing > 0.1 of that: 232
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bgonly7unbias-bgonly-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to unbias
Use the bgonly data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 37.85
Epoch 1, loss 2.44
Epoch 2, loss 1.75
Epoch 3, loss 1.56
Epoch 4, loss 1.23
Epoch 5, loss 1.09
Epoch 6, loss 1.27
Epoch 7, loss 0.96
Epoch 8, loss 0.75
Epoch 9, loss 0.72
**** Finished Training ****
Change in stitch weights: 0.7679184675216675
Largest abs weight change: 0.009409241378307343
Number of weights changing > 0.1 of that: 147893
Change in stitch bias: 0.026170281693339348
Largest abs bias change: 0.0020164698362350464
Number of bias changing > 0.1 of that: 449
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bgonly8unbias-bgonly-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to unbias
Use the bgonly data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 24.15
Epoch 1, loss 2.47
Epoch 2, loss 1.59
Epoch 3, loss 1.40
Epoch 4, loss 1.24
Epoch 5, loss 1.16
Epoch 6, loss 1.14
Epoch 7, loss 1.11
Epoch 8, loss 1.02
Epoch 9, loss 0.74
**** Finished Training ****
Change in stitch weights: 0.7276692986488342
Largest abs weight change: 0.009227459318935871
Number of weights changing > 0.1 of that: 147623
Change in stitch bias: 0.02747548185288906
Largest abs bias change: 0.0020181722939014435
Number of bias changing > 0.1 of that: 462
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2e_b_rank/bg3unbias-bg-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bg to unbias
Use the bg data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 382.30
Epoch 1, loss 83.97
Epoch 2, loss 52.68
Epoch 3, loss 40.49
Epoch 4, loss 32.68
Epoch 5, loss 29.16
Epoch 6, loss 24.77
Epoch 7, loss 22.08
Epoch 8, loss 20.49
Epoch 9, loss 19.54
**** Finished Training ****
Change in stitch weights: 1.3255140781402588
Largest abs weight change: 0.1060323491692543
Number of weights changing > 0.1 of that: 2129
Change in stitch bias: 0.026527537032961845
Largest abs bias change: 0.005697332322597504
Number of bias changing > 0.1 of that: 58
Test the trained stitch against key='unbias' data
Test Accuracy: 99.90 %
Confusion Matrix
tensor([[ 999,    0,    0,    0,    0,    0,    1,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1001,    1,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0,  997,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1003,    0,    0,    0,    0,    0],
        [   0,    0,    0,    2,    0,  993,    0,    0,    0,    0],
        [   0,    0,    3,    0,    0,    0,  995,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  995,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1003,    0],
        [   0,    0,    0,    1,    0,    0,    0,    0,    1, 1001]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bg4unbias-bg-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bg to unbias
Use the bg data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 342.86
Epoch 1, loss 44.18
Epoch 2, loss 27.62
Epoch 3, loss 20.31
Epoch 4, loss 16.58
Epoch 5, loss 13.20
Epoch 6, loss 12.58
Epoch 7, loss 12.26
Epoch 8, loss 11.06
Epoch 9, loss 10.05
**** Finished Training ****
Change in stitch weights: 1.182030200958252
Largest abs weight change: 0.10090412944555283
Number of weights changing > 0.1 of that: 2094
Change in stitch bias: 0.02733805775642395
Largest abs bias change: 0.005537308752536774
Number of bias changing > 0.1 of that: 59
Test the trained stitch against key='unbias' data
Test Accuracy: 99.97 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1002,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0,  996,    0,    1,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1003,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  995,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  998,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  995,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1003,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    1, 1002]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bg5unbias-bg-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bg to unbias
Use the bg data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 349.16
Epoch 1, loss 20.28
Epoch 2, loss 11.79
Epoch 3, loss 8.37
Epoch 4, loss 8.40
Epoch 5, loss 6.67
Epoch 6, loss 7.10
Epoch 7, loss 5.39
Epoch 8, loss 5.10
Epoch 9, loss 4.96
**** Finished Training ****
Change in stitch weights: 0.9207443594932556
Largest abs weight change: 0.053705353289842606
Number of weights changing > 0.1 of that: 6148
Change in stitch bias: 0.026497891172766685
Largest abs bias change: 0.0040263831615448
Number of bias changing > 0.1 of that: 116
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1003,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  997,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1003,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  995,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  998,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  995,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1003,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bg6unbias-bg-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bg to unbias
Use the bg data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 75.24
Epoch 1, loss 7.26
Epoch 2, loss 4.79
Epoch 3, loss 3.38
Epoch 4, loss 2.91
Epoch 5, loss 4.10
Epoch 6, loss 2.00
Epoch 7, loss 1.99
Epoch 8, loss 2.32
Epoch 9, loss 2.06
**** Finished Training ****
Change in stitch weights: 0.7156919836997986
Largest abs weight change: 0.018811943009495735
Number of weights changing > 0.1 of that: 31216
Change in stitch bias: 0.02796757034957409
Largest abs bias change: 0.002858314663171768
Number of bias changing > 0.1 of that: 235
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1003,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  997,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1003,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  995,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  998,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  995,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1003,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bg7unbias-bg-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bg to unbias
Use the bg data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 39.42
Epoch 1, loss 3.45
Epoch 2, loss 2.74
Epoch 3, loss 2.14
Epoch 4, loss 1.85
Epoch 5, loss 2.01
Epoch 6, loss 1.52
Epoch 7, loss 1.12
Epoch 8, loss 1.15
Epoch 9, loss 1.14
**** Finished Training ****
Change in stitch weights: 0.767868161201477
Largest abs weight change: 0.00970732793211937
Number of weights changing > 0.1 of that: 144764
Change in stitch bias: 0.025894243270158768
Largest abs bias change: 0.002019912004470825
Number of bias changing > 0.1 of that: 472
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1003,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  997,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1003,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  995,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  998,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  995,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1003,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bg8unbias-bg-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bg to unbias
Use the bg data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 41.63
Epoch 1, loss 2.94
Epoch 2, loss 2.99
Epoch 3, loss 2.11
Epoch 4, loss 1.78
Epoch 5, loss 1.35
Epoch 6, loss 1.41
Epoch 7, loss 1.18
Epoch 8, loss 1.11
Epoch 9, loss 0.99
**** Finished Training ****
Change in stitch weights: 0.7704233527183533
Largest abs weight change: 0.013790570199489594
Number of weights changing > 0.1 of that: 98831
Change in stitch bias: 0.02760826237499714
Largest abs bias change: 0.002008594572544098
Number of bias changing > 0.1 of that: 470
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[1000,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1003,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1003,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  997,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0, 1003,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  995,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  998,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,  995,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0, 1003,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2e_b_rank/bias3unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to unbias
Use the bias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 289.72
Epoch 1, loss 29.82
Epoch 2, loss 19.34
Epoch 3, loss 14.87
Epoch 4, loss 11.58
Epoch 5, loss 10.69
Epoch 6, loss 8.53
Epoch 7, loss 7.56
Epoch 8, loss 6.94
Epoch 9, loss 6.26
**** Finished Training ****
Change in stitch weights: 1.0489176511764526
Largest abs weight change: 0.10470443964004517
Number of weights changing > 0.1 of that: 1816
Change in stitch bias: 0.027429133653640747
Largest abs bias change: 0.005572199821472168
Number of bias changing > 0.1 of that: 64
Test the trained stitch against key='unbias' data
Test Accuracy: 99.91 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    1,  956,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   1,    0,    0,    0,    0,    0,    0,    0,  973,    0],
        [   1,    0,    0,    0,    0,    1,    0,    0,    4, 1003]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bias4unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to unbias
Use the bias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 294.75
Epoch 1, loss 18.29
Epoch 2, loss 11.52
Epoch 3, loss 8.80
Epoch 4, loss 7.19
Epoch 5, loss 6.45
Epoch 6, loss 5.33
Epoch 7, loss 4.65
Epoch 8, loss 4.57
Epoch 9, loss 3.94
**** Finished Training ****
Change in stitch weights: 0.9945859313011169
Largest abs weight change: 0.09870021790266037
Number of weights changing > 0.1 of that: 1716
Change in stitch bias: 0.025776073336601257
Largest abs bias change: 0.0056880563497543335
Number of bias changing > 0.1 of that: 60
Test the trained stitch against key='unbias' data
Test Accuracy: 99.90 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    2,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    2,    0,    0,    0,    0,  956,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1026,    2,    0],
        [   0,    0,    0,    0,    0,    1,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    1, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bias5unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to unbias
Use the bias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 160.84
Epoch 1, loss 12.62
Epoch 2, loss 7.24
Epoch 3, loss 5.33
Epoch 4, loss 4.41
Epoch 5, loss 3.79
Epoch 6, loss 3.34
Epoch 7, loss 3.03
Epoch 8, loss 2.63
Epoch 9, loss 2.30
**** Finished Training ****
Change in stitch weights: 0.8674237132072449
Largest abs weight change: 0.03961404412984848
Number of weights changing > 0.1 of that: 8087
Change in stitch bias: 0.02682400867342949
Largest abs bias change: 0.0040210336446762085
Number of bias changing > 0.1 of that: 117
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bias6unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to unbias
Use the bias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 84.03
Epoch 1, loss 4.94
Epoch 2, loss 2.81
Epoch 3, loss 2.05
Epoch 4, loss 1.55
Epoch 5, loss 1.48
Epoch 6, loss 1.14
Epoch 7, loss 0.99
Epoch 8, loss 1.12
Epoch 9, loss 0.74
**** Finished Training ****
Change in stitch weights: 0.7242650389671326
Largest abs weight change: 0.029274391010403633
Number of weights changing > 0.1 of that: 16530
Change in stitch bias: 0.025717053562402725
Largest abs bias change: 0.002793528139591217
Number of bias changing > 0.1 of that: 223
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bias7unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to unbias
Use the bias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 39.86
Epoch 1, loss 2.45
Epoch 2, loss 1.65
Epoch 3, loss 1.41
Epoch 4, loss 1.12
Epoch 5, loss 0.95
Epoch 6, loss 0.88
Epoch 7, loss 0.76
Epoch 8, loss 0.68
Epoch 9, loss 0.58
**** Finished Training ****
Change in stitch weights: 0.7673547863960266
Largest abs weight change: 0.011541804298758507
Number of weights changing > 0.1 of that: 123072
Change in stitch bias: 0.02712998352944851
Largest abs bias change: 0.002018474042415619
Number of bias changing > 0.1 of that: 457
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/bias8unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to unbias
Use the bias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 35.13
Epoch 1, loss 2.00
Epoch 2, loss 1.26
Epoch 3, loss 1.17
Epoch 4, loss 0.91
Epoch 5, loss 0.80
Epoch 6, loss 0.96
Epoch 7, loss 0.88
Epoch 8, loss 0.59
Epoch 9, loss 0.63
**** Finished Training ****
Change in stitch weights: 0.7406008839607239
Largest abs weight change: 0.013472581282258034
Number of weights changing > 0.1 of that: 99106
Change in stitch bias: 0.026967797428369522
Largest abs bias change: 0.002019491046667099
Number of bias changing > 0.1 of that: 458
Test the trained stitch against key='unbias' data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_2e_b_rank/unbias3unbias-unbias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from unbias to unbias
Use the unbias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 302.56
Epoch 1, loss 90.32
Epoch 2, loss 69.71
Epoch 3, loss 61.28
Epoch 4, loss 56.10
Epoch 5, loss 51.12
Epoch 6, loss 48.53
Epoch 7, loss 46.18
Epoch 8, loss 44.85
Epoch 9, loss 42.73
**** Finished Training ****
Change in stitch weights: 1.2106714248657227
Largest abs weight change: 0.2686198055744171
Number of weights changing > 0.1 of that: 314
Change in stitch bias: 0.02663499489426613
Largest abs bias change: 0.005670525133609772
Number of bias changing > 0.1 of that: 58
Test the trained stitch against key='unbias' data
Test Accuracy: 96.90 %
Confusion Matrix
tensor([[ 955,    0,    2,    0,    1,    1,   12,    1,    2,    6],
        [   0, 1123,    3,    2,    0,    2,    2,    1,    2,    0],
        [   2,    2, 1011,    5,    3,    0,    1,    2,    6,    0],
        [   0,    0,    4,  981,    0,   13,    0,    1,    9,    2],
        [   0,    1,    2,    1,  940,    2,    7,    1,    4,   24],
        [   2,    0,    0,    7,    0,  875,    1,    0,    7,    0],
        [   7,    5,    0,    0,    4,    9,  932,    0,    1,    0],
        [   0,    3,   14,    5,    0,    0,    0,  989,    3,   14],
        [  12,    2,    9,    7,    3,   10,    3,    4,  923,    1],
        [   1,    4,    4,    8,    7,    5,    0,    8,   11,  961]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/unbias4unbias-unbias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from unbias to unbias
Use the unbias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 187.87
Epoch 1, loss 55.88
Epoch 2, loss 46.68
Epoch 3, loss 41.70
Epoch 4, loss 38.42
Epoch 5, loss 35.76
Epoch 6, loss 33.86
Epoch 7, loss 32.60
Epoch 8, loss 31.88
Epoch 9, loss 30.64
**** Finished Training ****
Change in stitch weights: 1.0179760456085205
Largest abs weight change: 0.1766323447227478
Number of weights changing > 0.1 of that: 534
Change in stitch bias: 0.02762639708817005
Largest abs bias change: 0.005705833435058594
Number of bias changing > 0.1 of that: 61
Test the trained stitch against key='unbias' data
Test Accuracy: 97.72 %
Confusion Matrix
tensor([[ 967,    1,    2,    0,    0,    0,    8,    1,    1,    0],
        [   0, 1121,    2,    2,    0,    2,    3,    1,    4,    0],
        [   0,    2, 1018,    4,    1,    1,    1,    0,    5,    0],
        [   0,    0,    1,  996,    0,    7,    0,    1,    5,    0],
        [   0,    0,    1,    0,  953,    0,    4,    1,    4,   19],
        [   3,    0,    0,    7,    0,  871,    5,    0,    5,    1],
        [   9,    4,    0,    0,    1,    2,  938,    0,    4,    0],
        [   0,    4,   14,    2,    0,    0,    0,  998,    1,    9],
        [  10,    1,    3,    9,    2,    1,    3,    3,  941,    1],
        [   4,    5,    1,    8,    6,    8,    0,    3,    5,  969]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/unbias5unbias-unbias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from unbias to unbias
Use the unbias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 157.98
Epoch 1, loss 49.25
Epoch 2, loss 40.27
Epoch 3, loss 35.70
Epoch 4, loss 32.16
Epoch 5, loss 29.91
Epoch 6, loss 28.66
Epoch 7, loss 27.47
Epoch 8, loss 25.93
Epoch 9, loss 24.91
**** Finished Training ****
Change in stitch weights: 1.0312269926071167
Largest abs weight change: 0.07238055020570755
Number of weights changing > 0.1 of that: 4938
Change in stitch bias: 0.02545863948762417
Largest abs bias change: 0.003971725702285767
Number of bias changing > 0.1 of that: 108
Test the trained stitch against key='unbias' data
Test Accuracy: 98.12 %
Confusion Matrix
tensor([[ 971,    0,    1,    0,    0,    0,    6,    1,    1,    0],
        [   1, 1125,    2,    1,    0,    1,    2,    0,    3,    0],
        [   0,    1, 1023,    1,    1,    0,    0,    1,    5,    0],
        [   0,    0,    4,  991,    0,    6,    0,    2,    7,    0],
        [   0,    0,    4,    0,  959,    0,    1,    1,    3,   14],
        [   1,    0,    0,   10,    0,  870,    4,    0,    6,    1],
        [   8,    3,    1,    0,    2,    4,  937,    0,    3,    0],
        [   0,    2,    9,    2,    0,    0,    0, 1012,    1,    2],
        [   3,    0,    2,    4,    2,    3,    3,    1,  951,    5],
        [   1,    3,    2,    9,    6,    4,    0,    7,    4,  973]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/unbias6unbias-unbias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from unbias to unbias
Use the unbias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 99.16
Epoch 1, loss 26.84
Epoch 2, loss 22.90
Epoch 3, loss 21.44
Epoch 4, loss 20.26
Epoch 5, loss 19.20
Epoch 6, loss 18.67
Epoch 7, loss 18.04
Epoch 8, loss 17.30
Epoch 9, loss 17.31
**** Finished Training ****
Change in stitch weights: 0.8545934557914734
Largest abs weight change: 0.05771012604236603
Number of weights changing > 0.1 of that: 4622
Change in stitch bias: 0.027235105633735657
Largest abs bias change: 0.0028524287045001984
Number of bias changing > 0.1 of that: 236
Test the trained stitch against key='unbias' data
Test Accuracy: 98.32 %
Confusion Matrix
tensor([[ 975,    0,    1,    0,    0,    0,    2,    1,    1,    0],
        [   0, 1122,    1,    2,    0,    1,    3,    0,    5,    1],
        [   2,    1, 1021,    2,    1,    0,    0,    2,    3,    0],
        [   0,    0,    2,  993,    0,    9,    0,    0,    4,    2],
        [   0,    0,    2,    0,  964,    0,    1,    1,    1,   13],
        [   2,    0,    0,    9,    0,  871,    4,    1,    5,    0],
        [   8,    3,    2,    1,    2,    5,  934,    0,    2,    1],
        [   0,    2,    5,    1,    1,    0,    0, 1014,    1,    4],
        [   5,    0,    4,    5,    1,    1,    0,    1,  955,    2],
        [   2,    6,    2,    4,    4,    2,    0,    3,    3,  983]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/unbias7unbias-unbias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from unbias to unbias
Use the unbias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 66.91
Epoch 1, loss 21.77
Epoch 2, loss 19.90
Epoch 3, loss 19.14
Epoch 4, loss 18.22
Epoch 5, loss 17.73
Epoch 6, loss 18.00
Epoch 7, loss 17.55
Epoch 8, loss 17.23
Epoch 9, loss 16.65
**** Finished Training ****
Change in stitch weights: 0.8308162689208984
Largest abs weight change: 0.012748826295137405
Number of weights changing > 0.1 of that: 115586
Change in stitch bias: 0.02642734907567501
Largest abs bias change: 0.002019047737121582
Number of bias changing > 0.1 of that: 463
Test the trained stitch against key='unbias' data
Test Accuracy: 98.52 %
Confusion Matrix
tensor([[ 976,    0,    1,    0,    0,    0,    1,    1,    1,    0],
        [   0, 1125,    2,    0,    0,    1,    4,    1,    2,    0],
        [   0,    1, 1024,    1,    1,    0,    0,    2,    3,    0],
        [   0,    0,    2,  995,    0,    9,    0,    0,    3,    1],
        [   0,    0,    1,    0,  965,    0,    1,    1,    2,   12],
        [   1,    0,    0,    9,    0,  873,    6,    0,    3,    0],
        [   6,    3,    0,    0,    4,    1,  942,    0,    2,    0],
        [   0,    2,    4,    2,    1,    0,    0, 1013,    1,    5],
        [   6,    1,    4,    5,    2,    1,    0,    1,  954,    0],
        [   1,    3,    0,    4,    5,    3,    0,    4,    4,  985]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_2e_b_rank/unbias8unbias-unbias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from unbias to unbias
Use the unbias data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 69.64
Epoch 1, loss 21.86
Epoch 2, loss 20.11
Epoch 3, loss 18.91
Epoch 4, loss 18.13
Epoch 5, loss 17.77
Epoch 6, loss 16.90
Epoch 7, loss 17.50
Epoch 8, loss 17.15
Epoch 9, loss 16.92
**** Finished Training ****
Change in stitch weights: 0.838385820388794
Largest abs weight change: 0.013246946036815643
Number of weights changing > 0.1 of that: 110822
Change in stitch bias: 0.02628343179821968
Largest abs bias change: 0.0020193420350551605
Number of bias changing > 0.1 of that: 454
Test the trained stitch against key='unbias' data
Test Accuracy: 98.54 %
Confusion Matrix
tensor([[ 974,    0,    1,    0,    0,    0,    3,    1,    1,    0],
        [   0, 1128,    2,    0,    0,    1,    2,    0,    2,    0],
        [   0,    1, 1026,    1,    1,    0,    0,    1,    2,    0],
        [   0,    0,    2, 1000,    0,    5,    0,    0,    3,    0],
        [   0,    0,    2,    0,  965,    0,    1,    1,    2,   11],
        [   2,    0,    0,    8,    0,  874,    3,    1,    3,    1],
        [   4,    4,    2,    0,    3,    4,  939,    0,    2,    0],
        [   0,    2,    4,    4,    1,    0,    0, 1011,    1,    5],
        [   5,    0,    4,    5,    1,    1,    1,    1,  955,    1],
        [   1,    6,    1,    5,    5,    1,    0,    2,    6,  982]],
       dtype=torch.int32)
===================================================================
stitching_accuracies={'mix': {'unbias': {3: 98.38, 4: 98.85, 5: 99.19, 6: 99.47, 7: 99.55, 8: 99.6}}, 'bw': {'unbias': {3: 97.73, 4: 98.46, 5: 98.79, 6: 99.11, 7: 99.24, 8: 99.23}}, 'bgonly': {'unbias': {3: 97.18, 4: 100.0, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bg': {'unbias': {3: 99.9, 4: 99.97, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bias': {'unbias': {3: 99.91, 4: 99.9, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'unbias': {'unbias': {3: 96.9, 4: 97.72, 5: 98.12, 6: 98.32, 7: 98.52, 8: 98.54}}}
stitching_penalties={'mix': {'unbias': {3: -0.5799999999999983, 4: -1.0499999999999972, 5: -1.3900000000000006, 6: -1.6700000000000017, 7: -1.75, 8: -1.7999999999999972}}, 'bw': {'unbias': {3: 0.06999999999999318, 4: -0.6599999999999966, 5: -0.9900000000000091, 6: -1.3100000000000023, 7: -1.4399999999999977, 8: -1.4300000000000068}}, 'bgonly': {'unbias': {3: 0.6199999999999903, 4: -2.200000000000003, 5: -2.200000000000003, 6: -2.200000000000003, 7: -2.200000000000003, 8: -2.200000000000003}}, 'bg': {'unbias': {3: -2.1000000000000085, 4: -2.1700000000000017, 5: -2.200000000000003, 6: -2.200000000000003, 7: -2.200000000000003, 8: -2.200000000000003}}, 'bias': {'unbias': {3: -2.1099999999999994, 4: -2.1000000000000085, 5: -2.200000000000003, 6: -2.200000000000003, 7: -2.200000000000003, 8: -2.200000000000003}}, 'unbias': {'unbias': {3: 0.8999999999999915, 4: 0.0799999999999983, 5: -0.3200000000000074, 6: -0.519999999999996, 7: -0.7199999999999989, 8: -0.7400000000000091}}}
synth-mix
99.32
Stitch Accuracy
{3: 98.38, 4: 98.85, 5: 99.19, 6: 99.47, 7: 99.55, 8: 99.6}
--------------------------
synth-bw
99.09
Stitch Accuracy
{3: 97.73, 4: 98.46, 5: 98.79, 6: 99.11, 7: 99.24, 8: 99.23}
--------------------------
synth-bgonly
100.0
Stitch Accuracy
{3: 97.18, 4: 100.0, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bg
100.0
Stitch Accuracy
{3: 99.9, 4: 99.97, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bias
100.0
Stitch Accuracy
{3: 99.91, 4: 99.9, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-unbias
97.8
Stitch Accuracy
{3: 96.9, 4: 97.72, 5: 98.12, 6: 98.32, 7: 98.52, 8: 98.54}
--------------------------
