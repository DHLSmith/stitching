Executed at 2024-08-02_16-08-24
logging to ./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_log.txt
seed=58
bg_noise=0.1
train_mix_mnist_model=True
save_mix_mnist_model_as='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
original_train_epochs=4
train_bw_mnist_model=True
save_bw_mnist_model_as='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
original_train_epochs=4
train_bg_only_colour_mnist_model=True
save_bg_only_colour_mnist_model_as='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
original_train_epochs=4
train_bg_unbiased_colour_mnist_model=True
save_bg_unbiased_colour_mnist_model_as='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
original_train_epochs=4
train_biased_colour_mnist_model=True
save_biased_colour_mnist_model_as='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
original_train_epochs=4
train_unbiased_colour_mnist_model=True
save_unbiased_colour_mnist_model_as='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
original_train_epochs=4
stitch_train_epochs=10
================================================
Train ResNet18 on mix
Epoch 0, loss 301.40
Epoch 1, loss 30.65
Epoch 2, loss 20.10
Epoch 3, loss 15.57
**** Finished Training ****
saveas='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
Train ResNet18 on bw
Epoch 0, loss 100.55
Epoch 1, loss 24.85
Epoch 2, loss 16.87
Epoch 3, loss 13.89
**** Finished Training ****
saveas='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
Train ResNet18 on bgonly
Epoch 0, loss 78.48
Epoch 1, loss 4.50
Epoch 2, loss 6.31
Epoch 3, loss 2.62
**** Finished Training ****
saveas='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
Train ResNet18 on bg
Epoch 0, loss 173.69
Epoch 1, loss 4.36
Epoch 2, loss 5.71
Epoch 3, loss 3.20
**** Finished Training ****
saveas='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
Train ResNet18 on bias
Epoch 0, loss 52.64
Epoch 1, loss 1.99
Epoch 2, loss 0.71
Epoch 3, loss 0.16
**** Finished Training ****
saveas='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
Train ResNet18 on unbias
Epoch 0, loss 322.83
Epoch 1, loss 46.49
Epoch 2, loss 33.49
Epoch 3, loss 26.90
**** Finished Training ****
saveas='./results_4_epochs/2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
Entering Confusion
Accuracy Calculation for ResNet18 with key='mix'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 98.84 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  894,    0,    0,  116,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bw'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 63.86 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    0,    0,    2,    0],
        [  14, 1075,    2,    0,    2,    1,    6,    0,   35,    0],
        [  12,    1,  994,    0,    4,    0,    1,    2,   18,    0],
        [  40,    0,    0,    0,    1,    3,   16,    0,  950,    0],
        [   0,    0,    0,    0,  920,    0,   24,    0,   38,    0],
        [  42,    0,    0,    0,    0,   66,  731,    0,   53,    0],
        [   5,    1,    0,    0,    1,    0,  950,    0,    1,    0],
        [  92,    1,    8,    0,   26,    4,    0,  357,  540,    0],
        [  13,    0,    0,    0,    1,    0,   17,    0,  943,    0],
        [  63,    0,    0,    0,  254,   16,   10,    1,  562,  103]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bgonly'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 90.78 %
Confusion Matrix
tensor([[ 128,    0,    0,    0,    0,    0,  548,  304,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,  966,    0,    0,    1,    0,    0,   65,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    1,    0,    0,  957,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    3,    0,    0,    0,  971,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bg'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='unbias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 98.28 %
Confusion Matrix
tensor([[ 974,    1,    1,    1,    0,    1,    1,    0,    0,    1],
        [   0, 1129,    0,    2,    0,    1,    2,    1,    0,    0],
        [   2,    6, 1016,    2,    1,    0,    1,    2,    2,    0],
        [   0,    0,    0,  996,    0,    8,    0,    2,    3,    1],
        [   0,    1,    1,    0,  962,    0,    1,    0,    1,   16],
        [   2,    0,    0,    9,    0,  874,    4,    0,    1,    2],
        [   4,    3,    1,    1,    3,    6,  938,    0,    2,    0],
        [   1,    8,    6,    0,    0,    0,    0, 1002,    1,   10],
        [   3,    2,    1,    3,    0,    3,    2,    1,  954,    5],
        [   1,    4,    0,    8,    4,    3,    0,    2,    4,  983]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'mix': 98.84, 'bw': 63.86, 'bgonly': 90.78, 'bg': 100.0, 'bias': 100.0, 'unbias': 98.28}
Entering whole model check
Measure Rank for key='mix'
Measure Rank for key='bw'
Measure Rank for key='bgonly'
Measure Rank for key='bg'
Measure Rank for key='bias'
Measure Rank for key='unbias'
Entering Stitch/Rank
device='cuda:0'
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/mix3unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 233.01
Epoch 1, loss 34.62
Epoch 2, loss 24.99
Epoch 3, loss 19.75
Epoch 4, loss 16.74
Epoch 5, loss 14.39
Epoch 6, loss 13.33
Epoch 7, loss 12.39
Epoch 8, loss 10.44
Epoch 9, loss 10.27
**** Finished Training ****
Change in stitch weights: 0.9970026612281799
Largest abs weight change: 0.13168060779571533
Number of weights changing > 0.1 of that: 1360
Change in stitch bias: 0.026384670287370682
Largest abs bias change: 0.005682371556758881
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.67 %
Confusion Matrix
tensor([[ 974,    2,    0,    0,    0,    1,    0,    1,    1,    1],
        [   0, 1133,    0,    0,    2,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    1,    0, 1008,    0,    1,    0,    0,    0,    0],
        [   0,    0,    0,    0,  979,    0,    0,    0,    0,    3],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    1,    0,    0,    1,    1,  953,    0,    1,    0],
        [   0,    0,    4,    0,    1,    0,    0, 1022,    0,    1],
        [   0,    0,    1,    0,    0,    0,    0,    1,  970,    2],
        [   0,    1,    1,    2,    0,    0,    0,    0,    1, 1004]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix4unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 288.15
Epoch 1, loss 23.07
Epoch 2, loss 15.35
Epoch 3, loss 12.51
Epoch 4, loss 10.34
Epoch 5, loss 9.59
Epoch 6, loss 7.96
Epoch 7, loss 7.10
Epoch 8, loss 6.52
Epoch 9, loss 5.99
**** Finished Training ****
Change in stitch weights: 0.9708731770515442
Largest abs weight change: 0.11592254042625427
Number of weights changing > 0.1 of that: 1356
Change in stitch bias: 0.02660595253109932
Largest abs bias change: 0.00570562481880188
Number of bias changing > 0.1 of that: 55
Test the trained stitch against biased data
Test Accuracy: 99.88 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    1,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   4,    0,    0,    0,    0,    0,  953,    0,    1,    0],
        [   0,    0,    0,    0,    2,    1,    0, 1025,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix5unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 359.41
Epoch 1, loss 12.46
Epoch 2, loss 9.71
Epoch 3, loss 6.52
Epoch 4, loss 5.59
Epoch 5, loss 5.10
Epoch 6, loss 4.50
Epoch 7, loss 4.09
Epoch 8, loss 3.91
Epoch 9, loss 3.38
**** Finished Training ****
Change in stitch weights: 0.9015679359436035
Largest abs weight change: 0.055457547307014465
Number of weights changing > 0.1 of that: 5987
Change in stitch bias: 0.026225700974464417
Largest abs bias change: 0.00401885062456131
Number of bias changing > 0.1 of that: 112
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix6unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 108.93
Epoch 1, loss 7.03
Epoch 2, loss 4.98
Epoch 3, loss 3.45
Epoch 4, loss 2.72
Epoch 5, loss 2.41
Epoch 6, loss 2.08
Epoch 7, loss 2.04
Epoch 8, loss 1.95
Epoch 9, loss 1.97
**** Finished Training ****
Change in stitch weights: 0.8327924013137817
Largest abs weight change: 0.03284519165754318
Number of weights changing > 0.1 of that: 16840
Change in stitch bias: 0.027467647567391396
Largest abs bias change: 0.0028349198400974274
Number of bias changing > 0.1 of that: 238
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix7unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 44.48
Epoch 1, loss 4.75
Epoch 2, loss 3.29
Epoch 3, loss 2.52
Epoch 4, loss 2.39
Epoch 5, loss 2.21
Epoch 6, loss 1.77
Epoch 7, loss 1.86
Epoch 8, loss 1.70
Epoch 9, loss 1.55
**** Finished Training ****
Change in stitch weights: 0.7905762195587158
Largest abs weight change: 0.018030399456620216
Number of weights changing > 0.1 of that: 56747
Change in stitch bias: 0.026651810854673386
Largest abs bias change: 0.0020192041993141174
Number of bias changing > 0.1 of that: 461
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix8unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 40.46
Epoch 1, loss 4.53
Epoch 2, loss 3.08
Epoch 3, loss 2.50
Epoch 4, loss 2.20
Epoch 5, loss 2.19
Epoch 6, loss 1.83
Epoch 7, loss 1.67
Epoch 8, loss 1.68
Epoch 9, loss 1.44
**** Finished Training ****
Change in stitch weights: 0.7729005813598633
Largest abs weight change: 0.013050759211182594
Number of weights changing > 0.1 of that: 105545
Change in stitch bias: 0.02637135237455368
Largest abs bias change: 0.002017572522163391
Number of bias changing > 0.1 of that: 461
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bw3unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 240.68
Epoch 1, loss 66.45
Epoch 2, loss 55.33
Epoch 3, loss 50.38
Epoch 4, loss 46.45
Epoch 5, loss 43.87
Epoch 6, loss 41.75
Epoch 7, loss 39.58
Epoch 8, loss 37.98
Epoch 9, loss 37.67
**** Finished Training ****
Change in stitch weights: 1.0830845832824707
Largest abs weight change: 0.10740965604782104
Number of weights changing > 0.1 of that: 1568
Change in stitch bias: 0.028211718425154686
Largest abs bias change: 0.0055901482701301575
Number of bias changing > 0.1 of that: 61
Test the trained stitch against biased data
Test Accuracy: 97.79 %
Confusion Matrix
tensor([[ 966,    3,    7,    0,    0,    0,    0,    1,    2,    1],
        [   0, 1130,    3,    1,    0,    0,    1,    0,    0,    0],
        [   2,    2, 1023,    0,    1,    0,    0,    1,    3,    0],
        [   0,    0,    1,  980,    0,   20,    0,    5,    2,    2],
        [   0,    0,    0,    1,  972,    0,    3,    1,    0,    5],
        [   0,    0,    0,    7,    0,  884,    0,    0,    0,    1],
        [   4,    3,    3,    0,    3,   10,  930,    0,    5,    0],
        [   0,    1,    8,    2,    0,    0,    0,  995,    5,   17],
        [   5,    0,    8,    7,    2,    8,    5,    2,  921,   16],
        [   3,    2,    0,    7,    8,    3,    0,    5,    3,  978]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw4unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 117.89
Epoch 1, loss 50.80
Epoch 2, loss 41.61
Epoch 3, loss 37.20
Epoch 4, loss 33.22
Epoch 5, loss 31.68
Epoch 6, loss 28.91
Epoch 7, loss 27.58
Epoch 8, loss 26.49
Epoch 9, loss 25.37
**** Finished Training ****
Change in stitch weights: 0.9198948740959167
Largest abs weight change: 0.10068828612565994
Number of weights changing > 0.1 of that: 1461
Change in stitch bias: 0.026160726323723793
Largest abs bias change: 0.005689762532711029
Number of bias changing > 0.1 of that: 52
Test the trained stitch against biased data
Test Accuracy: 98.43 %
Confusion Matrix
tensor([[ 976,    1,    2,    0,    0,    0,    0,    1,    0,    0],
        [   2, 1125,    1,    2,    0,    1,    3,    0,    1,    0],
        [   3,    2, 1026,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0,  993,    0,   10,    0,    3,    4,    0],
        [   0,    0,    0,    0,  972,    0,    1,    1,    1,    7],
        [   0,    0,    0,    6,    0,  886,    0,    0,    0,    0],
        [   5,    4,    0,    0,    0,    6,  938,    0,    5,    0],
        [   0,    3,    6,    2,    6,    0,    0, 1001,    2,    8],
        [   3,    0,    1,    2,    4,    6,    4,    2,  947,    5],
        [   0,    3,    0,    5,   11,    2,    0,    4,    5,  979]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw5unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 180.58
Epoch 1, loss 40.69
Epoch 2, loss 31.96
Epoch 3, loss 27.94
Epoch 4, loss 25.36
Epoch 5, loss 23.29
Epoch 6, loss 21.85
Epoch 7, loss 20.80
Epoch 8, loss 19.58
Epoch 9, loss 19.00
**** Finished Training ****
Change in stitch weights: 1.0012245178222656
Largest abs weight change: 0.04844125360250473
Number of weights changing > 0.1 of that: 8031
Change in stitch bias: 0.025983210653066635
Largest abs bias change: 0.004040077328681946
Number of bias changing > 0.1 of that: 109
Test the trained stitch against biased data
Test Accuracy: 98.88 %
Confusion Matrix
tensor([[ 974,    1,    2,    0,    0,    0,    1,    1,    1,    0],
        [   1, 1130,    3,    0,    0,    0,    1,    0,    0,    0],
        [   4,    2, 1026,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  997,    0,    6,    0,    1,    5,    1],
        [   0,    0,    0,    0,  977,    0,    1,    1,    0,    3],
        [   0,    0,    0,    4,    0,  887,    0,    0,    1,    0],
        [   2,    1,    0,    0,    2,    4,  944,    0,    5,    0],
        [   0,    0,    3,    1,    1,    0,    0, 1016,    2,    5],
        [   2,    0,    0,    1,    1,    1,    6,    2,  957,    4],
        [   0,    0,    1,    4,   10,    2,    0,    5,    7,  980]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw6unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 287.72
Epoch 1, loss 29.29
Epoch 2, loss 21.89
Epoch 3, loss 19.30
Epoch 4, loss 17.80
Epoch 5, loss 15.74
Epoch 6, loss 15.01
Epoch 7, loss 14.55
Epoch 8, loss 13.77
Epoch 9, loss 13.58
**** Finished Training ****
Change in stitch weights: 1.0278197526931763
Largest abs weight change: 0.03528010845184326
Number of weights changing > 0.1 of that: 20023
Change in stitch bias: 0.025762896984815598
Largest abs bias change: 0.0028516538441181183
Number of bias changing > 0.1 of that: 231
Test the trained stitch against biased data
Test Accuracy: 99.17 %
Confusion Matrix
tensor([[ 978,    1,    0,    0,    0,    0,    0,    1,    0,    0],
        [   2, 1128,    3,    0,    0,    0,    1,    0,    1,    0],
        [   1,    0, 1031,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1003,    0,    3,    0,    1,    3,    0],
        [   0,    0,    0,    0,  976,    0,    1,    1,    0,    4],
        [   0,    0,    0,    4,    1,  886,    0,    0,    1,    0],
        [   0,    2,    0,    0,    3,    1,  946,    0,    6,    0],
        [   0,    2,    1,    1,    0,    0,    0, 1016,    1,    7],
        [   2,    0,    0,    3,    1,    0,    2,    3,  961,    2],
        [   0,    0,    0,    1,    6,    1,    0,    6,    3,  992]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw7unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 85.07
Epoch 1, loss 28.12
Epoch 2, loss 24.20
Epoch 3, loss 22.14
Epoch 4, loss 20.87
Epoch 5, loss 20.23
Epoch 6, loss 19.18
Epoch 7, loss 18.67
Epoch 8, loss 17.69
Epoch 9, loss 17.04
**** Finished Training ****
Change in stitch weights: 0.8923035264015198
Largest abs weight change: 0.01821836456656456
Number of weights changing > 0.1 of that: 69591
Change in stitch bias: 0.025636589154601097
Largest abs bias change: 0.0020182281732559204
Number of bias changing > 0.1 of that: 459
Test the trained stitch against biased data
Test Accuracy: 99.02 %
Confusion Matrix
tensor([[ 978,    1,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1131,    1,    0,    0,    0,    1,    0,    2,    0],
        [   3,    2, 1026,    0,    0,    0,    0,    1,    0,    0],
        [   0,    0,    0,  993,    1,    4,    1,    2,    7,    2],
        [   0,    0,    0,    0,  977,    1,    1,    1,    0,    2],
        [   0,    0,    0,    3,    0,  886,    1,    0,    2,    0],
        [   0,    2,    0,    0,    3,    5,  945,    0,    3,    0],
        [   0,    4,    1,    0,    0,    0,    0, 1018,    2,    3],
        [   1,    0,    0,    3,    0,    0,    1,    2,  964,    3],
        [   0,    3,    0,    3,    7,    0,    0,    5,    7,  984]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw8unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 97.89
Epoch 1, loss 29.79
Epoch 2, loss 24.76
Epoch 3, loss 22.68
Epoch 4, loss 21.39
Epoch 5, loss 20.35
Epoch 6, loss 19.63
Epoch 7, loss 18.39
Epoch 8, loss 18.16
Epoch 9, loss 17.35
**** Finished Training ****
Change in stitch weights: 0.9246634840965271
Largest abs weight change: 0.020503461360931396
Number of weights changing > 0.1 of that: 57729
Change in stitch bias: 0.02562265284359455
Largest abs bias change: 0.002016063779592514
Number of bias changing > 0.1 of that: 453
Test the trained stitch against biased data
Test Accuracy: 98.95 %
Confusion Matrix
tensor([[ 978,    1,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1132,    1,    1,    0,    0,    1,    0,    0,    0],
        [   2,    2, 1025,    0,    0,    0,    0,    3,    0,    0],
        [   0,    1,    0,  994,    1,    4,    0,    2,    6,    2],
        [   0,    0,    0,    0,  978,    0,    0,    2,    0,    2],
        [   0,    0,    0,    5,    0,  885,    0,    0,    2,    0],
        [   0,    2,    0,    0,    3,   12,  939,    0,    2,    0],
        [   0,    3,    1,    0,    0,    0,    0, 1018,    1,    5],
        [   1,    0,    0,    7,    0,    0,    2,    2,  958,    4],
        [   1,    2,    0,    4,    4,    0,    0,    5,    5,  988]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bgonly3unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 678.16
Epoch 1, loss 223.09
Epoch 2, loss 43.65
Epoch 3, loss 26.86
Epoch 4, loss 21.35
Epoch 5, loss 16.59
Epoch 6, loss 14.89
Epoch 7, loss 12.53
Epoch 8, loss 10.86
Epoch 9, loss 10.09
**** Finished Training ****
Change in stitch weights: 1.4110538959503174
Largest abs weight change: 0.11288975924253464
Number of weights changing > 0.1 of that: 2379
Change in stitch bias: 0.025959476828575134
Largest abs bias change: 0.005574896931648254
Number of bias changing > 0.1 of that: 56
Test the trained stitch against biased data
Test Accuracy: 99.92 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    0,    1,    1,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    1,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    1,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0, 1027,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0,    0,  972,    1],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly4unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 281.98
Epoch 1, loss 19.10
Epoch 2, loss 13.10
Epoch 3, loss 10.16
Epoch 4, loss 9.43
Epoch 5, loss 7.97
Epoch 6, loss 7.14
Epoch 7, loss 5.84
Epoch 8, loss 6.99
Epoch 9, loss 5.80
**** Finished Training ****
Change in stitch weights: 0.9237029552459717
Largest abs weight change: 0.1177876740694046
Number of weights changing > 0.1 of that: 1495
Change in stitch bias: 0.026877695694565773
Largest abs bias change: 0.005611158907413483
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly5unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 607.61
Epoch 1, loss 18.79
Epoch 2, loss 11.31
Epoch 3, loss 9.16
Epoch 4, loss 7.83
Epoch 5, loss 6.63
Epoch 6, loss 5.38
Epoch 7, loss 4.68
Epoch 8, loss 5.07
Epoch 9, loss 5.23
**** Finished Training ****
Change in stitch weights: 0.9576127529144287
Largest abs weight change: 0.043792180716991425
Number of weights changing > 0.1 of that: 8294
Change in stitch bias: 0.023959467187523842
Largest abs bias change: 0.004026949405670166
Number of bias changing > 0.1 of that: 113
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly6unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 192.41
Epoch 1, loss 9.24
Epoch 2, loss 7.17
Epoch 3, loss 6.38
Epoch 4, loss 5.02
Epoch 5, loss 4.65
Epoch 6, loss 4.39
Epoch 7, loss 3.57
Epoch 8, loss 5.48
Epoch 9, loss 3.38
**** Finished Training ****
Change in stitch weights: 0.86943519115448
Largest abs weight change: 0.03413112461566925
Number of weights changing > 0.1 of that: 17776
Change in stitch bias: 0.025361737236380577
Largest abs bias change: 0.002845022827386856
Number of bias changing > 0.1 of that: 222
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly7unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 51.81
Epoch 1, loss 6.50
Epoch 2, loss 5.55
Epoch 3, loss 5.21
Epoch 4, loss 4.11
Epoch 5, loss 3.22
Epoch 6, loss 3.26
Epoch 7, loss 3.69
Epoch 8, loss 3.18
Epoch 9, loss 3.34
**** Finished Training ****
Change in stitch weights: 0.7960517406463623
Largest abs weight change: 0.01398931723088026
Number of weights changing > 0.1 of that: 98690
Change in stitch bias: 0.026383772492408752
Largest abs bias change: 0.0020087510347366333
Number of bias changing > 0.1 of that: 470
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly8unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 41.36
Epoch 1, loss 6.94
Epoch 2, loss 6.02
Epoch 3, loss 4.81
Epoch 4, loss 3.97
Epoch 5, loss 3.39
Epoch 6, loss 4.02
Epoch 7, loss 3.41
Epoch 8, loss 3.24
Epoch 9, loss 2.94
**** Finished Training ****
Change in stitch weights: 0.771443247795105
Largest abs weight change: 0.010781588032841682
Number of weights changing > 0.1 of that: 131914
Change in stitch bias: 0.027603507041931152
Largest abs bias change: 0.0020161308348178864
Number of bias changing > 0.1 of that: 466
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bg3unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 451.96
Epoch 1, loss 32.70
Epoch 2, loss 18.90
Epoch 3, loss 15.10
Epoch 4, loss 11.04
Epoch 5, loss 9.19
Epoch 6, loss 7.65
Epoch 7, loss 7.11
Epoch 8, loss 6.25
Epoch 9, loss 6.04
**** Finished Training ****
Change in stitch weights: 1.0961331129074097
Largest abs weight change: 0.10128916800022125
Number of weights changing > 0.1 of that: 2066
Change in stitch bias: 0.0288543663918972
Largest abs bias change: 0.0056549981236457825
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.94 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1009,    0,    1,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    1,  955,    0,    2,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    1,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg4unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 284.51
Epoch 1, loss 31.33
Epoch 2, loss 18.94
Epoch 3, loss 14.79
Epoch 4, loss 11.67
Epoch 5, loss 9.97
Epoch 6, loss 8.60
Epoch 7, loss 7.41
Epoch 8, loss 6.87
Epoch 9, loss 6.44
**** Finished Training ****
Change in stitch weights: 1.0862184762954712
Largest abs weight change: 0.09568193554878235
Number of weights changing > 0.1 of that: 2083
Change in stitch bias: 0.026744084432721138
Largest abs bias change: 0.005702130496501923
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg5unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 416.34
Epoch 1, loss 17.06
Epoch 2, loss 12.42
Epoch 3, loss 9.25
Epoch 4, loss 7.51
Epoch 5, loss 6.27
Epoch 6, loss 5.59
Epoch 7, loss 5.68
Epoch 8, loss 4.45
Epoch 9, loss 4.26
**** Finished Training ****
Change in stitch weights: 0.9775480628013611
Largest abs weight change: 0.055876560509204865
Number of weights changing > 0.1 of that: 6841
Change in stitch bias: 0.025669926777482033
Largest abs bias change: 0.003973729908466339
Number of bias changing > 0.1 of that: 113
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg6unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 109.61
Epoch 1, loss 6.26
Epoch 2, loss 3.98
Epoch 3, loss 3.75
Epoch 4, loss 3.02
Epoch 5, loss 2.15
Epoch 6, loss 2.04
Epoch 7, loss 1.77
Epoch 8, loss 2.34
Epoch 9, loss 1.36
**** Finished Training ****
Change in stitch weights: 0.7919459939002991
Largest abs weight change: 0.021358270198106766
Number of weights changing > 0.1 of that: 29674
Change in stitch bias: 0.0264425128698349
Largest abs bias change: 0.0028583481907844543
Number of bias changing > 0.1 of that: 226
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg7unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 37.14
Epoch 1, loss 2.66
Epoch 2, loss 1.95
Epoch 3, loss 1.61
Epoch 4, loss 1.79
Epoch 5, loss 1.55
Epoch 6, loss 1.32
Epoch 7, loss 1.19
Epoch 8, loss 1.03
Epoch 9, loss 1.38
**** Finished Training ****
Change in stitch weights: 0.7627275586128235
Largest abs weight change: 0.01405064295977354
Number of weights changing > 0.1 of that: 94990
Change in stitch bias: 0.026581835001707077
Largest abs bias change: 0.0020174719393253326
Number of bias changing > 0.1 of that: 462
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg8unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 34.78
Epoch 1, loss 2.79
Epoch 2, loss 2.37
Epoch 3, loss 2.26
Epoch 4, loss 1.84
Epoch 5, loss 1.62
Epoch 6, loss 1.50
Epoch 7, loss 1.30
Epoch 8, loss 1.09
Epoch 9, loss 0.83
**** Finished Training ****
Change in stitch weights: 0.7605031728744507
Largest abs weight change: 0.016783978790044785
Number of weights changing > 0.1 of that: 67472
Change in stitch bias: 0.026924826204776764
Largest abs bias change: 0.002006903290748596
Number of bias changing > 0.1 of that: 460
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bias3unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 645.47
Epoch 1, loss 33.28
Epoch 2, loss 19.41
Epoch 3, loss 12.91
Epoch 4, loss 12.62
Epoch 5, loss 10.52
Epoch 6, loss 8.81
Epoch 7, loss 8.36
Epoch 8, loss 7.08
Epoch 9, loss 6.82
**** Finished Training ****
Change in stitch weights: 1.122786521911621
Largest abs weight change: 0.10602419078350067
Number of weights changing > 0.1 of that: 1987
Change in stitch bias: 0.026860125362873077
Largest abs bias change: 0.005706161260604858
Number of bias changing > 0.1 of that: 60
Test the trained stitch against biased data
Test Accuracy: 99.88 %
Confusion Matrix
tensor([[ 978,    2,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    1,    0,    0,  980,    0,    0,    0,    0,    1],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    1,  957,    0,    0,    0],
        [   0,    0,    1,    1,    0,    0,    0, 1026,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    1,    1,    0,    0,    2, 1005]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias4unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 295.11
Epoch 1, loss 16.91
Epoch 2, loss 10.18
Epoch 3, loss 8.25
Epoch 4, loss 6.43
Epoch 5, loss 5.64
Epoch 6, loss 4.85
Epoch 7, loss 4.53
Epoch 8, loss 4.03
Epoch 9, loss 3.71
**** Finished Training ****
Change in stitch weights: 0.9932954907417297
Largest abs weight change: 0.16620463132858276
Number of weights changing > 0.1 of that: 886
Change in stitch bias: 0.026209848001599312
Largest abs bias change: 0.00566476583480835
Number of bias changing > 0.1 of that: 63
Test the trained stitch against biased data
Test Accuracy: 99.95 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1134,    0,    1,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    1,    0,    0,    0,    0,  957,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias5unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 547.47
Epoch 1, loss 11.57
Epoch 2, loss 6.90
Epoch 3, loss 5.25
Epoch 4, loss 4.61
Epoch 5, loss 4.58
Epoch 6, loss 3.87
Epoch 7, loss 3.06
Epoch 8, loss 3.00
Epoch 9, loss 2.48
**** Finished Training ****
Change in stitch weights: 0.9532884359359741
Largest abs weight change: 0.045888934284448624
Number of weights changing > 0.1 of that: 7904
Change in stitch bias: 0.025657007470726967
Largest abs bias change: 0.004020906984806061
Number of bias changing > 0.1 of that: 116
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    1, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias6unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 158.61
Epoch 1, loss 4.79
Epoch 2, loss 2.91
Epoch 3, loss 2.09
Epoch 4, loss 1.99
Epoch 5, loss 1.77
Epoch 6, loss 1.29
Epoch 7, loss 1.25
Epoch 8, loss 0.95
Epoch 9, loss 1.03
**** Finished Training ****
Change in stitch weights: 0.8390713930130005
Largest abs weight change: 0.03090045228600502
Number of weights changing > 0.1 of that: 19193
Change in stitch bias: 0.02667166106402874
Largest abs bias change: 0.0028580762445926666
Number of bias changing > 0.1 of that: 223
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias7unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 28.72
Epoch 1, loss 1.76
Epoch 2, loss 1.11
Epoch 3, loss 0.96
Epoch 4, loss 0.68
Epoch 5, loss 0.65
Epoch 6, loss 0.61
Epoch 7, loss 0.51
Epoch 8, loss 0.66
Epoch 9, loss 0.54
**** Finished Training ****
Change in stitch weights: 0.7288087010383606
Largest abs weight change: 0.012351026758551598
Number of weights changing > 0.1 of that: 110468
Change in stitch bias: 0.026761917397379875
Largest abs bias change: 0.0020190179347991943
Number of bias changing > 0.1 of that: 455
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias8unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 24.03
Epoch 1, loss 1.71
Epoch 2, loss 1.32
Epoch 3, loss 0.87
Epoch 4, loss 0.71
Epoch 5, loss 0.69
Epoch 6, loss 0.73
Epoch 7, loss 0.56
Epoch 8, loss 0.60
Epoch 9, loss 0.73
**** Finished Training ****
Change in stitch weights: 0.7164239287376404
Largest abs weight change: 0.008989112451672554
Number of weights changing > 0.1 of that: 149908
Change in stitch bias: 0.026378538459539413
Largest abs bias change: 0.0020141340792179108
Number of bias changing > 0.1 of that: 470
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/unbias3unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 271.26
Epoch 1, loss 41.65
Epoch 2, loss 29.58
Epoch 3, loss 24.56
Epoch 4, loss 20.78
Epoch 5, loss 18.11
Epoch 6, loss 16.40
Epoch 7, loss 14.46
Epoch 8, loss 14.20
Epoch 9, loss 12.72
**** Finished Training ****
Change in stitch weights: 1.3531447649002075
Largest abs weight change: 0.15056736767292023
Number of weights changing > 0.1 of that: 1321
Change in stitch bias: 0.028205780312418938
Largest abs bias change: 0.0056242868304252625
Number of bias changing > 0.1 of that: 60
Test the trained stitch against biased data
Test Accuracy: 99.56 %
Confusion Matrix
tensor([[ 977,    0,    0,    0,    0,    0,    1,    1,    1,    0],
        [   0, 1133,    0,    0,    1,    0,    0,    0,    1,    0],
        [   0,    0, 1029,    1,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1009,    0,    1,    0,    0,    0,    0],
        [   0,    0,    1,    0,  979,    0,    0,    0,    2,    0],
        [   0,    0,    0,    0,    0,  891,    0,    0,    1,    0],
        [   2,    2,    0,    0,    1,    2,  949,    0,    2,    0],
        [   0,    0,    4,    2,    1,    0,    0, 1018,    0,    3],
        [   0,    0,    2,    0,    3,    0,    0,    0,  968,    1],
        [   1,    1,    1,    1,    0,    0,    0,    1,    1, 1003]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias4unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 129.46
Epoch 1, loss 42.75
Epoch 2, loss 36.13
Epoch 3, loss 31.98
Epoch 4, loss 29.49
Epoch 5, loss 27.16
Epoch 6, loss 25.40
Epoch 7, loss 23.94
Epoch 8, loss 23.13
Epoch 9, loss 21.92
**** Finished Training ****
Change in stitch weights: 0.8705445528030396
Largest abs weight change: 0.15699853003025055
Number of weights changing > 0.1 of that: 594
Change in stitch bias: 0.02577860839664936
Largest abs bias change: 0.0056590065360069275
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 98.54 %
Confusion Matrix
tensor([[ 975,    0,    1,    0,    0,    0,    1,    1,    2,    0],
        [   0, 1131,    1,    2,    0,    0,    1,    0,    0,    0],
        [   3,    1, 1025,    0,    0,    0,    1,    0,    2,    0],
        [   0,    0,    0, 1003,    0,    3,    0,    1,    2,    1],
        [   0,    0,    1,    1,  967,    0,    0,    0,    4,    9],
        [   0,    0,    0,    5,    0,  882,    1,    0,    3,    1],
        [   7,    4,    4,    0,    2,    4,  934,    0,    3,    0],
        [   1,    2,   14,    0,    1,    0,    0, 1001,    1,    8],
        [   1,    0,    6,    3,    4,    3,    1,    2,  949,    5],
        [   1,    3,    1,    4,    2,    3,    0,    3,    5,  987]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias5unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 141.74
Epoch 1, loss 42.03
Epoch 2, loss 35.02
Epoch 3, loss 30.80
Epoch 4, loss 28.42
Epoch 5, loss 26.66
Epoch 6, loss 24.83
Epoch 7, loss 24.23
Epoch 8, loss 23.10
Epoch 9, loss 22.02
**** Finished Training ****
Change in stitch weights: 0.9539299011230469
Largest abs weight change: 0.06564737856388092
Number of weights changing > 0.1 of that: 5001
Change in stitch bias: 0.02459477074444294
Largest abs bias change: 0.004015542566776276
Number of bias changing > 0.1 of that: 116
Test the trained stitch against biased data
Test Accuracy: 98.49 %
Confusion Matrix
tensor([[ 971,    1,    2,    0,    0,    2,    1,    1,    1,    1],
        [   0, 1122,    1,    1,    0,    0,    4,    2,    5,    0],
        [   3,    7, 1017,    0,    1,    0,    1,    0,    3,    0],
        [   0,    0,    0, 1002,    0,    5,    0,    1,    1,    1],
        [   0,    0,    0,    0,  972,    0,    1,    0,    0,    9],
        [   0,    0,    0,    4,    0,  885,    1,    0,    2,    0],
        [   3,    3,    0,    0,    3,    8,  938,    0,    3,    0],
        [   1,    3,    8,    1,    1,    0,    0, 1010,    1,    3],
        [   1,    0,    1,   10,    1,    2,    3,    1,  952,    3],
        [   2,    3,    0,    8,    8,    2,    0,    3,    3,  980]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias6unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 108.93
Epoch 1, loss 28.17
Epoch 2, loss 24.41
Epoch 3, loss 22.16
Epoch 4, loss 21.47
Epoch 5, loss 20.10
Epoch 6, loss 19.84
Epoch 7, loss 18.86
Epoch 8, loss 18.33
Epoch 9, loss 17.55
**** Finished Training ****
Change in stitch weights: 0.847469687461853
Largest abs weight change: 0.03807426989078522
Number of weights changing > 0.1 of that: 13757
Change in stitch bias: 0.0267935860902071
Largest abs bias change: 0.0028535686433315277
Number of bias changing > 0.1 of that: 243
Test the trained stitch against biased data
Test Accuracy: 98.61 %
Confusion Matrix
tensor([[ 975,    0,    1,    0,    0,    0,    2,    1,    1,    0],
        [   0, 1126,    2,    1,    0,    0,    1,    1,    4,    0],
        [   2,    3, 1018,    1,    1,    0,    1,    2,    4,    0],
        [   0,    0,    0, 1000,    0,    6,    0,    0,    3,    1],
        [   0,    0,    0,    0,  972,    0,    2,    0,    1,    7],
        [   2,    0,    0,   10,    0,  875,    2,    0,    2,    1],
        [   5,    4,    1,    0,    3,    4,  937,    0,    4,    0],
        [   0,    4,    4,    1,    0,    0,    0, 1015,    1,    3],
        [   3,    0,    0,    2,    0,    2,    0,    1,  962,    4],
        [   4,    4,    1,    5,    4,    1,    0,    5,    4,  981]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias7unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 74.77
Epoch 1, loss 25.12
Epoch 2, loss 23.91
Epoch 3, loss 22.84
Epoch 4, loss 21.21
Epoch 5, loss 21.18
Epoch 6, loss 20.92
Epoch 7, loss 20.07
Epoch 8, loss 19.41
Epoch 9, loss 19.14
**** Finished Training ****
Change in stitch weights: 0.8430435657501221
Largest abs weight change: 0.02041248232126236
Number of weights changing > 0.1 of that: 48401
Change in stitch bias: 0.02625831961631775
Largest abs bias change: 0.0020183026790618896
Number of bias changing > 0.1 of that: 456
Test the trained stitch against biased data
Test Accuracy: 98.53 %
Confusion Matrix
tensor([[ 976,    1,    1,    0,    0,    0,    1,    1,    0,    0],
        [   0, 1124,    1,    2,    0,    1,    2,    2,    3,    0],
        [   1,    3, 1019,    1,    1,    0,    0,    4,    3,    0],
        [   0,    0,    0,  996,    0,    7,    0,    2,    4,    1],
        [   0,    0,    0,    0,  971,    0,    1,    1,    1,    8],
        [   2,    0,    0,   10,    0,  873,    3,    1,    2,    1],
        [   4,    2,    1,    1,    2,    5,  938,    0,    5,    0],
        [   0,    4,    5,    1,    0,    0,    0, 1012,    2,    4],
        [   2,    1,    1,    1,    0,    0,    1,    0,  966,    2],
        [   2,    4,    1,    5,    7,    3,    0,    4,    5,  978]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias8unbias-bias-58_2024-08-02_16-08-24_SEED58_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 80.12
Epoch 1, loss 25.03
Epoch 2, loss 22.96
Epoch 3, loss 21.57
Epoch 4, loss 21.09
Epoch 5, loss 20.61
Epoch 6, loss 20.26
Epoch 7, loss 19.45
Epoch 8, loss 19.61
Epoch 9, loss 18.53
**** Finished Training ****
Change in stitch weights: 0.8553797006607056
Largest abs weight change: 0.013796772807836533
Number of weights changing > 0.1 of that: 106060
Change in stitch bias: 0.025879861786961555
Largest abs bias change: 0.002018529921770096
Number of bias changing > 0.1 of that: 456
Test the trained stitch against biased data
Test Accuracy: 98.49 %
Confusion Matrix
tensor([[ 976,    0,    1,    0,    0,    0,    1,    1,    1,    0],
        [   0, 1119,    3,    4,    0,    0,    3,    2,    4,    0],
        [   3,    1, 1022,    1,    0,    0,    0,    3,    2,    0],
        [   0,    0,    0,  998,    0,    7,    0,    1,    3,    1],
        [   0,    0,    1,    0,  968,    0,    1,    1,    1,   10],
        [   3,    0,    0,   12,    0,  870,    3,    1,    2,    1],
        [   4,    2,    1,    1,    2,    5,  940,    0,    3,    0],
        [   1,    2,    5,    0,    0,    0,    0, 1015,    1,    4],
        [   4,    0,    1,    2,    0,    0,    1,    1,  960,    5],
        [   1,    4,    1,    6,    7,    2,    0,    3,    4,  981]],
       dtype=torch.int32)
===================================================================
stitching_accuracies={'mix': {'unbias': {3: 99.67, 4: 99.88, 5: 99.98, 6: 99.99, 7: 100.0, 8: 100.0}}, 'bw': {'unbias': {3: 97.79, 4: 98.43, 5: 98.88, 6: 99.17, 7: 99.02, 8: 98.95}}, 'bgonly': {'unbias': {3: 99.92, 4: 100.0, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bg': {'unbias': {3: 99.94, 4: 99.98, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bias': {'unbias': {3: 99.88, 4: 99.95, 5: 99.99, 6: 100.0, 7: 100.0, 8: 100.0}}, 'unbias': {'unbias': {3: 99.56, 4: 98.54, 5: 98.49, 6: 98.61, 7: 98.53, 8: 98.49}}}
stitching_penalties={'mix': {'unbias': {3: -1.3900000000000006, 4: -1.5999999999999943, 5: -1.7000000000000028, 6: -1.7099999999999937, 7: -1.7199999999999989, 8: -1.7199999999999989}}, 'bw': {'unbias': {3: 0.4899999999999949, 4: -0.15000000000000568, 5: -0.5999999999999943, 6: -0.8900000000000006, 7: -0.7399999999999949, 8: -0.6700000000000017}}, 'bgonly': {'unbias': {3: -1.6400000000000006, 4: -1.7199999999999989, 5: -1.7199999999999989, 6: -1.7199999999999989, 7: -1.7199999999999989, 8: -1.7199999999999989}}, 'bg': {'unbias': {3: -1.6599999999999966, 4: -1.7000000000000028, 5: -1.7199999999999989, 6: -1.7199999999999989, 7: -1.7199999999999989, 8: -1.7199999999999989}}, 'bias': {'unbias': {3: -1.5999999999999943, 4: -1.6700000000000017, 5: -1.7099999999999937, 6: -1.7199999999999989, 7: -1.7199999999999989, 8: -1.7199999999999989}}, 'unbias': {'unbias': {3: -1.2800000000000011, 4: -0.2600000000000051, 5: -0.20999999999999375, 6: -0.3299999999999983, 7: -0.25, 8: -0.20999999999999375}}}
synth-mix
98.84
Stitch Accuracy
{3: 99.67, 4: 99.88, 5: 99.98, 6: 99.99, 7: 100.0, 8: 100.0}
--------------------------
synth-bw
63.86
Stitch Accuracy
{3: 97.79, 4: 98.43, 5: 98.88, 6: 99.17, 7: 99.02, 8: 98.95}
--------------------------
synth-bgonly
90.78
Stitch Accuracy
{3: 99.92, 4: 100.0, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bg
100.0
Stitch Accuracy
{3: 99.94, 4: 99.98, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bias
100.0
Stitch Accuracy
{3: 99.88, 4: 99.95, 5: 99.99, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-unbias
98.28
Stitch Accuracy
{3: 99.56, 4: 98.54, 5: 98.49, 6: 98.61, 7: 98.53, 8: 98.49}
--------------------------
