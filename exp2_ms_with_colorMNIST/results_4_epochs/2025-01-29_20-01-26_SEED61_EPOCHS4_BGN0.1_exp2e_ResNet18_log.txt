Executed at 2025-01-29_20-01-26
logging to ./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_log.txt
seed=61
bg_noise=0.1
train_mix_mnist_model=True
save_mix_mnist_model_as='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
original_train_epochs=4
train_bw_mnist_model=True
save_bw_mnist_model_as='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
original_train_epochs=4
train_bg_only_colour_mnist_model=True
save_bg_only_colour_mnist_model_as='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
original_train_epochs=4
train_bg_unbiased_colour_mnist_model=True
save_bg_unbiased_colour_mnist_model_as='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
original_train_epochs=4
train_biased_colour_mnist_model=True
save_biased_colour_mnist_model_as='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
original_train_epochs=4
train_unbiased_colour_mnist_model=True
save_unbiased_colour_mnist_model_as='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
original_train_epochs=4
stitch_train_epochs=10
================================================
Train Model on mix
Epoch 0, loss 291.71
Epoch 1, loss 75.00
Epoch 2, loss 37.22
Epoch 3, loss 15.44
**** Finished Training ****
saveas='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
Train Model on bw
Epoch 0, loss 137.39
Epoch 1, loss 26.91
Epoch 2, loss 19.86
Epoch 3, loss 15.93
**** Finished Training ****
saveas='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
Train Model on bgonly
Epoch 0, loss 47.01
Epoch 1, loss 8.15
Epoch 2, loss 3.67
Epoch 3, loss 1.52
**** Finished Training ****
saveas='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
Train Model on bg
Epoch 0, loss 66.28
Epoch 1, loss 4.52
Epoch 2, loss 1.49
Epoch 3, loss 1.58
**** Finished Training ****
saveas='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
Train Model on bias
Epoch 0, loss 63.10
Epoch 1, loss 3.65
Epoch 2, loss 1.01
Epoch 3, loss 1.73
**** Finished Training ****
saveas='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
Train Model on unbias
Epoch 0, loss 267.71
Epoch 1, loss 70.37
Epoch 2, loss 47.43
Epoch 3, loss 31.44
**** Finished Training ****
saveas='./results_4_epochs/2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
Entering Confusion
Accuracy Calculation for ResNet18 with key='mix'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bw'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 62.73 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    1,    1,    0,    0],
        [   9, 1101,    3,    0,    0,    0,   17,    0,    5,    0],
        [  54,    1,  907,    0,    5,    0,    5,    0,   60,    0],
        [ 130,    1,    1,    0,    0,    0,   16,    0,  862,    0],
        [   0,   15,    0,    0,  899,    0,   68,    0,    0,    0],
        [  39,    4,    0,    0,    1,   16,  394,    0,  438,    0],
        [   8,    4,    0,    0,    1,    0,  945,    0,    0,    0],
        [  35,  231,    4,    0,   89,    0,    1,  307,  358,    3],
        [  63,    5,    0,    0,    4,    0,   36,    0,  866,    0],
        [  66,   21,    0,    0,  283,    0,    3,    0,  382,  254]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bgonly'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 90.71 %
Confusion Matrix
tensor([[ 959,    0,    0,    0,    0,    0,    0,   21,    0,    0],
        [   0, 1127,    3,    5,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,   35,    0,    0,  923,    0,    0,    0],
        [   0,    0,    0,    0,   48,    0,    0,  980,    0,    0],
        [   0,    0,    0,    0,  277,    0,    0,    0,  697,    0],
        [   0,    0,    0,  514,    0,    0,    0,    0,   26,  469]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bg'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 99.95 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    5,    0,    0, 1023,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='unbias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 97.69 %
Confusion Matrix
tensor([[ 975,    0,    0,    0,    0,    0,    0,    1,    4,    0],
        [   0, 1113,    1,    4,    0,    0,    3,    1,   13,    0],
        [   1,    3, 1022,    0,    1,    0,    0,    2,    3,    0],
        [   0,    0,    2, 1001,    0,    1,    0,    0,    4,    2],
        [   0,    0,    0,    0,  976,    0,    0,    1,    3,    2],
        [  18,    0,    1,   23,    0,  844,    1,    2,    3,    0],
        [  19,    2,    0,    1,    5,    6,  919,    0,    6,    0],
        [   1,    2,   10,    4,    0,    0,    0, 1006,    3,    2],
        [   5,    2,    1,    1,    6,    4,    0,    2,  949,    4],
        [   5,    6,    0,    4,   12,    6,    0,    6,    6,  964]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'mix': 100.0, 'bw': 62.73, 'bgonly': 90.71, 'bg': 100.0, 'bias': 99.95, 'unbias': 97.69}
Entering whole model check
Measure Rank for key='mix'
Measure Rank for key='bw'
Measure Rank for key='bgonly'
Measure Rank for key='bg'
Measure Rank for key='bias'
Measure Rank for key='unbias'
Entering Stitch/Rank
device='cuda:0'
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/mix3unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 227.34
Epoch 1, loss 50.47
Epoch 2, loss 35.49
Epoch 3, loss 28.83
Epoch 4, loss 24.23
Epoch 5, loss 21.10
Epoch 6, loss 18.37
Epoch 7, loss 17.37
Epoch 8, loss 15.23
Epoch 9, loss 13.93
**** Finished Training ****
Change in stitch weights: 1.0903089046478271
Largest abs weight change: 0.11242035776376724
Number of weights changing > 0.1 of that: 1645
Change in stitch bias: 0.026613401249051094
Largest abs bias change: 0.0055512189865112305
Number of bias changing > 0.1 of that: 61
Test the trained stitch against biased data
Test Accuracy: 99.36 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    1,    1,    2,    0,    0],
        [   0, 1134,    0,    1,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1023,    1,    2,    1,    0,    0,    5,    0],
        [   0,    0,    0, 1008,    0,    1,    0,    0,    1,    0],
        [   0,    0,    0,    0,  978,    0,    0,    1,    2,    1],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   7,    1,    0,    0,    1,    2,  942,    0,    5,    0],
        [   1,    0,    1,    2,    1,    0,    0, 1022,    0,    1],
        [   0,    0,    0,    1,    3,    2,    0,    0,  968,    0],
        [   3,    4,    1,    3,    3,    1,    0,    0,    1,  993]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix4unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 367.69
Epoch 1, loss 32.62
Epoch 2, loss 19.90
Epoch 3, loss 15.64
Epoch 4, loss 12.33
Epoch 5, loss 9.97
Epoch 6, loss 9.15
Epoch 7, loss 8.69
Epoch 8, loss 6.91
Epoch 9, loss 7.11
**** Finished Training ****
Change in stitch weights: 1.114902138710022
Largest abs weight change: 0.12319251894950867
Number of weights changing > 0.1 of that: 1556
Change in stitch bias: 0.027516931295394897
Largest abs bias change: 0.005611389875411987
Number of bias changing > 0.1 of that: 60
Test the trained stitch against biased data
Test Accuracy: 99.71 %
Confusion Matrix
tensor([[ 978,    1,    0,    0,    0,    0,    1,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    1,    0],
        [   0,    1,    0,    0,    0,  891,    0,    0,    0,    0],
        [   1,    2,    0,    0,    0,    0,  955,    0,    0,    0],
        [   1,    0,    7,    0,    0,    0,    0, 1020,    0,    0],
        [   0,    1,    1,    0,    1,    0,    0,    0,  971,    0],
        [   2,    2,    0,    2,    0,    0,    0,    1,    2, 1000]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix5unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 227.15
Epoch 1, loss 14.16
Epoch 2, loss 8.85
Epoch 3, loss 6.50
Epoch 4, loss 5.02
Epoch 5, loss 4.52
Epoch 6, loss 3.54
Epoch 7, loss 3.14
Epoch 8, loss 3.18
Epoch 9, loss 2.87
**** Finished Training ****
Change in stitch weights: 0.9085882306098938
Largest abs weight change: 0.06845062226057053
Number of weights changing > 0.1 of that: 4210
Change in stitch bias: 0.027867073193192482
Largest abs bias change: 0.003968223929405212
Number of bias changing > 0.1 of that: 111
Test the trained stitch against biased data
Test Accuracy: 99.96 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    1,    0,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0,    1,  972,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix6unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 76.39
Epoch 1, loss 4.78
Epoch 2, loss 2.89
Epoch 3, loss 2.29
Epoch 4, loss 2.15
Epoch 5, loss 1.74
Epoch 6, loss 1.68
Epoch 7, loss 1.67
Epoch 8, loss 1.22
Epoch 9, loss 1.50
**** Finished Training ****
Change in stitch weights: 0.7377018332481384
Largest abs weight change: 0.027315039187669754
Number of weights changing > 0.1 of that: 18825
Change in stitch bias: 0.02506132423877716
Largest abs bias change: 0.002848513424396515
Number of bias changing > 0.1 of that: 228
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix7unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 51.14
Epoch 1, loss 3.03
Epoch 2, loss 2.67
Epoch 3, loss 2.18
Epoch 4, loss 1.76
Epoch 5, loss 1.43
Epoch 6, loss 1.49
Epoch 7, loss 1.32
Epoch 8, loss 1.26
Epoch 9, loss 1.37
**** Finished Training ****
Change in stitch weights: 0.8016335964202881
Largest abs weight change: 0.013892661780118942
Number of weights changing > 0.1 of that: 100703
Change in stitch bias: 0.02583794668316841
Largest abs bias change: 0.002016685903072357
Number of bias changing > 0.1 of that: 453
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix8unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 50.72
Epoch 1, loss 3.27
Epoch 2, loss 2.37
Epoch 3, loss 2.09
Epoch 4, loss 1.80
Epoch 5, loss 1.53
Epoch 6, loss 1.45
Epoch 7, loss 1.42
Epoch 8, loss 1.19
Epoch 9, loss 1.19
**** Finished Training ****
Change in stitch weights: 0.8050686717033386
Largest abs weight change: 0.013270174153149128
Number of weights changing > 0.1 of that: 107688
Change in stitch bias: 0.026144079864025116
Largest abs bias change: 0.002020888030529022
Number of bias changing > 0.1 of that: 463
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bw3unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 308.65
Epoch 1, loss 62.76
Epoch 2, loss 50.75
Epoch 3, loss 45.37
Epoch 4, loss 40.94
Epoch 5, loss 38.52
Epoch 6, loss 36.92
Epoch 7, loss 34.82
Epoch 8, loss 33.45
Epoch 9, loss 31.78
**** Finished Training ****
Change in stitch weights: 1.0683857202529907
Largest abs weight change: 0.14300793409347534
Number of weights changing > 0.1 of that: 1055
Change in stitch bias: 0.025759780779480934
Largest abs bias change: 0.00564604252576828
Number of bias changing > 0.1 of that: 56
Test the trained stitch against biased data
Test Accuracy: 97.79 %
Confusion Matrix
tensor([[ 973,    0,    3,    0,    0,    0,    1,    1,    2,    0],
        [   0, 1125,    5,    0,    3,    0,    1,    0,    1,    0],
        [   1,    2, 1022,    1,    3,    0,    0,    1,    2,    0],
        [   0,    0,    0,  996,    1,    8,    0,    1,    4,    0],
        [   0,    0,    1,    0,  972,    0,    1,    1,    2,    5],
        [   0,    0,    1,    9,    0,  879,    0,    1,    2,    0],
        [  16,    4,    4,    0,    4,    3,  922,    0,    5,    0],
        [   0,    2,   10,    5,    1,    0,    0, 1000,    1,    9],
        [   6,    0,    4,   10,    5,    2,    0,    1,  936,   10],
        [   9,    4,    2,    4,   14,   12,    0,    4,    6,  954]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw4unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 226.61
Epoch 1, loss 60.60
Epoch 2, loss 49.44
Epoch 3, loss 43.64
Epoch 4, loss 40.14
Epoch 5, loss 37.35
Epoch 6, loss 35.39
Epoch 7, loss 33.93
Epoch 8, loss 32.28
Epoch 9, loss 31.54
**** Finished Training ****
Change in stitch weights: 1.0824449062347412
Largest abs weight change: 0.10259586572647095
Number of weights changing > 0.1 of that: 1686
Change in stitch bias: 0.02606078051030636
Largest abs bias change: 0.0057085007429122925
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 97.99 %
Confusion Matrix
tensor([[ 975,    0,    1,    0,    0,    0,    0,    1,    3,    0],
        [   0, 1121,    6,    2,    0,    0,    3,    1,    2,    0],
        [   6,    4, 1015,    2,    1,    0,    0,    2,    2,    0],
        [   0,    0,    0,  994,    0,   11,    0,    2,    3,    0],
        [   1,    0,    0,    1,  966,    0,    1,    0,    3,   10],
        [   1,    0,    0,   12,    0,  874,    1,    0,    4,    0],
        [   8,    4,    0,    1,    2,    7,  933,    0,    3,    0],
        [   0,    0,   10,    4,    0,    0,    0, 1002,    4,    8],
        [   4,    2,    0,    4,    2,    2,    2,    2,  951,    5],
        [   4,    3,    1,    8,    7,    4,    0,    7,    7,  968]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw5unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 210.63
Epoch 1, loss 50.79
Epoch 2, loss 39.37
Epoch 3, loss 34.15
Epoch 4, loss 30.64
Epoch 5, loss 28.09
Epoch 6, loss 25.77
Epoch 7, loss 24.05
Epoch 8, loss 22.87
Epoch 9, loss 21.40
**** Finished Training ****
Change in stitch weights: 1.0879610776901245
Largest abs weight change: 0.053218014538288116
Number of weights changing > 0.1 of that: 7822
Change in stitch bias: 0.026817502453923225
Largest abs bias change: 0.0040097832679748535
Number of bias changing > 0.1 of that: 117
Test the trained stitch against biased data
Test Accuracy: 98.66 %
Confusion Matrix
tensor([[ 974,    0,    1,    0,    0,    0,    2,    1,    2,    0],
        [   0, 1127,    5,    0,    0,    0,    2,    0,    1,    0],
        [   6,    5, 1018,    0,    0,    0,    0,    1,    2,    0],
        [   0,    0,    0,  997,    0,    8,    0,    0,    4,    1],
        [   0,    0,    0,    0,  970,    1,    3,    0,    2,    6],
        [   0,    0,    0,   13,    0,  879,    0,    0,    0,    0],
        [   5,    2,    0,    0,    3,    3,  944,    0,    1,    0],
        [   0,    2,    2,    1,    1,    0,    0, 1018,    3,    1],
        [   4,    0,    0,    4,    0,    2,    4,    1,  954,    5],
        [   5,    0,    0,    3,    4,    0,    0,   10,    2,  985]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw6unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 117.40
Epoch 1, loss 29.11
Epoch 2, loss 23.57
Epoch 3, loss 20.42
Epoch 4, loss 18.87
Epoch 5, loss 17.66
Epoch 6, loss 16.75
Epoch 7, loss 15.60
Epoch 8, loss 15.30
Epoch 9, loss 14.80
**** Finished Training ****
Change in stitch weights: 0.8934941291809082
Largest abs weight change: 0.04855835810303688
Number of weights changing > 0.1 of that: 8180
Change in stitch bias: 0.02542518638074398
Largest abs bias change: 0.002824343740940094
Number of bias changing > 0.1 of that: 229
Test the trained stitch against biased data
Test Accuracy: 99.06 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    0,    0,    2,    0],
        [   1, 1130,    2,    0,    0,    0,    1,    0,    1,    0],
        [   3,    0, 1027,    0,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1003,    0,    3,    0,    1,    1,    2],
        [   0,    0,    0,    0,  974,    0,    0,    0,    1,    7],
        [   0,    0,    0,    5,    1,  886,    0,    0,    0,    0],
        [   1,    1,    0,    0,    2,    1,  947,    0,    6,    0],
        [   0,    2,    2,    1,    1,    0,    0, 1016,    3,    3],
        [   2,    0,    0,    3,    2,    0,    2,    2,  959,    4],
        [   1,    0,    0,    4,    6,    1,    0,    4,    7,  986]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw7unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 95.20
Epoch 1, loss 35.04
Epoch 2, loss 30.94
Epoch 3, loss 28.57
Epoch 4, loss 26.78
Epoch 5, loss 25.47
Epoch 6, loss 24.36
Epoch 7, loss 23.92
Epoch 8, loss 22.65
Epoch 9, loss 22.25
**** Finished Training ****
Change in stitch weights: 0.9160462617874146
Largest abs weight change: 0.02072807028889656
Number of weights changing > 0.1 of that: 53430
Change in stitch bias: 0.026117218658328056
Largest abs bias change: 0.0020145252346992493
Number of bias changing > 0.1 of that: 461
Test the trained stitch against biased data
Test Accuracy: 98.63 %
Confusion Matrix
tensor([[ 977,    1,    0,    1,    0,    0,    0,    0,    1,    0],
        [   2, 1130,    1,    1,    0,    0,    0,    0,    1,    0],
        [   4,    3, 1024,    0,    0,    0,    0,    1,    0,    0],
        [   1,    0,    0,  994,    0,    5,    0,    0,    9,    1],
        [   0,    0,    0,    0,  974,    0,    1,    0,    0,    7],
        [   1,    0,    0,    6,    1,  883,    1,    0,    0,    0],
        [   1,    1,    0,    0,    1,    3,  947,    0,    5,    0],
        [   0,    0,    3,    0,    1,    0,    0, 1018,    3,    3],
        [   4,    0,    0,   19,    3,    7,    2,    4,  934,    1],
        [   1,    0,    0,    5,    7,    3,    0,    7,    4,  982]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw8unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 92.90
Epoch 1, loss 35.69
Epoch 2, loss 31.03
Epoch 3, loss 28.19
Epoch 4, loss 27.05
Epoch 5, loss 25.37
Epoch 6, loss 24.36
Epoch 7, loss 23.64
Epoch 8, loss 22.58
Epoch 9, loss 22.52
**** Finished Training ****
Change in stitch weights: 0.9137888550758362
Largest abs weight change: 0.027671121060848236
Number of weights changing > 0.1 of that: 24139
Change in stitch bias: 0.027444319799542427
Largest abs bias change: 0.002016078680753708
Number of bias changing > 0.1 of that: 466
Test the trained stitch against biased data
Test Accuracy: 98.65 %
Confusion Matrix
tensor([[ 977,    1,    0,    0,    0,    0,    0,    1,    1,    0],
        [   1, 1133,    1,    0,    0,    0,    0,    0,    0,    0],
        [   3,    5, 1022,    0,    0,    0,    0,    2,    0,    0],
        [   1,    1,    0,  987,    0,    6,    0,    1,   10,    4],
        [   0,    0,    0,    0,  973,    0,    2,    1,    0,    6],
        [   0,    0,    0,    4,    1,  886,    1,    0,    0,    0],
        [   1,    2,    0,    0,    2,    1,  948,    0,    4,    0],
        [   0,    2,    1,    0,    1,    0,    0, 1018,    3,    3],
        [   3,    0,    0,   16,    3,    4,    2,    5,  938,    3],
        [   0,    0,    0,    4,    7,    3,    0,    7,    5,  983]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bgonly3unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 201.09
Epoch 1, loss 35.70
Epoch 2, loss 24.57
Epoch 3, loss 18.14
Epoch 4, loss 14.60
Epoch 5, loss 13.76
Epoch 6, loss 11.35
Epoch 7, loss 10.79
Epoch 8, loss 14.07
Epoch 9, loss 9.71
**** Finished Training ****
Change in stitch weights: 0.9936698079109192
Largest abs weight change: 0.06848961114883423
Number of weights changing > 0.1 of that: 2443
Change in stitch bias: 0.026311062276363373
Largest abs bias change: 0.005668014287948608
Number of bias changing > 0.1 of that: 56
Test the trained stitch against biased data
Test Accuracy: 99.87 %
Confusion Matrix
tensor([[ 979,    1,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    1,    0,    1,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   4,    0,    0,    0,    0,    0,  954,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    1,    1,    0,    0,    0,    0,  972,    0],
        [   1,    1,    0,    0,    1,    0,    0,    0,    0, 1006]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly4unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 256.18
Epoch 1, loss 26.05
Epoch 2, loss 18.55
Epoch 3, loss 13.02
Epoch 4, loss 10.43
Epoch 5, loss 8.02
Epoch 6, loss 6.46
Epoch 7, loss 6.47
Epoch 8, loss 5.28
Epoch 9, loss 5.10
**** Finished Training ****
Change in stitch weights: 0.9988711476325989
Largest abs weight change: 0.11771497130393982
Number of weights changing > 0.1 of that: 1436
Change in stitch bias: 0.02759340964257717
Largest abs bias change: 0.005455799400806427
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    1,    0,    0,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly5unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 384.32
Epoch 1, loss 15.27
Epoch 2, loss 8.24
Epoch 3, loss 5.63
Epoch 4, loss 4.49
Epoch 5, loss 3.60
Epoch 6, loss 3.47
Epoch 7, loss 3.08
Epoch 8, loss 2.81
Epoch 9, loss 2.26
**** Finished Training ****
Change in stitch weights: 0.9780821800231934
Largest abs weight change: 0.05151452496647835
Number of weights changing > 0.1 of that: 7353
Change in stitch bias: 0.026887862011790276
Largest abs bias change: 0.004001140594482422
Number of bias changing > 0.1 of that: 115
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly6unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 73.20
Epoch 1, loss 4.53
Epoch 2, loss 3.83
Epoch 3, loss 2.70
Epoch 4, loss 2.33
Epoch 5, loss 2.22
Epoch 6, loss 2.19
Epoch 7, loss 1.79
Epoch 8, loss 1.94
Epoch 9, loss 2.39
**** Finished Training ****
Change in stitch weights: 0.7204863429069519
Largest abs weight change: 0.0327579528093338
Number of weights changing > 0.1 of that: 12978
Change in stitch bias: 0.025838486850261688
Largest abs bias change: 0.0028469227254390717
Number of bias changing > 0.1 of that: 227
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly7unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 41.26
Epoch 1, loss 3.53
Epoch 2, loss 2.70
Epoch 3, loss 2.36
Epoch 4, loss 1.99
Epoch 5, loss 1.73
Epoch 6, loss 1.48
Epoch 7, loss 1.84
Epoch 8, loss 1.24
Epoch 9, loss 1.53
**** Finished Training ****
Change in stitch weights: 0.7729780673980713
Largest abs weight change: 0.011847528629004955
Number of weights changing > 0.1 of that: 119777
Change in stitch bias: 0.026628388091921806
Largest abs bias change: 0.002016652375459671
Number of bias changing > 0.1 of that: 457
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly8unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 30.57
Epoch 1, loss 3.45
Epoch 2, loss 2.78
Epoch 3, loss 2.41
Epoch 4, loss 1.78
Epoch 5, loss 1.71
Epoch 6, loss 1.80
Epoch 7, loss 1.64
Epoch 8, loss 1.60
Epoch 9, loss 1.62
**** Finished Training ****
Change in stitch weights: 0.7380415797233582
Largest abs weight change: 0.010037411004304886
Number of weights changing > 0.1 of that: 139191
Change in stitch bias: 0.02713966928422451
Largest abs bias change: 0.002019960433244705
Number of bias changing > 0.1 of that: 469
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bg3unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 397.57
Epoch 1, loss 40.56
Epoch 2, loss 24.61
Epoch 3, loss 19.34
Epoch 4, loss 15.58
Epoch 5, loss 13.58
Epoch 6, loss 11.33
Epoch 7, loss 10.75
Epoch 8, loss 9.40
Epoch 9, loss 8.45
**** Finished Training ****
Change in stitch weights: 1.1225857734680176
Largest abs weight change: 0.12990981340408325
Number of weights changing > 0.1 of that: 1564
Change in stitch bias: 0.024400576949119568
Largest abs bias change: 0.005558989942073822
Number of bias changing > 0.1 of that: 55
Test the trained stitch against biased data
Test Accuracy: 99.88 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    0,    1],
        [   0,    0,    0, 1009,    0,    1,    0,    0,    0,    0],
        [   0,    1,    0,    0,  981,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    2,    0,    0,    0,    0, 1026,    0,    0],
        [   0,    0,    1,    0,    3,    0,    0,    0,  970,    0],
        [   0,    0,    0,    1,    0,    1,    0,    0,    0, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg4unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 170.27
Epoch 1, loss 26.11
Epoch 2, loss 15.67
Epoch 3, loss 12.26
Epoch 4, loss 9.25
Epoch 5, loss 8.83
Epoch 6, loss 13.02
Epoch 7, loss 6.53
Epoch 8, loss 6.55
Epoch 9, loss 4.84
**** Finished Training ****
Change in stitch weights: 0.9316826462745667
Largest abs weight change: 0.09659131616353989
Number of weights changing > 0.1 of that: 1606
Change in stitch bias: 0.025043141096830368
Largest abs bias change: 0.005600273609161377
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.94 %
Confusion Matrix
tensor([[ 979,    1,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   2,    0,    0,    0,    0,    0,  956,    0,    0,    0],
        [   0,    1,    0,    0,    1,    0,    0, 1026,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    1,    0,    0,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg5unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 130.77
Epoch 1, loss 15.14
Epoch 2, loss 8.99
Epoch 3, loss 5.77
Epoch 4, loss 4.22
Epoch 5, loss 2.96
Epoch 6, loss 2.52
Epoch 7, loss 2.09
Epoch 8, loss 1.96
Epoch 9, loss 1.62
**** Finished Training ****
Change in stitch weights: 0.8400501608848572
Largest abs weight change: 0.04040226712822914
Number of weights changing > 0.1 of that: 7460
Change in stitch bias: 0.02705356478691101
Largest abs bias change: 0.003990039229393005
Number of bias changing > 0.1 of that: 118
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg6unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 46.41
Epoch 1, loss 2.48
Epoch 2, loss 1.75
Epoch 3, loss 1.46
Epoch 4, loss 0.87
Epoch 5, loss 0.88
Epoch 6, loss 0.78
Epoch 7, loss 0.67
Epoch 8, loss 0.91
Epoch 9, loss 0.60
**** Finished Training ****
Change in stitch weights: 0.6396150588989258
Largest abs weight change: 0.019459065049886703
Number of weights changing > 0.1 of that: 26990
Change in stitch bias: 0.02688261866569519
Largest abs bias change: 0.0028365179896354675
Number of bias changing > 0.1 of that: 230
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg7unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 21.63
Epoch 1, loss 1.65
Epoch 2, loss 1.05
Epoch 3, loss 1.20
Epoch 4, loss 0.64
Epoch 5, loss 0.69
Epoch 6, loss 0.75
Epoch 7, loss 0.56
Epoch 8, loss 0.63
Epoch 9, loss 0.61
**** Finished Training ****
Change in stitch weights: 0.7165595293045044
Largest abs weight change: 0.010365623980760574
Number of weights changing > 0.1 of that: 133503
Change in stitch bias: 0.025439806282520294
Largest abs bias change: 0.0020144805312156677
Number of bias changing > 0.1 of that: 460
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg8unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 38.23
Epoch 1, loss 1.95
Epoch 2, loss 1.43
Epoch 3, loss 1.03
Epoch 4, loss 0.87
Epoch 5, loss 1.04
Epoch 6, loss 0.75
Epoch 7, loss 0.78
Epoch 8, loss 0.65
Epoch 9, loss 0.65
**** Finished Training ****
Change in stitch weights: 0.7648314237594604
Largest abs weight change: 0.01106349192559719
Number of weights changing > 0.1 of that: 128599
Change in stitch bias: 0.02609965391457081
Largest abs bias change: 0.002011612057685852
Number of bias changing > 0.1 of that: 467
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bias3unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 258.39
Epoch 1, loss 28.23
Epoch 2, loss 20.09
Epoch 3, loss 15.30
Epoch 4, loss 13.83
Epoch 5, loss 12.33
Epoch 6, loss 10.86
Epoch 7, loss 9.83
Epoch 8, loss 8.37
Epoch 9, loss 8.22
**** Finished Training ****
Change in stitch weights: 0.9160932898521423
Largest abs weight change: 0.1708132028579712
Number of weights changing > 0.1 of that: 709
Change in stitch bias: 0.023039666935801506
Largest abs bias change: 0.005629546940326691
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.82 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    1,    0,    0,    0,    1,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    1,    0,    0,    0,  955,    0,    2,    0],
        [   0,    0,    3,    3,    0,    0,    0, 1022,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,  973,    0],
        [   3,    1,    0,    0,    1,    0,    0,    0,    0, 1004]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias4unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 372.70
Epoch 1, loss 44.65
Epoch 2, loss 26.57
Epoch 3, loss 19.30
Epoch 4, loss 15.89
Epoch 5, loss 13.81
Epoch 6, loss 11.59
Epoch 7, loss 10.56
Epoch 8, loss 9.76
Epoch 9, loss 7.97
**** Finished Training ****
Change in stitch weights: 1.1445326805114746
Largest abs weight change: 0.11890870332717896
Number of weights changing > 0.1 of that: 1610
Change in stitch bias: 0.027858387678861618
Largest abs bias change: 0.00570109486579895
Number of bias changing > 0.1 of that: 62
Test the trained stitch against biased data
Test Accuracy: 99.84 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    0,    2,    2,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1029,    0,    0,    0,    0,    0,    3,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   2,    1,    0,    0,    0,    0,  955,    0,    0,    0],
        [   2,    0,    0,    0,    1,    0,    0, 1025,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0,    0,  973,    0],
        [   0,    0,    0,    1,    0,    0,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias5unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 145.46
Epoch 1, loss 13.06
Epoch 2, loss 7.85
Epoch 3, loss 4.95
Epoch 4, loss 4.15
Epoch 5, loss 3.18
Epoch 6, loss 2.58
Epoch 7, loss 2.44
Epoch 8, loss 2.05
Epoch 9, loss 2.08
**** Finished Training ****
Change in stitch weights: 0.8460873365402222
Largest abs weight change: 0.04532681405544281
Number of weights changing > 0.1 of that: 6530
Change in stitch bias: 0.025572089478373528
Largest abs bias change: 0.003919102251529694
Number of bias changing > 0.1 of that: 122
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias6unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 73.07
Epoch 1, loss 5.94
Epoch 2, loss 3.48
Epoch 3, loss 2.44
Epoch 4, loss 1.86
Epoch 5, loss 1.62
Epoch 6, loss 1.32
Epoch 7, loss 1.13
Epoch 8, loss 1.00
Epoch 9, loss 0.81
**** Finished Training ****
Change in stitch weights: 0.7276481986045837
Largest abs weight change: 0.02974879927933216
Number of weights changing > 0.1 of that: 16661
Change in stitch bias: 0.02651733160018921
Largest abs bias change: 0.0028582699596881866
Number of bias changing > 0.1 of that: 231
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias7unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 34.48
Epoch 1, loss 2.62
Epoch 2, loss 1.66
Epoch 3, loss 1.59
Epoch 4, loss 1.14
Epoch 5, loss 0.95
Epoch 6, loss 1.31
Epoch 7, loss 0.79
Epoch 8, loss 0.76
Epoch 9, loss 0.76
**** Finished Training ****
Change in stitch weights: 0.7484055161476135
Largest abs weight change: 0.015189578756690025
Number of weights changing > 0.1 of that: 81565
Change in stitch bias: 0.02584034390747547
Largest abs bias change: 0.0020185187458992004
Number of bias changing > 0.1 of that: 457
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias8unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 36.26
Epoch 1, loss 3.22
Epoch 2, loss 2.34
Epoch 3, loss 1.74
Epoch 4, loss 1.55
Epoch 5, loss 1.18
Epoch 6, loss 0.95
Epoch 7, loss 0.94
Epoch 8, loss 1.03
Epoch 9, loss 0.97
**** Finished Training ****
Change in stitch weights: 0.7688118815422058
Largest abs weight change: 0.014020347967743874
Number of weights changing > 0.1 of that: 95530
Change in stitch bias: 0.02591685578227043
Largest abs bias change: 0.0020193755626678467
Number of bias changing > 0.1 of that: 450
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/unbias3unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 370.57
Epoch 1, loss 46.41
Epoch 2, loss 32.87
Epoch 3, loss 27.00
Epoch 4, loss 23.13
Epoch 5, loss 19.90
Epoch 6, loss 17.76
Epoch 7, loss 16.47
Epoch 8, loss 15.57
Epoch 9, loss 14.42
**** Finished Training ****
Change in stitch weights: 1.1561763286590576
Largest abs weight change: 0.14267700910568237
Number of weights changing > 0.1 of that: 1301
Change in stitch bias: 0.0278709065169096
Largest abs bias change: 0.00568370521068573
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.38 %
Confusion Matrix
tensor([[ 976,    0,    2,    0,    0,    0,    0,    1,    1,    0],
        [   0, 1133,    0,    0,    1,    0,    1,    0,    0,    0],
        [   0,    0, 1029,    0,    0,    0,    0,    0,    3,    0],
        [   0,    0,    2, 1006,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0,    0,  980,    0,    0,    1,    0,    1],
        [   0,    0,    0,    1,    0,  891,    0,    0,    0,    0],
        [  11,    0,    1,    1,    1,    3,  937,    0,    4,    0],
        [   0,    0,   10,    1,    0,    0,    0, 1016,    1,    0],
        [   0,    0,    0,    0,    4,    0,    0,    0,  969,    1],
        [   1,    0,    0,    2,    3,    1,    0,    1,    0, 1001]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias4unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 162.79
Epoch 1, loss 49.89
Epoch 2, loss 38.80
Epoch 3, loss 32.58
Epoch 4, loss 29.14
Epoch 5, loss 26.20
Epoch 6, loss 23.71
Epoch 7, loss 22.03
Epoch 8, loss 20.85
Epoch 9, loss 19.31
**** Finished Training ****
Change in stitch weights: 1.0073761940002441
Largest abs weight change: 0.13200369477272034
Number of weights changing > 0.1 of that: 1147
Change in stitch bias: 0.028249530121684074
Largest abs bias change: 0.005637906491756439
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 98.74 %
Confusion Matrix
tensor([[ 976,    0,    1,    0,    0,    0,    0,    1,    2,    0],
        [   0, 1129,    0,    3,    0,    0,    2,    0,    1,    0],
        [   1,    0, 1025,    1,    2,    0,    0,    1,    2,    0],
        [   0,    0,    0, 1005,    0,    2,    0,    0,    2,    1],
        [   0,    1,    0,    0,  980,    0,    0,    0,    1,    0],
        [   1,    0,    1,    7,    0,  881,    0,    0,    2,    0],
        [   9,    0,    4,    1,    3,    5,  935,    0,    1,    0],
        [   1,    2,    6,    2,    1,    0,    0, 1013,    1,    2],
        [   3,    0,    4,    5,    1,    1,    1,    3,  955,    1],
        [   3,    2,    0,    4,    5,   10,    0,    3,    7,  975]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias5unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 192.52
Epoch 1, loss 47.86
Epoch 2, loss 36.55
Epoch 3, loss 30.12
Epoch 4, loss 27.30
Epoch 5, loss 25.80
Epoch 6, loss 24.26
Epoch 7, loss 22.75
Epoch 8, loss 21.29
Epoch 9, loss 21.05
**** Finished Training ****
Change in stitch weights: 1.0372215509414673
Largest abs weight change: 0.06327448040246964
Number of weights changing > 0.1 of that: 6012
Change in stitch bias: 0.025303145870566368
Largest abs bias change: 0.0040357038378715515
Number of bias changing > 0.1 of that: 114
Test the trained stitch against biased data
Test Accuracy: 98.45 %
Confusion Matrix
tensor([[ 973,    0,    2,    0,    0,    0,    2,    1,    2,    0],
        [   0, 1122,    0,    4,    0,    0,    6,    0,    3,    0],
        [   1,    2, 1022,    1,    1,    0,    0,    0,    5,    0],
        [   0,    0,    0,  998,    0,    9,    0,    0,    2,    1],
        [   0,    0,    0,    0,  973,    0,    0,    2,    2,    5],
        [   1,    0,    1,   10,    0,  877,    1,    0,    2,    0],
        [   9,    2,    0,    2,    4,    4,  933,    0,    4,    0],
        [   0,    1,    5,    3,    0,    0,    0, 1014,    2,    3],
        [   4,    0,    1,    5,    3,    2,    2,    1,  952,    4],
        [   5,    5,    1,    3,    3,    4,    0,    2,    5,  981]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias6unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 128.26
Epoch 1, loss 36.40
Epoch 2, loss 30.59
Epoch 3, loss 27.18
Epoch 4, loss 25.39
Epoch 5, loss 24.16
Epoch 6, loss 22.30
Epoch 7, loss 22.06
Epoch 8, loss 20.91
Epoch 9, loss 20.38
**** Finished Training ****
Change in stitch weights: 0.9123812913894653
Largest abs weight change: 0.032476507127285004
Number of weights changing > 0.1 of that: 19739
Change in stitch bias: 0.0259136613458395
Largest abs bias change: 0.00284421443939209
Number of bias changing > 0.1 of that: 221
Test the trained stitch against biased data
Test Accuracy: 98.65 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    0,    3,    1,    0,    0],
        [   0, 1125,    0,    0,    0,    0,    5,    0,    5,    0],
        [   1,    2, 1022,    1,    0,    0,    0,    3,    3,    0],
        [   0,    0,    3,  999,    0,    5,    0,    0,    2,    1],
        [   0,    0,    0,    0,  973,    0,    0,    1,    2,    6],
        [   2,    0,    1,   10,    0,  876,    0,    1,    2,    0],
        [   4,    4,    0,    0,    3,    1,  943,    0,    3,    0],
        [   0,    1,    5,    2,    1,    0,    0, 1014,    3,    2],
        [   4,    0,    0,    3,    5,    2,    0,    2,  954,    4],
        [   1,    4,    2,    3,    4,    4,    0,    5,    3,  983]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias7unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 86.15
Epoch 1, loss 26.93
Epoch 2, loss 24.78
Epoch 3, loss 23.31
Epoch 4, loss 22.66
Epoch 5, loss 21.61
Epoch 6, loss 20.71
Epoch 7, loss 20.88
Epoch 8, loss 20.48
Epoch 9, loss 20.26
**** Finished Training ****
Change in stitch weights: 0.8723613619804382
Largest abs weight change: 0.011980276554822922
Number of weights changing > 0.1 of that: 127580
Change in stitch bias: 0.025867940858006477
Largest abs bias change: 0.0020201317965984344
Number of bias changing > 0.1 of that: 471
Test the trained stitch against biased data
Test Accuracy: 98.42 %
Confusion Matrix
tensor([[ 973,    0,    0,    0,    0,    1,    2,    1,    2,    1],
        [   0, 1120,    0,    2,    0,    0,    4,    1,    8,    0],
        [   0,    1, 1023,    0,    0,    0,    1,    4,    3,    0],
        [   0,    0,    1, 1001,    0,    4,    0,    0,    2,    2],
        [   0,    0,    0,    0,  977,    0,    0,    0,    2,    3],
        [   2,    0,    1,   12,    0,  872,    1,    1,    2,    1],
        [   6,    3,    0,    2,    2,    3,  939,    0,    3,    0],
        [   0,    2,    8,    3,    0,    0,    0, 1009,    3,    3],
        [   4,    2,    1,    4,    2,    3,    1,    2,  952,    3],
        [   0,    4,    2,    4,    6,    6,    0,    5,    6,  976]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias8unbias-bias-61_2025-01-29_20-01-26_SEED61_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 89.82
Epoch 1, loss 27.10
Epoch 2, loss 24.50
Epoch 3, loss 23.34
Epoch 4, loss 23.31
Epoch 5, loss 21.94
Epoch 6, loss 21.40
Epoch 7, loss 21.06
Epoch 8, loss 20.42
Epoch 9, loss 19.96
**** Finished Training ****
Change in stitch weights: 0.8706745505332947
Largest abs weight change: 0.011597005650401115
Number of weights changing > 0.1 of that: 131605
Change in stitch bias: 0.025922397151589394
Largest abs bias change: 0.0020193085074424744
Number of bias changing > 0.1 of that: 466
Test the trained stitch against biased data
Test Accuracy: 98.48 %
Confusion Matrix
tensor([[ 975,    0,    0,    0,    0,    0,    2,    1,    1,    1],
        [   0, 1124,    0,    0,    0,    0,    4,    0,    7,    0],
        [   0,    1, 1025,    0,    0,    0,    1,    2,    3,    0],
        [   0,    0,    2,  997,    0,    7,    0,    0,    2,    2],
        [   0,    0,    0,    0,  971,    0,    0,    1,    2,    8],
        [   2,    0,    1,    9,    0,  875,    2,    1,    2,    0],
        [   8,    2,    0,    1,    2,    6,  936,    0,    3,    0],
        [   1,    3,    7,    3,    0,    0,    0, 1010,    2,    2],
        [   5,    1,    0,    3,    2,    3,    0,    2,  954,    4],
        [   0,    5,    1,    3,    2,    6,    0,    5,    6,  981]],
       dtype=torch.int32)
===================================================================
stitching_accuracies={'mix': {'unbias': {3: 99.36, 4: 99.71, 5: 99.96, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bw': {'unbias': {3: 97.79, 4: 97.99, 5: 98.66, 6: 99.06, 7: 98.63, 8: 98.65}}, 'bgonly': {'unbias': {3: 99.87, 4: 99.99, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bg': {'unbias': {3: 99.88, 4: 99.94, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bias': {'unbias': {3: 99.82, 4: 99.84, 5: 99.99, 6: 100.0, 7: 100.0, 8: 100.0}}, 'unbias': {'unbias': {3: 99.38, 4: 98.74, 5: 98.45, 6: 98.65, 7: 98.42, 8: 98.48}}}
stitching_penalties={'mix': {'unbias': {3: -1.6700000000000017, 4: -2.019999999999996, 5: -2.269999999999996, 6: -2.3100000000000023, 7: -2.3100000000000023, 8: -2.3100000000000023}}, 'bw': {'unbias': {3: -0.10000000000000853, 4: -0.29999999999999716, 5: -0.9699999999999989, 6: -1.3700000000000045, 7: -0.9399999999999977, 8: -0.960000000000008}}, 'bgonly': {'unbias': {3: -2.180000000000007, 4: -2.299999999999997, 5: -2.3100000000000023, 6: -2.3100000000000023, 7: -2.3100000000000023, 8: -2.3100000000000023}}, 'bg': {'unbias': {3: -2.1899999999999977, 4: -2.25, 5: -2.3100000000000023, 6: -2.3100000000000023, 7: -2.3100000000000023, 8: -2.3100000000000023}}, 'bias': {'unbias': {3: -2.1299999999999955, 4: -2.1500000000000057, 5: -2.299999999999997, 6: -2.3100000000000023, 7: -2.3100000000000023, 8: -2.3100000000000023}}, 'unbias': {'unbias': {3: -1.6899999999999977, 4: -1.0499999999999972, 5: -0.7600000000000051, 6: -0.960000000000008, 7: -0.730000000000004, 8: -0.7900000000000063}}}
synth-mix
100.0
Stitch Accuracy
{3: 99.36, 4: 99.71, 5: 99.96, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bw
62.73
Stitch Accuracy
{3: 97.79, 4: 97.99, 5: 98.66, 6: 99.06, 7: 98.63, 8: 98.65}
--------------------------
synth-bgonly
90.71
Stitch Accuracy
{3: 99.87, 4: 99.99, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bg
100.0
Stitch Accuracy
{3: 99.88, 4: 99.94, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bias
99.95
Stitch Accuracy
{3: 99.82, 4: 99.84, 5: 99.99, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-unbias
97.69
Stitch Accuracy
{3: 99.38, 4: 98.74, 5: 98.45, 6: 98.65, 7: 98.42, 8: 98.48}
--------------------------
