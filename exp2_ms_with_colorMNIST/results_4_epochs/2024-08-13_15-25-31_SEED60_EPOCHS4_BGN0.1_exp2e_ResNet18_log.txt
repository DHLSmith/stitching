Executed at 2024-08-13_15-25-31
logging to ./results_4_epochs/2024-08-13_15-25-31_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_log.txt
seed=60
bg_noise=0.1
train_mix_mnist_model=False
mix_mnist_model_to_load='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_mix_mnist.weights'
train_bw_mnist_model=False
bw_mnist_model_to_load='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bw_mnist.weights'
train_bg_only_colour_mnist_model=False
bg_only_colour_mnist_model_to_load='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_only_colour_mnist.weights'
train_bg_unbiased_colour_mnist_model=False
bg_unbiased_colour_mnist_model_to_load='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_unbiased_colour_mnist.weights'
train_biased_colour_mnist_model=False
biased_colour_mnist_model_to_load='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_biased_colour_mnist.weights'
train_unbiased_colour_mnist_model=False
unbiased_colour_mnist_model_to_load='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist.weights'
stitch_train_epochs=10
================================================
val['loadfrom']='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_mix_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bw_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_only_colour_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_bg_unbiased_colour_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_biased_colour_mnist.weights'
val['loadfrom']='./results_4_epochs/2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist.weights'
Entering Confusion
Accuracy Calculation for ResNet18 with key='mix'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 99.97 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   3,    0,    0,    0,    0,    0,  955,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bw'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 73.75 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    0,    1,    1,    0],
        [   6, 1102,    4,    0,    0,    0,    5,    0,   18,    0],
        [  14,    1,  986,    0,    0,    0,    3,    1,   27,    0],
        [ 149,   32,   23,    0,    1,    0,  164,    2,  639,    0],
        [   1,   73,    0,    0,  874,    0,   32,    1,    0,    1],
        [   7,   11,    0,    0,    0,    0,  872,    0,    2,    0],
        [   8,    4,    0,    0,    1,    0,  945,    0,    0,    0],
        [  21,   13,   19,    0,    7,    0,    0,  907,   59,    2],
        [  78,   13,    0,    0,    1,    0,   40,    0,  842,    0],
        [  46,   34,    0,    0,   19,    0,   10,   33,  126,  741]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bgonly'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 75.26 %
Confusion Matrix
tensor([[ 786,    0,    0,    0,    0,    0,   97,   97,    0,    0],
        [   0, 1131,    0,    0,    0,    4,    0,    0,    0,    0],
        [   0,    0,  109,    0,    0,    0,    0,    0,  923,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,  298,    0,    0,  660,    0,    0,    0],
        [   0,    0,    0,    0,  238,    0,    0,  790,    0,    0],
        [   0,    0,    0,    0,  356,    0,    0,    0,  618,    0],
        [   0,    0,    0,    0,  461,    0,    0,    0,    0,  548]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bg'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='unbias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 96.61 %
Confusion Matrix
tensor([[ 971,    0,    1,    0,    0,    1,    2,    2,    2,    1],
        [   0, 1116,    1,    2,    2,    0,    0,    2,    5,    7],
        [   4,   11,  993,    7,    2,    0,    1,    5,    8,    1],
        [   0,    0,    3,  993,    0,    0,    0,   10,    3,    1],
        [   0,    0,    0,    0,  942,    0,    6,    2,    3,   29],
        [   3,    1,    1,   36,    0,  835,    3,    2,    5,    6],
        [  10,    6,    1,    1,    0,   13,  921,    1,    5,    0],
        [   1,    2,    7,    2,    0,    0,    0, 1005,    2,    9],
        [   3,    3,    3,   19,    4,    8,    2,    5,  923,    4],
        [   3,    1,    0,   16,    9,    3,    0,    9,    6,  962]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'mix': 99.97, 'bw': 73.75, 'bgonly': 75.26, 'bg': 100.0, 'bias': 100.0, 'unbias': 96.61}
Entering whole model check
Measure Rank for key='mix'
Measure Rank for key='bw'
Measure Rank for key='bgonly'
Measure Rank for key='bg'
Measure Rank for key='bias'
Measure Rank for key='unbias'
Entering Stitch/Rank
device='cuda:0'
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/mix3unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 832.77
Epoch 1, loss 445.10
Epoch 2, loss 69.01
Epoch 3, loss 25.03
Epoch 4, loss 21.38
Epoch 5, loss 19.05
Epoch 6, loss 15.11
Epoch 7, loss 13.47
Epoch 8, loss 12.91
Epoch 9, loss 11.86
**** Finished Training ****
Change in stitch weights: 1.1332757472991943
Largest abs weight change: 0.13223664462566376
Number of weights changing > 0.1 of that: 1420
Change in stitch bias: 0.025391962379217148
Largest abs bias change: 0.005655631422996521
Number of bias changing > 0.1 of that: 56
Test the trained stitch against biased data
Test Accuracy: 99.59 %
Confusion Matrix
tensor([[ 968,    0,    1,    5,    0,    0,    0,    6,    0,    0],
        [   0, 1134,    0,    0,    1,    0,    0,    0,    0,    0],
        [   0,    0, 1029,    2,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,  978,    0,    0,    3,    1,    0],
        [   0,    0,    0,    1,    0,  891,    0,    0,    0,    0],
        [   4,    1,    0,    1,    0,    2,  949,    1,    0,    0],
        [   2,    0,    1,    2,    0,    0,    0, 1022,    0,    1],
        [   0,    0,    0,    1,    0,    0,    0,    0,  973,    0],
        [   0,    0,    0,    2,    1,    0,    0,    0,    0, 1006]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix4unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 188.81
Epoch 1, loss 34.30
Epoch 2, loss 25.05
Epoch 3, loss 20.66
Epoch 4, loss 17.22
Epoch 5, loss 15.65
Epoch 6, loss 13.85
Epoch 7, loss 12.54
Epoch 8, loss 12.13
Epoch 9, loss 10.76
**** Finished Training ****
Change in stitch weights: 0.9733598232269287
Largest abs weight change: 0.0948297455906868
Number of weights changing > 0.1 of that: 1723
Change in stitch bias: 0.02602194808423519
Largest abs bias change: 0.005664072930812836
Number of bias changing > 0.1 of that: 63
Test the trained stitch against biased data
Test Accuracy: 99.88 %
Confusion Matrix
tensor([[ 977,    0,    0,    0,    0,    0,    0,    3,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    0,    1],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    2,  955,    0,    0,    0],
        [   0,    1,    0,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    1,    0,    1,    0,    0,    0,  972,    0],
        [   0,    0,    0,    1,    0,    0,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix5unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 187.39
Epoch 1, loss 14.26
Epoch 2, loss 9.57
Epoch 3, loss 7.28
Epoch 4, loss 5.77
Epoch 5, loss 4.59
Epoch 6, loss 4.23
Epoch 7, loss 3.69
Epoch 8, loss 3.36
Epoch 9, loss 3.15
**** Finished Training ****
Change in stitch weights: 0.8690624833106995
Largest abs weight change: 0.053184639662504196
Number of weights changing > 0.1 of that: 6077
Change in stitch bias: 0.02826189436018467
Largest abs bias change: 0.004027456045150757
Number of bias changing > 0.1 of that: 121
Test the trained stitch against biased data
Test Accuracy: 99.95 %
Confusion Matrix
tensor([[ 977,    0,    0,    0,    0,    0,    1,    2,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    1,    0,    0,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix6unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 129.72
Epoch 1, loss 4.11
Epoch 2, loss 2.82
Epoch 3, loss 2.35
Epoch 4, loss 2.13
Epoch 5, loss 2.21
Epoch 6, loss 1.46
Epoch 7, loss 1.55
Epoch 8, loss 1.56
Epoch 9, loss 1.21
**** Finished Training ****
Change in stitch weights: 0.7658876776695251
Largest abs weight change: 0.022560030221939087
Number of weights changing > 0.1 of that: 26795
Change in stitch bias: 0.026161909103393555
Largest abs bias change: 0.002846725285053253
Number of bias changing > 0.1 of that: 235
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix7unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 35.85
Epoch 1, loss 1.83
Epoch 2, loss 1.57
Epoch 3, loss 1.42
Epoch 4, loss 1.24
Epoch 5, loss 1.13
Epoch 6, loss 1.04
Epoch 7, loss 0.94
Epoch 8, loss 0.97
Epoch 9, loss 0.94
**** Finished Training ****
Change in stitch weights: 0.7529860734939575
Largest abs weight change: 0.008967479690909386
Number of weights changing > 0.1 of that: 152328
Change in stitch bias: 0.0259784497320652
Largest abs bias change: 0.0020124949514865875
Number of bias changing > 0.1 of that: 462
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix8unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 43.27
Epoch 1, loss 2.14
Epoch 2, loss 1.65
Epoch 3, loss 1.76
Epoch 4, loss 1.28
Epoch 5, loss 1.16
Epoch 6, loss 1.21
Epoch 7, loss 1.12
Epoch 8, loss 1.11
Epoch 9, loss 0.93
**** Finished Training ****
Change in stitch weights: 0.7669064402580261
Largest abs weight change: 0.011955413967370987
Number of weights changing > 0.1 of that: 118417
Change in stitch bias: 0.026137936860322952
Largest abs bias change: 0.002018321305513382
Number of bias changing > 0.1 of that: 466
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bw3unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 270.18
Epoch 1, loss 106.40
Epoch 2, loss 86.03
Epoch 3, loss 76.66
Epoch 4, loss 68.55
Epoch 5, loss 63.15
Epoch 6, loss 58.37
Epoch 7, loss 55.70
Epoch 8, loss 53.10
Epoch 9, loss 50.49
**** Finished Training ****
Change in stitch weights: 1.1472152471542358
Largest abs weight change: 0.12643612921237946
Number of weights changing > 0.1 of that: 1415
Change in stitch bias: 0.026627497747540474
Largest abs bias change: 0.005707003176212311
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 96.85 %
Confusion Matrix
tensor([[ 970,    0,    4,    0,    0,    0,    2,    3,    1,    0],
        [   0, 1127,    2,    2,    1,    0,    0,    1,    2,    0],
        [   7,    6, 1004,    0,    0,    0,    6,    2,    7,    0],
        [   0,    0,    0,  993,    0,    9,    0,    2,    5,    1],
        [   0,    0,    0,    1,  958,    0,   11,    0,    3,    9],
        [   0,    0,    1,   14,    0,  874,    2,    1,    0,    0],
        [   9,    7,    0,    0,    3,    6,  921,    0,   12,    0],
        [   0,    2,   17,    8,    2,    0,    1,  981,    5,   12],
        [   6,    0,    4,    9,    5,    3,    9,    2,  928,    8],
        [   5,    4,    0,   15,    4,   29,    0,   15,    8,  929]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw4unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 177.46
Epoch 1, loss 78.99
Epoch 2, loss 67.45
Epoch 3, loss 60.98
Epoch 4, loss 56.70
Epoch 5, loss 53.17
Epoch 6, loss 50.69
Epoch 7, loss 48.96
Epoch 8, loss 47.69
Epoch 9, loss 46.16
**** Finished Training ****
Change in stitch weights: 0.9519348740577698
Largest abs weight change: 0.10134170949459076
Number of weights changing > 0.1 of that: 1618
Change in stitch bias: 0.02358582243323326
Largest abs bias change: 0.005541585385799408
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 97.12 %
Confusion Matrix
tensor([[ 965,    2,    8,    0,    0,    0,    2,    2,    1,    0],
        [   0, 1119,    6,    1,    0,    0,    2,    1,    5,    1],
        [   8,    3, 1017,    0,    1,    0,    0,    0,    3,    0],
        [   1,    0,    1,  991,    0,    6,    0,    1,    8,    2],
        [   0,    0,    0,    0,  955,    1,    4,    0,    6,   16],
        [   1,    0,    0,   11,    0,  869,    5,    1,    4,    1],
        [   5,    3,    1,    0,    3,    4,  939,    0,    3,    0],
        [   0,    6,    6,    5,    3,    0,    0,  997,    2,    9],
        [  10,    0,    7,   12,    2,    5,    2,    7,  916,   13],
        [   5,    6,    1,   14,   11,    3,    0,   11,   14,  944]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw5unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 266.53
Epoch 1, loss 56.24
Epoch 2, loss 45.08
Epoch 3, loss 39.14
Epoch 4, loss 35.35
Epoch 5, loss 32.49
Epoch 6, loss 30.05
Epoch 7, loss 29.19
Epoch 8, loss 27.14
Epoch 9, loss 26.06
**** Finished Training ****
Change in stitch weights: 1.079681396484375
Largest abs weight change: 0.06993662565946579
Number of weights changing > 0.1 of that: 5489
Change in stitch bias: 0.024987904354929924
Largest abs bias change: 0.003983601927757263
Number of bias changing > 0.1 of that: 118
Test the trained stitch against biased data
Test Accuracy: 98.36 %
Confusion Matrix
tensor([[ 976,    0,    3,    0,    0,    0,    0,    0,    1,    0],
        [   1, 1125,    5,    0,    1,    0,    1,    0,    2,    0],
        [   6,    0, 1022,    0,    0,    0,    0,    3,    1,    0],
        [   0,    0,    0, 1001,    0,    4,    0,    1,    4,    0],
        [   0,    0,    0,    0,  959,    0,    6,    0,    3,   14],
        [   0,    0,    0,   12,    0,  880,    0,    0,    0,    0],
        [   1,    3,    1,    0,    2,    0,  945,    0,    6,    0],
        [   0,    3,    4,    1,    1,    0,    0, 1008,    2,    9],
        [   4,    0,    0,    3,    1,    1,    3,    2,  952,    8],
        [   5,    2,    1,    3,    7,    2,    0,   11,   10,  968]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw6unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 138.52
Epoch 1, loss 32.50
Epoch 2, loss 26.17
Epoch 3, loss 23.21
Epoch 4, loss 20.94
Epoch 5, loss 19.37
Epoch 6, loss 18.77
Epoch 7, loss 17.58
Epoch 8, loss 17.05
Epoch 9, loss 16.34
**** Finished Training ****
Change in stitch weights: 0.901451826095581
Largest abs weight change: 0.04258602112531662
Number of weights changing > 0.1 of that: 10847
Change in stitch bias: 0.026139505207538605
Largest abs bias change: 0.00285281240940094
Number of bias changing > 0.1 of that: 226
Test the trained stitch against biased data
Test Accuracy: 98.88 %
Confusion Matrix
tensor([[ 977,    1,    1,    0,    0,    0,    1,    0,    0,    0],
        [   1, 1127,    3,    1,    0,    0,    0,    0,    3,    0],
        [   6,    2, 1023,    0,    0,    0,    0,    1,    0,    0],
        [   0,    0,    0, 1001,    0,    5,    0,    1,    2,    1],
        [   0,    0,    0,    0,  965,    1,    5,    0,    1,   10],
        [   0,    0,    0,   12,    0,  879,    0,    0,    1,    0],
        [   0,    1,    0,    0,    3,    1,  951,    0,    2,    0],
        [   0,    1,    1,    3,    1,    0,    0, 1017,    1,    4],
        [   2,    0,    0,    5,    3,    1,    2,    2,  956,    3],
        [   0,    0,    0,    3,    5,    0,    0,    5,    4,  992]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw7unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 84.77
Epoch 1, loss 36.24
Epoch 2, loss 31.95
Epoch 3, loss 29.27
Epoch 4, loss 27.48
Epoch 5, loss 25.86
Epoch 6, loss 24.18
Epoch 7, loss 23.72
Epoch 8, loss 22.30
Epoch 9, loss 22.45
**** Finished Training ****
Change in stitch weights: 0.8792247176170349
Largest abs weight change: 0.023279445245862007
Number of weights changing > 0.1 of that: 33915
Change in stitch bias: 0.026858773082494736
Largest abs bias change: 0.002019822597503662
Number of bias changing > 0.1 of that: 477
Test the trained stitch against biased data
Test Accuracy: 98.53 %
Confusion Matrix
tensor([[ 977,    0,    2,    0,    0,    0,    0,    0,    1,    0],
        [   0, 1126,    2,    1,    0,    0,    1,    2,    3,    0],
        [   3,    2, 1026,    1,    0,    0,    0,    0,    0,    0],
        [   3,    0,    0,  995,    0,    7,    0,    1,    4,    0],
        [   0,    0,    0,    0,  973,    1,    3,    0,    0,    5],
        [   2,    0,    0,   13,    0,  875,    0,    0,    2,    0],
        [   2,    1,    0,    0,    2,    8,  945,    0,    0,    0],
        [   0,    4,    1,    2,    0,    0,    0, 1017,    0,    4],
        [   5,    0,    2,   15,    2,    3,    1,    1,  940,    5],
        [   0,    1,    0,    9,   11,    0,    0,    6,    3,  979]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw8unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 100.42
Epoch 1, loss 39.13
Epoch 2, loss 33.51
Epoch 3, loss 31.02
Epoch 4, loss 28.33
Epoch 5, loss 27.28
Epoch 6, loss 26.02
Epoch 7, loss 25.36
Epoch 8, loss 24.56
Epoch 9, loss 23.84
**** Finished Training ****
Change in stitch weights: 0.9094244837760925
Largest abs weight change: 0.024452712386846542
Number of weights changing > 0.1 of that: 31859
Change in stitch bias: 0.02656920626759529
Largest abs bias change: 0.0020156018435955048
Number of bias changing > 0.1 of that: 462
Test the trained stitch against biased data
Test Accuracy: 98.64 %
Confusion Matrix
tensor([[ 976,    1,    1,    0,    0,    1,    0,    1,    0,    0],
        [   0, 1127,    2,    0,    1,    0,    1,    2,    2,    0],
        [   3,    2, 1026,    0,    0,    0,    0,    1,    0,    0],
        [   2,    0,    0,  994,    1,    5,    0,    1,    7,    0],
        [   0,    0,    0,    0,  970,    1,    2,    0,    0,    9],
        [   1,    0,    0,   10,    0,  879,    0,    0,    2,    0],
        [   0,    0,    0,    0,    3,    6,  947,    0,    2,    0],
        [   0,    2,    4,    1,    0,    0,    0, 1016,    0,    5],
        [   3,    0,    0,   13,    0,    4,    1,    3,  944,    6],
        [   1,    1,    0,    7,    8,    0,    0,    4,    3,  985]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bgonly3unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 494.92
Epoch 1, loss 67.18
Epoch 2, loss 42.92
Epoch 3, loss 33.76
Epoch 4, loss 27.91
Epoch 5, loss 25.37
Epoch 6, loss 22.83
Epoch 7, loss 21.00
Epoch 8, loss 19.31
Epoch 9, loss 17.79
**** Finished Training ****
Change in stitch weights: 1.1009780168533325
Largest abs weight change: 0.11796611547470093
Number of weights changing > 0.1 of that: 1789
Change in stitch bias: 0.027017105370759964
Largest abs bias change: 0.005704447627067566
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.90 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   5,    0,    0,    0,    0,    1,  950,    0,    2,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly4unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 166.89
Epoch 1, loss 27.30
Epoch 2, loss 17.30
Epoch 3, loss 13.91
Epoch 4, loss 11.87
Epoch 5, loss 10.36
Epoch 6, loss 8.78
Epoch 7, loss 8.26
Epoch 8, loss 7.37
Epoch 9, loss 6.72
**** Finished Training ****
Change in stitch weights: 0.8811162710189819
Largest abs weight change: 0.0707237645983696
Number of weights changing > 0.1 of that: 2047
Change in stitch bias: 0.025791306048631668
Largest abs bias change: 0.005664929747581482
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.97 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    2,    0,    0,    0,  972,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly5unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 106.99
Epoch 1, loss 10.68
Epoch 2, loss 8.32
Epoch 3, loss 7.56
Epoch 4, loss 5.71
Epoch 5, loss 5.12
Epoch 6, loss 5.15
Epoch 7, loss 3.86
Epoch 8, loss 3.98
Epoch 9, loss 4.30
**** Finished Training ****
Change in stitch weights: 0.7366340756416321
Largest abs weight change: 0.04029763489961624
Number of weights changing > 0.1 of that: 7201
Change in stitch bias: 0.025795280933380127
Largest abs bias change: 0.004039451479911804
Number of bias changing > 0.1 of that: 121
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly6unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 65.80
Epoch 1, loss 6.60
Epoch 2, loss 6.07
Epoch 3, loss 5.18
Epoch 4, loss 3.67
Epoch 5, loss 4.04
Epoch 6, loss 3.76
Epoch 7, loss 3.27
Epoch 8, loss 3.66
Epoch 9, loss 3.44
**** Finished Training ****
Change in stitch weights: 0.6514320373535156
Largest abs weight change: 0.024357261136174202
Number of weights changing > 0.1 of that: 19596
Change in stitch bias: 0.025339091196656227
Largest abs bias change: 0.0028337426483631134
Number of bias changing > 0.1 of that: 232
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly7unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 35.78
Epoch 1, loss 7.13
Epoch 2, loss 5.31
Epoch 3, loss 5.40
Epoch 4, loss 4.17
Epoch 5, loss 4.22
Epoch 6, loss 5.00
Epoch 7, loss 4.11
Epoch 8, loss 4.91
Epoch 9, loss 4.34
**** Finished Training ****
Change in stitch weights: 0.7422196269035339
Largest abs weight change: 0.011250032112002373
Number of weights changing > 0.1 of that: 124779
Change in stitch bias: 0.026170281693339348
Largest abs bias change: 0.0020164698362350464
Number of bias changing > 0.1 of that: 449
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly8unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 53.29
Epoch 1, loss 6.94
Epoch 2, loss 5.81
Epoch 3, loss 5.54
Epoch 4, loss 5.26
Epoch 5, loss 4.63
Epoch 6, loss 4.82
Epoch 7, loss 4.69
Epoch 8, loss 3.49
Epoch 9, loss 3.61
**** Finished Training ****
Change in stitch weights: 0.7876706123352051
Largest abs weight change: 0.012650514021515846
Number of weights changing > 0.1 of that: 111837
Change in stitch bias: 0.02747548185288906
Largest abs bias change: 0.0020181722939014435
Number of bias changing > 0.1 of that: 462
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    1,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bg3unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 391.32
Epoch 1, loss 51.06
Epoch 2, loss 33.27
Epoch 3, loss 25.86
Epoch 4, loss 21.10
Epoch 5, loss 18.23
Epoch 6, loss 16.22
Epoch 7, loss 14.76
Epoch 8, loss 14.00
Epoch 9, loss 13.17
**** Finished Training ****
Change in stitch weights: 1.098547101020813
Largest abs weight change: 0.09341984987258911
Number of weights changing > 0.1 of that: 2052
Change in stitch bias: 0.026527531445026398
Largest abs bias change: 0.005697332322597504
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.89 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    0,    0,    3,    1,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    4,    2,  951,    0,    1,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg4unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 597.60
Epoch 1, loss 53.11
Epoch 2, loss 37.66
Epoch 3, loss 28.05
Epoch 4, loss 23.19
Epoch 5, loss 19.32
Epoch 6, loss 16.52
Epoch 7, loss 15.70
Epoch 8, loss 13.21
Epoch 9, loss 12.41
**** Finished Training ****
Change in stitch weights: 1.1842563152313232
Largest abs weight change: 0.12404072284698486
Number of weights changing > 0.1 of that: 1692
Change in stitch bias: 0.02733806148171425
Largest abs bias change: 0.005537301301956177
Number of bias changing > 0.1 of that: 59
Test the trained stitch against biased data
Test Accuracy: 99.82 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    0,    1,    2,    0,    1],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  979,    0,    0,    3,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  956,    0,    1,    0],
        [   0,    1,    0,    0,    4,    0,    0, 1023,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    2, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg5unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 131.09
Epoch 1, loss 11.13
Epoch 2, loss 6.72
Epoch 3, loss 5.34
Epoch 4, loss 4.62
Epoch 5, loss 3.66
Epoch 6, loss 3.41
Epoch 7, loss 2.70
Epoch 8, loss 2.60
Epoch 9, loss 2.10
**** Finished Training ****
Change in stitch weights: 0.8051870465278625
Largest abs weight change: 0.06946160644292831
Number of weights changing > 0.1 of that: 3543
Change in stitch bias: 0.026497889310121536
Largest abs bias change: 0.0040263831615448
Number of bias changing > 0.1 of that: 116
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg6unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 111.00
Epoch 1, loss 5.84
Epoch 2, loss 3.32
Epoch 3, loss 2.73
Epoch 4, loss 2.15
Epoch 5, loss 1.98
Epoch 6, loss 1.95
Epoch 7, loss 1.23
Epoch 8, loss 1.24
Epoch 9, loss 1.63
**** Finished Training ****
Change in stitch weights: 0.7766641974449158
Largest abs weight change: 0.023598741739988327
Number of weights changing > 0.1 of that: 25729
Change in stitch bias: 0.02796757034957409
Largest abs bias change: 0.002858314663171768
Number of bias changing > 0.1 of that: 235
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg7unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 32.15
Epoch 1, loss 1.90
Epoch 2, loss 1.39
Epoch 3, loss 1.60
Epoch 4, loss 1.17
Epoch 5, loss 1.27
Epoch 6, loss 0.96
Epoch 7, loss 0.97
Epoch 8, loss 0.68
Epoch 9, loss 1.05
**** Finished Training ****
Change in stitch weights: 0.7470281720161438
Largest abs weight change: 0.013047633692622185
Number of weights changing > 0.1 of that: 104798
Change in stitch bias: 0.025894243270158768
Largest abs bias change: 0.002019912004470825
Number of bias changing > 0.1 of that: 472
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg8unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 34.11
Epoch 1, loss 2.15
Epoch 2, loss 1.18
Epoch 3, loss 1.49
Epoch 4, loss 0.97
Epoch 5, loss 1.13
Epoch 6, loss 1.15
Epoch 7, loss 0.70
Epoch 8, loss 0.75
Epoch 9, loss 0.79
**** Finished Training ****
Change in stitch weights: 0.7461817860603333
Largest abs weight change: 0.013307780027389526
Number of weights changing > 0.1 of that: 101436
Change in stitch bias: 0.02760826237499714
Largest abs bias change: 0.002008594572544098
Number of bias changing > 0.1 of that: 470
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bias3unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 404.45
Epoch 1, loss 53.96
Epoch 2, loss 34.21
Epoch 3, loss 27.38
Epoch 4, loss 21.86
Epoch 5, loss 19.94
Epoch 6, loss 16.84
Epoch 7, loss 15.30
Epoch 8, loss 14.17
Epoch 9, loss 13.32
**** Finished Training ****
Change in stitch weights: 1.1519163846969604
Largest abs weight change: 0.10559792816638947
Number of weights changing > 0.1 of that: 2008
Change in stitch bias: 0.027429133653640747
Largest abs bias change: 0.005572207272052765
Number of bias changing > 0.1 of that: 64
Test the trained stitch against biased data
Test Accuracy: 99.76 %
Confusion Matrix
tensor([[ 973,    0,    0,    0,    0,    0,    1,    5,    1,    0],
        [   0, 1129,    0,    0,    2,    0,    0,    0,    0,    4],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    2,    0,    0],
        [   0,    0,    0,    1,    0,  891,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    3,    3,    0,    0,  968,    0],
        [   0,    0,    0,    0,    0,    0,    0,    1,    1, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias4unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 169.61
Epoch 1, loss 31.26
Epoch 2, loss 23.38
Epoch 3, loss 19.06
Epoch 4, loss 16.35
Epoch 5, loss 14.66
Epoch 6, loss 13.41
Epoch 7, loss 11.84
Epoch 8, loss 11.40
Epoch 9, loss 10.65
**** Finished Training ****
Change in stitch weights: 0.8822181820869446
Largest abs weight change: 0.08899268507957458
Number of weights changing > 0.1 of that: 1567
Change in stitch bias: 0.025776071473956108
Largest abs bias change: 0.005688048899173737
Number of bias changing > 0.1 of that: 60
Test the trained stitch against biased data
Test Accuracy: 99.94 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    0,    1,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    1,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    0,    0,    2,    0,    0, 1026,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    1,    0,    0,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias5unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 265.45
Epoch 1, loss 23.15
Epoch 2, loss 11.45
Epoch 3, loss 7.96
Epoch 4, loss 5.96
Epoch 5, loss 5.15
Epoch 6, loss 4.53
Epoch 7, loss 3.41
Epoch 8, loss 3.33
Epoch 9, loss 3.00
**** Finished Training ****
Change in stitch weights: 1.0315301418304443
Largest abs weight change: 0.06468769162893295
Number of weights changing > 0.1 of that: 5531
Change in stitch bias: 0.026824014261364937
Largest abs bias change: 0.004021041095256805
Number of bias changing > 0.1 of that: 117
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   2,    0,    0,    0,    0,    0,  956,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias6unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 56.60
Epoch 1, loss 3.41
Epoch 2, loss 1.73
Epoch 3, loss 1.88
Epoch 4, loss 1.34
Epoch 5, loss 1.66
Epoch 6, loss 1.12
Epoch 7, loss 0.92
Epoch 8, loss 1.41
Epoch 9, loss 0.93
**** Finished Training ****
Change in stitch weights: 0.6665264368057251
Largest abs weight change: 0.02281293272972107
Number of weights changing > 0.1 of that: 22383
Change in stitch bias: 0.025717053562402725
Largest abs bias change: 0.002793528139591217
Number of bias changing > 0.1 of that: 223
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias7unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 34.45
Epoch 1, loss 1.78
Epoch 2, loss 1.40
Epoch 3, loss 1.45
Epoch 4, loss 0.91
Epoch 5, loss 0.95
Epoch 6, loss 1.32
Epoch 7, loss 0.63
Epoch 8, loss 0.70
Epoch 9, loss 0.57
**** Finished Training ****
Change in stitch weights: 0.7446051239967346
Largest abs weight change: 0.014228872954845428
Number of weights changing > 0.1 of that: 90932
Change in stitch bias: 0.02712998352944851
Largest abs bias change: 0.002018474042415619
Number of bias changing > 0.1 of that: 457
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias8unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 29.53
Epoch 1, loss 1.63
Epoch 2, loss 1.11
Epoch 3, loss 1.17
Epoch 4, loss 0.91
Epoch 5, loss 0.79
Epoch 6, loss 1.33
Epoch 7, loss 1.15
Epoch 8, loss 0.79
Epoch 9, loss 0.65
**** Finished Training ****
Change in stitch weights: 0.7311301827430725
Largest abs weight change: 0.015083279460668564
Number of weights changing > 0.1 of that: 79927
Change in stitch bias: 0.026967797428369522
Largest abs bias change: 0.002019491046667099
Number of bias changing > 0.1 of that: 458
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/unbias3unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 493.23
Epoch 1, loss 53.39
Epoch 2, loss 35.75
Epoch 3, loss 27.51
Epoch 4, loss 22.21
Epoch 5, loss 19.34
Epoch 6, loss 16.85
Epoch 7, loss 14.69
Epoch 8, loss 13.13
Epoch 9, loss 12.68
**** Finished Training ****
Change in stitch weights: 1.1516896486282349
Largest abs weight change: 0.17604753375053406
Number of weights changing > 0.1 of that: 788
Change in stitch bias: 0.02663499303162098
Largest abs bias change: 0.005670525133609772
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.62 %
Confusion Matrix
tensor([[ 971,    0,    1,    4,    0,    1,    0,    3,    0,    0],
        [   0, 1134,    0,    0,    0,    0,    0,    0,    0,    1],
        [   0,    0, 1029,    2,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  979,    0,    1,    0,    2,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    1,    2,  954,    0,    0,    0],
        [   0,    0,    3,    1,    0,    0,    0, 1023,    0,    1],
        [   0,    0,    4,    2,    0,    2,    0,    0,  964,    2],
        [   0,    0,    0,    2,    0,    1,    0,    0,    0, 1006]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias4unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 194.00
Epoch 1, loss 59.87
Epoch 2, loss 49.26
Epoch 3, loss 43.05
Epoch 4, loss 38.81
Epoch 5, loss 35.46
Epoch 6, loss 33.10
Epoch 7, loss 31.02
Epoch 8, loss 29.53
Epoch 9, loss 27.78
**** Finished Training ****
Change in stitch weights: 0.9984074234962463
Largest abs weight change: 0.19466933608055115
Number of weights changing > 0.1 of that: 529
Change in stitch bias: 0.02762639708817005
Largest abs bias change: 0.005705833435058594
Number of bias changing > 0.1 of that: 61
Test the trained stitch against biased data
Test Accuracy: 98.64 %
Confusion Matrix
tensor([[ 966,    3,    0,    1,    0,    1,    4,    5,    0,    0],
        [   0, 1128,    1,    1,    0,    0,    0,    2,    0,    3],
        [   2,    1, 1021,    0,    0,    0,    0,    0,    8,    0],
        [   0,    0,    0, 1006,    0,    0,    0,    0,    2,    2],
        [   0,    0,    0,    0,  970,    0,    2,    2,    2,    6],
        [   0,    1,    0,    4,    0,  886,    0,    0,    1,    0],
        [   1,    1,    2,    0,    5,    5,  938,    0,    6,    0],
        [   1,   10,    2,    0,    4,    0,    0, 1009,    1,    1],
        [   3,    0,    6,    2,    0,    0,    2,    0,  960,    1],
        [   3,    5,    0,    8,    4,    1,    0,    2,    6,  980]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias5unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 168.75
Epoch 1, loss 67.95
Epoch 2, loss 57.03
Epoch 3, loss 51.16
Epoch 4, loss 46.73
Epoch 5, loss 43.53
Epoch 6, loss 40.46
Epoch 7, loss 38.29
Epoch 8, loss 35.83
Epoch 9, loss 33.76
**** Finished Training ****
Change in stitch weights: 0.9361949563026428
Largest abs weight change: 0.06935615837574005
Number of weights changing > 0.1 of that: 4143
Change in stitch bias: 0.025458643212914467
Largest abs bias change: 0.003971725702285767
Number of bias changing > 0.1 of that: 108
Test the trained stitch against biased data
Test Accuracy: 97.96 %
Confusion Matrix
tensor([[ 974,    0,    0,    0,    0,    1,    2,    2,    0,    1],
        [   0, 1115,    2,    2,    0,    0,    3,    0,   13,    0],
        [   3,    4, 1017,    1,    0,    0,    1,    0,    6,    0],
        [   0,    0,    1, 1003,    0,    3,    0,    1,    2,    0],
        [   0,    0,    0,    0,  966,    0,    1,    1,    3,   11],
        [   0,    0,    0,    5,    0,  882,    2,    0,    1,    2],
        [   7,    3,    2,    0,    1,    4,  934,    0,    7,    0],
        [   2,    3,    9,    0,    1,    0,    0, 1006,    2,    5],
        [   3,    2,    4,    8,    3,    4,    5,    3,  937,    5],
        [   7,    6,    0,    8,    2,    4,    0,    1,   19,  962]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias6unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 138.80
Epoch 1, loss 52.32
Epoch 2, loss 46.98
Epoch 3, loss 43.63
Epoch 4, loss 40.52
Epoch 5, loss 39.05
Epoch 6, loss 37.95
Epoch 7, loss 36.09
Epoch 8, loss 35.90
Epoch 9, loss 34.43
**** Finished Training ****
Change in stitch weights: 0.8885810971260071
Largest abs weight change: 0.05352718010544777
Number of weights changing > 0.1 of that: 5745
Change in stitch bias: 0.027235105633735657
Largest abs bias change: 0.0028524287045001984
Number of bias changing > 0.1 of that: 236
Test the trained stitch against biased data
Test Accuracy: 97.93 %
Confusion Matrix
tensor([[ 972,    0,    2,    0,    0,    1,    1,    2,    1,    1],
        [   0, 1122,    4,    0,    1,    0,    3,    2,    3,    0],
        [   5,    0, 1019,    0,    1,    0,    1,    2,    4,    0],
        [   0,    0,    1,  998,    0,    5,    0,    4,    2,    0],
        [   0,    0,    0,    0,  966,    0,    3,    0,    1,   12],
        [   1,    0,    0,    9,    1,  867,    6,    1,    4,    3],
        [   5,    4,    1,    0,    0,    1,  938,    1,    8,    0],
        [   2,    4,    7,    7,    2,    0,    1,  996,    2,    7],
        [   5,    1,    2,    6,    2,    3,    3,    5,  944,    3],
        [   5,    1,    0,    8,    6,    0,    0,    5,   13,  971]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias7unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 125.75
Epoch 1, loss 55.22
Epoch 2, loss 51.55
Epoch 3, loss 47.97
Epoch 4, loss 46.57
Epoch 5, loss 44.68
Epoch 6, loss 43.67
Epoch 7, loss 42.17
Epoch 8, loss 42.17
Epoch 9, loss 40.71
**** Finished Training ****
Change in stitch weights: 0.907426118850708
Largest abs weight change: 0.019044673070311546
Number of weights changing > 0.1 of that: 62416
Change in stitch bias: 0.02642734907567501
Largest abs bias change: 0.002019047737121582
Number of bias changing > 0.1 of that: 463
Test the trained stitch against biased data
Test Accuracy: 97.52 %
Confusion Matrix
tensor([[ 969,    0,    1,    0,    0,    3,    4,    2,    0,    1],
        [   0, 1123,    2,    1,    0,    0,    4,    0,    4,    1],
        [   5,    1, 1008,    2,    1,    0,    0,    5,   10,    0],
        [   0,    0,    3,  987,    0,   11,    0,    4,    4,    1],
        [   1,    0,    0,    0,  961,    0,    4,    1,    0,   15],
        [   2,    0,    0,    3,    1,  874,    4,    1,    4,    3],
        [   6,    2,    2,    1,    1,    5,  937,    1,    3,    0],
        [   2,    5,    9,    6,    0,    0,    0,  993,    2,   11],
        [   3,    2,    5,    9,    3,    3,    6,    5,  936,    2],
        [   4,    6,    0,    9,    9,    5,    0,    3,    9,  964]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias8unbias-bias-60_2024-08-01_00-44-53_SEED57_EPOCHS4_BGN0.1_exp2d_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 116.59
Epoch 1, loss 56.51
Epoch 2, loss 49.72
Epoch 3, loss 48.57
Epoch 4, loss 46.60
Epoch 5, loss 45.66
Epoch 6, loss 44.54
Epoch 7, loss 43.05
Epoch 8, loss 42.21
Epoch 9, loss 41.25
**** Finished Training ****
Change in stitch weights: 0.898486852645874
Largest abs weight change: 0.018083158880472183
Number of weights changing > 0.1 of that: 68012
Change in stitch bias: 0.02628343179821968
Largest abs bias change: 0.0020193420350551605
Number of bias changing > 0.1 of that: 454
Test the trained stitch against biased data
Test Accuracy: 97.56 %
Confusion Matrix
tensor([[ 971,    0,    0,    0,    0,    2,    2,    3,    1,    1],
        [   0, 1116,    4,    0,    0,    0,    5,    3,    6,    1],
        [   5,    0, 1005,    4,    1,    0,    1,    5,   11,    0],
        [   0,    0,    0,  996,    0,    8,    0,    3,    2,    1],
        [   2,    0,    0,    0,  957,    0,    3,    0,    2,   18],
        [   2,    0,    0,    9,    0,  870,    4,    2,    3,    2],
        [   6,    2,    1,    0,    1,    5,  938,    1,    4,    0],
        [   2,    2,    7,    5,    0,    0,    0, 1001,    1,   10],
        [   5,    0,    2,   13,    2,    5,    2,    6,  937,    2],
        [   4,    4,    0,   11,    8,    4,    0,    3,   10,  965]],
       dtype=torch.int32)
===================================================================
stitching_accuracies={'mix': {'unbias': {3: 99.59, 4: 99.88, 5: 99.95, 6: 100.0, 7: 99.99, 8: 100.0}}, 'bw': {'unbias': {3: 96.85, 4: 97.12, 5: 98.36, 6: 98.88, 7: 98.53, 8: 98.64}}, 'bgonly': {'unbias': {3: 99.9, 4: 99.97, 5: 100.0, 6: 100.0, 7: 99.98, 8: 99.99}}, 'bg': {'unbias': {3: 99.89, 4: 99.82, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bias': {'unbias': {3: 99.76, 4: 99.94, 5: 99.98, 6: 100.0, 7: 100.0, 8: 100.0}}, 'unbias': {'unbias': {3: 99.62, 4: 98.64, 5: 97.96, 6: 97.93, 7: 97.52, 8: 97.56}}}
stitching_penalties={'mix': {'unbias': {3: -2.980000000000004, 4: -3.269999999999996, 5: -3.3400000000000034, 6: -3.3900000000000006, 7: -3.3799999999999955, 8: -3.3900000000000006}}, 'bw': {'unbias': {3: -0.23999999999999488, 4: -0.5100000000000051, 5: -1.75, 6: -2.269999999999996, 7: -1.9200000000000017, 8: -2.030000000000001}}, 'bgonly': {'unbias': {3: -3.2900000000000063, 4: -3.3599999999999994, 5: -3.3900000000000006, 6: -3.3900000000000006, 7: -3.3700000000000045, 8: -3.3799999999999955}}, 'bg': {'unbias': {3: -3.280000000000001, 4: -3.2099999999999937, 5: -3.3900000000000006, 6: -3.3900000000000006, 7: -3.3900000000000006, 8: -3.3900000000000006}}, 'bias': {'unbias': {3: -3.1500000000000057, 4: -3.3299999999999983, 5: -3.3700000000000045, 6: -3.3900000000000006, 7: -3.3900000000000006, 8: -3.3900000000000006}}, 'unbias': {'unbias': {3: -3.010000000000005, 4: -2.030000000000001, 5: -1.3499999999999943, 6: -1.3200000000000074, 7: -0.9099999999999966, 8: -0.9500000000000028}}}
synth-mix
99.97
Stitch Accuracy
{3: 99.59, 4: 99.88, 5: 99.95, 6: 100.0, 7: 99.99, 8: 100.0}
--------------------------
synth-bw
73.75
Stitch Accuracy
{3: 96.85, 4: 97.12, 5: 98.36, 6: 98.88, 7: 98.53, 8: 98.64}
--------------------------
synth-bgonly
75.26
Stitch Accuracy
{3: 99.9, 4: 99.97, 5: 100.0, 6: 100.0, 7: 99.98, 8: 99.99}
--------------------------
synth-bg
100.0
Stitch Accuracy
{3: 99.89, 4: 99.82, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bias
100.0
Stitch Accuracy
{3: 99.76, 4: 99.94, 5: 99.98, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-unbias
96.61
Stitch Accuracy
{3: 99.62, 4: 98.64, 5: 97.96, 6: 97.93, 7: 97.52, 8: 97.56}
--------------------------
