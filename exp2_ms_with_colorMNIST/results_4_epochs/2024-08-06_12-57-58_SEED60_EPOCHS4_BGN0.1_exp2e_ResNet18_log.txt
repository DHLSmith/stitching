Executed at 2024-08-06_12-57-58
logging to ./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_log.txt
seed=60
bg_noise=0.1
train_mix_mnist_model=True
save_mix_mnist_model_as='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
original_train_epochs=4
train_bw_mnist_model=True
save_bw_mnist_model_as='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
original_train_epochs=4
train_bg_only_colour_mnist_model=True
save_bg_only_colour_mnist_model_as='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
original_train_epochs=4
train_bg_unbiased_colour_mnist_model=True
save_bg_unbiased_colour_mnist_model_as='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
original_train_epochs=4
train_biased_colour_mnist_model=True
save_biased_colour_mnist_model_as='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
original_train_epochs=4
train_unbiased_colour_mnist_model=True
save_unbiased_colour_mnist_model_as='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
original_train_epochs=4
stitch_train_epochs=10
================================================
Train ResNet18 on mix
Epoch 0, loss 129.46
Epoch 1, loss 20.03
Epoch 2, loss 13.29
Epoch 3, loss 10.86
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
Train ResNet18 on bw
Epoch 0, loss 109.38
Epoch 1, loss 23.59
Epoch 2, loss 19.19
Epoch 3, loss 13.64
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
Train ResNet18 on bgonly
Epoch 0, loss 50.04
Epoch 1, loss 2.65
Epoch 2, loss 3.07
Epoch 3, loss 1.28
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
Train ResNet18 on bg
Epoch 0, loss 91.11
Epoch 1, loss 8.60
Epoch 2, loss 2.39
Epoch 3, loss 1.87
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
Train ResNet18 on bias
Epoch 0, loss 77.07
Epoch 1, loss 1.40
Epoch 2, loss 1.47
Epoch 3, loss 0.20
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
Train ResNet18 on unbias
Epoch 0, loss 393.76
Epoch 1, loss 47.33
Epoch 2, loss 32.99
Epoch 3, loss 26.12
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
Entering Confusion
Accuracy Calculation for ResNet18 with key='mix'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bw'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 80.02 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    0,    0,    2,    0],
        [   7, 1064,    4,    0,    0,    2,    3,    2,   51,    2],
        [   1,    0, 1021,    2,    0,    0,    0,    0,    8,    0],
        [   0,    0,   12,  738,    0,    5,    0,    0,  255,    0],
        [   0,    0,   38,    0,  280,    4,    1,    0,  495,  164],
        [   1,    0,    0,    2,    0,  572,    1,    0,  316,    0],
        [   9,    2,    9,    0,    0,    0,  823,    0,  115,    0],
        [   8,    1,  106,   32,    0,    3,    0,  618,  207,   53],
        [   1,    0,    1,    0,    0,    0,    0,    0,  972,    0],
        [   8,    0,    1,    0,    0,    2,    0,    0,   62,  936]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bgonly'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 58.89 %
Confusion Matrix
tensor([[ 765,    0,    0,    0,  116,    0,    0,   99,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,   69,    0,  205,    0,    0,    0,  758,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,  289,  270,    0,  399,    0,    0,    0],
        [   0,    0,    0,    0,  430,    0,    0,  598,    0,    0],
        [   0,    0,    0,    0,  963,    0,    0,    0,   11,    0],
        [   0,    0,    0,    0,  900,    0,    0,    2,   79,   28]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bg'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='unbias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 97.64 %
Confusion Matrix
tensor([[ 971,    0,    1,    0,    0,    0,    6,    1,    1,    0],
        [   0, 1127,    0,    3,    0,    1,    1,    2,    1,    0],
        [   0,    3, 1018,    4,    1,    0,    0,    2,    4,    0],
        [   0,    0,    0, 1002,    0,    5,    0,    0,    3,    0],
        [   0,    2,    1,    1,  938,    1,    6,    0,    4,   29],
        [   1,    0,    0,   20,    0,  865,    3,    0,    3,    0],
        [   6,    4,    0,    1,    0,    7,  936,    0,    4,    0],
        [   1,    2,   14,    8,    1,    0,    0, 1000,    0,    2],
        [   3,    1,    5,    7,    1,    2,    1,    2,  952,    0],
        [   2,    3,    1,   24,    4,    4,    0,    6,   10,  955]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'mix': 100.0, 'bw': 80.02, 'bgonly': 58.89, 'bg': 100.0, 'bias': 100.0, 'unbias': 97.64}
Entering whole model check
Measure Rank for key='mix'
Measure Rank for key='bw'
Measure Rank for key='bgonly'
Measure Rank for key='bg'
Measure Rank for key='bias'
Measure Rank for key='unbias'
Entering Stitch/Rank
device='cuda:0'
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/mix3unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 132.14
Epoch 1, loss 38.36
Epoch 2, loss 26.10
Epoch 3, loss 20.38
Epoch 4, loss 17.10
Epoch 5, loss 14.47
Epoch 6, loss 12.23
Epoch 7, loss 11.05
Epoch 8, loss 9.71
Epoch 9, loss 8.28
**** Finished Training ****
Change in stitch weights: 0.9063479900360107
Largest abs weight change: 0.12958061695098877
Number of weights changing > 0.1 of that: 1114
Change in stitch bias: 0.027543319389224052
Largest abs bias change: 0.0056838467717170715
Number of bias changing > 0.1 of that: 62
Test the trained stitch against biased data
Test Accuracy: 99.67 %
Confusion Matrix
tensor([[ 974,    0,    1,    0,    0,    1,    1,    1,    0,    2],
        [   0, 1133,    0,    0,    1,    0,    1,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    1,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    3,    0,    1,    0,    2,  950,    0,    2,    0],
        [   0,    2,    3,    0,    1,    0,    0, 1022,    0,    0],
        [   2,    0,    0,    0,    0,    0,    0,    0,  972,    0],
        [   0,    5,    0,    1,    0,    0,    0,    0,    0, 1003]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix4unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 329.75
Epoch 1, loss 31.96
Epoch 2, loss 20.80
Epoch 3, loss 16.05
Epoch 4, loss 12.71
Epoch 5, loss 10.08
Epoch 6, loss 8.88
Epoch 7, loss 8.34
Epoch 8, loss 7.06
Epoch 9, loss 6.60
**** Finished Training ****
Change in stitch weights: 1.1121914386749268
Largest abs weight change: 0.12380965799093246
Number of weights changing > 0.1 of that: 1572
Change in stitch bias: 0.02492452599108219
Largest abs bias change: 0.005661576986312866
Number of bias changing > 0.1 of that: 55
Test the trained stitch against biased data
Test Accuracy: 99.74 %
Confusion Matrix
tensor([[ 977,    0,    1,    0,    0,    0,    1,    1,    0,    0],
        [   0, 1134,    0,    1,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    1,    1],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    5,    0,    0,    0,    0,  948,    0,    4,    0],
        [   0,    0,    0,    0,    2,    0,    0, 1026,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  973,    1],
        [   0,    0,    0,    3,    0,    0,    0,    0,    2, 1004]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix5unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 227.71
Epoch 1, loss 16.27
Epoch 2, loss 10.84
Epoch 3, loss 8.25
Epoch 4, loss 7.25
Epoch 5, loss 6.11
Epoch 6, loss 5.09
Epoch 7, loss 4.65
Epoch 8, loss 4.01
Epoch 9, loss 4.21
**** Finished Training ****
Change in stitch weights: 0.9131964445114136
Largest abs weight change: 0.05041421949863434
Number of weights changing > 0.1 of that: 7365
Change in stitch bias: 0.026580076664686203
Largest abs bias change: 0.004032209515571594
Number of bias changing > 0.1 of that: 117
Test the trained stitch against biased data
Test Accuracy: 99.96 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  980,    0,    0,    0,    2,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix6unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 127.64
Epoch 1, loss 6.39
Epoch 2, loss 4.12
Epoch 3, loss 3.18
Epoch 4, loss 2.66
Epoch 5, loss 2.29
Epoch 6, loss 2.19
Epoch 7, loss 1.65
Epoch 8, loss 1.75
Epoch 9, loss 1.54
**** Finished Training ****
Change in stitch weights: 0.8149559497833252
Largest abs weight change: 0.027656642720103264
Number of weights changing > 0.1 of that: 22214
Change in stitch bias: 0.02748127281665802
Largest abs bias change: 0.0028510652482509613
Number of bias changing > 0.1 of that: 233
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix7unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 21.14
Epoch 1, loss 2.91
Epoch 2, loss 2.21
Epoch 3, loss 1.84
Epoch 4, loss 1.68
Epoch 5, loss 1.43
Epoch 6, loss 1.39
Epoch 7, loss 1.41
Epoch 8, loss 1.24
Epoch 9, loss 1.18
**** Finished Training ****
Change in stitch weights: 0.7229616045951843
Largest abs weight change: 0.010038914158940315
Number of weights changing > 0.1 of that: 137976
Change in stitch bias: 0.025702152401208878
Largest abs bias change: 0.0020065680146217346
Number of bias changing > 0.1 of that: 455
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix8unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 33.99
Epoch 1, loss 3.04
Epoch 2, loss 2.29
Epoch 3, loss 1.97
Epoch 4, loss 1.66
Epoch 5, loss 1.55
Epoch 6, loss 1.33
Epoch 7, loss 1.39
Epoch 8, loss 1.35
Epoch 9, loss 1.26
**** Finished Training ****
Change in stitch weights: 0.7625612616539001
Largest abs weight change: 0.010682715103030205
Number of weights changing > 0.1 of that: 132968
Change in stitch bias: 0.02620168775320053
Largest abs bias change: 0.002017781138420105
Number of bias changing > 0.1 of that: 455
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bw3unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 253.51
Epoch 1, loss 54.74
Epoch 2, loss 43.27
Epoch 3, loss 37.53
Epoch 4, loss 34.39
Epoch 5, loss 31.50
Epoch 6, loss 29.21
Epoch 7, loss 28.07
Epoch 8, loss 27.00
Epoch 9, loss 25.81
**** Finished Training ****
Change in stitch weights: 1.1025590896606445
Largest abs weight change: 0.13058914244174957
Number of weights changing > 0.1 of that: 1191
Change in stitch bias: 0.025450782850384712
Largest abs bias change: 0.005703940987586975
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 98.24 %
Confusion Matrix
tensor([[ 969,    2,    3,    0,    0,    0,    2,    1,    0,    3],
        [   0, 1126,    5,    0,    0,    1,    3,    0,    0,    0],
        [   4,    1, 1024,    0,    1,    0,    0,    1,    1,    0],
        [   0,    0,    0, 1000,    0,    8,    0,    0,    2,    0],
        [   0,    0,    0,    0,  969,    1,    2,    0,    1,    9],
        [   0,    0,    0,    7,    0,  885,    0,    0,    0,    0],
        [   8,    5,    1,    0,    0,    3,  937,    0,    4,    0],
        [   0,    0,    8,    6,    2,    0,    0, 1001,    2,    9],
        [   5,    0,    3,    6,    1,    0,    8,    2,  944,    5],
        [   0,    6,    1,    4,    9,    6,    1,    4,    9,  969]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw4unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 236.04
Epoch 1, loss 56.94
Epoch 2, loss 45.49
Epoch 3, loss 39.38
Epoch 4, loss 35.07
Epoch 5, loss 32.59
Epoch 6, loss 30.39
Epoch 7, loss 28.54
Epoch 8, loss 27.25
Epoch 9, loss 26.30
**** Finished Training ****
Change in stitch weights: 1.066178798675537
Largest abs weight change: 0.1316828727722168
Number of weights changing > 0.1 of that: 1177
Change in stitch bias: 0.02330009825527668
Largest abs bias change: 0.005612678825855255
Number of bias changing > 0.1 of that: 55
Test the trained stitch against biased data
Test Accuracy: 98.25 %
Confusion Matrix
tensor([[ 973,    1,    1,    0,    0,    0,    4,    1,    0,    0],
        [   0, 1124,    4,    0,    0,    1,    2,    2,    2,    0],
        [   4,    0, 1023,    1,    1,    0,    0,    1,    2,    0],
        [   1,    0,    0,  994,    0,    9,    0,    0,    6,    0],
        [   0,    1,    0,    0,  966,    0,    1,    1,    3,   10],
        [   1,    0,    0,    4,    0,  885,    0,    0,    2,    0],
        [   6,    3,    2,    0,    0,    1,  943,    0,    3,    0],
        [   0,    0,    8,    5,    1,    0,    0, 1007,    0,    7],
        [  12,    0,    1,    3,    1,    3,    4,    3,  946,    1],
        [   1,    3,    1,    1,    5,    9,    0,    8,   17,  964]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw5unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 156.51
Epoch 1, loss 48.67
Epoch 2, loss 37.56
Epoch 3, loss 32.83
Epoch 4, loss 28.75
Epoch 5, loss 26.45
Epoch 6, loss 24.14
Epoch 7, loss 23.08
Epoch 8, loss 21.62
Epoch 9, loss 20.70
**** Finished Training ****
Change in stitch weights: 1.0450284481048584
Largest abs weight change: 0.05272502452135086
Number of weights changing > 0.1 of that: 7715
Change in stitch bias: 0.026655253022909164
Largest abs bias change: 0.004037410020828247
Number of bias changing > 0.1 of that: 116
Test the trained stitch against biased data
Test Accuracy: 98.75 %
Confusion Matrix
tensor([[ 974,    0,    2,    0,    0,    0,    1,    1,    1,    1],
        [   0, 1130,    2,    0,    0,    0,    2,    0,    1,    0],
        [   3,    2, 1022,    0,    0,    0,    0,    1,    4,    0],
        [   0,    0,    0,  996,    0,    9,    0,    0,    5,    0],
        [   0,    0,    0,    0,  974,    0,    0,    0,    3,    5],
        [   0,    0,    0,    4,    0,  887,    0,    0,    1,    0],
        [   1,    1,    1,    0,    1,    2,  947,    0,    5,    0],
        [   0,    0,    9,    2,    1,    0,    0, 1006,    2,    8],
        [   3,    0,    1,    3,    4,    1,    0,    2,  960,    0],
        [   1,    2,    1,    3,    5,    2,    0,    6,   10,  979]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw6unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 100.19
Epoch 1, loss 25.70
Epoch 2, loss 21.49
Epoch 3, loss 19.33
Epoch 4, loss 17.63
Epoch 5, loss 16.49
Epoch 6, loss 16.06
Epoch 7, loss 14.98
Epoch 8, loss 14.12
Epoch 9, loss 13.61
**** Finished Training ****
Change in stitch weights: 0.8275817632675171
Largest abs weight change: 0.04257475957274437
Number of weights changing > 0.1 of that: 9564
Change in stitch bias: 0.027270732447504997
Largest abs bias change: 0.0028490833938121796
Number of bias changing > 0.1 of that: 227
Test the trained stitch against biased data
Test Accuracy: 99.11 %
Confusion Matrix
tensor([[ 977,    1,    0,    0,    0,    0,    1,    1,    0,    0],
        [   2, 1129,    3,    0,    0,    0,    1,    0,    0,    0],
        [   1,    0, 1028,    0,    1,    0,    0,    1,    1,    0],
        [   0,    0,    0,  998,    0,    4,    0,    4,    4,    0],
        [   0,    0,    0,    0,  976,    0,    0,    0,    0,    6],
        [   0,    0,    0,    6,    0,  883,    0,    0,    3,    0],
        [   0,    2,    1,    0,    0,    3,  949,    0,    2,    1],
        [   0,    0,    4,    2,    0,    0,    0, 1015,    1,    6],
        [   2,    0,    2,    4,    2,    1,    0,    1,  961,    1],
        [   1,    0,    0,    2,    2,    2,    0,    3,    4,  995]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw7unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 80.69
Epoch 1, loss 28.57
Epoch 2, loss 24.82
Epoch 3, loss 22.54
Epoch 4, loss 21.71
Epoch 5, loss 20.69
Epoch 6, loss 19.83
Epoch 7, loss 19.09
Epoch 8, loss 18.96
Epoch 9, loss 18.10
**** Finished Training ****
Change in stitch weights: 0.8813040852546692
Largest abs weight change: 0.021477896720170975
Number of weights changing > 0.1 of that: 45089
Change in stitch bias: 0.02642800658941269
Largest abs bias change: 0.002008795738220215
Number of bias changing > 0.1 of that: 467
Test the trained stitch against biased data
Test Accuracy: 98.98 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    1,    0,    1,    0,    0],
        [   2, 1130,    1,    1,    0,    0,    1,    0,    0,    0],
        [   2,    0, 1021,    1,    1,    0,    0,    5,    2,    0],
        [   0,    0,    1,  992,    0,    9,    0,    1,    7,    0],
        [   0,    0,    0,    0,  978,    0,    0,    0,    0,    4],
        [   2,    1,    0,    4,    0,  882,    0,    0,    3,    0],
        [   0,    3,    1,    0,    1,    3,  948,    0,    2,    0],
        [   0,    0,    5,    1,    0,    0,    0, 1013,    2,    7],
        [   1,    0,    1,    4,    2,    0,    0,    2,  963,    1],
        [   2,    0,    0,    3,    4,    0,    0,    3,    4,  993]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw8unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 82.13
Epoch 1, loss 30.19
Epoch 2, loss 25.79
Epoch 3, loss 23.40
Epoch 4, loss 22.35
Epoch 5, loss 21.28
Epoch 6, loss 20.23
Epoch 7, loss 19.66
Epoch 8, loss 19.30
Epoch 9, loss 18.89
**** Finished Training ****
Change in stitch weights: 0.9052149653434753
Largest abs weight change: 0.019248303025960922
Number of weights changing > 0.1 of that: 61163
Change in stitch bias: 0.025959108024835587
Largest abs bias change: 0.0020209141075611115
Number of bias changing > 0.1 of that: 454
Test the trained stitch against biased data
Test Accuracy: 98.89 %
Confusion Matrix
tensor([[ 976,    3,    0,    0,    0,    0,    0,    1,    0,    0],
        [   2, 1129,    1,    0,    0,    0,    2,    1,    0,    0],
        [   1,    1, 1022,    1,    1,    0,    0,    4,    2,    0],
        [   0,    0,    1,  995,    0,    5,    0,    2,    7,    0],
        [   0,    0,    0,    0,  976,    1,    0,    0,    0,    5],
        [   1,    0,    0,    7,    0,  881,    1,    0,    2,    0],
        [   1,    3,    1,    0,    1,    3,  946,    0,    2,    1],
        [   0,    0,    5,    1,    0,    0,    0, 1016,    1,    5],
        [   1,    0,    1,    8,    3,    1,    0,    2,  957,    1],
        [   1,    0,    0,    4,    3,    1,    0,    5,    4,  991]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bgonly3unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 236.16
Epoch 1, loss 25.76
Epoch 2, loss 17.37
Epoch 3, loss 12.42
Epoch 4, loss 10.61
Epoch 5, loss 9.07
Epoch 6, loss 7.95
Epoch 7, loss 7.64
Epoch 8, loss 6.75
Epoch 9, loss 5.92
**** Finished Training ****
Change in stitch weights: 0.9229204654693604
Largest abs weight change: 0.07331520318984985
Number of weights changing > 0.1 of that: 2312
Change in stitch bias: 0.0264930110424757
Largest abs bias change: 0.005709335207939148
Number of bias changing > 0.1 of that: 56
Test the trained stitch against biased data
Test Accuracy: 99.92 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    1,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  955,    0,    3,    0],
        [   0,    0,    1,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    1,    0,    0,  973,    0],
        [   0,    0,    0,    1,    0,    0,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly4unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 259.71
Epoch 1, loss 22.25
Epoch 2, loss 11.63
Epoch 3, loss 9.10
Epoch 4, loss 7.67
Epoch 5, loss 5.85
Epoch 6, loss 5.50
Epoch 7, loss 5.17
Epoch 8, loss 4.47
Epoch 9, loss 4.01
**** Finished Training ****
Change in stitch weights: 0.9524655938148499
Largest abs weight change: 0.12458188831806183
Number of weights changing > 0.1 of that: 1411
Change in stitch bias: 0.02498786896467209
Largest abs bias change: 0.005706168711185455
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly5unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 462.56
Epoch 1, loss 46.33
Epoch 2, loss 9.88
Epoch 3, loss 7.53
Epoch 4, loss 6.51
Epoch 5, loss 5.54
Epoch 6, loss 5.31
Epoch 7, loss 5.11
Epoch 8, loss 4.19
Epoch 9, loss 4.71
**** Finished Training ****
Change in stitch weights: 0.8923920392990112
Largest abs weight change: 0.03556834161281586
Number of weights changing > 0.1 of that: 9580
Change in stitch bias: 0.026841185986995697
Largest abs bias change: 0.004041321575641632
Number of bias changing > 0.1 of that: 117
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly6unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 95.96
Epoch 1, loss 10.16
Epoch 2, loss 7.82
Epoch 3, loss 6.11
Epoch 4, loss 5.42
Epoch 5, loss 5.21
Epoch 6, loss 5.96
Epoch 7, loss 5.29
Epoch 8, loss 5.08
Epoch 9, loss 4.53
**** Finished Training ****
Change in stitch weights: 0.7440804839134216
Largest abs weight change: 0.02652156352996826
Number of weights changing > 0.1 of that: 21852
Change in stitch bias: 0.02681247889995575
Largest abs bias change: 0.0028561167418956757
Number of bias changing > 0.1 of that: 236
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly7unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 49.04
Epoch 1, loss 9.93
Epoch 2, loss 9.34
Epoch 3, loss 8.39
Epoch 4, loss 7.57
Epoch 5, loss 7.70
Epoch 6, loss 7.03
Epoch 7, loss 6.13
Epoch 8, loss 6.30
Epoch 9, loss 6.04
**** Finished Training ****
Change in stitch weights: 0.8005796074867249
Largest abs weight change: 0.014656290411949158
Number of weights changing > 0.1 of that: 91886
Change in stitch bias: 0.026439273729920387
Largest abs bias change: 0.0020166896283626556
Number of bias changing > 0.1 of that: 451
Test the trained stitch against biased data
Test Accuracy: 99.94 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1028,    0,    0,    0,    0,    0,    4,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly8unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 46.57
Epoch 1, loss 9.96
Epoch 2, loss 8.32
Epoch 3, loss 7.75
Epoch 4, loss 6.89
Epoch 5, loss 6.30
Epoch 6, loss 6.21
Epoch 7, loss 6.38
Epoch 8, loss 5.96
Epoch 9, loss 5.55
**** Finished Training ****
Change in stitch weights: 0.7819873094558716
Largest abs weight change: 0.011739592999219894
Number of weights changing > 0.1 of that: 121815
Change in stitch bias: 0.025407372042536736
Largest abs bias change: 0.0020132847130298615
Number of bias changing > 0.1 of that: 455
Test the trained stitch against biased data
Test Accuracy: 99.92 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1026,    0,    0,    0,    0,    0,    6,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    2,    0,    0,    0,  972,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bg3unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 460.10
Epoch 1, loss 37.28
Epoch 2, loss 23.65
Epoch 3, loss 17.89
Epoch 4, loss 15.22
Epoch 5, loss 13.21
Epoch 6, loss 11.26
Epoch 7, loss 10.28
Epoch 8, loss 9.24
Epoch 9, loss 7.96
**** Finished Training ****
Change in stitch weights: 1.1298376321792603
Largest abs weight change: 0.11133230477571487
Number of weights changing > 0.1 of that: 1738
Change in stitch bias: 0.025796107947826385
Largest abs bias change: 0.005583323538303375
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.81 %
Confusion Matrix
tensor([[ 975,    2,    1,    0,    0,    1,    1,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    1,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    2,    1,    0,    0,    1,  952,    0,    1,    0],
        [   0,    1,    1,    0,    1,    0,    0, 1025,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    2,    0,    2,    0,    0,    0,    0,    0, 1005]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg4unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 190.64
Epoch 1, loss 19.14
Epoch 2, loss 12.24
Epoch 3, loss 8.83
Epoch 4, loss 6.97
Epoch 5, loss 5.97
Epoch 6, loss 5.69
Epoch 7, loss 4.30
Epoch 8, loss 4.27
Epoch 9, loss 3.97
**** Finished Training ****
Change in stitch weights: 0.9503940939903259
Largest abs weight change: 0.09427151083946228
Number of weights changing > 0.1 of that: 1763
Change in stitch bias: 0.02452622912824154
Largest abs bias change: 0.005528353154659271
Number of bias changing > 0.1 of that: 56
Test the trained stitch against biased data
Test Accuracy: 99.95 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    1,    0, 1009,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    1,    0,    0,    0,    0,  957,    0,    0,    0],
        [   0,    1,    0,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    0,    1,    0,  973,    0],
        [   0,    0,    0,    1,    0,    0,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg5unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 173.47
Epoch 1, loss 14.32
Epoch 2, loss 7.77
Epoch 3, loss 7.19
Epoch 4, loss 5.59
Epoch 5, loss 4.47
Epoch 6, loss 4.42
Epoch 7, loss 4.08
Epoch 8, loss 4.65
Epoch 9, loss 3.44
**** Finished Training ****
Change in stitch weights: 0.8611477017402649
Largest abs weight change: 0.049328502267599106
Number of weights changing > 0.1 of that: 6402
Change in stitch bias: 0.026007356122136116
Largest abs bias change: 0.003985300660133362
Number of bias changing > 0.1 of that: 108
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg6unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 115.89
Epoch 1, loss 7.08
Epoch 2, loss 5.33
Epoch 3, loss 4.26
Epoch 4, loss 3.98
Epoch 5, loss 2.70
Epoch 6, loss 2.85
Epoch 7, loss 2.09
Epoch 8, loss 1.89
Epoch 9, loss 2.34
**** Finished Training ****
Change in stitch weights: 0.8194682002067566
Largest abs weight change: 0.025866100564599037
Number of weights changing > 0.1 of that: 23903
Change in stitch bias: 0.027012299746274948
Largest abs bias change: 0.0028511881828308105
Number of bias changing > 0.1 of that: 230
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg7unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 43.88
Epoch 1, loss 3.09
Epoch 2, loss 2.32
Epoch 3, loss 1.83
Epoch 4, loss 1.40
Epoch 5, loss 1.83
Epoch 6, loss 1.42
Epoch 7, loss 1.35
Epoch 8, loss 1.14
Epoch 9, loss 1.31
**** Finished Training ****
Change in stitch weights: 0.7748593091964722
Largest abs weight change: 0.012751953676342964
Number of weights changing > 0.1 of that: 110109
Change in stitch bias: 0.02675599791109562
Largest abs bias change: 0.002013314515352249
Number of bias changing > 0.1 of that: 468
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg8unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 49.71
Epoch 1, loss 3.28
Epoch 2, loss 2.17
Epoch 3, loss 1.81
Epoch 4, loss 1.75
Epoch 5, loss 2.37
Epoch 6, loss 1.41
Epoch 7, loss 1.96
Epoch 8, loss 1.24
Epoch 9, loss 1.21
**** Finished Training ****
Change in stitch weights: 0.7915648221969604
Largest abs weight change: 0.013577109202742577
Number of weights changing > 0.1 of that: 102999
Change in stitch bias: 0.02695685811340809
Largest abs bias change: 0.002004031091928482
Number of bias changing > 0.1 of that: 478
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bias3unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 133.95
Epoch 1, loss 24.75
Epoch 2, loss 15.58
Epoch 3, loss 11.98
Epoch 4, loss 9.79
Epoch 5, loss 8.16
Epoch 6, loss 7.17
Epoch 7, loss 6.22
Epoch 8, loss 5.91
Epoch 9, loss 5.43
**** Finished Training ****
Change in stitch weights: 0.852433979511261
Largest abs weight change: 0.0954650342464447
Number of weights changing > 0.1 of that: 1617
Change in stitch bias: 0.025495244190096855
Largest abs bias change: 0.00563386082649231
Number of bias changing > 0.1 of that: 60
Test the trained stitch against biased data
Test Accuracy: 99.89 %
Confusion Matrix
tensor([[ 979,    0,    1,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    0,    1,    1],
        [   0,    0,    0, 1009,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    1,    0,    0,    0,    0,  956,    0,    0,    0],
        [   0,    0,    1,    1,    0,    0,    0, 1026,    0,    0],
        [   0,    0,    0,    0,    0,    1,    0,    0,  973,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,    1, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias4unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 128.12
Epoch 1, loss 22.21
Epoch 2, loss 14.22
Epoch 3, loss 11.18
Epoch 4, loss 8.57
Epoch 5, loss 7.90
Epoch 6, loss 6.36
Epoch 7, loss 5.97
Epoch 8, loss 5.05
Epoch 9, loss 5.39
**** Finished Training ****
Change in stitch weights: 0.8715866208076477
Largest abs weight change: 0.13086409866809845
Number of weights changing > 0.1 of that: 968
Change in stitch bias: 0.027440344914793968
Largest abs bias change: 0.0056481435894966125
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.92 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    1,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   2,    1,    0,    0,    0,    0,  955,    0,    0,    0],
        [   0,    0,    0,    1,    0,    0,    0, 1025,    2,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias5unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 195.28
Epoch 1, loss 14.01
Epoch 2, loss 7.92
Epoch 3, loss 5.75
Epoch 4, loss 5.01
Epoch 5, loss 4.43
Epoch 6, loss 3.78
Epoch 7, loss 3.77
Epoch 8, loss 3.28
Epoch 9, loss 2.76
**** Finished Training ****
Change in stitch weights: 0.914356529712677
Largest abs weight change: 0.045940324664115906
Number of weights changing > 0.1 of that: 7328
Change in stitch bias: 0.025596510618925095
Largest abs bias change: 0.004033952951431274
Number of bias changing > 0.1 of that: 114
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias6unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 64.45
Epoch 1, loss 4.24
Epoch 2, loss 2.26
Epoch 3, loss 1.90
Epoch 4, loss 1.39
Epoch 5, loss 0.96
Epoch 6, loss 1.07
Epoch 7, loss 1.04
Epoch 8, loss 0.80
Epoch 9, loss 0.76
**** Finished Training ****
Change in stitch weights: 0.6901230812072754
Largest abs weight change: 0.02627684734761715
Number of weights changing > 0.1 of that: 19257
Change in stitch bias: 0.027446849271655083
Largest abs bias change: 0.0028538592159748077
Number of bias changing > 0.1 of that: 240
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias7unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 35.41
Epoch 1, loss 2.35
Epoch 2, loss 1.27
Epoch 3, loss 1.06
Epoch 4, loss 0.90
Epoch 5, loss 0.81
Epoch 6, loss 0.71
Epoch 7, loss 0.91
Epoch 8, loss 0.51
Epoch 9, loss 0.60
**** Finished Training ****
Change in stitch weights: 0.7562779188156128
Largest abs weight change: 0.01027693971991539
Number of weights changing > 0.1 of that: 136951
Change in stitch bias: 0.025747232139110565
Largest abs bias change: 0.0020189210772514343
Number of bias changing > 0.1 of that: 465
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias8unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 41.58
Epoch 1, loss 2.26
Epoch 2, loss 1.38
Epoch 3, loss 1.14
Epoch 4, loss 0.91
Epoch 5, loss 0.91
Epoch 6, loss 0.77
Epoch 7, loss 0.71
Epoch 8, loss 0.56
Epoch 9, loss 0.72
**** Finished Training ****
Change in stitch weights: 0.7756749391555786
Largest abs weight change: 0.011321400292217731
Number of weights changing > 0.1 of that: 126228
Change in stitch bias: 0.025887612253427505
Largest abs bias change: 0.0020198561251163483
Number of bias changing > 0.1 of that: 449
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/unbias3unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 434.75
Epoch 1, loss 94.30
Epoch 2, loss 27.53
Epoch 3, loss 21.63
Epoch 4, loss 18.57
Epoch 5, loss 15.88
Epoch 6, loss 13.90
Epoch 7, loss 12.53
Epoch 8, loss 11.19
Epoch 9, loss 10.26
**** Finished Training ****
Change in stitch weights: 1.064193606376648
Largest abs weight change: 0.1589215099811554
Number of weights changing > 0.1 of that: 923
Change in stitch bias: 0.024866778403520584
Largest abs bias change: 0.005545765161514282
Number of bias changing > 0.1 of that: 51
Test the trained stitch against biased data
Test Accuracy: 99.51 %
Confusion Matrix
tensor([[ 975,    1,    2,    0,    1,    0,    1,    0,    0,    0],
        [   0, 1128,    1,    1,    0,    2,    3,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  978,    0,    0,    0,    1,    3],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    2,    0,    1,    0,    4,  950,    0,    0,    0],
        [   0,    5,    6,    0,    2,    0,    0, 1015,    0,    0],
        [   0,    0,    1,    0,    3,    0,    0,    0,  969,    1],
        [   0,    1,    0,    3,    0,    2,    0,    0,    1, 1002]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias4unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 149.67
Epoch 1, loss 37.17
Epoch 2, loss 28.71
Epoch 3, loss 24.65
Epoch 4, loss 22.03
Epoch 5, loss 20.23
Epoch 6, loss 19.02
Epoch 7, loss 17.52
Epoch 8, loss 16.20
Epoch 9, loss 15.71
**** Finished Training ****
Change in stitch weights: 0.9391210079193115
Largest abs weight change: 0.15332603454589844
Number of weights changing > 0.1 of that: 711
Change in stitch bias: 0.025311611592769623
Largest abs bias change: 0.005711406469345093
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 98.98 %
Confusion Matrix
tensor([[ 974,    0,    1,    0,    0,    0,    3,    1,    1,    0],
        [   1, 1130,    0,    0,    0,    1,    2,    0,    1,    0],
        [   0,    0, 1026,    1,    0,    0,    0,    0,    5,    0],
        [   0,    0,    0, 1005,    0,    2,    0,    0,    3,    0],
        [   0,    0,    0,    0,  975,    0,    0,    2,    2,    3],
        [   0,    0,    0,    2,    0,  888,    1,    0,    1,    0],
        [   7,    3,    0,    1,    1,    2,  942,    0,    2,    0],
        [   0,    3,    2,    0,    2,    0,    0, 1018,    2,    1],
        [   0,    0,    2,    1,    3,    3,    2,    3,  958,    2],
        [   2,    3,    2,    6,    3,    2,    0,    6,    3,  982]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias5unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 168.56
Epoch 1, loss 47.16
Epoch 2, loss 37.42
Epoch 3, loss 32.63
Epoch 4, loss 29.33
Epoch 5, loss 27.10
Epoch 6, loss 25.33
Epoch 7, loss 23.98
Epoch 8, loss 22.92
Epoch 9, loss 21.30
**** Finished Training ****
Change in stitch weights: 1.04582941532135
Largest abs weight change: 0.07121159136295319
Number of weights changing > 0.1 of that: 5284
Change in stitch bias: 0.02598593197762966
Largest abs bias change: 0.0040296390652656555
Number of bias changing > 0.1 of that: 112
Test the trained stitch against biased data
Test Accuracy: 98.61 %
Confusion Matrix
tensor([[ 971,    0,    1,    0,    0,    0,    4,    1,    1,    2],
        [   0, 1125,    2,    2,    0,    1,    3,    1,    1,    0],
        [   1,    2, 1023,    1,    0,    0,    0,    1,    4,    0],
        [   0,    0,    0,  997,    0,    5,    0,    1,    7,    0],
        [   0,    0,    1,    0,  971,    0,    1,    1,    2,    6],
        [   1,    0,    0,    4,    0,  881,    2,    1,    3,    0],
        [   6,    2,    0,    0,    2,    1,  943,    0,    4,    0],
        [   0,    3,    6,    4,    0,    0,    0, 1007,    5,    3],
        [   5,    0,    0,    1,    2,    0,    3,    1,  961,    1],
        [   3,    5,    3,    4,    4,    2,    0,    1,    5,  982]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias6unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 87.45
Epoch 1, loss 30.13
Epoch 2, loss 26.22
Epoch 3, loss 23.14
Epoch 4, loss 21.74
Epoch 5, loss 20.62
Epoch 6, loss 19.72
Epoch 7, loss 19.13
Epoch 8, loss 18.54
Epoch 9, loss 18.22
**** Finished Training ****
Change in stitch weights: 0.8327586054801941
Largest abs weight change: 0.0510091669857502
Number of weights changing > 0.1 of that: 6217
Change in stitch bias: 0.025850314646959305
Largest abs bias change: 0.002853620797395706
Number of bias changing > 0.1 of that: 234
Test the trained stitch against biased data
Test Accuracy: 98.51 %
Confusion Matrix
tensor([[ 975,    0,    1,    0,    0,    0,    2,    1,    1,    0],
        [   0, 1124,    2,    3,    1,    1,    1,    0,    3,    0],
        [   0,    4, 1021,    1,    1,    0,    0,    2,    3,    0],
        [   0,    0,    2,  993,    0,    9,    0,    1,    4,    1],
        [   0,    0,    0,    0,  965,    0,    2,    2,    1,   12],
        [   1,    0,    0,    6,    0,  880,    3,    1,    1,    0],
        [   8,    4,    0,    0,    3,    5,  934,    0,    4,    0],
        [   0,    2,    5,    2,    0,    0,    0, 1010,    1,    8],
        [   3,    0,    3,    4,    2,    1,    0,    2,  957,    2],
        [   0,    5,    1,    2,    4,    0,    0,    3,    2,  992]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias7unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 78.87
Epoch 1, loss 25.43
Epoch 2, loss 23.55
Epoch 3, loss 22.17
Epoch 4, loss 21.46
Epoch 5, loss 20.63
Epoch 6, loss 20.67
Epoch 7, loss 19.89
Epoch 8, loss 19.42
Epoch 9, loss 19.10
**** Finished Training ****
Change in stitch weights: 0.8486222624778748
Largest abs weight change: 0.013880521059036255
Number of weights changing > 0.1 of that: 105241
Change in stitch bias: 0.02752174623310566
Largest abs bias change: 0.0020161569118499756
Number of bias changing > 0.1 of that: 459
Test the trained stitch against biased data
Test Accuracy: 98.42 %
Confusion Matrix
tensor([[ 974,    0,    1,    0,    0,    0,    3,    1,    1,    0],
        [   0, 1124,    2,    1,    1,    1,    2,    1,    3,    0],
        [   0,    2, 1021,    1,    1,    0,    0,    2,    5,    0],
        [   1,    0,    1,  996,    0,    7,    0,    0,    4,    1],
        [   0,    1,    1,    0,  966,    0,    1,    0,    2,   11],
        [   1,    0,    0,   13,    0,  872,    3,    1,    2,    0],
        [   6,    3,    0,    1,    4,    3,  938,    0,    3,    0],
        [   0,    2,    3,    3,    1,    0,    0, 1015,    1,    3],
        [   3,    2,    3,    3,    2,    2,    3,    2,  954,    0],
        [   2,    4,    2,    5,    7,    1,    0,    5,    1,  982]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias8unbias-bias-60_2024-08-06_12-57-58_SEED60_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 67.65
Epoch 1, loss 25.02
Epoch 2, loss 22.91
Epoch 3, loss 21.65
Epoch 4, loss 20.98
Epoch 5, loss 20.80
Epoch 6, loss 19.70
Epoch 7, loss 19.65
Epoch 8, loss 19.19
Epoch 9, loss 18.98
**** Finished Training ****
Change in stitch weights: 0.8241394758224487
Largest abs weight change: 0.01211075484752655
Number of weights changing > 0.1 of that: 121353
Change in stitch bias: 0.0262344591319561
Largest abs bias change: 0.002018354833126068
Number of bias changing > 0.1 of that: 457
Test the trained stitch against biased data
Test Accuracy: 98.49 %
Confusion Matrix
tensor([[ 974,    0,    1,    0,    0,    0,    3,    1,    1,    0],
        [   0, 1126,    2,    1,    1,    1,    1,    0,    3,    0],
        [   0,    2, 1021,    2,    1,    0,    0,    0,    6,    0],
        [   0,    0,    2,  995,    0,    8,    0,    0,    4,    1],
        [   0,    1,    1,    0,  969,    0,    2,    0,    1,    8],
        [   1,    0,    0,   12,    0,  872,    2,    1,    4,    0],
        [   3,    3,    0,    0,    5,    6,  938,    0,    3,    0],
        [   0,    3,    4,    5,    1,    0,    0, 1012,    1,    2],
        [   3,    0,    1,    5,    2,    2,    1,    2,  957,    1],
        [   2,    5,    1,    5,    5,    3,    0,    2,    1,  985]],
       dtype=torch.int32)
===================================================================
stitching_accuracies={'mix': {'unbias': {3: 99.67, 4: 99.74, 5: 99.96, 6: 99.98, 7: 100.0, 8: 100.0}}, 'bw': {'unbias': {3: 98.24, 4: 98.25, 5: 98.75, 6: 99.11, 7: 98.98, 8: 98.89}}, 'bgonly': {'unbias': {3: 99.92, 4: 100.0, 5: 100.0, 6: 99.98, 7: 99.94, 8: 99.92}}, 'bg': {'unbias': {3: 99.81, 4: 99.95, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bias': {'unbias': {3: 99.89, 4: 99.92, 5: 99.99, 6: 100.0, 7: 100.0, 8: 100.0}}, 'unbias': {'unbias': {3: 99.51, 4: 98.98, 5: 98.61, 6: 98.51, 7: 98.42, 8: 98.49}}}
stitching_penalties={'mix': {'unbias': {3: -2.030000000000001, 4: -2.0999999999999943, 5: -2.319999999999993, 6: -2.3400000000000034, 7: -2.3599999999999994, 8: -2.3599999999999994}}, 'bw': {'unbias': {3: -0.5999999999999943, 4: -0.6099999999999994, 5: -1.1099999999999994, 6: -1.4699999999999989, 7: -1.3400000000000034, 8: -1.25}}, 'bgonly': {'unbias': {3: -2.280000000000001, 4: -2.3599999999999994, 5: -2.3599999999999994, 6: -2.3400000000000034, 7: -2.299999999999997, 8: -2.280000000000001}}, 'bg': {'unbias': {3: -2.1700000000000017, 4: -2.3100000000000023, 5: -2.3599999999999994, 6: -2.3599999999999994, 7: -2.3599999999999994, 8: -2.3599999999999994}}, 'bias': {'unbias': {3: -2.25, 4: -2.280000000000001, 5: -2.3499999999999943, 6: -2.3599999999999994, 7: -2.3599999999999994, 8: -2.3599999999999994}}, 'unbias': {'unbias': {3: -1.8700000000000045, 4: -1.3400000000000034, 5: -0.9699999999999989, 6: -0.8700000000000045, 7: -0.7800000000000011, 8: -0.8499999999999943}}}
synth-mix
100.0
Stitch Accuracy
{3: 99.67, 4: 99.74, 5: 99.96, 6: 99.98, 7: 100.0, 8: 100.0}
--------------------------
synth-bw
80.02
Stitch Accuracy
{3: 98.24, 4: 98.25, 5: 98.75, 6: 99.11, 7: 98.98, 8: 98.89}
--------------------------
synth-bgonly
58.89
Stitch Accuracy
{3: 99.92, 4: 100.0, 5: 100.0, 6: 99.98, 7: 99.94, 8: 99.92}
--------------------------
synth-bg
100.0
Stitch Accuracy
{3: 99.81, 4: 99.95, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bias
100.0
Stitch Accuracy
{3: 99.89, 4: 99.92, 5: 99.99, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-unbias
97.64
Stitch Accuracy
{3: 99.51, 4: 98.98, 5: 98.61, 6: 98.51, 7: 98.42, 8: 98.49}
--------------------------
