Executed at 2024-08-06_10-24-01
logging to ./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_log.txt
seed=59
bg_noise=0.1
train_mix_mnist_model=True
save_mix_mnist_model_as='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
original_train_epochs=4
train_bw_mnist_model=True
save_bw_mnist_model_as='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
original_train_epochs=4
train_bg_only_colour_mnist_model=True
save_bg_only_colour_mnist_model_as='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
original_train_epochs=4
train_bg_unbiased_colour_mnist_model=True
save_bg_unbiased_colour_mnist_model_as='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
original_train_epochs=4
train_biased_colour_mnist_model=True
save_biased_colour_mnist_model_as='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
original_train_epochs=4
train_unbiased_colour_mnist_model=True
save_unbiased_colour_mnist_model_as='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
original_train_epochs=4
stitch_train_epochs=10
================================================
Train ResNet18 on mix
Epoch 0, loss 197.50
Epoch 1, loss 24.10
Epoch 2, loss 18.33
Epoch 3, loss 12.18
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_mix_mnist.weights'
Train ResNet18 on bw
Epoch 0, loss 100.13
Epoch 1, loss 23.93
Epoch 2, loss 17.43
Epoch 3, loss 26.36
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_bw_mnist.weights'
Train ResNet18 on bgonly
Epoch 0, loss 65.88
Epoch 1, loss 6.66
Epoch 2, loss 2.93
Epoch 3, loss 4.76
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_only_colour_mnist.weights'
Train ResNet18 on bg
Epoch 0, loss 140.47
Epoch 1, loss 38.48
Epoch 2, loss 5.94
Epoch 3, loss 0.81
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_bg_unbiased_colour_mnist.weights'
Train ResNet18 on bias
Epoch 0, loss 90.13
Epoch 1, loss 1.46
Epoch 2, loss 2.63
Epoch 3, loss 0.89
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_biased_colour_mnist.weights'
Train ResNet18 on unbias
Epoch 0, loss 197.57
Epoch 1, loss 40.87
Epoch 2, loss 28.94
Epoch 3, loss 24.39
**** Finished Training ****
saveas='./results_4_epochs/2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist.weights'
Entering Confusion
Accuracy Calculation for ResNet18 with key='mix'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    1,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bw'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 75.20 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1131,    1,    1,    0,    1,    0,    0,    1,    0],
        [  21,    1,  946,    0,    2,    0,    1,    2,   59,    0],
        [   5,   42,   25,   83,    0,    3,    0,    9,  840,    3],
        [   6,  139,    0,    0,  807,    0,    0,    0,   14,   16],
        [   4,   19,    0,    0,    0,   66,    0,    1,  802,    0],
        [  66,   44,    0,    0,    1,    0,  817,    0,   30,    0],
        [   3,   85,   10,    0,    2,    0,    0,  867,   46,   15],
        [  30,    4,    0,    0,    0,    0,    0,    1,  939,    0],
        [  12,   37,    0,    0,    2,    0,    0,    1,   72,  885]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bgonly'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 60.15 %
Confusion Matrix
tensor([[  60,    0,    0,    4,    0,    0,  653,  263,    0,    0],
        [   0, 1063,    0,   24,   34,   14,    0,    0,    0,    0],
        [   0,    0,  448,    0,    0,   69,    0,    0,  515,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,  659,    0,    0,  299,    0,    0,    0],
        [   0,    0,    0,    0,  530,    0,    0,  498,    0,    0],
        [   0,    0,    0,    0,   62,  733,    0,    0,  179,    0],
        [   0,    0,    0,  414,    0,   11,    0,    0,    0,  584]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bg'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='bias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 99.87 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  997,    0,    0,   13,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
tensor(10000)
Accuracy Calculation for ResNet18 with key='unbias'
Test the Trained Resnet18 against BIASED TEST DATALOADER
Test Accuracy: 98.52 %
Confusion Matrix
tensor([[ 975,    0,    0,    0,    0,    2,    1,    1,    1,    0],
        [   0, 1134,    0,    0,    0,    0,    0,    1,    0,    0],
        [   1,    0, 1023,    0,    1,    0,    0,    7,    0,    0],
        [   0,    0,    3, 1000,    0,    0,    0,    2,    3,    2],
        [   0,    0,    2,    0,  965,    0,    2,    2,    1,   10],
        [   2,    0,    1,   12,    0,  860,    8,    1,    2,    6],
        [   6,    2,    0,    0,    1,    1,  947,    0,    1,    0],
        [   0,    2,    1,    0,    0,    0,    0, 1022,    1,    2],
        [   4,    1,    2,    3,    4,    1,    3,    3,  948,    5],
        [   2,    4,    1,    1,   11,    2,    0,    8,    2,  978]],
       dtype=torch.int32)
tensor(10000)
original_accuracy={'mix': 99.99, 'bw': 75.2, 'bgonly': 60.15, 'bg': 100.0, 'bias': 99.87, 'unbias': 98.52}
Entering whole model check
Measure Rank for key='mix'
Measure Rank for key='bw'
Measure Rank for key='bgonly'
Measure Rank for key='bg'
Measure Rank for key='bias'
Measure Rank for key='unbias'
Entering Stitch/Rank
device='cuda:0'
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/mix3unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 199.31
Epoch 1, loss 32.60
Epoch 2, loss 22.02
Epoch 3, loss 16.68
Epoch 4, loss 14.08
Epoch 5, loss 11.98
Epoch 6, loss 10.50
Epoch 7, loss 9.51
Epoch 8, loss 8.68
Epoch 9, loss 8.05
**** Finished Training ****
Change in stitch weights: 0.9676177501678467
Largest abs weight change: 0.1106453463435173
Number of weights changing > 0.1 of that: 1523
Change in stitch bias: 0.028366319835186005
Largest abs bias change: 0.005660012364387512
Number of bias changing > 0.1 of that: 60
Test the trained stitch against biased data
Test Accuracy: 99.66 %
Confusion Matrix
tensor([[ 974,    0,    1,    0,    0,    1,    1,    2,    1,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1009,    0,    0,    0,    1,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    1,    0],
        [   0,    0,    0,    1,    0,  891,    0,    0,    0,    0],
        [   3,    2,    0,    0,    1,    0,  948,    0,    4,    0],
        [   0,    0,    1,    2,    0,    0,    0, 1024,    1,    0],
        [   0,    0,    2,    2,    1,    0,    0,    0,  969,    0],
        [   0,    1,    1,    0,    3,    0,    0,    1,    0, 1003]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix4unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 264.56
Epoch 1, loss 25.62
Epoch 2, loss 14.71
Epoch 3, loss 11.02
Epoch 4, loss 8.64
Epoch 5, loss 7.69
Epoch 6, loss 6.00
Epoch 7, loss 5.47
Epoch 8, loss 5.00
Epoch 9, loss 4.49
**** Finished Training ****
Change in stitch weights: 0.9466359615325928
Largest abs weight change: 0.08188138902187347
Number of weights changing > 0.1 of that: 2179
Change in stitch bias: 0.02911350131034851
Largest abs bias change: 0.0056976452469825745
Number of bias changing > 0.1 of that: 61
Test the trained stitch against biased data
Test Accuracy: 99.83 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    1,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    0,    0,    0,    0,    0,    2,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  979,    0,    0,    2,    0,    1],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    0,    0,    0,    1,    0,  956,    0,    0,    0],
        [   0,    0,    0,    1,    1,    0,    0, 1026,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   1,    0,    0,    2,    1,    0,    0,    0,    3, 1002]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix5unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 197.55
Epoch 1, loss 17.70
Epoch 2, loss 10.44
Epoch 3, loss 7.55
Epoch 4, loss 7.28
Epoch 5, loss 5.91
Epoch 6, loss 5.17
Epoch 7, loss 4.64
Epoch 8, loss 4.11
Epoch 9, loss 3.53
**** Finished Training ****
Change in stitch weights: 0.9238337278366089
Largest abs weight change: 0.04482462257146835
Number of weights changing > 0.1 of that: 7577
Change in stitch bias: 0.027191290631890297
Largest abs bias change: 0.004012644290924072
Number of bias changing > 0.1 of that: 115
Test the trained stitch against biased data
Test Accuracy: 99.95 %
Confusion Matrix
tensor([[ 979,    0,    1,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   1,    0,    0,    0,    0,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    1, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix6unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 58.39
Epoch 1, loss 7.11
Epoch 2, loss 4.66
Epoch 3, loss 3.84
Epoch 4, loss 3.09
Epoch 5, loss 2.69
Epoch 6, loss 2.50
Epoch 7, loss 2.20
Epoch 8, loss 1.85
Epoch 9, loss 1.87
**** Finished Training ****
Change in stitch weights: 0.737060010433197
Largest abs weight change: 0.024376321583986282
Number of weights changing > 0.1 of that: 23346
Change in stitch bias: 0.026800600811839104
Largest abs bias change: 0.002838399261236191
Number of bias changing > 0.1 of that: 230
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix7unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 34.31
Epoch 1, loss 4.23
Epoch 2, loss 3.57
Epoch 3, loss 2.71
Epoch 4, loss 2.52
Epoch 5, loss 2.05
Epoch 6, loss 1.95
Epoch 7, loss 1.73
Epoch 8, loss 1.68
Epoch 9, loss 1.60
**** Finished Training ****
Change in stitch weights: 0.7720333933830261
Largest abs weight change: 0.011208981275558472
Number of weights changing > 0.1 of that: 127289
Change in stitch bias: 0.02673996612429619
Largest abs bias change: 0.0020164325833320618
Number of bias changing > 0.1 of that: 461
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    1,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/mix8unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from mix to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 44.50
Epoch 1, loss 4.62
Epoch 2, loss 3.44
Epoch 3, loss 2.70
Epoch 4, loss 2.28
Epoch 5, loss 2.18
Epoch 6, loss 1.82
Epoch 7, loss 1.72
Epoch 8, loss 1.60
Epoch 9, loss 1.54
**** Finished Training ****
Change in stitch weights: 0.8030382990837097
Largest abs weight change: 0.010420606471598148
Number of weights changing > 0.1 of that: 138465
Change in stitch bias: 0.02578665502369404
Largest abs bias change: 0.0020191967487335205
Number of bias changing > 0.1 of that: 454
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bw3unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 194.96
Epoch 1, loss 55.86
Epoch 2, loss 45.05
Epoch 3, loss 39.31
Epoch 4, loss 35.91
Epoch 5, loss 33.39
Epoch 6, loss 31.46
Epoch 7, loss 29.72
Epoch 8, loss 28.79
Epoch 9, loss 27.49
**** Finished Training ****
Change in stitch weights: 1.0010168552398682
Largest abs weight change: 0.11841902136802673
Number of weights changing > 0.1 of that: 1352
Change in stitch bias: 0.023518092930316925
Largest abs bias change: 0.00566033273935318
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 98.34 %
Confusion Matrix
tensor([[ 972,    1,    4,    0,    0,    0,    2,    1,    0,    0],
        [   0, 1130,    0,    0,    0,    0,    3,    0,    2,    0],
        [   1,    0, 1023,    1,    0,    0,    4,    3,    0,    0],
        [   0,    0,    0, 1001,    0,    4,    0,    2,    3,    0],
        [   0,    1,    3,    1,  966,    0,    2,    2,    2,    5],
        [   0,    0,    0,    9,    0,  880,    1,    2,    0,    0],
        [   8,    3,    1,    1,    1,    5,  934,    0,    5,    0],
        [   0,    0,    6,    0,    0,    0,    0, 1014,    4,    4],
        [   8,    0,    2,    3,    3,    5,    5,    1,  942,    5],
        [   4,    1,    4,    3,    5,    6,    1,    7,    6,  972]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw4unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 162.35
Epoch 1, loss 56.24
Epoch 2, loss 44.62
Epoch 3, loss 38.44
Epoch 4, loss 34.54
Epoch 5, loss 31.35
Epoch 6, loss 29.15
Epoch 7, loss 27.31
Epoch 8, loss 25.82
Epoch 9, loss 24.84
**** Finished Training ****
Change in stitch weights: 0.9927200675010681
Largest abs weight change: 0.124881312251091
Number of weights changing > 0.1 of that: 1411
Change in stitch bias: 0.027491478249430656
Largest abs bias change: 0.0056682005524635315
Number of bias changing > 0.1 of that: 56
Test the trained stitch against biased data
Test Accuracy: 98.43 %
Confusion Matrix
tensor([[ 973,    1,    2,    0,    1,    1,    1,    0,    1,    0],
        [   0, 1131,    1,    0,    0,    0,    1,    2,    0,    0],
        [   5,    1, 1022,    0,    0,    0,    0,    2,    2,    0],
        [   0,    0,    0,  999,    0,    2,    0,    1,    5,    3],
        [   0,    0,    0,    0,  971,    1,    2,    3,    1,    4],
        [   0,    0,    0,   10,    0,  879,    0,    0,    2,    1],
        [   7,    2,    0,    1,    2,    4,  940,    0,    2,    0],
        [   0,    1,   11,    3,    1,    0,    0, 1004,    3,    5],
        [   2,    0,    1,    4,    3,    4,    2,    1,  952,    5],
        [   6,    1,    1,    3,    8,    2,    0,   10,    6,  972]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw5unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 231.50
Epoch 1, loss 46.61
Epoch 2, loss 36.01
Epoch 3, loss 31.48
Epoch 4, loss 27.97
Epoch 5, loss 25.84
Epoch 6, loss 23.82
Epoch 7, loss 21.76
Epoch 8, loss 21.04
Epoch 9, loss 19.88
**** Finished Training ****
Change in stitch weights: 1.035704255104065
Largest abs weight change: 0.05452379956841469
Number of weights changing > 0.1 of that: 7296
Change in stitch bias: 0.02641872875392437
Largest abs bias change: 0.004035040736198425
Number of bias changing > 0.1 of that: 112
Test the trained stitch against biased data
Test Accuracy: 98.68 %
Confusion Matrix
tensor([[ 973,    0,    3,    0,    0,    0,    2,    1,    1,    0],
        [   1, 1126,    4,    0,    0,    0,    3,    0,    1,    0],
        [   3,    2, 1025,    0,    0,    0,    0,    1,    1,    0],
        [   0,    0,    1, 1000,    0,    1,    0,    1,    5,    2],
        [   0,    0,    0,    0,  973,    0,    1,    0,    2,    6],
        [   0,    0,    0,    6,    0,  886,    0,    0,    0,    0],
        [   3,    3,    0,    0,    4,    1,  944,    0,    3,    0],
        [   0,    3,    7,    3,    0,    0,    0, 1007,    1,    7],
        [   1,    0,    1,    0,    1,    1,    3,    2,  961,    4],
        [   1,    3,    2,    5,    5,    4,    0,   10,    6,  973]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw6unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 164.59
Epoch 1, loss 36.58
Epoch 2, loss 28.40
Epoch 3, loss 24.88
Epoch 4, loss 22.42
Epoch 5, loss 21.20
Epoch 6, loss 19.67
Epoch 7, loss 18.01
Epoch 8, loss 17.55
Epoch 9, loss 16.98
**** Finished Training ****
Change in stitch weights: 0.9179556369781494
Largest abs weight change: 0.03881826251745224
Number of weights changing > 0.1 of that: 14146
Change in stitch bias: 0.026775788515806198
Largest abs bias change: 0.002833578735589981
Number of bias changing > 0.1 of that: 238
Test the trained stitch against biased data
Test Accuracy: 99.18 %
Confusion Matrix
tensor([[ 979,    0,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1132,    2,    0,    0,    0,    1,    0,    0,    0],
        [   3,    1, 1028,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,  998,    0,    2,    0,    2,    6,    2],
        [   0,    0,    0,    0,  977,    0,    0,    0,    1,    4],
        [   0,    0,    0,    7,    0,  884,    0,    0,    1,    0],
        [   2,    3,    2,    0,    2,    0,  947,    0,    2,    0],
        [   0,    3,    2,    2,    0,    0,    0, 1014,    1,    6],
        [   1,    0,    0,    0,    1,    0,    2,    1,  966,    3],
        [   0,    2,    2,    5,    4,    0,    0,    2,    1,  993]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw7unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 85.45
Epoch 1, loss 32.43
Epoch 2, loss 29.15
Epoch 3, loss 27.89
Epoch 4, loss 26.67
Epoch 5, loss 25.86
Epoch 6, loss 24.83
Epoch 7, loss 24.59
Epoch 8, loss 23.53
Epoch 9, loss 23.21
**** Finished Training ****
Change in stitch weights: 0.8659304976463318
Largest abs weight change: 0.014645768329501152
Number of weights changing > 0.1 of that: 97624
Change in stitch bias: 0.02614867314696312
Largest abs bias change: 0.0020109154284000397
Number of bias changing > 0.1 of that: 462
Test the trained stitch against biased data
Test Accuracy: 98.68 %
Confusion Matrix
tensor([[ 974,    0,    0,    0,    0,    0,    3,    1,    2,    0],
        [   0, 1127,    1,    2,    0,    0,    3,    1,    1,    0],
        [   4,    0, 1024,    1,    0,    0,    1,    1,    1,    0],
        [   0,    0,    1,  990,    0,    4,    0,    6,    7,    2],
        [   0,    0,    0,    0,  973,    1,    0,    0,    3,    5],
        [   2,    0,    0,    8,    0,  878,    0,    1,    3,    0],
        [   5,    3,    0,    0,    1,    2,  946,    0,    1,    0],
        [   0,    1,    2,    3,    0,    0,    0, 1015,    2,    5],
        [   8,    0,    0,    1,    2,    2,    1,    1,  956,    3],
        [   1,    3,    1,    7,    4,    3,    0,    2,    3,  985]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bw8unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bw to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 70.89
Epoch 1, loss 32.53
Epoch 2, loss 29.53
Epoch 3, loss 27.79
Epoch 4, loss 26.41
Epoch 5, loss 25.47
Epoch 6, loss 25.13
Epoch 7, loss 24.18
Epoch 8, loss 23.28
Epoch 9, loss 23.26
**** Finished Training ****
Change in stitch weights: 0.8343254327774048
Largest abs weight change: 0.014350553043186665
Number of weights changing > 0.1 of that: 97690
Change in stitch bias: 0.026254719123244286
Largest abs bias change: 0.0020202770829200745
Number of bias changing > 0.1 of that: 458
Test the trained stitch against biased data
Test Accuracy: 98.56 %
Confusion Matrix
tensor([[ 973,    0,    0,    0,    0,    1,    3,    1,    2,    0],
        [   0, 1126,    2,    3,    0,    0,    2,    1,    1,    0],
        [   3,    0, 1027,    1,    0,    0,    0,    0,    1,    0],
        [   0,    0,    1,  996,    0,    2,    0,    4,    5,    2],
        [   0,    0,    0,    0,  971,    0,    0,    1,    3,    7],
        [   3,    0,    0,   11,    0,  872,    0,    0,    6,    0],
        [   7,    3,    0,    0,    1,    2,  944,    0,    1,    0],
        [   0,    4,    2,    5,    0,    1,    0, 1008,    2,    6],
        [   8,    0,    0,    4,    2,    1,    2,    1,  953,    3],
        [   1,    3,    0,    7,    5,    2,    0,    4,    1,  986]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bgonly3unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 185.52
Epoch 1, loss 29.79
Epoch 2, loss 18.66
Epoch 3, loss 13.40
Epoch 4, loss 11.20
Epoch 5, loss 9.26
Epoch 6, loss 8.51
Epoch 7, loss 6.77
Epoch 8, loss 5.11
Epoch 9, loss 5.33
**** Finished Training ****
Change in stitch weights: 0.9347208142280579
Largest abs weight change: 0.08474062383174896
Number of weights changing > 0.1 of that: 2006
Change in stitch bias: 0.02463260293006897
Largest abs bias change: 0.005621075630187988
Number of bias changing > 0.1 of that: 61
Test the trained stitch against biased data
Test Accuracy: 99.96 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    1,    1,    0,    0,    0,  955,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly4unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 247.64
Epoch 1, loss 14.05
Epoch 2, loss 9.83
Epoch 3, loss 8.36
Epoch 4, loss 6.49
Epoch 5, loss 5.81
Epoch 6, loss 5.24
Epoch 7, loss 4.03
Epoch 8, loss 3.34
Epoch 9, loss 3.89
**** Finished Training ****
Change in stitch weights: 0.8422967195510864
Largest abs weight change: 0.06706503033638
Number of weights changing > 0.1 of that: 2221
Change in stitch bias: 0.027754738926887512
Largest abs bias change: 0.005497179925441742
Number of bias changing > 0.1 of that: 55
Test the trained stitch against biased data
Test Accuracy: 99.98 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    1,    0,    0,    1,    0, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly5unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 421.85
Epoch 1, loss 19.90
Epoch 2, loss 12.75
Epoch 3, loss 9.61
Epoch 4, loss 8.12
Epoch 5, loss 6.08
Epoch 6, loss 5.51
Epoch 7, loss 4.86
Epoch 8, loss 5.71
Epoch 9, loss 3.73
**** Finished Training ****
Change in stitch weights: 0.9065176248550415
Largest abs weight change: 0.03707258775830269
Number of weights changing > 0.1 of that: 9175
Change in stitch bias: 0.02548041380941868
Largest abs bias change: 0.004004254937171936
Number of bias changing > 0.1 of that: 110
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly6unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 191.19
Epoch 1, loss 17.71
Epoch 2, loss 13.56
Epoch 3, loss 9.70
Epoch 4, loss 9.32
Epoch 5, loss 7.90
Epoch 6, loss 7.01
Epoch 7, loss 6.37
Epoch 8, loss 5.67
Epoch 9, loss 5.23
**** Finished Training ****
Change in stitch weights: 0.9171082973480225
Largest abs weight change: 0.031107136979699135
Number of weights changing > 0.1 of that: 21378
Change in stitch bias: 0.02592414803802967
Largest abs bias change: 0.0028528012335300446
Number of bias changing > 0.1 of that: 239
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly7unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 56.19
Epoch 1, loss 14.52
Epoch 2, loss 12.05
Epoch 3, loss 11.47
Epoch 4, loss 10.33
Epoch 5, loss 9.92
Epoch 6, loss 9.22
Epoch 7, loss 8.85
Epoch 8, loss 9.10
Epoch 9, loss 7.82
**** Finished Training ****
Change in stitch weights: 0.8180520534515381
Largest abs weight change: 0.016653241589665413
Number of weights changing > 0.1 of that: 74625
Change in stitch bias: 0.02611091360449791
Largest abs bias change: 0.0020175278186798096
Number of bias changing > 0.1 of that: 460
Test the trained stitch against biased data
Test Accuracy: 99.89 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    0,    4,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1031,    0,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    6,    0,    0,  952,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bgonly8unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bgonly to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 59.34
Epoch 1, loss 14.18
Epoch 2, loss 12.34
Epoch 3, loss 10.49
Epoch 4, loss 11.40
Epoch 5, loss 9.51
Epoch 6, loss 8.99
Epoch 7, loss 8.53
Epoch 8, loss 9.50
Epoch 9, loss 8.69
**** Finished Training ****
Change in stitch weights: 0.8101438879966736
Largest abs weight change: 0.015515566803514957
Number of weights changing > 0.1 of that: 84829
Change in stitch bias: 0.026694852858781815
Largest abs bias change: 0.0020208507776260376
Number of bias changing > 0.1 of that: 463
Test the trained stitch against biased data
Test Accuracy: 99.87 %
Confusion Matrix
tensor([[ 973,    0,    0,    0,    0,    0,    7,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    5,    0,    0,  953,    0,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0, 1027,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bg3unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 422.92
Epoch 1, loss 29.59
Epoch 2, loss 18.72
Epoch 3, loss 14.32
Epoch 4, loss 11.88
Epoch 5, loss 8.84
Epoch 6, loss 8.29
Epoch 7, loss 7.09
Epoch 8, loss 6.18
Epoch 9, loss 6.34
**** Finished Training ****
Change in stitch weights: 1.1078405380249023
Largest abs weight change: 0.07789531350135803
Number of weights changing > 0.1 of that: 2234
Change in stitch bias: 0.027579205110669136
Largest abs bias change: 0.005704209208488464
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 99.82 %
Confusion Matrix
tensor([[ 975,    1,    0,    0,    0,    0,    2,    1,    1,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   3,    1,    0,    0,    0,    0,  954,    0,    0,    0],
        [   0,    0,    2,    3,    0,    0,    0, 1023,    0,    0],
        [   0,    0,    0,    0,    1,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    2,    0, 1007]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg4unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 237.80
Epoch 1, loss 18.21
Epoch 2, loss 10.92
Epoch 3, loss 9.51
Epoch 4, loss 7.11
Epoch 5, loss 6.53
Epoch 6, loss 5.45
Epoch 7, loss 4.83
Epoch 8, loss 5.00
Epoch 9, loss 3.45
**** Finished Training ****
Change in stitch weights: 0.9503136873245239
Largest abs weight change: 0.08697263896465302
Number of weights changing > 0.1 of that: 1924
Change in stitch bias: 0.023341134190559387
Largest abs bias change: 0.005671001970767975
Number of bias changing > 0.1 of that: 54
Test the trained stitch against biased data
Test Accuracy: 99.95 %
Confusion Matrix
tensor([[ 978,    0,    0,    0,    0,    0,    0,    2,    0,    0],
        [   0, 1133,    0,    0,    0,    2,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    1,    0,    0,    0, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg5unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 298.74
Epoch 1, loss 10.02
Epoch 2, loss 6.37
Epoch 3, loss 4.86
Epoch 4, loss 3.55
Epoch 5, loss 3.46
Epoch 6, loss 3.24
Epoch 7, loss 3.02
Epoch 8, loss 2.76
Epoch 9, loss 2.07
**** Finished Training ****
Change in stitch weights: 0.8359228372573853
Largest abs weight change: 0.0449335053563118
Number of weights changing > 0.1 of that: 7265
Change in stitch bias: 0.025854218751192093
Largest abs bias change: 0.004035592079162598
Number of bias changing > 0.1 of that: 116
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg6unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 109.06
Epoch 1, loss 6.03
Epoch 2, loss 3.90
Epoch 3, loss 2.51
Epoch 4, loss 2.14
Epoch 5, loss 2.16
Epoch 6, loss 1.56
Epoch 7, loss 1.41
Epoch 8, loss 1.21
Epoch 9, loss 1.35
**** Finished Training ****
Change in stitch weights: 0.7634811997413635
Largest abs weight change: 0.026897232979536057
Number of weights changing > 0.1 of that: 20608
Change in stitch bias: 0.025699757039546967
Largest abs bias change: 0.0028502866625785828
Number of bias changing > 0.1 of that: 225
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg7unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 46.66
Epoch 1, loss 2.71
Epoch 2, loss 2.07
Epoch 3, loss 1.53
Epoch 4, loss 1.22
Epoch 5, loss 1.23
Epoch 6, loss 1.02
Epoch 7, loss 1.23
Epoch 8, loss 0.91
Epoch 9, loss 0.94
**** Finished Training ****
Change in stitch weights: 0.786370038986206
Largest abs weight change: 0.01039934903383255
Number of weights changing > 0.1 of that: 137506
Change in stitch bias: 0.0261771772056818
Largest abs bias change: 0.0020205266773700714
Number of bias changing > 0.1 of that: 459
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bg8unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bg to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 45.46
Epoch 1, loss 2.70
Epoch 2, loss 1.78
Epoch 3, loss 1.66
Epoch 4, loss 1.36
Epoch 5, loss 1.07
Epoch 6, loss 1.09
Epoch 7, loss 1.14
Epoch 8, loss 0.99
Epoch 9, loss 0.90
**** Finished Training ****
Change in stitch weights: 0.7818205952644348
Largest abs weight change: 0.010647686198353767
Number of weights changing > 0.1 of that: 134537
Change in stitch bias: 0.02719532512128353
Largest abs bias change: 0.0020143501460552216
Number of bias changing > 0.1 of that: 473
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/bias3unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 183.39
Epoch 1, loss 20.70
Epoch 2, loss 14.60
Epoch 3, loss 11.66
Epoch 4, loss 9.37
Epoch 5, loss 8.15
Epoch 6, loss 6.77
Epoch 7, loss 6.22
Epoch 8, loss 5.49
Epoch 9, loss 4.92
**** Finished Training ****
Change in stitch weights: 0.9035182595252991
Largest abs weight change: 0.07068471610546112
Number of weights changing > 0.1 of that: 2379
Change in stitch bias: 0.025912510231137276
Largest abs bias change: 0.005695939064025879
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.88 %
Confusion Matrix
tensor([[ 979,    0,    1,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1030,    1,    0,    0,    0,    0,    1,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  981,    0,    0,    0,    1,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   1,    1,    0,    0,    0,    0,  955,    1,    0,    0],
        [   0,    0,    1,    0,    2,    0,    0, 1025,    0,    0],
        [   0,    0,    1,    0,    0,    0,    0,    0,  973,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    1, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias4unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 280.75
Epoch 1, loss 13.75
Epoch 2, loss 6.98
Epoch 3, loss 5.67
Epoch 4, loss 5.03
Epoch 5, loss 4.49
Epoch 6, loss 4.27
Epoch 7, loss 3.32
Epoch 8, loss 3.24
Epoch 9, loss 3.08
**** Finished Training ****
Change in stitch weights: 0.9364172220230103
Largest abs weight change: 0.08228965103626251
Number of weights changing > 0.1 of that: 2142
Change in stitch bias: 0.023578863590955734
Largest abs bias change: 0.005699492990970612
Number of bias changing > 0.1 of that: 57
Test the trained stitch against biased data
Test Accuracy: 99.99 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    1, 1008]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias5unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 208.44
Epoch 1, loss 15.79
Epoch 2, loss 9.78
Epoch 3, loss 6.89
Epoch 4, loss 6.09
Epoch 5, loss 4.93
Epoch 6, loss 4.70
Epoch 7, loss 3.86
Epoch 8, loss 3.44
Epoch 9, loss 3.50
**** Finished Training ****
Change in stitch weights: 0.8858732581138611
Largest abs weight change: 0.044274747371673584
Number of weights changing > 0.1 of that: 7417
Change in stitch bias: 0.022780224680900574
Largest abs bias change: 0.003961190581321716
Number of bias changing > 0.1 of that: 108
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias6unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 96.30
Epoch 1, loss 5.76
Epoch 2, loss 3.74
Epoch 3, loss 2.53
Epoch 4, loss 2.65
Epoch 5, loss 2.34
Epoch 6, loss 1.71
Epoch 7, loss 1.45
Epoch 8, loss 1.66
Epoch 9, loss 1.29
**** Finished Training ****
Change in stitch weights: 0.7760009169578552
Largest abs weight change: 0.047073401510715485
Number of weights changing > 0.1 of that: 6351
Change in stitch bias: 0.026330305263400078
Largest abs bias change: 0.002839989960193634
Number of bias changing > 0.1 of that: 232
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias7unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 50.19
Epoch 1, loss 3.06
Epoch 2, loss 1.96
Epoch 3, loss 1.90
Epoch 4, loss 1.49
Epoch 5, loss 1.60
Epoch 6, loss 0.99
Epoch 7, loss 1.02
Epoch 8, loss 0.86
Epoch 9, loss 0.97
**** Finished Training ****
Change in stitch weights: 0.7960789203643799
Largest abs weight change: 0.01546570286154747
Number of weights changing > 0.1 of that: 84424
Change in stitch bias: 0.027574311941862106
Largest abs bias change: 0.0020195096731185913
Number of bias changing > 0.1 of that: 458
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/bias8unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from bias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 50.49
Epoch 1, loss 3.37
Epoch 2, loss 2.22
Epoch 3, loss 1.98
Epoch 4, loss 1.69
Epoch 5, loss 1.66
Epoch 6, loss 1.48
Epoch 7, loss 1.25
Epoch 8, loss 1.20
Epoch 9, loss 1.06
**** Finished Training ****
Change in stitch weights: 0.8030101656913757
Largest abs weight change: 0.012965698726475239
Number of weights changing > 0.1 of that: 110677
Change in stitch bias: 0.026369385421276093
Largest abs bias change: 0.00201241672039032
Number of bias changing > 0.1 of that: 467
Test the trained stitch against biased data
Test Accuracy: 100.00 %
Confusion Matrix
tensor([[ 980,    0,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1032,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0, 1010,    0,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,  982,    0,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,  892,    0,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,  958,    0,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0, 1028,    0,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,  974,    0],
        [   0,    0,    0,    0,    0,    0,    0,    0,    0, 1009]],
       dtype=torch.int32)
===================================================================
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
NOTE: Only running stitch with unbias receive model
Evaluate ranks and output to ./results_4_epochs_rank/unbias3unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 3 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 103.67
Epoch 1, loss 33.38
Epoch 2, loss 25.61
Epoch 3, loss 22.07
Epoch 4, loss 19.38
Epoch 5, loss 17.39
Epoch 6, loss 15.81
Epoch 7, loss 14.66
Epoch 8, loss 13.87
Epoch 9, loss 12.93
**** Finished Training ****
Change in stitch weights: 0.8320612907409668
Largest abs weight change: 0.08224041014909744
Number of weights changing > 0.1 of that: 1765
Change in stitch bias: 0.024359939619898796
Largest abs bias change: 0.005704037845134735
Number of bias changing > 0.1 of that: 58
Test the trained stitch against biased data
Test Accuracy: 99.26 %
Confusion Matrix
tensor([[ 977,    2,    0,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1135,    0,    0,    0,    0,    0,    0,    0,    0],
        [   0,    0, 1024,    2,    0,    0,    0,    4,    2,    0],
        [   0,    0,    0, 1008,    0,    0,    0,    1,    0,    1],
        [   0,    0,    0,    0,  974,    0,    2,    2,    4,    0],
        [   0,    0,    0,    6,    0,  886,    0,    0,    0,    0],
        [  10,    3,    1,    0,    2,    1,  939,    0,    2,    0],
        [   0,    0,    3,    0,    0,    0,    0, 1025,    0,    0],
        [   2,    0,    3,    3,    2,    0,    2,    2,  959,    1],
        [   2,    0,    2,    1,    3,    0,    0,    0,    2,  999]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias4unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 4 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 140.50
Epoch 1, loss 46.52
Epoch 2, loss 37.01
Epoch 3, loss 32.26
Epoch 4, loss 28.42
Epoch 5, loss 25.99
Epoch 6, loss 24.41
Epoch 7, loss 22.88
Epoch 8, loss 21.88
Epoch 9, loss 20.74
**** Finished Training ****
Change in stitch weights: 0.9665029048919678
Largest abs weight change: 0.09710429608821869
Number of weights changing > 0.1 of that: 1755
Change in stitch bias: 0.02374572493135929
Largest abs bias change: 0.005703501403331757
Number of bias changing > 0.1 of that: 55
Test the trained stitch against biased data
Test Accuracy: 98.64 %
Confusion Matrix
tensor([[ 974,    0,    1,    0,    0,    0,    4,    1,    0,    0],
        [   0, 1134,    0,    0,    0,    0,    0,    1,    0,    0],
        [   3,    0, 1019,    0,    1,    0,    0,    3,    6,    0],
        [   0,    0,    0, 1003,    0,    4,    0,    1,    2,    0],
        [   0,    0,    2,    1,  973,    0,    1,    0,    2,    3],
        [   0,    0,    0,   11,    0,  876,    1,    1,    3,    0],
        [   9,    1,    0,    1,    2,    2,  941,    0,    2,    0],
        [   0,    0,    9,    1,    1,    0,    0, 1010,    1,    6],
        [   3,    1,    3,    4,    0,    4,    6,    2,  949,    2],
        [   3,    3,    3,    2,    5,    3,    0,    3,    2,  985]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias5unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 5 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 156.56
Epoch 1, loss 41.51
Epoch 2, loss 32.93
Epoch 3, loss 28.75
Epoch 4, loss 26.02
Epoch 5, loss 24.35
Epoch 6, loss 22.62
Epoch 7, loss 21.09
Epoch 8, loss 20.21
Epoch 9, loss 19.10
**** Finished Training ****
Change in stitch weights: 0.9721702933311462
Largest abs weight change: 0.04554278030991554
Number of weights changing > 0.1 of that: 8186
Change in stitch bias: 0.027660077437758446
Largest abs bias change: 0.0040282681584358215
Number of bias changing > 0.1 of that: 115
Test the trained stitch against biased data
Test Accuracy: 98.66 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    1,    1,    1,    1,    0],
        [   0, 1128,    2,    0,    0,    0,    4,    0,    1,    0],
        [   2,    2, 1018,    2,    1,    0,    1,    4,    2,    0],
        [   0,    0,    0, 1001,    0,    3,    0,    2,    3,    1],
        [   0,    0,    0,    0,  970,    0,    1,    2,    1,    8],
        [   2,    0,    0,    5,    0,  881,    1,    0,    2,    1],
        [   7,    0,    0,    0,    3,    3,  939,    0,    6,    0],
        [   0,    2,    7,    0,    0,    0,    0, 1015,    1,    3],
        [   3,    2,    1,    3,    3,    0,    0,    2,  959,    1],
        [   3,    4,    0,    3,    8,    2,    0,    5,    5,  979]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias6unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 6 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 102.20
Epoch 1, loss 27.44
Epoch 2, loss 23.75
Epoch 3, loss 21.94
Epoch 4, loss 20.97
Epoch 5, loss 19.87
Epoch 6, loss 19.09
Epoch 7, loss 18.29
Epoch 8, loss 17.65
Epoch 9, loss 17.50
**** Finished Training ****
Change in stitch weights: 0.8384742140769958
Largest abs weight change: 0.04911770671606064
Number of weights changing > 0.1 of that: 6926
Change in stitch bias: 0.026493113487958908
Largest abs bias change: 0.002855006605386734
Number of bias changing > 0.1 of that: 233
Test the trained stitch against biased data
Test Accuracy: 98.71 %
Confusion Matrix
tensor([[ 978,    0,    1,    0,    0,    0,    0,    1,    0,    0],
        [   0, 1131,    0,    1,    0,    0,    0,    0,    3,    0],
        [   4,    0, 1023,    0,    1,    0,    0,    3,    1,    0],
        [   0,    0,    0, 1005,    0,    1,    0,    1,    3,    0],
        [   0,    0,    1,    0,  964,    0,    1,    2,    3,   11],
        [   1,    0,    0,    9,    0,  876,    2,    1,    2,    1],
        [   5,    1,    0,    1,    2,    1,  945,    0,    3,    0],
        [   0,    3,    5,    1,    1,    0,    0, 1012,    2,    4],
        [   3,    0,    0,    4,    2,    1,    1,    3,  958,    2],
        [   1,    3,    0,    6,   10,    0,    0,    6,    4,  979]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias7unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 7 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 70.87
Epoch 1, loss 22.97
Epoch 2, loss 21.04
Epoch 3, loss 19.36
Epoch 4, loss 19.25
Epoch 5, loss 18.41
Epoch 6, loss 18.38
Epoch 7, loss 17.61
Epoch 8, loss 17.50
Epoch 9, loss 17.16
**** Finished Training ****
Change in stitch weights: 0.8275539875030518
Largest abs weight change: 0.012132352218031883
Number of weights changing > 0.1 of that: 122046
Change in stitch bias: 0.027291929349303246
Largest abs bias change: 0.0020201802253723145
Number of bias changing > 0.1 of that: 454
Test the trained stitch against biased data
Test Accuracy: 98.70 %
Confusion Matrix
tensor([[ 976,    0,    0,    0,    0,    1,    1,    1,    1,    0],
        [   0, 1131,    0,    1,    0,    0,    2,    0,    1,    0],
        [   1,    0, 1023,    1,    1,    0,    0,    3,    3,    0],
        [   0,    0,    0, 1004,    0,    2,    0,    1,    3,    0],
        [   0,    0,    0,    0,  965,    0,    1,    2,    2,   12],
        [   2,    0,    0,    9,    0,  874,    3,    1,    3,    0],
        [   4,    2,    0,    0,    1,    2,  943,    0,    6,    0],
        [   0,    2,    3,    2,    0,    0,    0, 1014,    1,    6],
        [   1,    0,    2,    4,    3,    2,    1,    2,  958,    1],
        [   1,    4,    0,    3,   10,    2,    0,    4,    3,  982]],
       dtype=torch.int32)
===================================================================
Evaluate ranks and output to ./results_4_epochs_rank/unbias8unbias-bias-59_2024-08-06_10-24-01_SEED59_EPOCHS4_BGN0.1_exp2e_ResNet18_unbiased_colour_mnist-test.csv
Train the stitch to a model stitched after layer 8 from unbias to unbias
Use the biased data loader (train and test) regardless of what unbias was trained on
Epoch 0, loss 61.31
Epoch 1, loss 22.16
Epoch 2, loss 20.88
Epoch 3, loss 19.82
Epoch 4, loss 19.36
Epoch 5, loss 18.34
Epoch 6, loss 17.66
Epoch 7, loss 17.37
Epoch 8, loss 17.35
Epoch 9, loss 17.28
**** Finished Training ****
Change in stitch weights: 0.8123928308486938
Largest abs weight change: 0.01356690376996994
Number of weights changing > 0.1 of that: 105251
Change in stitch bias: 0.026411479339003563
Largest abs bias change: 0.0020171664655208588
Number of bias changing > 0.1 of that: 460
Test the trained stitch against biased data
Test Accuracy: 98.64 %
Confusion Matrix
tensor([[ 977,    0,    0,    0,    0,    1,    1,    1,    0,    0],
        [   0, 1130,    0,    1,    0,    0,    1,    1,    2,    0],
        [   2,    0, 1024,    0,    1,    0,    0,    3,    2,    0],
        [   0,    0,    1, 1001,    0,    3,    0,    2,    3,    0],
        [   0,    0,    1,    0,  966,    0,    1,    2,    2,   10],
        [   2,    0,    0,    8,    0,  877,    1,    1,    2,    1],
        [   5,    1,    0,    0,    2,    4,  942,    0,    4,    0],
        [   0,    0,    5,    3,    0,    0,    0, 1016,    1,    3],
        [   3,    0,    3,    4,    1,    3,    1,    2,  955,    2],
        [   1,    4,    1,    2,   11,    7,    0,    3,    4,  976]],
       dtype=torch.int32)
===================================================================
stitching_accuracies={'mix': {'unbias': {3: 99.66, 4: 99.83, 5: 99.95, 6: 100.0, 7: 99.98, 8: 99.98}}, 'bw': {'unbias': {3: 98.34, 4: 98.43, 5: 98.68, 6: 99.18, 7: 98.68, 8: 98.56}}, 'bgonly': {'unbias': {3: 99.96, 4: 99.98, 5: 100.0, 6: 100.0, 7: 99.89, 8: 99.87}}, 'bg': {'unbias': {3: 99.82, 4: 99.95, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'bias': {'unbias': {3: 99.88, 4: 99.99, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}}, 'unbias': {'unbias': {3: 99.26, 4: 98.64, 5: 98.66, 6: 98.71, 7: 98.7, 8: 98.64}}}
stitching_penalties={'mix': {'unbias': {3: -1.1400000000000006, 4: -1.3100000000000023, 5: -1.4300000000000068, 6: -1.480000000000004, 7: -1.460000000000008, 8: -1.460000000000008}}, 'bw': {'unbias': {3: 0.1799999999999926, 4: 0.0899999999999892, 5: -0.1600000000000108, 6: -0.6600000000000108, 7: -0.1600000000000108, 8: -0.04000000000000625}}, 'bgonly': {'unbias': {3: -1.4399999999999977, 4: -1.460000000000008, 5: -1.480000000000004, 6: -1.480000000000004, 7: -1.3700000000000045, 8: -1.3500000000000085}}, 'bg': {'unbias': {3: -1.2999999999999972, 4: -1.4300000000000068, 5: -1.480000000000004, 6: -1.480000000000004, 7: -1.480000000000004, 8: -1.480000000000004}}, 'bias': {'unbias': {3: -1.3599999999999994, 4: -1.4699999999999989, 5: -1.480000000000004, 6: -1.480000000000004, 7: -1.480000000000004, 8: -1.480000000000004}}, 'unbias': {'unbias': {3: -0.7400000000000091, 4: -0.12000000000000455, 5: -0.14000000000000057, 6: -0.18999999999999773, 7: -0.18000000000000682, 8: -0.12000000000000455}}}
synth-mix
99.99
Stitch Accuracy
{3: 99.66, 4: 99.83, 5: 99.95, 6: 100.0, 7: 99.98, 8: 99.98}
--------------------------
synth-bw
75.2
Stitch Accuracy
{3: 98.34, 4: 98.43, 5: 98.68, 6: 99.18, 7: 98.68, 8: 98.56}
--------------------------
synth-bgonly
60.15
Stitch Accuracy
{3: 99.96, 4: 99.98, 5: 100.0, 6: 100.0, 7: 99.89, 8: 99.87}
--------------------------
synth-bg
100.0
Stitch Accuracy
{3: 99.82, 4: 99.95, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-bias
99.87
Stitch Accuracy
{3: 99.88, 4: 99.99, 5: 100.0, 6: 100.0, 7: 100.0, 8: 100.0}
--------------------------
synth-unbias
98.52
Stitch Accuracy
{3: 99.26, 4: 98.64, 5: 98.66, 6: 98.71, 7: 98.7, 8: 98.64}
--------------------------
